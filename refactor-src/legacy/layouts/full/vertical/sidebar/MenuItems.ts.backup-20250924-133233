import {
  IconActivity,
  IconApps,
  IconBell,
  IconBorderAll,
  IconBug,
  IconCalendar,
  IconCalendarEvent,
  IconChartHistogram,
  IconComponents,
  IconDatabase,
  IconEdit,
  IconFileDescription,
  IconForms,
  IconHome,
  IconLayout,
  IconLayoutDashboard,
  IconMessage,
  IconNews,
  IconNotes,
  IconPalette,
  IconPoint,
  IconRocket,
  IconShield,
  IconSitemap,
  IconTerminal,
  IconUserPlus,
  IconUsers,
  IconWriting,
  IconSettings,
  IconGitBranch
} from '@tabler/icons-react';
import { uniqueId } from 'lodash';
import OrthodoxChurchIcon from '@/components/shared/OrthodoxChurchIcon';

interface MenuitemsType {
  [x: string]: any;
  id?: string;
  navlabel?: boolean;
  subheader?: string;
  title?: string;
  icon?: any;
  href?: string;
  children?: MenuitemsType[];
  chip?: string;
  chipColor?: string;
  variant?: string;
  external?: boolean;
}

// Icon mapping function for refactored routes
const getIconComponent = (iconName?: string) => {
  switch (iconName) {
    case 'Shield':
      return IconShield;
    case 'List':
      return IconBorderAll;
    case 'User':
      return IconUserPlus;
    case 'UserCheck':
      return IconUserPlus;
    case 'Users':
      return IconUsers;
    case 'FileCode':
      return IconFileDescription;
    case 'Sliders':
      return IconEdit;
    case 'Table':
      return IconBorderAll;
    case 'Lock':
      return IconShield;
    case 'Wrench':
      return IconSettings;
    case 'Edit':
      return IconEdit;
    case 'Bug':
      return IconBug;
    case 'Git':
      return IconGitBranch;
    case 'Sitemap':
      return IconSitemap;
    case 'Search':
      return IconEdit; // Using Edit as placeholder for Search
    case 'Server':
      return IconShield; // Using Shield as placeholder for Server
    case 'Wand':
      return IconEdit; // Using Edit as placeholder for Wand
    case 'Test':
      return IconBug; // Using Bug as placeholder for Test
    case 'Alert':
      return IconEdit; // Using Edit as placeholder for Alert
    case 'Fallback':
      return IconEdit; // Using Edit as placeholder for Fallback
    case 'Key':
      return IconShield; // Using Shield as placeholder for Key
    case 'Toggle':
      return IconEdit; // Using Edit as placeholder for Toggle
    case 'Dashboard':
      return IconLayoutDashboard;
    case 'Terminal':
      return IconTerminal;
    case 'Build':
      return IconEdit; // Using Edit as placeholder for Build
    case 'Monitor':
      return IconEdit; // Using Edit as placeholder for Monitor
    case 'Memory':
      return IconEdit; // Using Edit as placeholder for Memory
    case 'Bell':
      return IconBell;
    case 'Book':
      return IconFileDescription;
    case 'Settings':
      return IconSettings;
    case 'Eye':
      return IconEdit; // Using Edit as placeholder for Eye
    case 'Sync':
      return IconEdit; // Using Edit as placeholder for Sync
    case 'Route':
      return IconEdit; // Using Edit as placeholder for Route
    case 'Brain':
      return IconEdit; // Using Edit as placeholder for Brain
    case 'Logs':
      return IconEdit; // Using Edit as placeholder for Logs
    case 'Translate':
      return IconEdit; // Using Edit as placeholder for Translate
    case 'Generate':
      return IconEdit; // Using Edit as placeholder for Generate
    case 'Deploy':
      return IconEdit; // Using Edit as placeholder for Deploy
    case 'Chart':
      return IconChartHistogram;
    case 'Grid':
      return IconBorderAll;
    case 'Dialog':
      return IconEdit; // Using Edit as placeholder for Dialog
    case 'Import':
      return IconEdit; // Using Edit as placeholder for Import
    case 'Token':
      return IconEdit; // Using Edit as placeholder for Token
    case 'Records':
      return IconFileDescription;
    case 'Demo':
      return IconEdit; // Using Edit as placeholder for Demo
    case 'Board':
      return IconBorderAll;
    case 'Column':
      return IconBorderAll;
    case 'Card':
      return IconBorderAll;
    case 'Modal':
      return IconEdit; // Using Edit as placeholder for Modal
    case 'Palette':
      return IconPalette;
    case 'Control':
      return IconEdit; // Using Edit as placeholder for Control
    case 'Color':
      return IconPalette;
    case 'Inspect':
      return IconBug;
    case 'Regression':
      return IconEdit; // Using Edit as placeholder for Regression
    case 'Upload':
      return IconEdit; // Using Edit as placeholder for Upload
    case 'Scan':
      return IconEdit; // Using Edit as placeholder for Scan
    case 'Backup':
      return IconEdit; // Using Edit as placeholder for Backup
    case 'Registry':
      return IconEdit; // Using Edit as placeholder for Registry
    case 'Form':
      return IconForms;
    case 'Install':
      return IconEdit; // Using Edit as placeholder for Install
    case 'Files':
      return IconFileDescription;
    case 'View':
      return IconEdit; // Using Edit as placeholder for View
    case 'Discovery':
      return IconEdit; // Using Edit as placeholder for Discovery
    case 'Mobile':
      return IconEdit; // Using Edit as placeholder for Mobile
    default:
      return IconComponents;
  }
};

const Menuitems: MenuitemsType[] = [
  {
    navlabel: true,
    subheader: 'üè† Dashboards',
  },
  {
    id: uniqueId(),
    title: 'Enhanced Modern Dashboard',
    icon: IconHome,
    href: '/dashboards/modern',
  },
  {
    id: uniqueId(),
    title: 'Admin Dashboard',
    icon: IconShield,
    href: '/dashboards/orthodmetrics',
  },
  {
    id: uniqueId(),
    title: 'Super Admin Console',
    icon: IconShield,
    href: '/admin/dashboard',
  },
  {
    id: uniqueId(),
    title: 'Berry UI',
    icon: IconApps,
    href: '/berry',

  },
  {
    navlabel: true,
    subheader: 'üì∞ News & Social',
  },
  {
    id: uniqueId(),
    title: 'Orthodox Headlines',
    icon: IconNews,
    href: '/orthodox-headlines',
  },
  {
    id: uniqueId(),
    title: 'Blog',
    icon: IconWriting,
    href: '/social/blog',
  },
  {
    id: uniqueId(),
    title: 'Friends',
    icon: IconUserPlus,
    href: '/social/friends',
  },
  {
    id: uniqueId(),
    title: 'Chat',
    icon: IconMessage,
    href: '/social/chat',
  },
  {
    id: uniqueId(),
    title: 'Notifications',
    icon: IconBell,
    href: '/social/notifications',
  },

  {
    navlabel: true,
    subheader: 'üïç Church Tools',
  },
  {
    id: uniqueId(),
    title: 'Church Management',
    icon: OrthodoxChurchIcon,
    href: '#',
    children: [
      {
        id: uniqueId(),
        title: 'All Churches',
        icon: IconPoint,
        href: '/apps/church-management',
      },
      {
        id: uniqueId(),
        title: 'Church Setup Wizard',
        icon: IconPoint,
        href: '/apps/church-management/wizard',
      },
      {
        id: uniqueId(),
        title: 'Church OCR',
        icon: IconPoint,
        href: '/admin/church/:id/ocr',
      },
      {
        id: uniqueId(),
        title: 'Legacy Profile',
        icon: IconPoint,
        href: '/user-profile',
      },
    ],
  },
  {
    id: uniqueId(),
    title: 'Records Management',
    icon: IconFileDescription,
    href: '#',
    children: [
      {
        id: uniqueId(),
        title: 'Dynamic Records',
        icon: IconDatabase,
        href: '/apps/records/dynamic',
      },
      {
        id: uniqueId(),
        title: 'Records AG Grid',
        icon: IconBorderAll,
        href: '/apps/records/enhanced',
      },
      {
        id: uniqueId(),
        title: 'Simple Church Records',
        icon: IconDatabase,
        href: '/apps/records-simple',
      },
      {
        id: uniqueId(),
        title: 'Baptism Records',
        icon: IconFileDescription,
        href: '/apps/records/baptism',
      },
      {
        id: uniqueId(),
        title: 'Marriage Records',
        icon: IconFileDescription,
        href: '/apps/records/marriage',
      },
      {
        id: uniqueId(),
        title: 'Funeral Records',
        icon: IconFileDescription,
        href: '/apps/records/funeral',
      },
      {
        id: uniqueId(),
        title: 'Centralized Records',
        icon: IconBorderAll,
        href: '/apps/records/centralized',
      },
      {
        id: uniqueId(),
        title: 'Dynamic Records Manager',
        icon: IconDatabase,
        href: '/apps/records/manager',
      },
      {
        id: uniqueId(),
        title: 'Modern Records Manager',
        icon: IconRocket,
        href: '/apps/records/modern-manager',
      },
      {
        id: uniqueId(),
        title: 'Editable Records',
        icon: IconEdit,
        href: '/apps/records/editable',
      },
    ],
  },
  {
    id: uniqueId(),
    title: 'Analytics',
    icon: IconChartHistogram,
    href: '/analytics',
  },
  {
    id: uniqueId(),
    title: 'Orthodox Calendar',
    icon: IconCalendar,
    href: '/apps/liturgical-calendar',
  },

  {
    navlabel: true,
    subheader: 'ü§ñ Orthodox Metrics Admin OMAI Studio',
  },
  {
    id: uniqueId(),
    title: 'OMAI Ultimate Logger',
    icon: IconActivity,
    href: '/admin/omai-logger',
  },
  {
    id: uniqueId(),
    title: 'Build Console',
    icon: IconTerminal,
    href: '/admin/build',
  },
  {
    id: uniqueId(),
    title: 'Permissions Management',
    icon: IconShield,
    href: '/admin/permissions',
  },
  {
    navlabel: true,
    subheader: 'üß© Site Components',
  },
  {
    id: uniqueId(),
    title: 'Core Components',
    icon: IconComponents,
    children: [
      {
        id: uniqueId(),
        title: 'Form Components',
        icon: IconForms,
        href: '/sandbox/component-preview/core/forms',
      },
      {
        id: uniqueId(),
        title: 'Theme Components',
        icon: IconPalette,
        href: '/sandbox/component-preview/core/theme',
      },
      {
        id: uniqueId(),
        title: 'Feature Components',
        icon: IconUsers,
        href: '/sandbox/component-preview/core/features',
      },
    ],
  },
  {
    id: uniqueId(),
    title: 'Modernize Components',
    icon: IconLayoutDashboard,
    children: [
      {
        id: uniqueId(),
        title: 'Calendar Components',
        icon: IconCalendarEvent,
        href: '/sandbox/component-preview/modernize/calendar',
      },
      {
        id: uniqueId(),
        title: 'Data Components',
        icon: IconDatabase,
        href: '/sandbox/component-preview/modernize/data',
      },
      {
        id: uniqueId(),
        title: 'Feature Components',
        icon: IconApps,
        href: '/sandbox/component-preview/modernize/features',
      },
    ],
  },
  {
    id: uniqueId(),
    title: 'üß© Component Library',
    icon: IconBorderAll,
    href: '/sandbox/component-library',
  },
  {
    navlabel: true,
    subheader: 'üõ†Ô∏è Developer Tools',
  },
  {
    id: uniqueId(),
    title: 'Site Structure Visualizer',
    icon: IconSitemap,
    href: '/tools/site-structure',
  },
  {
    id: uniqueId(),
    title: 'OMTrace Console',
    icon: IconTerminal,
    href: '/tools/omtrace',
  },
  {
    id: uniqueId(),
    title: 'Assign Task',
    icon: IconEdit,
    href: '/admin/settings',
  },



  {
    navlabel: true,
    subheader: 'üóÇÔ∏è MISC',
  },
  {
    id: uniqueId(),
    title: 'eCommerce',
    icon: IconPoint,
    href: '#',
    children: [
      {
        id: uniqueId(),
        title: 'Shop',
        icon: IconPoint,
        href: '/apps/ecommerce/shop',
      },
      {
        id: uniqueId(),
        title: 'Product List',
        icon: IconPoint,
        href: '/apps/ecommerce/eco-product-list',
      },
      {
        id: uniqueId(),
        title: 'Checkout',
        icon: IconPoint,
        href: '/apps/ecommerce/eco-checkout',
      },
      {
        id: uniqueId(),
        title: 'Add Product',
        icon: IconPoint,
        href: '/apps/ecommerce/add-product',
      },
      {
        id: uniqueId(),
        title: 'Edit Product',
        icon: IconPoint,
        href: '/apps/ecommerce/edit-product',
      },
    ],
  },
  {
    id: uniqueId(),
    title: 'Invoice',
    icon: IconPoint,
    href: '#',
    children: [
      {
        id: uniqueId(),
        title: 'Invoice List',
        icon: IconPoint,
        href: '/apps/invoice/list',
      },
      {
        id: uniqueId(),
        title: 'Create Invoice',
        icon: IconPoint,
        href: '/apps/invoice/create',
      },
    ],
  },
  {
    id: uniqueId(),
    title: 'User Profile',
    icon: IconPoint,
    href: '#',
    children: [
      {
        id: uniqueId(),
        title: 'Followers',
        icon: IconPoint,
        href: '/apps/followers',
      },
      {
        id: uniqueId(),
        title: 'Friends',
        icon: IconPoint,
        href: '/apps/friends',
      },
      {
        id: uniqueId(),
        title: 'Gallery',
        icon: IconPoint,
        href: '/apps/gallery',
      },
    ],
  },

  // Refactored Components Menu Group
];

export const getMenuItems = (user: any) => {
  const churchId = user?.church_id || 46; // fallback to default church ID
  
  if (user && (user.role === 'super_admin' || user.role === 'admin')) {
    // Create dynamic menu items with church-aware URLs
    let dynamicMenuItems = Menuitems.map(item => {
      if (item.title === 'Records Management' && item.children) {
        return {
          ...item,
          children: item.children.map(child => {
            switch (child.title) {
              case 'Dynamic Records':
                return { ...child, href: `/apps/records/dynamic/${churchId}` };
              case 'Records AG Grid':
                return { ...child, href: `/apps/records/enhanced/${churchId}` };
              case 'Simple Church Records':
                return { ...child, href: `/apps/records-simple/${churchId}` };
              case 'Baptism Records':
                return { ...child, href: `/apps/records/baptism` };
              case 'Marriage Records':
                return { ...child, href: `/apps/records/marriage` };
              case 'Funeral Records':
                return { ...child, href: `/apps/records/funeral` };
              case 'Centralized Records':
                return { ...child, href: `/apps/records/centralized` };
              case 'Dynamic Records Manager':
                return { ...child, href: `/apps/records/manager` };
              case 'Modern Records Manager':
                return { ...child, href: `/apps/records/modern-manager` };
              case 'Editable Records':
                return { ...child, href: `/apps/records/editable` };
              default:
                return child;
            }
          })
        };
      }
      return item;
    });
    
    // Filter out Developer Tools for non-super_admin users
    if (user.role !== 'super_admin') {
      dynamicMenuItems = dynamicMenuItems.filter(item => {
        // Remove Developer Tools section and its items
        if (item.subheader === 'üõ†Ô∏è Developer Tools') return false;
        if (item.title === 'Site Structure Visualizer') return false;
        if (item.title === 'OMTrace Console') return false;
        if (item.title === 'Assign Task') return false;
        return true;
      });
    }
    
    return dynamicMenuItems;
  }
  // For non-admin users, show basic apps and their church records
  
  return [
    {
      navlabel: true,
      subheader: 'Dashboard',
    },
    {
      id: uniqueId(),
      title: 'Enhanced Modern Dashboard',
      icon: IconHome,
      href: '/dashboards/modern',
    },
    {
      navlabel: true,
      subheader: 'Apps',
    },
    {
      id: uniqueId(),
      title: 'Notes',
      icon: IconNotes,
      href: '/apps/notes',
    },
    {
      id: uniqueId(),
      title: 'Orthodox Liturgical Calendar',
      icon: IconCalendar,
      href: '/apps/liturgical-calendar',
    },
    // Add Records Management for non-admin users with church-specific URLs
    {
      id: uniqueId(),
      title: 'Records Management',
      icon: IconFileDescription,
      href: '#',
      children: [
        {
          id: uniqueId(),
          title: 'Dynamic Records',
          icon: IconActivity,
          href: `/apps/records/dynamic/${churchId}`,
        },
        {
          id: uniqueId(),
          title: 'Simple Church Records',
          icon: IconDatabase,
          href: `/apps/records-simple/${churchId}`,
        },
        {
          id: uniqueId(),
          title: 'Records AG Grid',
          icon: IconBorderAll,
          href: `/apps/records/enhanced/${churchId}`,
        },
        {
          id: uniqueId(),
          title: 'Baptism Records',
          icon: IconFileDescription,
          href: '/apps/records/baptism',
        },
        {
          id: uniqueId(),
          title: 'Marriage Records',
          icon: IconFileDescription,
          href: '/apps/records/marriage',
        },
        {
          id: uniqueId(),
          title: 'Funeral Records',
          icon: IconFileDescription,
          href: '/apps/records/funeral',
        },
        {
          id: uniqueId(),
          title: 'Centralized Records',
          icon: IconBorderAll,
          href: '/apps/records/centralized',
        },
        {
          id: uniqueId(),
          title: 'Dynamic Records Manager',
          icon: IconDatabase,
          href: '/apps/records/manager',
        },
        {
          id: uniqueId(),
          title: 'Modern Records Manager',
          icon: IconRocket,
          href: '/apps/records/modern-manager',
        },
        {
          id: uniqueId(),
          title: 'Editable Records',
          icon: IconEdit,
          href: '/apps/records/editable',
        },
      ],
    },
    {
      navlabel: true,
      subheader: 'üí¨ Social',
    },
    {
      id: uniqueId(),
      title: 'Blog',
      icon: IconWriting,
      href: '/social/blog',
    },
    {
      id: uniqueId(),
      title: 'Friends',
      icon: IconUserPlus,
      href: '/social/friends',
    },
    {
      id: uniqueId(),
      title: 'Chat',
      icon: IconMessage,
      href: '/social/chat',
    },
    {
      id: uniqueId(),
      title: 'Notifications',
      icon: IconBell,
      href: '/social/notifications',
    },
    {
      navlabel: true,
      subheader: 'Quick Links',
    },
    {
      id: uniqueId(),
      title: 'Users Guide',
      icon: IconFileDescription,
      href: '/frontend-pages/coming-soon',
    },
  ];
};

export default Menuitems;
