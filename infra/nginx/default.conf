# Default server configuration - Strict host matching
# Returns 444 (Connection closed without response) for unmatched hosts
# This prevents serving content to unknown/malicious Host headers

server {
    listen 80 default_server;
    listen [::]:80 default_server;
    
    # Catch all server names not explicitly configured
    server_name _;
    
    # Close connection without response for security
    return 444;
    
    # Disable access logging for rejected requests
    access_log off;
    
    # Optional: Log rejected hosts for monitoring
    # access_log /var/log/nginx/rejected_hosts.log combined;
}

# Additional security: Block requests with no Host header
server {
    listen 80;
    listen [::]:80;
    
    # Empty server_name matches requests with no Host header
    server_name "";
    
    # Close connection without response
    return 444;
    
    access_log off;
}