{"version":3,"file":"UserManagement-CAnrfH6i.js","sources":["../../node_modules/@tabler/icons-react/dist/esm/icons/IconArticle.mjs","../../node_modules/@tabler/icons-react/dist/esm/icons/IconCrown.mjs","../../node_modules/@tabler/icons-react/dist/esm/icons/IconEyeOff.mjs","../../node_modules/@tabler/icons-react/dist/esm/icons/IconKey.mjs","../../node_modules/@tabler/icons-react/dist/esm/icons/IconMessageCircle.mjs","../../src/components/SocialPermissionsToggle.tsx","../../src/components/UserFormModal.tsx","../../src/features/admin/admin/UserManagement.tsx"],"sourcesContent":["/**\n * @license @tabler/icons-react v3.34.1 - MIT\n *\n * This source code is licensed under the MIT license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createReactComponent from '../createReactComponent.mjs';\n\nconst __iconNode = [[\"path\", { \"d\": \"M3 4m0 2a2 2 0 0 1 2 -2h14a2 2 0 0 1 2 2v12a2 2 0 0 1 -2 2h-14a2 2 0 0 1 -2 -2z\", \"key\": \"svg-0\" }], [\"path\", { \"d\": \"M7 8h10\", \"key\": \"svg-1\" }], [\"path\", { \"d\": \"M7 12h10\", \"key\": \"svg-2\" }], [\"path\", { \"d\": \"M7 16h10\", \"key\": \"svg-3\" }]];\nconst IconArticle = createReactComponent(\"outline\", \"article\", \"Article\", __iconNode);\n\nexport { __iconNode, IconArticle as default };\n//# sourceMappingURL=IconArticle.mjs.map\n","/**\n * @license @tabler/icons-react v3.34.1 - MIT\n *\n * This source code is licensed under the MIT license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createReactComponent from '../createReactComponent.mjs';\n\nconst __iconNode = [[\"path\", { \"d\": \"M12 6l4 6l5 -4l-2 10h-14l-2 -10l5 4z\", \"key\": \"svg-0\" }]];\nconst IconCrown = createReactComponent(\"outline\", \"crown\", \"Crown\", __iconNode);\n\nexport { __iconNode, IconCrown as default };\n//# sourceMappingURL=IconCrown.mjs.map\n","/**\n * @license @tabler/icons-react v3.34.1 - MIT\n *\n * This source code is licensed under the MIT license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createReactComponent from '../createReactComponent.mjs';\n\nconst __iconNode = [[\"path\", { \"d\": \"M10.585 10.587a2 2 0 0 0 2.829 2.828\", \"key\": \"svg-0\" }], [\"path\", { \"d\": \"M16.681 16.673a8.717 8.717 0 0 1 -4.681 1.327c-3.6 0 -6.6 -2 -9 -6c1.272 -2.12 2.712 -3.678 4.32 -4.674m2.86 -1.146a9.055 9.055 0 0 1 1.82 -.18c3.6 0 6.6 2 9 6c-.666 1.11 -1.379 2.067 -2.138 2.87\", \"key\": \"svg-1\" }], [\"path\", { \"d\": \"M3 3l18 18\", \"key\": \"svg-2\" }]];\nconst IconEyeOff = createReactComponent(\"outline\", \"eye-off\", \"EyeOff\", __iconNode);\n\nexport { __iconNode, IconEyeOff as default };\n//# sourceMappingURL=IconEyeOff.mjs.map\n","/**\n * @license @tabler/icons-react v3.34.1 - MIT\n *\n * This source code is licensed under the MIT license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createReactComponent from '../createReactComponent.mjs';\n\nconst __iconNode = [[\"path\", { \"d\": \"M16.555 3.843l3.602 3.602a2.877 2.877 0 0 1 0 4.069l-2.643 2.643a2.877 2.877 0 0 1 -4.069 0l-.301 -.301l-6.558 6.558a2 2 0 0 1 -1.239 .578l-.175 .008h-1.172a1 1 0 0 1 -.993 -.883l-.007 -.117v-1.172a2 2 0 0 1 .467 -1.284l.119 -.13l.414 -.414h2v-2h2v-2l2.144 -2.144l-.301 -.301a2.877 2.877 0 0 1 0 -4.069l2.643 -2.643a2.877 2.877 0 0 1 4.069 0z\", \"key\": \"svg-0\" }], [\"path\", { \"d\": \"M15 9h.01\", \"key\": \"svg-1\" }]];\nconst IconKey = createReactComponent(\"outline\", \"key\", \"Key\", __iconNode);\n\nexport { __iconNode, IconKey as default };\n//# sourceMappingURL=IconKey.mjs.map\n","/**\n * @license @tabler/icons-react v3.34.1 - MIT\n *\n * This source code is licensed under the MIT license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createReactComponent from '../createReactComponent.mjs';\n\nconst __iconNode = [[\"path\", { \"d\": \"M3 20l1.3 -3.9c-2.324 -3.437 -1.426 -7.872 2.1 -10.374c3.526 -2.501 8.59 -2.296 11.845 .48c3.255 2.777 3.695 7.266 1.029 10.501c-2.666 3.235 -7.615 4.215 -11.574 2.293l-4.7 1\", \"key\": \"svg-0\" }]];\nconst IconMessageCircle = createReactComponent(\"outline\", \"message-circle\", \"MessageCircle\", __iconNode);\n\nexport { __iconNode, IconMessageCircle as default };\n//# sourceMappingURL=IconMessageCircle.mjs.map\n","import React, { useState, useEffect } from 'react';\r\nimport {\r\n    Box,\r\n    Typography,\r\n    Switch,\r\n    FormControlLabel,\r\n    Alert,\r\n    CircularProgress,\r\n    Stack,\r\n    Card,\r\n    CardContent,\r\n    Chip,\r\n    Button,\r\n    Divider,\r\n    List,\r\n    ListItem,\r\n    ListItemIcon,\r\n    ListItemText,\r\n    Tooltip\r\n} from '@mui/material';\r\nimport {\r\n    IconUsers,\r\n    IconArticle,\r\n    IconUserPlus,\r\n    IconMessageCircle,\r\n    IconBell,\r\n    IconCheck,\r\n    IconX\r\n} from '@tabler/icons-react';\r\nimport { useAuth } from '../context/AuthContext.tsx';\r\n\r\ninterface SocialPermission {\r\n    id: number;\r\n    menu_key: string;\r\n    title: string;\r\n    path: string;\r\n    description: string;\r\n    enabled: boolean;\r\n}\r\n\r\ninterface SocialPermissionsToggleProps {\r\n    userId: number;\r\n    userEmail: string;\r\n    userRole: string;\r\n    onPermissionsChanged?: () => void;\r\n}\r\n\r\nconst SocialPermissionsToggle: React.FC<SocialPermissionsToggleProps> = ({\r\n    userId,\r\n    userEmail,\r\n    userRole,\r\n    onPermissionsChanged\r\n}) => {\r\n    const { isSuperAdmin } = useAuth();\r\n    const [loading, setLoading] = useState(false);\r\n    const [permissions, setPermissions] = useState<SocialPermission[]>([]);\r\n    const [socialEnabled, setSocialEnabled] = useState(false);\r\n    const [error, setError] = useState<string>('');\r\n    const [success, setSuccess] = useState<string>('');\r\n\r\n    // Icon mapping for social features\r\n    const getIcon = (menuKey: string) => {\r\n        switch (menuKey) {\r\n            case 'social': return IconUsers;\r\n            case 'social.blog': return IconArticle;\r\n            case 'social.friends': return IconUserPlus;\r\n            case 'social.chat': return IconMessageCircle;\r\n            case 'social.notifications': return IconBell;\r\n            default: return IconUsers;\r\n        }\r\n    };\r\n\r\n    // Load user's social permissions\r\n    const loadPermissions = async () => {\r\n        try {\r\n            setLoading(true);\r\n            setError('');\r\n            \r\n            const response = await fetch(`/api/admin/social-permissions/user/${userId}`, {\r\n                credentials: 'include'\r\n            });\r\n            \r\n            if (response.ok) {\r\n                const data = await response.json();\r\n                if (data.success) {\r\n                    setPermissions(data.socialPermissions || []);\r\n                    \r\n                    // Check if any social features are enabled\r\n                    const hasEnabledFeatures = data.socialPermissions?.some((p: SocialPermission) => p.enabled) || false;\r\n                    setSocialEnabled(hasEnabledFeatures);\r\n                    \r\n                    console.log('üì± Loaded social permissions:', data);\r\n                } else {\r\n                    setError(data.message || 'Failed to load social permissions');\r\n                }\r\n            } else {\r\n                setError('Failed to load social permissions');\r\n            }\r\n        } catch (err) {\r\n            console.error('Error loading social permissions:', err);\r\n            setError('Failed to load social permissions');\r\n        } finally {\r\n            setLoading(false);\r\n        }\r\n    };\r\n\r\n    // Toggle social features on/off\r\n    const toggleSocialFeatures = async (enabled: boolean) => {\r\n        if (!isSuperAdmin()) {\r\n            setError('Only super administrators can manage social permissions');\r\n            return;\r\n        }\r\n\r\n        try {\r\n            setLoading(true);\r\n            setError('');\r\n            setSuccess('');\r\n            \r\n            const response = await fetch(`/api/admin/social-permissions/user/${userId}`, {\r\n                method: 'PUT',\r\n                headers: {\r\n                    'Content-Type': 'application/json'\r\n                },\r\n                credentials: 'include',\r\n                body: JSON.stringify({\r\n                    enabled,\r\n                    socialItems: permissions.map(p => p.id)\r\n                })\r\n            });\r\n            \r\n            if (response.ok) {\r\n                const data = await response.json();\r\n                if (data.success) {\r\n                    setSocialEnabled(enabled);\r\n                    setSuccess(data.message || `Social features ${enabled ? 'enabled' : 'disabled'} successfully`);\r\n                    \r\n                    // Reload permissions to reflect changes\r\n                    await loadPermissions();\r\n                    \r\n                    // Notify parent component\r\n                    if (onPermissionsChanged) {\r\n                        onPermissionsChanged();\r\n                    }\r\n                    \r\n                    console.log('üì± Updated social permissions:', data);\r\n                } else {\r\n                    setError(data.message || 'Failed to update social permissions');\r\n                }\r\n            } else {\r\n                setError('Failed to update social permissions');\r\n            }\r\n        } catch (err) {\r\n            console.error('Error updating social permissions:', err);\r\n            setError('Failed to update social permissions');\r\n        } finally {\r\n            setLoading(false);\r\n        }\r\n    };\r\n\r\n    // Quick enable button\r\n    const quickEnable = async () => {\r\n        if (!isSuperAdmin()) {\r\n            setError('Only super administrators can manage social permissions');\r\n            return;\r\n        }\r\n\r\n        try {\r\n            setLoading(true);\r\n            setError('');\r\n            setSuccess('');\r\n            \r\n            const response = await fetch(`/api/admin/social-permissions/user/${userId}/enable`, {\r\n                method: 'POST',\r\n                credentials: 'include'\r\n            });\r\n            \r\n            if (response.ok) {\r\n                const data = await response.json();\r\n                if (data.success) {\r\n                    setSuccess(`Social features enabled for ${userEmail}`);\r\n                    await loadPermissions();\r\n                    \r\n                    if (onPermissionsChanged) {\r\n                        onPermissionsChanged();\r\n                    }\r\n                    \r\n                    console.log('üì± Quick enabled social features:', data);\r\n                } else {\r\n                    setError(data.message || 'Failed to enable social features');\r\n                }\r\n            } else {\r\n                setError('Failed to enable social features');\r\n            }\r\n        } catch (err) {\r\n            console.error('Error enabling social features:', err);\r\n            setError('Failed to enable social features');\r\n        } finally {\r\n            setLoading(false);\r\n        }\r\n    };\r\n\r\n    // Load permissions on component mount\r\n    useEffect(() => {\r\n        if (userId) {\r\n            loadPermissions();\r\n        }\r\n    }, [userId]);\r\n\r\n    // Auto-clear messages after 3 seconds\r\n    useEffect(() => {\r\n        if (success) {\r\n            const timer = setTimeout(() => setSuccess(''), 3000);\r\n            return () => clearTimeout(timer);\r\n        }\r\n    }, [success]);\r\n\r\n    useEffect(() => {\r\n        if (error) {\r\n            const timer = setTimeout(() => setError(''), 5000);\r\n            return () => clearTimeout(timer);\r\n        }\r\n    }, [error]);\r\n\r\n    if (!isSuperAdmin()) {\r\n        return (\r\n            <Card variant=\"outlined\">\r\n                <CardContent>\r\n                    <Typography variant=\"body2\" color=\"text.secondary\">\r\n                        Social permissions management is only available to super administrators.\r\n                    </Typography>\r\n                </CardContent>\r\n            </Card>\r\n        );\r\n    }\r\n\r\n    return (\r\n        <Card variant=\"outlined\">\r\n            <CardContent>\r\n                <Box sx={{ display: 'flex', alignItems: 'center', justifyContent: 'space-between', mb: 2 }}>\r\n                    <Typography variant=\"h6\" sx={{ display: 'flex', alignItems: 'center', gap: 1 }}>\r\n                        <IconUsers size={20} />\r\n                        Social Features\r\n                    </Typography>\r\n                    \r\n                    {loading && <CircularProgress size={20} />}\r\n                </Box>\r\n\r\n                {error && (\r\n                    <Alert severity=\"error\" sx={{ mb: 2 }}>\r\n                        {error}\r\n                    </Alert>\r\n                )}\r\n\r\n                {success && (\r\n                    <Alert severity=\"success\" sx={{ mb: 2 }}>\r\n                        {success}\r\n                    </Alert>\r\n                )}\r\n\r\n                <Stack spacing={2}>\r\n                    {/* Main Toggle */}\r\n                    <FormControlLabel\r\n                        control={\r\n                            <Switch\r\n                                checked={socialEnabled}\r\n                                onChange={(e) => toggleSocialFeatures(e.target.checked)}\r\n                                disabled={loading}\r\n                            />\r\n                        }\r\n                        label={\r\n                            <Box>\r\n                                <Typography variant=\"body1\">\r\n                                    Enable Social Features\r\n                                </Typography>\r\n                                <Typography variant=\"body2\" color=\"text.secondary\">\r\n                                    Allow this user to access social features (role: {userRole})\r\n                                </Typography>\r\n                            </Box>\r\n                        }\r\n                    />\r\n\r\n                    {/* Quick Actions */}\r\n                    <Box sx={{ display: 'flex', gap: 1 }}>\r\n                        <Button\r\n                            variant=\"outlined\"\r\n                            size=\"small\"\r\n                            onClick={quickEnable}\r\n                            disabled={loading || socialEnabled}\r\n                            startIcon={<IconCheck size={16} />}\r\n                        >\r\n                            Quick Enable\r\n                        </Button>\r\n                        \r\n                        <Button\r\n                            variant=\"outlined\"\r\n                            size=\"small\"\r\n                            onClick={() => toggleSocialFeatures(false)}\r\n                            disabled={loading || !socialEnabled}\r\n                            startIcon={<IconX size={16} />}\r\n                        >\r\n                            Disable All\r\n                        </Button>\r\n                    </Box>\r\n\r\n                    {/* Feature List */}\r\n                    {permissions.length > 0 && (\r\n                        <>\r\n                            <Divider />\r\n                            <Typography variant=\"subtitle2\" color=\"text.secondary\">\r\n                                Available Social Features:\r\n                            </Typography>\r\n                            \r\n                            <List dense>\r\n                                {permissions.map((permission) => {\r\n                                    const IconComponent = getIcon(permission.menu_key);\r\n                                    return (\r\n                                        <ListItem key={permission.id} sx={{ py: 0.5 }}>\r\n                                            <ListItemIcon sx={{ minWidth: 32 }}>\r\n                                                <IconComponent size={18} />\r\n                                            </ListItemIcon>\r\n                                            <ListItemText\r\n                                                primary={permission.title}\r\n                                                secondary={permission.description}\r\n                                                primaryTypographyProps={{ variant: 'body2' }}\r\n                                                secondaryTypographyProps={{ variant: 'caption' }}\r\n                                            />\r\n                                            <Chip\r\n                                                label={permission.enabled ? 'Enabled' : 'Disabled'}\r\n                                                size=\"small\"\r\n                                                color={permission.enabled ? 'success' : 'default'}\r\n                                                variant={permission.enabled ? 'filled' : 'outlined'}\r\n                                            />\r\n                                        </ListItem>\r\n                                    );\r\n                                })}\r\n                            </List>\r\n                        </>\r\n                    )}\r\n\r\n                    {/* Status Info */}\r\n                    <Box sx={{ mt: 2, p: 1, bgcolor: 'background.default', borderRadius: 1 }}>\r\n                        <Typography variant=\"caption\" color=\"text.secondary\">\r\n                            Social features are managed per user role. Changes affect all users with the \"{userRole}\" role.\r\n                        </Typography>\r\n                    </Box>\r\n                </Stack>\r\n            </CardContent>\r\n        </Card>\r\n    );\r\n};\r\n\r\nexport default SocialPermissionsToggle; ","// src/components/UserFormModal.tsx\r\nimport React, { useState, useEffect } from 'react';\r\nimport {\r\n    Dialog,\r\n    DialogTitle,\r\n    DialogContent,\r\n    DialogActions,\r\n    TextField,\r\n    FormControl,\r\n    InputLabel,\r\n    Select,\r\n    MenuItem,\r\n    Button,\r\n    Box,\r\n    Switch,\r\n    FormControlLabel,\r\n    Alert,\r\n    CircularProgress,\r\n    IconButton,\r\n    InputAdornment,\r\n    Chip,\r\n    Stack,\r\n    Typography\r\n} from '@mui/material';\r\nimport {\r\n    IconX,\r\n    IconEye,\r\n    IconEyeOff,\r\n    IconRefresh,\r\n    IconCopy\r\n} from '@tabler/icons-react';\r\nimport { User, UpdateUser, Church, ResetPasswordData } from '../services/userService.ts';\r\nimport SocialPermissionsToggle from './SocialPermissionsToggle.tsx';\r\n\r\ninterface UserFormModalProps {\r\n    open: boolean;\r\n    onClose: () => void;\r\n    user: User | null;\r\n    churches: Church[];\r\n    mode: 'view' | 'edit' | 'reset-password' | 'delete-confirm';\r\n    onSubmit: (data: UpdateUser | ResetPasswordData | { confirm: boolean }) => Promise<void>;\r\n    loading?: boolean;\r\n    currentUserRole?: string;\r\n}\r\n\r\nconst UserFormModal: React.FC<UserFormModalProps> = ({\r\n    open,\r\n    onClose,\r\n    user,\r\n    churches,\r\n    mode,\r\n    onSubmit,\r\n    loading = false,\r\n    currentUserRole = 'admin'\r\n}) => {\r\n    // Edit user form state\r\n    const [formData, setFormData] = useState<UpdateUser>({\r\n        email: '',\r\n        first_name: '',\r\n        last_name: '',\r\n        role: 'user',\r\n        church_id: null,\r\n        preferred_language: 'en',\r\n        is_active: true\r\n    });\r\n\r\n    // Reset password form state\r\n    const [passwordData, setPasswordData] = useState<ResetPasswordData>({\r\n        new_password: '',\r\n        confirm_password: '',\r\n        auto_generate: false\r\n    });\r\n\r\n    const [showPassword, setShowPassword] = useState(false);\r\n    const [formErrors, setFormErrors] = useState<Record<string, string>>({});\r\n    const [generatedPassword, setGeneratedPassword] = useState('');\r\n\r\n    // Log when modal opens/closes to debug the flow\r\n    useEffect(() => {\r\n        console.log('üîç UserFormModal - Modal open state changed:', open, 'mode:', mode);\r\n        if (open && user && mode === 'edit') {\r\n            console.log('üîç UserFormModal - Modal opened in edit mode with user:', JSON.stringify(user, null, 2));\r\n        }\r\n    }, [open, mode, user]);\r\n\r\n    // Initialize form data when user changes\r\n    useEffect(() => {\r\n        if (user && mode === 'edit') {\r\n            console.log('üîç UserFormModal - FULL DEBUG START');\r\n            console.log('üîç User object:', JSON.stringify(user, null, 2));\r\n            console.log('üîç Churches array:', JSON.stringify(churches, null, 2));\r\n            console.log('üîç User church_id:', user.church_id, 'type:', typeof user.church_id);\r\n            \r\n            // Convert church_id to string for form compatibility\r\n            const churchIdString = user.church_id ? user.church_id.toString() : '';\r\n            console.log('üîç Converting to string:', churchIdString);\r\n            \r\n            // Find matching church\r\n            const matchingChurch = churches.find(ch => ch.id.toString() === churchIdString);\r\n            console.log('üîç Searching for church with ID matching:', churchIdString);\r\n            console.log('üîç Available church IDs:', churches.map(ch => `${ch.id} (${typeof ch.id})`));\r\n            console.log('üîç Matching church found:', matchingChurch);\r\n            console.log('üîç UserFormModal - FULL DEBUG END');\r\n            \r\n            setFormData({\r\n                email: user.email,\r\n                first_name: user.first_name,\r\n                last_name: user.last_name,\r\n                role: user.role,\r\n                church_id: churchIdString,\r\n                preferred_language: user.preferred_language || 'en',\r\n                is_active: user.is_active\r\n            });\r\n        }\r\n    }, [user, mode, churches]);\r\n\r\n    // Reset form state when modal closes\r\n    useEffect(() => {\r\n        if (!open) {\r\n            setFormErrors({});\r\n            setPasswordData({\r\n                new_password: '',\r\n                confirm_password: '',\r\n                auto_generate: false\r\n            });\r\n            setGeneratedPassword('');\r\n            setShowPassword(false);\r\n        }\r\n    }, [open]);\r\n\r\n    const validateEditForm = (): boolean => {\r\n        const errors: Record<string, string> = {};\r\n\r\n        if (!formData.email.trim()) {\r\n            errors.email = 'Email is required';\r\n        } else if (!/\\S+@\\S+\\.\\S+/.test(formData.email)) {\r\n            errors.email = 'Please enter a valid email address';\r\n        }\r\n\r\n        if (!formData.first_name.trim()) {\r\n            errors.first_name = 'First name is required';\r\n        }\r\n\r\n        if (!formData.last_name.trim()) {\r\n            errors.last_name = 'Last name is required';\r\n        }\r\n\r\n        if (!formData.role) {\r\n            errors.role = 'Role is required';\r\n        }\r\n\r\n        // Church selection is only required for non-global admin users\r\n        if (!formData.church_id && formData.role !== 'super_admin' && formData.role !== 'admin') {\r\n            errors.church_id = 'Church selection is required';\r\n        }\r\n\r\n        setFormErrors(errors);\r\n        return Object.keys(errors).length === 0;\r\n    };\r\n\r\n    const validatePasswordForm = (): boolean => {\r\n        const errors: Record<string, string> = {};\r\n\r\n        if (!passwordData.auto_generate) {\r\n            if (!passwordData.new_password) {\r\n                errors.new_password = 'New password is required';\r\n            } else if (passwordData.new_password.length < 8) {\r\n                errors.new_password = 'Password must be at least 8 characters long';\r\n            }\r\n\r\n            if (!passwordData.confirm_password) {\r\n                errors.confirm_password = 'Please confirm the password';\r\n            } else if (passwordData.new_password !== passwordData.confirm_password) {\r\n                errors.confirm_password = 'Passwords do not match';\r\n            }\r\n        }\r\n\r\n        setFormErrors(errors);\r\n        return Object.keys(errors).length === 0;\r\n    };\r\n\r\n    const handleGeneratePassword = () => {\r\n        // Generate secure password\r\n        const charset = 'abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789!@#$%^&*';\r\n        const length = 16;\r\n        let password = '';\r\n        \r\n        // Ensure at least one character from each category\r\n        const lowercase = 'abcdefghijklmnopqrstuvwxyz';\r\n        const uppercase = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ';\r\n        const numbers = '0123456789';\r\n        const symbols = '!@#$%^&*';\r\n        \r\n        password += lowercase[Math.floor(Math.random() * lowercase.length)];\r\n        password += uppercase[Math.floor(Math.random() * uppercase.length)];\r\n        password += numbers[Math.floor(Math.random() * numbers.length)];\r\n        password += symbols[Math.floor(Math.random() * symbols.length)];\r\n        \r\n        // Fill the rest randomly\r\n        for (let i = 4; i < length; i++) {\r\n            password += charset[Math.floor(Math.random() * charset.length)];\r\n        }\r\n        \r\n        // Shuffle the password\r\n        const shuffledPassword = password.split('').sort(() => Math.random() - 0.5).join('');\r\n        \r\n        setGeneratedPassword(shuffledPassword);\r\n        setPasswordData(prev => ({\r\n            ...prev,\r\n            new_password: shuffledPassword,\r\n            confirm_password: shuffledPassword,\r\n            auto_generate: true\r\n        }));\r\n    };\r\n\r\n    const handleCopyPassword = () => {\r\n        if (generatedPassword) {\r\n            navigator.clipboard.writeText(generatedPassword);\r\n        }\r\n    };\r\n\r\n    const handleSubmit = async () => {\r\n        if (mode === 'edit') {\r\n            if (!validateEditForm()) return;\r\n            await onSubmit(formData);\r\n        } else if (mode === 'reset-password') {\r\n            if (!validatePasswordForm()) return;\r\n            await onSubmit(passwordData);\r\n        } else if (mode === 'delete-confirm') {\r\n            await onSubmit({ confirm: true });\r\n        }\r\n    };\r\n\r\n    const canEditRole = (targetRole: string): boolean => {\r\n        if (currentUserRole === 'super_admin') {\r\n            return targetRole !== 'super_admin';\r\n        }\r\n        if (currentUserRole === 'admin') {\r\n            return !['admin', 'super_admin'].includes(targetRole);\r\n        }\r\n        return false;\r\n    };\r\n\r\n    const getAvailableRoles = () => {\r\n        const allRoles = [\r\n            { value: 'viewer', label: 'Viewer', description: 'Read-only access' },\r\n            { value: 'editor', label: 'Editor', description: 'Can edit records/content' },\r\n            { value: 'deacon', label: 'Deacon', description: 'Partial clergy privileges' },\r\n            { value: 'priest', label: 'Priest', description: 'Full clergy privileges' },\r\n            { value: 'church_admin', label: 'Church Administrator', description: 'Church-specific admin access' }\r\n        ];\r\n\r\n        if (currentUserRole === 'super_admin') {\r\n            allRoles.push({ value: 'admin', label: 'Administrator', description: 'Platform administrative access' });\r\n        }\r\n\r\n        return allRoles;\r\n    };\r\n\r\n    const getModalTitle = () => {\r\n        switch (mode) {\r\n            case 'view':\r\n                return `View User: ${user?.first_name} ${user?.last_name}`;\r\n            case 'edit':\r\n                return `Edit User: ${user?.first_name} ${user?.last_name}`;\r\n            case 'reset-password':\r\n                return `Reset Password: ${user?.first_name} ${user?.last_name}`;\r\n            case 'delete-confirm':\r\n                return `Delete User: ${user?.first_name} ${user?.last_name}`;\r\n            default:\r\n                return 'User Management';\r\n        }\r\n    };\r\n\r\n    const renderViewForm = () => (\r\n        <Box sx={{ display: 'flex', flexDirection: 'column', gap: 3, mt: 1 }}>\r\n            <Stack direction=\"row\" spacing={2}>\r\n                <TextField\r\n                    fullWidth\r\n                    label=\"First Name\"\r\n                    value={user?.first_name || ''}\r\n                    InputProps={{ readOnly: true }}\r\n                    variant=\"outlined\"\r\n                />\r\n                <TextField\r\n                    fullWidth\r\n                    label=\"Last Name\"\r\n                    value={user?.last_name || ''}\r\n                    InputProps={{ readOnly: true }}\r\n                    variant=\"outlined\"\r\n                />\r\n            </Stack>\r\n            \r\n            <TextField\r\n                fullWidth\r\n                label=\"Email\"\r\n                value={user?.email || ''}\r\n                InputProps={{ readOnly: true }}\r\n                variant=\"outlined\"\r\n            />\r\n\r\n            <Stack direction=\"row\" spacing={2}>\r\n                <TextField\r\n                    fullWidth\r\n                    label=\"Role\"\r\n                    value={user?.role || ''}\r\n                    InputProps={{ readOnly: true }}\r\n                    variant=\"outlined\"\r\n                />\r\n                <TextField\r\n                    fullWidth\r\n                    label=\"Church\"\r\n                    value={user?.church_name || 'No Church'}\r\n                    InputProps={{ readOnly: true }}\r\n                    variant=\"outlined\"\r\n                />\r\n            </Stack>\r\n\r\n            <Stack direction=\"row\" spacing={2}>\r\n                <TextField\r\n                    fullWidth\r\n                    label=\"Status\"\r\n                    value={user?.is_active ? 'Active' : 'Inactive'}\r\n                    InputProps={{ readOnly: true }}\r\n                    variant=\"outlined\"\r\n                />\r\n                <TextField\r\n                    fullWidth\r\n                    label=\"Last Login\"\r\n                    value={user?.last_login ? new Date(user.last_login).toLocaleDateString() : 'Never'}\r\n                    InputProps={{ readOnly: true }}\r\n                    variant=\"outlined\"\r\n                />\r\n            </Stack>\r\n\r\n            <TextField\r\n                fullWidth\r\n                label=\"Created At\"\r\n                value={user?.created_at ? new Date(user.created_at).toLocaleDateString() : 'Unknown'}\r\n                InputProps={{ readOnly: true }}\r\n                variant=\"outlined\"\r\n            />\r\n        </Box>\r\n    );\r\n\r\n    const renderEditForm = () => (\r\n        <Box sx={{ display: 'flex', flexDirection: 'column', gap: 3, mt: 1 }}>\r\n            <Stack direction=\"row\" spacing={2}>\r\n                <TextField\r\n                    fullWidth\r\n                    label=\"First Name\"\r\n                    value={formData.first_name}\r\n                    onChange={(e) => setFormData(prev => ({ ...prev, first_name: e.target.value }))}\r\n                    error={!!formErrors.first_name}\r\n                    helperText={formErrors.first_name}\r\n                    disabled={loading}\r\n                />\r\n                <TextField\r\n                    fullWidth\r\n                    label=\"Last Name\"\r\n                    value={formData.last_name}\r\n                    onChange={(e) => setFormData(prev => ({ ...prev, last_name: e.target.value }))}\r\n                    error={!!formErrors.last_name}\r\n                    helperText={formErrors.last_name}\r\n                    disabled={loading}\r\n                />\r\n            </Stack>\r\n\r\n            <TextField\r\n                fullWidth\r\n                label=\"Email\"\r\n                type=\"email\"\r\n                value={formData.email}\r\n                onChange={(e) => setFormData(prev => ({ ...prev, email: e.target.value }))}\r\n                error={!!formErrors.email}\r\n                helperText={formErrors.email || 'User will be notified of email changes'}\r\n                disabled={loading}\r\n            />\r\n\r\n            <Stack direction=\"row\" spacing={2}>\r\n                <FormControl fullWidth error={!!formErrors.role}>\r\n                    <InputLabel>Role</InputLabel>\r\n                    <Select\r\n                        value={formData.role}\r\n                        label=\"Role\"\r\n                        onChange={(e) => setFormData(prev => ({ ...prev, role: e.target.value }))}\r\n                        disabled={loading || !canEditRole(formData.role)}\r\n                    >\r\n                        {getAvailableRoles().map((role) => (\r\n                            <MenuItem key={role.value} value={role.value}>\r\n                                <Box>\r\n                                    <Typography variant=\"body1\">{role.label}</Typography>\r\n                                    <Typography variant=\"caption\" color=\"text.secondary\">\r\n                                        {role.description}\r\n                                    </Typography>\r\n                                </Box>\r\n                            </MenuItem>\r\n                        ))}\r\n                    </Select>\r\n                    {formErrors.role && (\r\n                        <Typography variant=\"caption\" color=\"error\" sx={{ mt: 1, ml: 2 }}>\r\n                            {formErrors.role}\r\n                        </Typography>\r\n                    )}\r\n                </FormControl>\r\n\r\n                <FormControl fullWidth required={formData.role !== 'super_admin' && formData.role !== 'admin'} error={!!formErrors.church_id}>\r\n                    <InputLabel>Church {formData.role !== 'super_admin' && formData.role !== 'admin' ? '*' : '(Optional - Global Access)'}</InputLabel>\r\n                    <Select\r\n                        value={formData.church_id || ''}\r\n                        label={`Church ${formData.role !== 'super_admin' && formData.role !== 'admin' ? '*' : '(Optional - Global Access)'}`}\r\n                        onChange={(e) => {\r\n                            const value = e.target.value;\r\n                            console.log('üîç Church select changed to:', value, 'type:', typeof value);\r\n                            setFormData(prev => ({ ...prev, church_id: value || null }));\r\n                        }}\r\n                        disabled={loading}\r\n                    >\r\n                        <MenuItem value=\"\">\r\n                            {formData.role === 'super_admin' || formData.role === 'admin' \r\n                                ? 'No specific church (Global access)' \r\n                                : 'Select a church...'\r\n                            }\r\n                        </MenuItem>\r\n                        {churches.sort((a, b) => a.name.localeCompare(b.name)).map((church) => {\r\n                            const isSelected = formData.church_id === church.id.toString();\r\n                            console.log(`üîç MenuItem church ${church.name} (${church.id}): value=\"${church.id.toString()}\", selected=${isSelected}, formData.church_id=\"${formData.church_id}\"`);\r\n                            return (\r\n                                <MenuItem key={church.id} value={church.id.toString()}>\r\n                                    {church.name} {isSelected ? '‚úì' : ''}\r\n                                </MenuItem>\r\n                            );\r\n                        })}\r\n                    </Select>\r\n                    {formErrors.church_id && (\r\n                        <Typography variant=\"caption\" color=\"error\" sx={{ mt: 1, ml: 2 }}>\r\n                            {formErrors.church_id}\r\n                        </Typography>\r\n                    )}\r\n                </FormControl>\r\n            </Stack>\r\n\r\n            <FormControl fullWidth>\r\n                <InputLabel>Language</InputLabel>\r\n                <Select\r\n                    value={formData.preferred_language}\r\n                    label=\"Language\"\r\n                    onChange={(e) => setFormData(prev => ({ ...prev, preferred_language: e.target.value }))}\r\n                    disabled={loading}\r\n                >\r\n                    <MenuItem value=\"en\">English</MenuItem>\r\n                    <MenuItem value=\"gr\">Greek</MenuItem>\r\n                    <MenuItem value=\"ru\">Russian</MenuItem>\r\n                    <MenuItem value=\"sr\">Serbian</MenuItem>\r\n                    <MenuItem value=\"bg\">Bulgarian</MenuItem>\r\n                    <MenuItem value=\"ro\">Romanian</MenuItem>\r\n                </Select>\r\n            </FormControl>\r\n\r\n            <FormControlLabel\r\n                control={\r\n                    <Switch\r\n                        checked={formData.is_active}\r\n                        onChange={(e) => setFormData(prev => ({ ...prev, is_active: e.target.checked }))}\r\n                        disabled={loading}\r\n                    />\r\n                }\r\n                label={\r\n                    <Box>\r\n                        <Typography variant=\"body2\">\r\n                            Account Status\r\n                        </Typography>\r\n                        <Typography variant=\"caption\" color=\"text.secondary\">\r\n                            {formData.is_active ? 'User can access the system' : 'User access is disabled'}\r\n                        </Typography>\r\n                    </Box>\r\n                }\r\n            />\r\n        </Box>\r\n    );\r\n\r\n    const renderPasswordForm = () => (\r\n        <Box sx={{ display: 'flex', flexDirection: 'column', gap: 3, mt: 1 }}>\r\n            <FormControlLabel\r\n                control={\r\n                    <Switch\r\n                        checked={passwordData.auto_generate}\r\n                        onChange={(e) => {\r\n                            const autoGen = e.target.checked;\r\n                            setPasswordData(prev => ({ ...prev, auto_generate: autoGen }));\r\n                            if (autoGen) {\r\n                                handleGeneratePassword();\r\n                            } else {\r\n                                setGeneratedPassword('');\r\n                                setPasswordData(prev => ({ ...prev, new_password: '', confirm_password: '' }));\r\n                            }\r\n                        }}\r\n                        disabled={loading}\r\n                    />\r\n                }\r\n                label=\"Auto-generate secure password\"\r\n            />\r\n\r\n            {passwordData.auto_generate && generatedPassword && (\r\n                <Box sx={{ p: 2, bgcolor: 'background.paper', border: 1, borderColor: 'divider', borderRadius: 1 }}>\r\n                    <Stack direction=\"row\" spacing={1} alignItems=\"center\" sx={{ mb: 1 }}>\r\n                        <Typography variant=\"subtitle2\" color=\"primary\">\r\n                            Generated Password:\r\n                        </Typography>\r\n                        <IconButton size=\"small\" onClick={handleGeneratePassword} disabled={loading}>\r\n                            <IconRefresh size={16} />\r\n                        </IconButton>\r\n                        <IconButton size=\"small\" onClick={handleCopyPassword} disabled={loading}>\r\n                            <IconCopy size={16} />\r\n                        </IconButton>\r\n                    </Stack>\r\n                    <Typography \r\n                        variant=\"body2\" \r\n                        sx={{ \r\n                            fontFamily: 'monospace', \r\n                            bgcolor: 'grey.100', \r\n                            p: 1, \r\n                            borderRadius: 0.5,\r\n                            wordBreak: 'break-all'\r\n                        }}\r\n                    >\r\n                        {generatedPassword}\r\n                    </Typography>\r\n                    <Typography variant=\"caption\" color=\"text.secondary\">\r\n                        Make sure to copy this password as it won't be shown again.\r\n                    </Typography>\r\n                </Box>\r\n            )}\r\n\r\n            {!passwordData.auto_generate && (\r\n                <>\r\n                    <TextField\r\n                        fullWidth\r\n                        label=\"New Password\"\r\n                        type={showPassword ? 'text' : 'password'}\r\n                        value={passwordData.new_password}\r\n                        onChange={(e) => setPasswordData(prev => ({ ...prev, new_password: e.target.value }))}\r\n                        error={!!formErrors.new_password}\r\n                        helperText={formErrors.new_password || 'Minimum 8 characters with uppercase, lowercase, number, and symbol'}\r\n                        disabled={loading}\r\n                        InputProps={{\r\n                            endAdornment: (\r\n                                <InputAdornment position=\"end\">\r\n                                    <IconButton\r\n                                        onClick={() => setShowPassword(!showPassword)}\r\n                                        disabled={loading}\r\n                                    >\r\n                                        {showPassword ? <IconEyeOff size={20} /> : <IconEye size={20} />}\r\n                                    </IconButton>\r\n                                </InputAdornment>\r\n                            ),\r\n                        }}\r\n                    />\r\n\r\n                    <TextField\r\n                        fullWidth\r\n                        label=\"Confirm Password\"\r\n                        type={showPassword ? 'text' : 'password'}\r\n                        value={passwordData.confirm_password}\r\n                        onChange={(e) => setPasswordData(prev => ({ ...prev, confirm_password: e.target.value }))}\r\n                        error={!!formErrors.confirm_password}\r\n                        helperText={formErrors.confirm_password}\r\n                        disabled={loading}\r\n                    />\r\n                </>\r\n            )}\r\n\r\n            <Alert severity=\"info\">\r\n                The user will be notified via email about their password change and will be required to log in again.\r\n            </Alert>\r\n        </Box>\r\n    );\r\n\r\n    const renderDeleteConfirm = () => (\r\n        <Box sx={{ mt: 1 }}>\r\n            <Alert severity=\"warning\" sx={{ mb: 2 }}>\r\n                <Typography variant=\"body1\" gutterBottom>\r\n                    <strong>Are you sure you want to delete this user?</strong>\r\n                </Typography>\r\n                <Typography variant=\"body2\">\r\n                    This action cannot be undone. The user will lose access to:\r\n                </Typography>\r\n                <Box component=\"ul\" sx={{ mt: 1, mb: 1 }}>\r\n                    <li>All account data and settings</li>\r\n                    <li>Access to church management system</li>\r\n                    <li>Historical activity records</li>\r\n                </Box>\r\n                <Typography variant=\"body2\">\r\n                    Consider deactivating the user instead if you want to preserve their data.\r\n                </Typography>\r\n            </Alert>\r\n\r\n            <Box sx={{ p: 2, bgcolor: 'background.paper', border: 1, borderColor: 'divider', borderRadius: 1 }}>\r\n                <Typography variant=\"subtitle2\" gutterBottom>User Details:</Typography>\r\n                <Stack spacing={1}>\r\n                    <Stack direction=\"row\" spacing={1} alignItems=\"center\">\r\n                        <Typography variant=\"body2\"><strong>Name:</strong></Typography>\r\n                        <Typography variant=\"body2\">{user?.first_name} {user?.last_name}</Typography>\r\n                    </Stack>\r\n                    <Stack direction=\"row\" spacing={1} alignItems=\"center\">\r\n                        <Typography variant=\"body2\"><strong>Email:</strong></Typography>\r\n                        <Typography variant=\"body2\">{user?.email}</Typography>\r\n                    </Stack>\r\n                    <Stack direction=\"row\" spacing={1} alignItems=\"center\">\r\n                        <Typography variant=\"body2\"><strong>Role:</strong></Typography>\r\n                        <Chip \r\n                            size=\"small\" \r\n                            label={user?.role} \r\n                            color={user?.role === 'admin' || user?.role === 'super_admin' ? 'error' : 'primary'}\r\n                        />\r\n                    </Stack>\r\n                    <Stack direction=\"row\" spacing={1} alignItems=\"center\">\r\n                        <Typography variant=\"body2\"><strong>Church:</strong></Typography>\r\n                        <Typography variant=\"body2\">{user?.church_name || 'No Church'}</Typography>\r\n                    </Stack>\r\n                </Stack>\r\n            </Box>\r\n        </Box>\r\n    );\r\n\r\n    return (\r\n        <Dialog \r\n            open={open} \r\n            onClose={onClose} \r\n            maxWidth=\"md\" \r\n            fullWidth\r\n            PaperProps={{\r\n                sx: { minHeight: mode === 'delete-confirm' ? 400 : 500 }\r\n            }}\r\n        >\r\n            <DialogTitle sx={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center' }}>\r\n                <Typography variant=\"h6\">{getModalTitle()}</Typography>\r\n                <IconButton onClick={onClose} disabled={loading}>\r\n                    <IconX size={20} />\r\n                </IconButton>\r\n            </DialogTitle>\r\n\r\n            <DialogContent>\r\n                {mode === 'view' && renderViewForm()}\r\n                {mode === 'edit' && renderEditForm()}\r\n                {mode === 'reset-password' && renderPasswordForm()}\r\n                {mode === 'delete-confirm' && renderDeleteConfirm()}\r\n                \r\n                {/* Social Permissions Section - Only show for edit mode and super admin */}\r\n                {mode === 'edit' && user && (\r\n                    <Box sx={{ mt: 3 }}>\r\n                        <SocialPermissionsToggle\r\n                            userId={user.id}\r\n                            userEmail={user.email}\r\n                            userRole={user.role}\r\n                        />\r\n                    </Box>\r\n                )}\r\n            </DialogContent>\r\n\r\n            <DialogActions sx={{ px: 3, pb: 3 }}>\r\n                <Button onClick={onClose} disabled={loading}>\r\n                    {mode === 'view' ? 'Close' : 'Cancel'}\r\n                </Button>\r\n                {mode !== 'view' && (\r\n                    <Button\r\n                        onClick={handleSubmit}\r\n                        variant=\"contained\"\r\n                        color={mode === 'delete-confirm' ? 'error' : 'primary'}\r\n                        disabled={loading}\r\n                        startIcon={loading ? <CircularProgress size={20} /> : undefined}\r\n                    >\r\n                        {loading ? 'Processing...' : (\r\n                            mode === 'edit' ? 'Save Changes' :\r\n                            mode === 'reset-password' ? 'Reset Password' :\r\n                            'Delete User'\r\n                        )}\r\n                    </Button>\r\n                )}\r\n            </DialogActions>\r\n        </Dialog>\r\n    );\r\n};\r\n\r\nexport default UserFormModal;\r\n","import React, { useState, useEffect } from 'react';\r\nimport {\r\n    Box,\r\n    Card,\r\n    CardContent,\r\n    Typography,\r\n    Button,\r\n    TextField,\r\n    FormControl,\r\n    InputLabel,\r\n    Select,\r\n    MenuItem,\r\n    Table,\r\n    TableBody,\r\n    TableCell,\r\n    TableContainer,\r\n    TableHead,\r\n    TableRow,\r\n    IconButton,\r\n    Dialog,\r\n    DialogTitle,\r\n    DialogContent,\r\n    DialogActions,\r\n    Alert,\r\n    Chip,\r\n    Avatar,\r\n    Stack,\r\n    Switch,\r\n    FormControlLabel,\r\n    Tooltip,\r\n    TablePagination,\r\n    Tabs,\r\n    Tab,\r\n    Snackbar,\r\n    CircularProgress\r\n} from '@mui/material';\r\nimport {\r\n    IconKey,\r\n    IconUserPlus,\r\n    IconBuilding,\r\n    IconUsers,\r\n    IconSearch,\r\n    IconEdit,\r\n    IconTrash,\r\n    IconCrown,\r\n    IconEye\r\n} from '@tabler/icons-react';\r\n\r\nimport PageContainer from '@/shared/ui/PageContainer';\r\nimport Breadcrumb from '@/layouts/full/shared/breadcrumb/Breadcrumb';\r\nimport UserFormModal from '@/components/UserFormModal';\r\n\r\n// contexts\r\nimport { useAuth } from '@/context/AuthContext';\r\nimport { User as AuthUser } from '@/types/orthodox-metrics.types';\r\n\r\n// services\r\nimport userService, { User, Church, NewUser, UpdateUser, ResetPasswordData } from '@/shared/lib/userService';\r\n\r\nconst UserManagement: React.FC = () => {\r\n    const { \r\n        user, \r\n        canCreateAdmins, \r\n        canManageAllUsers, \r\n        isSuperAdmin,\r\n        isRootSuperAdmin,\r\n        canManageUser,\r\n        canPerformDestructiveOperation,\r\n        canChangeRole\r\n    } = useAuth();\r\n    \r\n    const [users, setUsers] = useState<User[]>([]);\r\n    const [churches, setChurches] = useState<Church[]>([]);\r\n    const [loading, setLoading] = useState(false);\r\n    const [error, setError] = useState<string | null>(null);\r\n    const [success, setSuccess] = useState<string | null>(null);\r\n\r\n    // Pagination\r\n    const [page, setPage] = useState(0);\r\n    const [rowsPerPage, setRowsPerPage] = useState(10);\r\n\r\n    // Search and filters\r\n    const [searchTerm, setSearchTerm] = useState('');\r\n    const [roleFilter, setRoleFilter] = useState('all');\r\n    const [churchFilter, setChurchFilter] = useState('all');\r\n    const [activeFilter, setActiveFilter] = useState('all');\r\n\r\n    // Tabs\r\n    const [tabValue, setTabValue] = useState(0);\r\n\r\n    // Dialog states\r\n    const [createUserDialogOpen, setCreateUserDialogOpen] = useState(false);\r\n    const [modalOpen, setModalOpen] = useState(false);\r\n    const [modalMode, setModalMode] = useState<'view' | 'edit' | 'reset-password' | 'delete-confirm'>('edit');\r\n    const [selectedUser, setSelectedUser] = useState<User | null>(null);\r\n    const [modalLoading, setModalLoading] = useState(false);\r\n\r\n    // Form state for creating users\r\n    const [newUser, setNewUser] = useState<NewUser>({\r\n        email: '',\r\n        first_name: '',\r\n        last_name: '',\r\n        role: 'viewer',\r\n        church_id: '',\r\n        phone: '',\r\n        preferred_language: 'en',\r\n        send_welcome_email: true\r\n    });\r\n\r\n    // Check if user is admin\r\n    const isAdmin = user?.role === 'admin' || user?.role === 'super_admin' || user?.role === 'church_admin';\r\n\r\n    // Helper function to convert userService User to AuthUser for permission checks\r\n    const toAuthUser = (userData: User): AuthUser => ({\r\n        ...userData,\r\n        username: userData.email, // Use email as username since it's missing from userService User\r\n        role: userData.role as any, // Type assertion for role compatibility\r\n        preferred_language: (userData.preferred_language || 'en') as any,\r\n        timezone: userData.timezone || undefined,\r\n        church_id: userData.church_id || undefined // Convert null to undefined\r\n    });\r\n\r\n    // Root super admin email constant\r\n    const ROOT_SUPERADMIN_EMAIL = 'superadmin@orthodoxmetrics.com';\r\n\r\n    useEffect(() => {\r\n        if (isAdmin) {\r\n            loadData();\r\n        }\r\n    }, [isAdmin]);\r\n\r\n    const loadData = async () => {\r\n        setLoading(true);\r\n        try {\r\n            console.log('üìä Frontend: Loading data...');\r\n            console.log('üîê Current user:', user);\r\n            console.log('üîê User role:', user?.role);\r\n            console.log('üîê Is admin?', isAdmin);\r\n            \r\n            // Debug: Test direct API call\r\n            try {\r\n                const testResponse = await fetch('/api/admin/users', {\r\n                    credentials: 'include'\r\n                });\r\n                console.log('üîç Direct API test response status:', testResponse.status);\r\n                console.log('üîç Direct API test response headers:', Object.fromEntries(testResponse.headers.entries()));\r\n                if (!testResponse.ok) {\r\n                    const errorText = await testResponse.text();\r\n                    console.log('üîç Direct API test error body:', errorText);\r\n                }\r\n            } catch (directErr) {\r\n                console.log('üîç Direct API test failed:', directErr);\r\n            }\r\n            \r\n            const [usersResponse, churchesResponse] = await Promise.all([\r\n                userService.getUsers(),\r\n                userService.getChurches()\r\n            ]);\r\n\r\n            console.log('üìä Frontend: Users response:', usersResponse);\r\n            if (usersResponse.success) {\r\n                console.log('üìä Frontend: Setting users to:', usersResponse.users?.length, 'users');\r\n                // Debug: Log each user's is_active status\r\n                usersResponse.users?.forEach((u, i) => {\r\n                    console.log(`üë§ User ${i+1}: ${u.email} - is_active: ${u.is_active} (type: ${typeof u.is_active})`);\r\n                });\r\n                setUsers(usersResponse.users || []);\r\n            } else {\r\n                console.error('‚ùå Users API failed:', usersResponse);\r\n                setError(usersResponse.message || 'Failed to load users');\r\n            }\r\n\r\n            if (churchesResponse.success) {\r\n                console.log('‚úÖ Churches loaded:', churchesResponse.churches);\r\n                console.log('üîç Looking for Saints Peter and Paul:', \r\n                    churchesResponse.churches?.find(ch => ch.name && ch.name.includes('Saints Peter and Paul')));\r\n                setChurches(churchesResponse.churches || []);\r\n            } else {\r\n                console.error('‚ùå Churches API failed:', churchesResponse);\r\n                console.error('‚ùå Failed to load churches:', churchesResponse.message);\r\n                if (churchesResponse.message === undefined) {\r\n                    setError('Failed to load churches: API returned undefined message (possible 401 error)');\r\n                } else {\r\n                    setError('Failed to load churches: ' + churchesResponse.message);\r\n                }\r\n            }\r\n        } catch (err) {\r\n            console.error('‚ùå Error loading data:', err);\r\n            setError('Failed to load data');\r\n        } finally {\r\n            setLoading(false);\r\n        }\r\n    };\r\n\r\n    const handleCreateUser = async () => {\r\n        // Validate required fields\r\n        if (!newUser.email.trim()) {\r\n            setError('Email is required');\r\n            return;\r\n        }\r\n        if (!newUser.first_name.trim()) {\r\n            setError('First name is required');\r\n            return;\r\n        }\r\n        if (!newUser.last_name.trim()) {\r\n            setError('Last name is required');\r\n            return;\r\n        }\r\n        if (!newUser.role) {\r\n            setError('Role is required');\r\n            return;\r\n        }\r\n        // Church selection is only required for non-global roles\r\n        if (!newUser.church_id && !['super_admin', 'admin'].includes(newUser.role)) {\r\n            setError('Church selection is required for this role');\r\n            return;\r\n        }\r\n\r\n        try {\r\n            setLoading(true);\r\n            const response = await userService.createUser(newUser);\r\n\r\n            if (response.success) {\r\n                setSuccess(`User created successfully! ${response.tempPassword ? `Temporary password: ${response.tempPassword}` : ''}`);\r\n                setCreateUserDialogOpen(false);\r\n                setNewUser({\r\n                    email: '',\r\n                    first_name: '',\r\n                    last_name: '',\r\n                    role: 'viewer',\r\n                    church_id: '',\r\n                    phone: '',\r\n                    preferred_language: 'en',\r\n                    send_welcome_email: true\r\n                });\r\n                await loadData();\r\n            } else {\r\n                setError(response.message || 'Failed to create user');\r\n            }\r\n        } catch (err) {\r\n            setError('An error occurred while creating the user');\r\n            console.error('Error creating user:', err);\r\n        } finally {\r\n            setLoading(false);\r\n        }\r\n    };\r\n\r\n    const handleViewUser = (userData: User) => {\r\n        setSelectedUser(userData);\r\n        setModalMode('view');\r\n        setModalOpen(true);\r\n    };\r\n\r\n    const handleEditUser = (userData: User) => {\r\n        console.log('üîç EDIT USER CLICKED - userData received:', JSON.stringify(userData, null, 2));\r\n        console.log('üîç userData.church_id:', userData.church_id, 'type:', typeof userData.church_id);\r\n        console.log('üîç Current churches state:', churches.length, 'churches loaded');\r\n        setSelectedUser(userData);\r\n        setModalMode('edit');\r\n        setModalOpen(true);\r\n    };\r\n\r\n    const handleResetPassword = (userData: User) => {\r\n        setSelectedUser(userData);\r\n        setModalMode('reset-password');\r\n        setModalOpen(true);\r\n    };\r\n\r\n    const handleDeleteUser = (userData: User) => {\r\n        setSelectedUser(userData);\r\n        setModalMode('delete-confirm');\r\n        setModalOpen(true);\r\n    };\r\n\r\n    const handleModalSubmit = async (data: UpdateUser | ResetPasswordData | { confirm: boolean }) => {\r\n        if (!selectedUser) return;\r\n\r\n        try {\r\n            setModalLoading(true);\r\n            let response;\r\n\r\n            if (modalMode === 'edit') {\r\n                response = await userService.updateUser(selectedUser.id, data as UpdateUser);\r\n            } else if (modalMode === 'reset-password') {\r\n                response = await userService.resetPassword(selectedUser.id, data as ResetPasswordData);\r\n                if (response.success && response.newPassword) {\r\n                    setSuccess(`Password reset successfully! New password: ${response.newPassword}`);\r\n                }\r\n            } else if (modalMode === 'delete-confirm') {\r\n                response = await userService.deleteUser(selectedUser.id);\r\n            }\r\n\r\n            if (response?.success) {\r\n                if (modalMode !== 'reset-password' || !response.newPassword) {\r\n                    setSuccess(response.message || 'Operation completed successfully');\r\n                }\r\n                setModalOpen(false);\r\n                await loadData();\r\n            } else {\r\n                setError(response?.message || 'Operation failed');\r\n            }\r\n        } catch (err) {\r\n            setError('An error occurred during the operation');\r\n            console.error('Error in modal operation:', err);\r\n        } finally {\r\n            setModalLoading(false);\r\n        }\r\n    };\r\n\r\n    const handleToggleUserStatus = async (userId: number, currentStatus: boolean) => {\r\n        try {\r\n            console.log(`üîÑ Frontend: Toggling user ${userId} from ${currentStatus} to ${!currentStatus}`);\r\n            const response = await userService.toggleUserStatus(userId);\r\n            console.log('üîÑ Frontend: Toggle response:', response);\r\n\r\n            if (response.success) {\r\n                setSuccess(response.message || `User ${!currentStatus ? 'activated' : 'deactivated'} successfully`);\r\n                console.log('üîÑ Frontend: Calling loadData to refresh users list...');\r\n                await loadData();\r\n                console.log('üîÑ Frontend: loadData completed');\r\n            } else {\r\n                setError(response.message || 'Failed to update user status');\r\n            }\r\n        } catch (err) {\r\n            setError('An error occurred while updating user status');\r\n            console.error('Error toggling user status:', err);\r\n        }\r\n    };\r\n\r\n    // Filter users based on search and filters\r\n    const filteredUsers = users.filter((userData: User) => {\r\n        const matchesSearch =\r\n            (userData.email || '').toLowerCase().includes(searchTerm.toLowerCase()) ||\r\n            (userData.first_name || '').toLowerCase().includes(searchTerm.toLowerCase()) ||\r\n            (userData.last_name || '').toLowerCase().includes(searchTerm.toLowerCase()) ||\r\n            (userData.church_name && userData.church_name.toLowerCase().includes(searchTerm.toLowerCase()));\r\n\r\n        const matchesRole = roleFilter === 'all' || userData.role === roleFilter;\r\n        const matchesChurch = churchFilter === 'all' || (userData.church_id && userData.church_id.toString() === churchFilter);\r\n        const matchesStatus = activeFilter === 'all' ||\r\n            (activeFilter === 'active' && userData.is_active) ||\r\n            (activeFilter === 'inactive' && !userData.is_active);\r\n\r\n        // Role-based access: Regular admins can't see super_admin or other admin users\r\n        const hasRoleAccess = isSuperAdmin() ||\r\n            (userData.role !== 'super_admin' && userData.role !== 'admin' && userData.role !== 'church_admin');\r\n\r\n        return matchesSearch && matchesRole && matchesChurch && matchesStatus && hasRoleAccess;\r\n    });\r\n\r\n    // Paginate filtered users\r\n    const paginatedUsers = filteredUsers.slice(page * rowsPerPage, page * rowsPerPage + rowsPerPage);\r\n\r\n    // Check if a user is the root super admin\r\n    const isUserRootSuperAdmin = (userData: User): boolean => {\r\n        return userData.email === ROOT_SUPERADMIN_EMAIL;\r\n    };\r\n\r\n    if (!isAdmin) {\r\n        return (\r\n            <PageContainer title=\"User Management\" description=\"Admin user management system\">\r\n                <Alert severity=\"error\">\r\n                    You do not have permission to access this page.\r\n                </Alert>\r\n            </PageContainer>\r\n        );\r\n    }\r\n\r\n    const BCrumb = [\r\n        { to: '/', title: 'Home' },\r\n        { to: '/admin', title: 'Admin' },\r\n        { title: 'User Management' },\r\n    ];\r\n\r\n    return (\r\n        <PageContainer title=\"User Management\" description=\"Manage users in the Orthodox Metrics system\">\r\n            <Breadcrumb title=\"User Management\" items={BCrumb} />\r\n            <Box p={3}>\r\n                <Typography variant=\"h4\" gutterBottom>\r\n                    User Management\r\n                </Typography>\r\n\r\n                <Snackbar\r\n                    open={!!error}\r\n                    autoHideDuration={6000}\r\n                    onClose={() => setError(null)}\r\n                    anchorOrigin={{ vertical: 'top', horizontal: 'center' }}\r\n                >\r\n                    <Alert severity=\"error\" onClose={() => setError(null)}>\r\n                        {error}\r\n                    </Alert>\r\n                </Snackbar>\r\n\r\n                <Snackbar\r\n                    open={!!success}\r\n                    autoHideDuration={6000}\r\n                    onClose={() => setSuccess(null)}\r\n                    anchorOrigin={{ vertical: 'top', horizontal: 'center' }}\r\n                >\r\n                    <Alert severity=\"success\" onClose={() => setSuccess(null)}>\r\n                        {success}\r\n                    </Alert>\r\n                </Snackbar>\r\n\r\n                <Tabs value={tabValue} onChange={(_, newValue) => setTabValue(newValue)} sx={{ mb: 3 }}>\r\n                    <Tab icon={<IconUsers />} label=\"User Management\" />\r\n                    <Tab icon={<IconBuilding />} label=\"Church Management\" />\r\n                </Tabs>\r\n\r\n                {tabValue === 0 && (\r\n                    <>\r\n                        {/* Search and Filters */}\r\n                        <Card sx={{ mb: 3 }}>\r\n                            <CardContent>\r\n                                <Stack direction={{ xs: 'column', md: 'row' }} spacing={2} alignItems=\"center\">\r\n                                    <TextField\r\n                                        sx={{ flex: 1, minWidth: 250 }}\r\n                                        placeholder=\"Search users...\"\r\n                                        value={searchTerm}\r\n                                        onChange={(e) => setSearchTerm(e.target.value)}\r\n                                        InputProps={{\r\n                                            startAdornment: <IconSearch size={20} />,\r\n                                        }}\r\n                                    />\r\n                                    <FormControl sx={{ minWidth: 120 }}>\r\n                                        <InputLabel>Role</InputLabel>\r\n                                        <Select\r\n                                            value={roleFilter}\r\n                                            onChange={(e) => setRoleFilter(e.target.value)}\r\n                                            label=\"Role\"\r\n                                        >\r\n                                            <MenuItem value=\"all\">All Roles</MenuItem>\r\n                                            {isSuperAdmin() && (\r\n                                                <>\r\n                                                    <MenuItem value=\"admin\">Admin</MenuItem>\r\n                                                    <MenuItem value=\"super_admin\">Super Admin</MenuItem>\r\n                                                </>\r\n                                            )}\r\n                                            <MenuItem value=\"manager\">Manager</MenuItem>\r\n                                            <MenuItem value=\"user\">User</MenuItem>\r\n                                            <MenuItem value=\"viewer\">Viewer</MenuItem>\r\n                                        </Select>\r\n                                    </FormControl>\r\n                                    <FormControl sx={{ minWidth: 150 }}>\r\n                                        <InputLabel>Church</InputLabel>\r\n                                        <Select\r\n                                            value={churchFilter}\r\n                                            onChange={(e) => setChurchFilter(e.target.value)}\r\n                                            label=\"Church\"\r\n                                        >\r\n                                            <MenuItem value=\"all\">All Churches</MenuItem>\r\n                                            {churches.map((church) => (\r\n                                                <MenuItem key={church.id} value={church.id.toString()}>\r\n                                                    {church.name}\r\n                                                </MenuItem>\r\n                                            ))}\r\n                                        </Select>\r\n                                    </FormControl>\r\n                                    <FormControl sx={{ minWidth: 120 }}>\r\n                                        <InputLabel>Status</InputLabel>\r\n                                        <Select\r\n                                            value={activeFilter}\r\n                                            onChange={(e) => setActiveFilter(e.target.value)}\r\n                                            label=\"Status\"\r\n                                        >\r\n                                            <MenuItem value=\"all\">All Status</MenuItem>\r\n                                            <MenuItem value=\"active\">Active</MenuItem>\r\n                                            <MenuItem value=\"inactive\">Inactive</MenuItem>\r\n                                        </Select>\r\n                                    </FormControl>\r\n                                    <Button\r\n                                        variant=\"contained\"\r\n                                        startIcon={<IconUserPlus />}\r\n                                        onClick={() => setCreateUserDialogOpen(true)}\r\n                                    >\r\n                                        Add User\r\n                                    </Button>\r\n                                </Stack>\r\n                            </CardContent>\r\n                        </Card>\r\n\r\n                        {/* Users Table */}\r\n                        <Card>\r\n                            <CardContent>\r\n                                {loading ? (\r\n                                    <Box display=\"flex\" justifyContent=\"center\" p={3}>\r\n                                        <CircularProgress />\r\n                                    </Box>\r\n                                ) : (\r\n                                    <>\r\n                                        <TableContainer>\r\n                                            <Table>\r\n                                                <TableHead>\r\n                                                    <TableRow>\r\n                                                        <TableCell>User</TableCell>\r\n                                                        <TableCell>Role</TableCell>\r\n                                                        <TableCell>Church</TableCell>\r\n                                                        <TableCell>Status</TableCell>\r\n                                                        <TableCell>Last Login</TableCell>\r\n                                                        <TableCell align=\"right\">Actions</TableCell>\r\n                                                    </TableRow>\r\n                                                </TableHead>\r\n                                                <TableBody>\r\n                                                    {paginatedUsers.map((userData) => (\r\n                                                        <TableRow key={userData.id}>\r\n                                                            <TableCell>\r\n                                                                <Stack direction=\"row\" spacing={2} alignItems=\"center\">\r\n                                                                    <Avatar sx={{ bgcolor: 'primary.main' }}>\r\n                                                                        {(userData.first_name?.charAt(0) || '') + (userData.last_name?.charAt(0) || '')}\r\n                                                                    </Avatar>\r\n                                                                    <Box>\r\n                                                                        <Stack direction=\"row\" spacing={1} alignItems=\"center\">\r\n                                                                            <Typography variant=\"subtitle2\">\r\n                                                                                {userData.full_name || `${userData.first_name || ''} ${userData.last_name || ''}`.trim() || userData.email}\r\n                                                                            </Typography>\r\n                                                                            {isUserRootSuperAdmin(userData) && (\r\n                                                                                <Tooltip title=\"Root Super Admin\">\r\n                                                                                    <IconCrown size={16} style={{ color: '#FFD700' }} />\r\n                                                                                </Tooltip>\r\n                                                                            )}\r\n                                                                        </Stack>\r\n                                                                        <Typography variant=\"body2\" color=\"text.secondary\">\r\n                                                                            {userData.email}\r\n                                                                        </Typography>\r\n                                                                    </Box>\r\n                                                                </Stack>\r\n                                                            </TableCell>\r\n                                                            <TableCell>\r\n                                                                <Stack direction=\"row\" spacing={1} alignItems=\"center\">\r\n                                                                    <Chip\r\n                                                                        label={userData.role}\r\n                                                                        size=\"small\"\r\n                                                                        color={userService.getRoleBadgeColor(userData.role)}\r\n                                                                    />\r\n                                                                    {isUserRootSuperAdmin(userData) && (\r\n                                                                        <Chip\r\n                                                                            label=\"ROOT\"\r\n                                                                            size=\"small\"\r\n                                                                            sx={{ \r\n                                                                                bgcolor: '#FFD700', \r\n                                                                                color: '#000',\r\n                                                                                fontWeight: 'bold',\r\n                                                                                fontSize: '0.7rem'\r\n                                                                            }}\r\n                                                                        />\r\n                                                                    )}\r\n                                                                </Stack>\r\n                                                            </TableCell>\r\n                                                            <TableCell>\r\n                                                                {userData.church_name || 'No Church'}\r\n                                                            </TableCell>\r\n                                                            <TableCell>\r\n                                                                <Stack direction=\"row\" spacing={1} alignItems=\"center\">\r\n                                                                    <Switch\r\n                                                                        checked={userData.is_active}\r\n                                                                        onChange={() => handleToggleUserStatus(userData.id, userData.is_active)}\r\n                                                                        size=\"small\"\r\n                                                                        disabled={!canPerformDestructiveOperation(toAuthUser(userData))}\r\n                                                                    />\r\n                                                                    <Chip\r\n                                                                        label={userData.is_active ? 'Active' : 'Inactive'}\r\n                                                                        size=\"small\"\r\n                                                                        color={userData.is_active ? 'success' : 'default'}\r\n                                                                    />\r\n                                                                </Stack>\r\n                                                            </TableCell>\r\n                                                            <TableCell>\r\n                                                                <Typography variant=\"body2\">\r\n                                                                    {userService.formatLastLogin(userData.last_login)}\r\n                                                                </Typography>\r\n                                                            </TableCell>\r\n                                                            <TableCell align=\"right\">\r\n                                                                <Stack direction=\"row\" spacing={1}>\r\n                                                                    <Tooltip title=\"View User\">\r\n                                                                        <IconButton\r\n                                                                            size=\"small\"\r\n                                                                            onClick={() => handleViewUser(userData)}\r\n                                                                            color=\"info\"\r\n                                                                        >\r\n                                                                            <IconEye size={16} />\r\n                                                                        </IconButton>\r\n                                                                    </Tooltip>\r\n                                                                    {canManageUser(toAuthUser(userData)) && (\r\n                                                                        <Tooltip title=\"Edit User\">\r\n                                                                            <IconButton\r\n                                                                                size=\"small\"\r\n                                                                                onClick={() => handleEditUser(userData)}\r\n                                                                                color=\"primary\"\r\n                                                                            >\r\n                                                                                <IconEdit size={16} />\r\n                                                                            </IconButton>\r\n                                                                        </Tooltip>\r\n                                                                    )}\r\n                                                                    {canManageUser(toAuthUser(userData)) && (\r\n                                                                        <Tooltip title=\"Reset Password\">\r\n                                                                            <IconButton\r\n                                                                                size=\"small\"\r\n                                                                                onClick={() => handleResetPassword(userData)}\r\n                                                                                color=\"warning\"\r\n                                                                            >\r\n                                                                                <IconKey size={16} />\r\n                                                                            </IconButton>\r\n                                                                        </Tooltip>\r\n                                                                    )}\r\n                                                                    {canPerformDestructiveOperation(toAuthUser(userData)) && (\r\n                                                                        <Tooltip title=\"Delete User\">\r\n                                                                            <IconButton\r\n                                                                                size=\"small\"\r\n                                                                                onClick={() => handleDeleteUser(userData)}\r\n                                                                                color=\"error\"\r\n                                                                            >\r\n                                                                                <IconTrash size={16} />\r\n                                                                            </IconButton>\r\n                                                                        </Tooltip>\r\n                                                                    )}\r\n                                                                </Stack>\r\n                                                            </TableCell>\r\n                                                        </TableRow>\r\n                                                    ))}\r\n                                                </TableBody>\r\n                                            </Table>\r\n                                        </TableContainer>\r\n\r\n                                        <TablePagination\r\n                                            rowsPerPageOptions={[5, 10, 25, 50]}\r\n                                            component=\"div\"\r\n                                            count={filteredUsers.length}\r\n                                            rowsPerPage={rowsPerPage}\r\n                                            page={page}\r\n                                            onPageChange={(_, newPage) => setPage(newPage)}\r\n                                            onRowsPerPageChange={(e) => {\r\n                                                setRowsPerPage(parseInt(e.target.value, 10));\r\n                                                setPage(0);\r\n                                            }}\r\n                                        />\r\n                                    </>\r\n                                )}\r\n                            </CardContent>\r\n                        </Card>\r\n                    </>\r\n                )}\r\n\r\n                {tabValue === 1 && (\r\n                    <Card>\r\n                        <CardContent>\r\n                            <Typography variant=\"h6\" gutterBottom>\r\n                                Church Management\r\n                            </Typography>\r\n                            <Alert severity=\"info\">\r\n                                Church management features are coming soon.\r\n                            </Alert>\r\n                        </CardContent>\r\n                    </Card>\r\n                )}\r\n            </Box>\r\n\r\n            {/* Create User Dialog */}\r\n            <Dialog open={createUserDialogOpen} onClose={() => setCreateUserDialogOpen(false)} maxWidth=\"md\" fullWidth>\r\n                <DialogTitle>Create New User</DialogTitle>\r\n                <DialogContent>\r\n                    <Stack spacing={3} sx={{ mt: 1 }}>\r\n                        {error && (\r\n                            <Alert severity=\"error\" onClose={() => setError(null)}>\r\n                                {error}\r\n                            </Alert>\r\n                        )}\r\n                        <Stack direction=\"row\" spacing={2}>\r\n                            <TextField\r\n                                fullWidth\r\n                                label=\"First Name\"\r\n                                value={newUser.first_name}\r\n                                onChange={(e) => setNewUser({ ...newUser, first_name: e.target.value })}\r\n                            />\r\n                            <TextField\r\n                                fullWidth\r\n                                label=\"Last Name\"\r\n                                value={newUser.last_name}\r\n                                onChange={(e) => setNewUser({ ...newUser, last_name: e.target.value })}\r\n                            />\r\n                        </Stack>\r\n                        <TextField\r\n                            fullWidth\r\n                            label=\"Email\"\r\n                            type=\"email\"\r\n                            value={newUser.email}\r\n                            onChange={(e) => setNewUser({ ...newUser, email: e.target.value })}\r\n                        />\r\n                        <Stack direction=\"row\" spacing={2}>\r\n                            <FormControl fullWidth>\r\n                                <InputLabel>Role</InputLabel>\r\n                                <Select\r\n                                    value={newUser.role}\r\n                                    onChange={(e) => setNewUser({ ...newUser, role: e.target.value })}\r\n                                    label=\"Role\"\r\n                                >\r\n                                    <MenuItem value=\"viewer\">Viewer</MenuItem>\r\n                                    <MenuItem value=\"editor\">Editor</MenuItem>\r\n                                    <MenuItem value=\"deacon\">Deacon</MenuItem>\r\n                                    <MenuItem value=\"priest\">Priest</MenuItem>\r\n                                    <MenuItem value=\"church_admin\">Church Administrator</MenuItem>\r\n                                    {canCreateAdmins() && (\r\n                                        <MenuItem value=\"admin\">Platform Administrator</MenuItem>\r\n                                    )}\r\n                                    {isRootSuperAdmin() && (\r\n                                        <MenuItem value=\"super_admin\">Super Administrator</MenuItem>\r\n                                    )}\r\n                                </Select>\r\n                            </FormControl>\r\n                            <FormControl \r\n                                fullWidth \r\n                                required={!['super_admin', 'admin'].includes(newUser.role)}\r\n                            >\r\n                                <InputLabel>\r\n                                    Church {['super_admin', 'admin'].includes(newUser.role) ? '(Optional - Global Access)' : '*'}\r\n                                </InputLabel>\r\n                                <Select\r\n                                    value={newUser.church_id}\r\n                                    onChange={(e) => setNewUser({ ...newUser, church_id: e.target.value })}\r\n                                    label={`Church ${['super_admin', 'admin'].includes(newUser.role) ? '(Optional - Global Access)' : '*'}`}\r\n                                >\r\n                                    <MenuItem value=\"\">\r\n                                        {['super_admin', 'admin'].includes(newUser.role) \r\n                                            ? 'No specific church (Global Access)' \r\n                                            : 'Select a church...'\r\n                                        }\r\n                                    </MenuItem>\r\n                                    {churches.sort((a, b) => a.name.localeCompare(b.name)).map((church) => (\r\n                                        <MenuItem key={church.id} value={church.id.toString()}>\r\n                                            {church.name}\r\n                                        </MenuItem>\r\n                                    ))}\r\n                                </Select>\r\n                            </FormControl>\r\n                        </Stack>\r\n                        <TextField\r\n                            fullWidth\r\n                            label=\"Phone\"\r\n                            value={newUser.phone}\r\n                            onChange={(e) => setNewUser({ ...newUser, phone: e.target.value })}\r\n                        />\r\n                        <FormControlLabel\r\n                            control={\r\n                                <Switch\r\n                                    checked={newUser.send_welcome_email}\r\n                                    onChange={(e) => setNewUser({ ...newUser, send_welcome_email: e.target.checked })}\r\n                                />\r\n                            }\r\n                            label=\"Send welcome email with temporary password\"\r\n                        />\r\n                    </Stack>\r\n                </DialogContent>\r\n                <DialogActions>\r\n                    <Button onClick={() => setCreateUserDialogOpen(false)}>Cancel</Button>\r\n                    <Button \r\n                        onClick={handleCreateUser} \r\n                        variant=\"contained\"\r\n                        disabled={loading}\r\n                        startIcon={loading ? <CircularProgress size={20} /> : undefined}\r\n                    >\r\n                        {loading ? 'Creating...' : 'Create User'}\r\n                    </Button>\r\n                </DialogActions>\r\n            </Dialog>\r\n\r\n            {/* User Form Modal */}\r\n            <UserFormModal\r\n                open={modalOpen}\r\n                onClose={() => setModalOpen(false)}\r\n                user={selectedUser}\r\n                churches={churches}\r\n                mode={modalMode}\r\n                onSubmit={handleModalSubmit}\r\n                loading={modalLoading}\r\n                currentUserRole={user?.role}\r\n            />\r\n        </PageContainer>\r\n    );\r\n};\r\n\r\nexport default UserManagement;\r\n"],"names":["__iconNode","IconArticle","createReactComponent","IconCrown","IconEyeOff","IconKey","IconMessageCircle","SocialPermissionsToggle","userId","userEmail","userRole","onPermissionsChanged","isSuperAdmin","useAuth","loading","setLoading","useState","permissions","setPermissions","socialEnabled","setSocialEnabled","error","setError","success","setSuccess","getIcon","menuKey","IconUsers","IconUserPlus","IconBell","loadPermissions","__async","response","data","hasEnabledFeatures","_a","p","err","toggleSocialFeatures","enabled","quickEnable","useEffect","timer","jsx","Card","CardContent","jsxs","Box","Typography","CircularProgress","Alert","Stack","FormControlLabel","Switch","e","Button","IconCheck","IconX","Fragment","Divider","List","permission","IconComponent","ListItem","ListItemIcon","ListItemText","Chip","UserFormModal","open","onClose","user","churches","mode","onSubmit","currentUserRole","formData","setFormData","passwordData","setPasswordData","showPassword","setShowPassword","formErrors","setFormErrors","generatedPassword","setGeneratedPassword","churchIdString","matchingChurch","ch","validateEditForm","errors","validatePasswordForm","handleGeneratePassword","charset","password","lowercase","uppercase","numbers","symbols","i","shuffledPassword","prev","__spreadProps","__spreadValues","handleCopyPassword","handleSubmit","canEditRole","targetRole","getAvailableRoles","allRoles","getModalTitle","renderViewForm","TextField","renderEditForm","FormControl","InputLabel","Select","role","MenuItem","value","a","b","church","isSelected","renderPasswordForm","autoGen","IconButton","IconRefresh","IconCopy","InputAdornment","IconEye","renderDeleteConfirm","Dialog","DialogTitle","DialogContent","DialogActions","UserManagement","canCreateAdmins","canManageAllUsers","isRootSuperAdmin","canManageUser","canPerformDestructiveOperation","canChangeRole","users","setUsers","setChurches","page","setPage","rowsPerPage","setRowsPerPage","searchTerm","setSearchTerm","roleFilter","setRoleFilter","churchFilter","setChurchFilter","activeFilter","setActiveFilter","tabValue","setTabValue","createUserDialogOpen","setCreateUserDialogOpen","modalOpen","setModalOpen","modalMode","setModalMode","selectedUser","setSelectedUser","modalLoading","setModalLoading","newUser","setNewUser","isAdmin","toAuthUser","userData","ROOT_SUPERADMIN_EMAIL","loadData","testResponse","errorText","directErr","usersResponse","churchesResponse","userService","_b","u","_c","handleCreateUser","handleViewUser","handleEditUser","handleResetPassword","handleDeleteUser","handleModalSubmit","handleToggleUserStatus","currentStatus","filteredUsers","matchesSearch","matchesRole","matchesChurch","matchesStatus","hasRoleAccess","paginatedUsers","isUserRootSuperAdmin","PageContainer","BCrumb","Breadcrumb","Snackbar","Tabs","_","newValue","Tab","IconBuilding","IconSearch","TableContainer","Table","TableHead","TableRow","TableCell","TableBody","Avatar","Tooltip","IconEdit","IconTrash","TablePagination","newPage"],"mappings":"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","x_google_ignoreList":[0,1,2,3,4]}