var fe=Object.defineProperty,ye=Object.defineProperties;var be=Object.getOwnPropertyDescriptors;var P=Object.getOwnPropertySymbols;var oe=Object.prototype.hasOwnProperty,ie=Object.prototype.propertyIsEnumerable;var ne=(s,a,r)=>a in s?fe(s,a,{enumerable:!0,configurable:!0,writable:!0,value:r}):s[a]=r,H=(s,a)=>{for(var r in a||(a={}))oe.call(a,r)&&ne(s,r,a[r]);if(P)for(var r of P(a))ie.call(a,r)&&ne(s,r,a[r]);return s},Q=(s,a)=>ye(s,be(a));var le=(s,a)=>{var r={};for(var o in s)oe.call(s,o)&&a.indexOf(o)<0&&(r[o]=s[o]);if(s!=null&&P)for(var o of P(s))a.indexOf(o)<0&&ie.call(s,o)&&(r[o]=s[o]);return r};var W=(s,a,r)=>new Promise((o,p)=>{var S=c=>{try{f(r.next(c))}catch(y){p(y)}},w=c=>{try{f(r.throw(c))}catch(y){p(y)}},f=c=>c.done?o(c.value):Promise.resolve(c.value).then(S,w);f((r=r.apply(s,a)).next())});import{aO as ve,aN as Be,a4 as Ce,j as e,s as E,W as Se,bc as me,aP as we,bi as Te,c as D,m as ze,B as C,S as T,d as j,T as $e,h as I,C as K,I as q,aI as Re,R as ce,O as Fe,e as de,a0 as Ie,a1 as Le,a2 as Me,f as O,$ as ke,Q as Ge,U as Pe}from"./index-CQJq875H.js";import{r as l}from"./vendor-DgfDxsY7.js";import{B as We}from"./Badge-DjvORn3y.js";import{I as Oe}from"./IconRobot-CZ-XBfi6.js";import{a as Ne,b as Ue,t as N,T as U}from"./ToggleButton-Ds8id01h.js";import{g as Ee}from"./getValidReactChildren-BaONKtAS.js";import{I as De}from"./IconSearch-SCSVgCwv.js";import{I as _e}from"./IconLayoutGrid-CLfqDmiI.js";import{T as Ae,a as He,b as Qe,c as ue,d as Ke}from"./TableRow-DCPT_a5G.js";import{T as g}from"./TableCell-MgPOxDnu.js";import{I as he}from"./IconDownload-Ck4fhu6u.js";import{C as qe}from"./Container-G5_yDdAc.js";import{I as Ve}from"./IconCode-DzMIO-Oz.js";import{I as ge}from"./IconFileText-DzJ2nKRC.js";import"./usePreviousProps-BWumOsHT.js";function Je(s){return Be("MuiToggleButtonGroup",s)}const n=ve("MuiToggleButtonGroup",["root","selected","horizontal","vertical","disabled","grouped","groupedHorizontal","groupedVertical","fullWidth","firstButton","lastButton","middleButton"]),Xe=s=>{const{classes:a,orientation:r,fullWidth:o,disabled:p}=s,S={root:["root",r,o&&"fullWidth"],grouped:["grouped",`grouped${me(r)}`,p&&"disabled"],firstButton:["firstButton"],lastButton:["lastButton"],middleButton:["middleButton"]};return we(S,Je,a)},Ye=E("div",{name:"MuiToggleButtonGroup",slot:"Root",overridesResolver:(s,a)=>{const{ownerState:r}=s;return[{[`& .${n.grouped}`]:a.grouped},{[`& .${n.grouped}`]:a[`grouped${me(r.orientation)}`]},{[`& .${n.firstButton}`]:a.firstButton},{[`& .${n.lastButton}`]:a.lastButton},{[`& .${n.middleButton}`]:a.middleButton},a.root,r.orientation==="vertical"&&a.vertical,r.fullWidth&&a.fullWidth]}})(Te(({theme:s})=>({display:"inline-flex",borderRadius:(s.vars||s).shape.borderRadius,variants:[{props:{orientation:"vertical"},style:{flexDirection:"column",[`& .${n.grouped}`]:{[`&.${n.selected} + .${n.grouped}.${n.selected}`]:{borderTop:0,marginTop:0}},[`& .${n.firstButton},& .${n.middleButton}`]:{borderBottomLeftRadius:0,borderBottomRightRadius:0},[`& .${n.lastButton},& .${n.middleButton}`]:{marginTop:-1,borderTop:"1px solid transparent",borderTopLeftRadius:0,borderTopRightRadius:0},[`& .${n.lastButton}.${N.disabled},& .${n.middleButton}.${N.disabled}`]:{borderTop:"1px solid transparent"}}},{props:{fullWidth:!0},style:{width:"100%"}},{props:{orientation:"horizontal"},style:{[`& .${n.grouped}`]:{[`&.${n.selected} + .${n.grouped}.${n.selected}`]:{borderLeft:0,marginLeft:0}},[`& .${n.firstButton},& .${n.middleButton}`]:{borderTopRightRadius:0,borderBottomRightRadius:0},[`& .${n.lastButton},& .${n.middleButton}`]:{marginLeft:-1,borderLeft:"1px solid transparent",borderTopLeftRadius:0,borderBottomLeftRadius:0},[`& .${n.lastButton}.${N.disabled},& .${n.middleButton}.${N.disabled}`]:{borderLeft:"1px solid transparent"}}}]}))),pe=l.forwardRef(function(a,r){const o=Ce({props:a,name:"MuiToggleButtonGroup"}),L=o,{children:p,className:S,color:w="standard",disabled:f=!1,exclusive:c=!1,fullWidth:y=!1,onChange:b,orientation:_="horizontal",size:$="medium",value:u}=L,J=le(L,["children","className","color","disabled","exclusive","fullWidth","onChange","orientation","size","value"]),R=Q(H({},o),{disabled:f,fullWidth:y,orientation:_,size:$}),x=Xe(R),M=l.useCallback((v,d)=>{if(!b)return;const B=u&&u.indexOf(d);let z;u&&B>=0?(z=u.slice(),z.splice(B,1)):z=u?u.concat(d):[d],b(v,z)},[b,u]),k=l.useCallback((v,d)=>{b&&b(v,u===d?null:d)},[b,u]),G=l.useMemo(()=>({className:x.grouped,onChange:c?k:M,value:u,size:$,fullWidth:y,color:w,disabled:f}),[x.grouped,c,k,M,u,$,y,w,f]),F=Ee(p),A=F.length,m=v=>{const d=v===0,B=v===A-1;return d&&B?"":d?x.firstButton:B?x.lastButton:x.middleButton};return e.jsx(Ye,Q(H({role:"group",className:Se(x.root,S),ref:r,ownerState:R},J),{children:e.jsx(Ne.Provider,{value:G,children:F.map((v,d)=>e.jsx(Ue.Provider,{value:m(d),children:v},d))})}))});/**
 * @license @tabler/icons-react v3.34.1 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ze=[["path",{d:"M14 3v4a1 1 0 0 0 1 1h4",key:"svg-0"}],["path",{d:"M17 21h-10a2 2 0 0 1 -2 -2v-14a2 2 0 0 1 2 -2h7l5 5v11a2 2 0 0 1 -2 2z",key:"svg-1"}],["path",{d:"M8 11h8v7h-8z",key:"svg-2"}],["path",{d:"M8 15h8",key:"svg-3"}],["path",{d:"M11 11v7",key:"svg-4"}]],et=D("outline","file-spreadsheet","FileSpreadsheet",Ze);/**
 * @license @tabler/icons-react v3.34.1 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */const tt=[["path",{d:"M14 3v4a1 1 0 0 0 1 1h4",key:"svg-0"}],["path",{d:"M17 21h-10a2 2 0 0 1 -2 -2v-14a2 2 0 0 1 2 -2h7l5 5v11a2 2 0 0 1 -2 2z",key:"svg-1"}]],xe=D("outline","file","File",tt);/**
 * @license @tabler/icons-react v3.34.1 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */const st=[["path",{d:"M9 15l6 -6",key:"svg-0"}],["path",{d:"M11 6l.463 -.536a5 5 0 0 1 7.071 7.072l-.534 .464",key:"svg-1"}],["path",{d:"M13 18l-.397 .534a5.068 5.068 0 0 1 -7.127 0a4.972 4.972 0 0 1 0 -7.071l.524 -.463",key:"svg-2"}]],V=D("outline","link","Link",st);/**
 * @license @tabler/icons-react v3.34.1 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */const rt=[["path",{d:"M3 5a2 2 0 0 1 2 -2h14a2 2 0 0 1 2 2v14a2 2 0 0 1 -2 2h-14a2 2 0 0 1 -2 -2v-14z",key:"svg-0"}],["path",{d:"M3 10h18",key:"svg-1"}],["path",{d:"M10 3v18",key:"svg-2"}]],at=D("outline","table","Table",rt),nt=E(qe)(({theme:s})=>({paddingTop:s.spacing(4),paddingBottom:s.spacing(4),minHeight:"100vh"})),ot=E(C)(({theme:s})=>({display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(280px, 1fr))",gap:s.spacing(2),marginTop:s.spacing(3)})),it=E(Pe)(({theme:s})=>({cursor:"pointer",transition:"transform 0.2s ease, box-shadow 0.2s ease","&:hover":{transform:"scale(1.02)",boxShadow:s.shadows[8]}})),St=()=>{ze();const[s,a]=l.useState([]),[r,o]=l.useState([]),[p,S]=l.useState(!0),[w,f]=l.useState(null),[c,y]=l.useState(""),[b,_]=l.useState("filename"),[$,u]=l.useState(!1),[J,R]=l.useState([]),[x,M]=l.useState("all"),[k,G]=l.useState(null),[F,A]=l.useState("table"),[m,L]=l.useState({running:!1}),[v,d]=l.useState(!1),B=()=>W(void 0,null,function*(){d(!0);try{const t=yield fetch("/api/library/status",{credentials:"include"});if(t.ok){const i=yield t.json();L(i)}}catch(t){console.warn("Could not load librarian status:",t),L({running:!1})}finally{d(!1)}}),z=()=>W(void 0,null,function*(){S(!0),f(null);try{const t=new URLSearchParams;x!=="all"&&t.append("category",x);const i=yield fetch(`/api/library/files?${t.toString()}`,{credentials:"include"});if(!i.ok)throw new Error("Failed to load library files");const h=yield i.json();a(h.files||[]),o(h.files||[])}catch(t){console.error("Error loading library:",t),f(t.message||"Failed to load library"),a([]),o([])}finally{S(!1)}}),X=()=>W(void 0,null,function*(){if(!c.trim()){R([]),o(s);return}u(!0);try{const t=new URLSearchParams;t.append("q",c),t.append("mode",b),x!=="all"&&t.append("category",x);const i=yield fetch(`/api/library/search?${t.toString()}`,{credentials:"include"});if(!i.ok)throw new Error("Search failed");const h=yield i.json();R(h.results||[]),o(h.results||[])}catch(t){console.error("Search error:",t),f("Search failed. Please try again.")}finally{u(!1)}}),Y=t=>{G(t.id);const i=s.filter(h=>h.id===t.id||t.relatedFiles.includes(h.id)||h.relatedFiles.includes(t.id));o(i)},je=()=>{G(null),o(s)},Z=t=>{window.open(`/api/library/download/${encodeURIComponent(t.id)}`,"_blank")},ee=t=>{var h;switch((h=t.split(".").pop())==null?void 0:h.toLowerCase()){case"md":case"txt":return e.jsx(ge,{size:20});case"docx":return e.jsx(ge,{size:20});case"xlsx":return e.jsx(et,{size:20});case"ts":case"tsx":case"js":case"json":return e.jsx(Ve,{size:20});default:return e.jsx(xe,{size:20})}},te=t=>{switch(t){case"technical":return"primary";case"ops":return"success";case"recovery":return"warning";default:return"default"}},se=t=>{if(t===0)return"0 Bytes";const i=1024,h=["Bytes","KB","MB","GB"],ae=Math.floor(Math.log(t)/Math.log(i));return Math.round(t/Math.pow(i,ae)*100)/100+" "+h[ae]},re=t=>new Date(t).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"});return l.useEffect(()=>{B(),z();const t=setInterval(B,3e4);return()=>clearInterval(t)},[]),l.useEffect(()=>{c||z()},[x]),e.jsxs(nt,{maxWidth:"xl",children:[e.jsxs(C,{sx:{mb:4},children:[e.jsxs(T,{direction:"row",spacing:2,alignItems:"center",sx:{mb:2},children:[e.jsx(j,{variant:"h3",component:"h1",sx:{flex:1},children:"ðŸ“š OM-Library"}),e.jsx($e,{title:m.running?`Librarian Online - ${m.totalFiles||0} files indexed`:"Librarian Offline",children:e.jsx(We,{badgeContent:m.totalFiles||0,color:m.running?"success":"error",max:9999,children:e.jsx(I,{icon:v?e.jsx(K,{size:16}):e.jsx(Oe,{size:18}),label:m.running?"Librarian Online":"Librarian Offline",color:m.running?"success":"default",size:"small"})})}),e.jsx(q,{onClick:B,title:"Refresh status",children:e.jsx(Re,{size:20})})]}),e.jsx(j,{variant:"body2",color:"text.secondary",children:"Searchable, relationship-aware documentation library"})]}),e.jsx(ce,{sx:{p:2,mb:3},children:e.jsxs(T,{spacing:2,children:[e.jsxs(T,{direction:"row",spacing:2,children:[e.jsxs(pe,{value:b,exclusive:!0,onChange:(t,i)=>i&&_(i),size:"small",children:[e.jsx(U,{value:"filename",children:"Filenames"}),e.jsx(U,{value:"content",children:"Contents"})]}),e.jsx(Fe,{fullWidth:!0,placeholder:`Search ${b==="filename"?"filenames":"file contents"}...`,value:c,onChange:t=>y(t.target.value),onKeyPress:t=>t.key==="Enter"&&X(),InputProps:{startAdornment:e.jsx(De,{size:20,style:{marginRight:8}})}}),e.jsx(de,{variant:"contained",onClick:X,disabled:$||!c.trim(),children:$?e.jsx(K,{size:20}):"Search"}),c&&e.jsx(de,{variant:"outlined",onClick:()=>{y(""),R([]),o(s)},children:"Clear"})]}),e.jsxs(T,{direction:"row",spacing:2,alignItems:"center",children:[e.jsxs(Ie,{size:"small",sx:{minWidth:150},children:[e.jsx(Le,{children:"Category"}),e.jsxs(Me,{value:x,label:"Category",onChange:t=>M(t.target.value),children:[e.jsx(O,{value:"all",children:"All Categories"}),e.jsx(O,{value:"technical",children:"Technical"}),e.jsx(O,{value:"ops",children:"Operations"}),e.jsx(O,{value:"recovery",children:"Recovery"})]})]}),k&&e.jsx(I,{icon:e.jsx(V,{size:16}),label:"Showing Related Group",onDelete:je,color:"primary"}),e.jsx(C,{sx:{flex:1}}),e.jsxs(pe,{value:F,exclusive:!0,onChange:(t,i)=>i&&A(i),size:"small",children:[e.jsx(U,{value:"table",children:e.jsx(at,{size:18})}),e.jsx(U,{value:"grid",children:e.jsx(_e,{size:18})})]})]})]})}),p&&e.jsx(C,{sx:{display:"flex",justifyContent:"center",py:8},children:e.jsx(K,{})}),w&&!p&&e.jsxs(ke,{severity:"warning",sx:{mb:3},children:[w,!m.running&&e.jsx(C,{sx:{mt:1},children:e.jsx(j,{variant:"caption",children:"The OM-Librarian agent may be offline. Library features will be limited."})})]}),!p&&!w&&r.length===0&&e.jsxs(C,{sx:{textAlign:"center",py:8},children:[e.jsx(xe,{size:64,style:{opacity:.3,marginBottom:16}}),e.jsx(j,{variant:"h6",color:"text.secondary",children:c?"No files found matching your search":"No files in library yet"}),!m.running&&e.jsx(j,{variant:"body2",color:"text.secondary",sx:{mt:1},children:"Start the OM-Librarian agent to begin indexing documentation files"})]}),!p&&F==="table"&&r.length>0&&e.jsx(Ae,{component:ce,children:e.jsxs(He,{children:[e.jsx(Qe,{children:e.jsxs(ue,{children:[e.jsx(g,{children:e.jsx("strong",{children:"Title"})}),e.jsx(g,{children:e.jsx("strong",{children:"Category"})}),e.jsx(g,{children:e.jsx("strong",{children:"Source"})}),e.jsx(g,{children:e.jsx("strong",{children:"Related"})}),e.jsx(g,{children:e.jsx("strong",{children:"Size"})}),e.jsx(g,{children:e.jsx("strong",{children:"Modified"})}),e.jsx(g,{children:e.jsx("strong",{children:"Actions"})})]})}),e.jsx(Ke,{children:r.map(t=>e.jsxs(ue,{hover:!0,children:[e.jsx(g,{children:e.jsxs(T,{direction:"row",spacing:1,alignItems:"center",children:[ee(t.filename),e.jsxs(C,{children:[e.jsx(j,{variant:"body2",sx:{fontWeight:600},children:t.title}),t.firstParagraph&&e.jsxs(j,{variant:"caption",color:"text.secondary",children:[t.firstParagraph.substring(0,80),"..."]})]})]})}),e.jsx(g,{children:e.jsx(I,{label:t.category,color:te(t.category),size:"small"})}),e.jsx(g,{children:e.jsx(j,{variant:"caption",children:t.sourceFolder})}),e.jsx(g,{children:t.relatedFiles.length>0&&e.jsx(I,{icon:e.jsx(V,{size:14}),label:`${t.relatedFiles.length} related`,size:"small",onClick:()=>Y(t),sx:{cursor:"pointer"}})}),e.jsx(g,{children:se(t.size)}),e.jsx(g,{children:re(t.modified)}),e.jsx(g,{children:e.jsx(q,{size:"small",onClick:()=>Z(t),color:"primary",children:e.jsx(he,{size:18})})})]},t.id))})]})}),!p&&F==="grid"&&r.length>0&&e.jsx(ot,{children:r.map(t=>e.jsx(it,{children:e.jsx(Ge,{children:e.jsxs(T,{spacing:1,children:[e.jsxs(T,{direction:"row",spacing:1,alignItems:"center",children:[ee(t.filename),e.jsx(j,{variant:"h6",noWrap:!0,sx:{flex:1},children:t.title})]}),e.jsx(I,{label:t.category,color:te(t.category),size:"small",sx:{width:"fit-content"}}),e.jsx(j,{variant:"body2",color:"text.secondary",sx:{minHeight:40},children:t.firstParagraph}),e.jsx(Divider,{}),e.jsxs(T,{direction:"row",spacing:1,alignItems:"center",children:[e.jsx(j,{variant:"caption",color:"text.secondary",children:se(t.size)}),e.jsx(C,{sx:{flex:1}}),t.relatedFiles.length>0&&e.jsx(I,{icon:e.jsx(V,{size:12}),label:t.relatedFiles.length,size:"small",onClick:()=>Y(t)}),e.jsx(q,{size:"small",onClick:()=>Z(t),color:"primary",children:e.jsx(he,{size:18})})]})]})})},t.id))}),!p&&r.length>0&&e.jsx(C,{sx:{mt:4,textAlign:"center"},children:e.jsxs(j,{variant:"body2",color:"text.secondary",children:["Showing ",r.length," of ",s.length," files",m.lastIndexUpdate&&e.jsxs(e.Fragment,{children:[" Â· Last indexed: ",re(m.lastIndexUpdate)]})]})})]})};export{St as default};
//# sourceMappingURL=OMLibrary-E1girdF_.js.map
