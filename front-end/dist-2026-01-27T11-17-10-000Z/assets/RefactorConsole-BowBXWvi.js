var Qt=Object.defineProperty,Xt=Object.defineProperties;var Zt=Object.getOwnPropertyDescriptors;var Ee=Object.getOwnPropertySymbols;var dt=Object.prototype.hasOwnProperty,ht=Object.prototype.propertyIsEnumerable;var Ve=(r,s,t)=>s in r?Qt(r,s,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[s]=t,Z=(r,s)=>{for(var t in s||(s={}))dt.call(s,t)&&Ve(r,t,s[t]);if(Ee)for(var t of Ee(s))ht.call(s,t)&&Ve(r,t,s[t]);return r},ce=(r,s)=>Xt(r,Zt(s));var xt=(r,s)=>{var t={};for(var a in r)dt.call(r,a)&&s.indexOf(a)<0&&(t[a]=r[a]);if(r!=null&&Ee)for(var a of Ee(r))s.indexOf(a)<0&&ht.call(r,a)&&(t[a]=r[a]);return t};var pt=(r,s,t)=>Ve(r,typeof s!="symbol"?s+"":s,t);var F=(r,s,t)=>new Promise((a,i)=>{var o=p=>{try{d(t.next(p))}catch(j){i(j)}},l=p=>{try{d(t.throw(p))}catch(j){i(j)}},d=p=>p.done?a(p.value):Promise.resolve(p.value).then(o,l);d((t=t.apply(r,s)).next())});import{m as we,j as e,R as se,B as n,d as f,e as U,aW as z,O as Ne,a0 as Yt,a1 as Kt,a2 as er,f as sr,h as Y,cA as W,J as ft,Y as bt,K as jt,$ as be,cF as qe,p as tr,D as Je,a3 as vt,C as ts,T as Ce,I as Ye,n as rr,q as ar}from"./index-CQJq875H.js";import{r as c,b as or}from"./vendor-DgfDxsY7.js";import{c as D,C as nr}from"./chevron-right-BVYlsjMd.js";import{b as de,C as ye,a as je,X as lr}from"./x-CuUwSEEl.js";import{B as ir}from"./ButtonGroup-BYc09hZ_.js";import{R as Ie,S as cr}from"./settings-sicq60mA.js";import{T as dr,a as Ge}from"./Tabs-Da3Qyh1W.js";import{L as hr}from"./ListItem-C0K_HsLZ.js";import{T as xr,a as pr,b as mr,c as mt,d as ur}from"./TableRow-DCPT_a5G.js";import{T as ee}from"./TableCell-MgPOxDnu.js";import{T as gr}from"./TablePagination-CStzre4i.js";import"./getValidReactChildren-BaONKtAS.js";import"./KeyboardArrowRight-Z7vVVss9.js";import"./listItemButtonClasses-B2JwQewU.js";import"./LastPage-Nfpn9sHk.js";import"./Toolbar-BixKUISM.js";/**
 * @license lucide-react v0.534.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yr=[["rect",{width:"20",height:"5",x:"2",y:"3",rx:"1",key:"1wp1u1"}],["path",{d:"M4 8v11a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8",key:"1s80jp"}],["path",{d:"M10 12h4",key:"a56b0p"}]],wt=D("archive",yr);/**
 * @license lucide-react v0.534.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fr=[["path",{d:"m3 16 4 4 4-4",key:"1co6wj"}],["path",{d:"M7 20V4",key:"1yoxec"}],["path",{d:"M11 4h10",key:"1w87gc"}],["path",{d:"M11 8h7",key:"djye34"}],["path",{d:"M11 12h4",key:"q8tih4"}]],br=D("arrow-down-wide-narrow",fr);/**
 * @license lucide-react v0.534.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jr=[["path",{d:"m3 8 4-4 4 4",key:"11wl7u"}],["path",{d:"M7 4v16",key:"1glfcx"}],["path",{d:"M11 12h4",key:"q8tih4"}],["path",{d:"M11 16h7",key:"uosisv"}],["path",{d:"M11 20h10",key:"jvxblo"}]],vr=D("arrow-up-narrow-wide",jr);/**
 * @license lucide-react v0.534.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wr=[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]],Ae=D("calendar",wr);/**
 * @license lucide-react v0.534.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kr=[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]],Me=D("check",kr);/**
 * @license lucide-react v0.534.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Sr=[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]],Ke=D("chevron-down",Sr);/**
 * @license lucide-react v0.534.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Pr=[["path",{d:"M12 6v6l4 2",key:"mmk7yg"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],kt=D("clock",Pr);/**
 * @license lucide-react v0.534.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Nr=[["path",{d:"m16 18 6-6-6-6",key:"eg8j8"}],["path",{d:"m8 6-6 6 6 6",key:"ppft3o"}]],Cr=D("code",Nr);/**
 * @license lucide-react v0.534.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Tr=[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]],Ir=D("copy",Tr);/**
 * @license lucide-react v0.534.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Rr=[["path",{d:"M12 15V3",key:"m9g1x1"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["path",{d:"m7 10 5 5 5-5",key:"brsn70"}]],Er=D("download",Rr);/**
 * @license lucide-react v0.534.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Mr=[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"M10 14 21 3",key:"gplh6r"}],["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}]],St=D("external-link",Mr);/**
 * @license lucide-react v0.534.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $r=[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],Pt=D("eye",$r);/**
 * @license lucide-react v0.534.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Fr=[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"m9 15 2 2 4-4",key:"1grp1n"}]],Ar=D("file-check",Fr);/**
 * @license lucide-react v0.534.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zr=[["path",{d:"M10 12.5 8 15l2 2.5",key:"1tg20x"}],["path",{d:"m14 12.5 2 2.5-2 2.5",key:"yinavb"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7z",key:"1mlx9k"}]],me=D("file-code",zr);/**
 * @license lucide-react v0.534.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _r=[["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M4.268 21a2 2 0 0 0 1.727 1H18a2 2 0 0 0 2-2V7l-5-5H6a2 2 0 0 0-2 2v3",key:"ms7g94"}],["path",{d:"m9 18-1.5-1.5",key:"1j6qii"}],["circle",{cx:"5",cy:"14",r:"3",key:"ufru5t"}]],$e=D("file-search",_r);/**
 * @license lucide-react v0.534.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Lr=[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]],Nt=D("file-text",Lr);/**
 * @license lucide-react v0.534.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Wr=[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"m14.5 12.5-5 5",key:"b62r18"}],["path",{d:"m9.5 12.5 5 5",key:"1rk7el"}]],Dr=D("file-x",Wr);/**
 * @license lucide-react v0.534.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Hr=[["path",{d:"m6 14 1.5-2.9A2 2 0 0 1 9.24 10H20a2 2 0 0 1 1.94 2.5l-1.54 6a2 2 0 0 1-1.95 1.5H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h3.9a2 2 0 0 1 1.69.9l.81 1.2a2 2 0 0 0 1.67.9H18a2 2 0 0 1 2 2v2",key:"usdka0"}]],Or=D("folder-open",Hr);/**
 * @license lucide-react v0.534.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Br=[["path",{d:"M20 20a2 2 0 0 0 2-2V8a2 2 0 0 0-2-2h-7.9a2 2 0 0 1-1.69-.9L9.6 3.9A2 2 0 0 0 7.93 3H4a2 2 0 0 0-2 2v13a2 2 0 0 0 2 2Z",key:"1kt360"}]],Ur=D("folder",Br);/**
 * @license lucide-react v0.534.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Vr=[["path",{d:"M10 20a1 1 0 0 0 .553.895l2 1A1 1 0 0 0 14 21v-7a2 2 0 0 1 .517-1.341L21.74 4.67A1 1 0 0 0 21 3H3a1 1 0 0 0-.742 1.67l7.225 7.989A2 2 0 0 1 10 14z",key:"sc7q7i"}]],qr=D("funnel",Vr);/**
 * @license lucide-react v0.534.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Jr=[["line",{x1:"6",x2:"6",y1:"3",y2:"15",key:"17qcm7"}],["circle",{cx:"18",cy:"6",r:"3",key:"1h7g24"}],["circle",{cx:"6",cy:"18",r:"3",key:"fqmcym"}],["path",{d:"M18 9a9 9 0 0 1-9 9",key:"n2h4wq"}]],Ct=D("git-branch",Jr);/**
 * @license lucide-react v0.534.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Gr=[["circle",{cx:"18",cy:"18",r:"3",key:"1xkwt0"}],["circle",{cx:"6",cy:"6",r:"3",key:"1lh9wr"}],["path",{d:"M13 6h3a2 2 0 0 1 2 2v7",key:"1yeb86"}],["path",{d:"M11 18H8a2 2 0 0 1-2-2V9",key:"19pyzm"}]],ut=D("git-compare",Gr);/**
 * @license lucide-react v0.534.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qr=[["line",{x1:"22",x2:"2",y1:"12",y2:"12",key:"1y58io"}],["path",{d:"M5.45 5.11 2 12v6a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2v-6l-3.45-6.89A2 2 0 0 0 16.76 4H7.24a2 2 0 0 0-1.79 1.11z",key:"oot6mr"}],["line",{x1:"6",x2:"6.01",y1:"16",y2:"16",key:"sgf278"}],["line",{x1:"10",x2:"10.01",y1:"16",y2:"16",key:"1l4acy"}]],Xr=D("hard-drive",Qr);/**
 * @license lucide-react v0.534.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Zr=[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}],["path",{d:"M12 7v5l4 2",key:"1fdv2h"}]],es=D("history",Zr);/**
 * @license lucide-react v0.534.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Yr=[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]],Kr=D("loader-circle",Yr);/**
 * @license lucide-react v0.534.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ea=[["path",{d:"M11 21.73a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73z",key:"1a0edw"}],["path",{d:"M12 22V12",key:"d0xqtd"}],["polyline",{points:"3.29 7 12 12 20.71 7",key:"ousv84"}],["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}]],rs=D("package",ea);/**
 * @license lucide-react v0.534.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sa=[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]],ta=D("rotate-ccw",sa);/**
 * @license lucide-react v0.534.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ra=[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]],aa=D("search",ra);/**
 * @license lucide-react v0.534.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const oa=[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]],ve=D("triangle-alert",oa);/**
 * @license lucide-react v0.534.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const na=[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]],la=D("user",na);/**
 * @license lucide-react v0.534.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ia=[["path",{d:"M4 14a1 1 0 0 1-.78-1.63l9.9-10.2a.5.5 0 0 1 .86.46l-1.92 6.02A1 1 0 0 0 13 10h7a1 1 0 0 1 .78 1.63l-9.9 10.2a.5.5 0 0 1-.86-.46l1.92-6.02A1 1 0 0 0 11 14z",key:"1xq2db"}]],Qe=D("zap",ia),ss=r=>{const s=r.split("/");return s[s.length-1]||"/"},ca=r=>{const s=ss(r),t=s.lastIndexOf(".");return t>=0?s.slice(t):""},da=r=>{if(!r)return null;switch(r){case"missing_in_prod":return e.jsx(Dr,{className:"w-4 h-4 text-purple-500",title:"Missing in production"});case"modified_since_backup":return e.jsx(ve,{className:"w-4 h-4 text-orange-500",title:"Modified since backup"});case"new_file":return e.jsx(Ar,{className:"w-4 h-4 text-green-500",title:"New file (not in backup)"});case"unchanged":return e.jsx(de,{className:"w-4 h-4 text-gray-400",title:"Unchanged since backup"});default:return null}},ha=r=>{switch(r){case"green":return e.jsx(de,{className:"w-4 h-4 text-green-500"});case"orange":return e.jsx(ve,{className:"w-4 h-4 text-orange-500"});case"yellow":return e.jsx(kt,{className:"w-4 h-4 text-yellow-500"});case"red":return e.jsx(ye,{className:"w-4 h-4 text-red-500"});default:return e.jsx(me,{className:"w-4 h-4 text-gray-400"})}},xa=r=>{switch(ca(r).toLowerCase()){case"tsx":case"ts":return e.jsx(me,{className:"w-4 h-4 text-blue-500"});case"jsx":case"js":return e.jsx(me,{className:"w-4 h-4 text-yellow-500"});case"css":case"scss":return e.jsx(me,{className:"w-4 h-4 text-purple-500"});case"json":return e.jsx(me,{className:"w-4 h-4 text-green-500"});default:return e.jsx(me,{className:"w-4 h-4 text-gray-400"})}},Tt=c.memo(({item:r,level:s,onToggleExpanded:t,onNodeAction:a,showBadges:i=!0,isDark:o=!1})=>{const[l,d]=c.useState(!1),p=r.expanded,j=r.children&&r.children.length>0,M=r.type==="dir",u={marginLeft:`${s*16}px`},m=(()=>{switch(r.classification){case"green":return o?"#4ade80":"#15803d";case"orange":return o?"#fb923c":"#c2410c";case"yellow":return o?"#facc15":"#a16207";case"red":return o?"#f87171":"#b91c1c";default:return o?"#d1d5db":"#374151"}})(),w=(b,I)=>{b.stopPropagation(),a(I,r),d(!1)},P=()=>{var A,J;if(!i)return null;const b=[],I=E=>{const X={purple:{bg:o?"rgba(147, 51, 234, 0.25)":"#f3e8ff",text:o?"#d8b4fe":"#7e22ce",border:o?"#7c3aed":"#c4b5fd"},orange:{bg:o?"rgba(234, 88, 12, 0.25)":"#ffedd5",text:o?"#fdba74":"#c2410c",border:o?"#ea580c":"#fdba74"},green:{bg:o?"rgba(34, 197, 94, 0.25)":"#dcfce7",text:o?"#86efac":"#15803d",border:o?"#22c55e":"#86efac"},yellow:{bg:o?"rgba(234, 179, 8, 0.25)":"#fef9c3",text:o?"#fde047":"#a16207",border:o?"#eab308":"#fde047"},red:{bg:o?"rgba(239, 68, 68, 0.25)":"#fee2e2",text:o?"#fca5a5":"#b91c1c",border:o?"#ef4444":"#fca5a5"},blue:{bg:o?"rgba(59, 130, 246, 0.25)":"#dbeafe",text:o?"#93c5fd":"#1e40af"},gray:{bg:o?"#374151":"#f3f4f6",text:o?"#9ca3af":"#4b5563",border:o?"#4b5563":"#d1d5db"}};return X[E]||X.gray};if(r.recoveryStatus){const E={missing_in_prod:"MISSING",modified_since_backup:"MODIFIED",new_file:"NEW",unchanged:"UNCHANGED"},T=I({missing_in_prod:"purple",modified_since_backup:"orange",new_file:"green",unchanged:"gray"}[r.recoveryStatus]);b.push(e.jsx("span",{className:"text-xs px-2 py-1 rounded-full font-medium",style:{backgroundColor:T.bg,color:T.text,border:T.border?`1px solid ${T.border}`:"none"},children:E[r.recoveryStatus]},"recovery"))}const $=I(r.classification==="green"?"green":r.classification==="orange"?"orange":r.classification==="yellow"?"yellow":"red");if(b.push(e.jsx("span",{className:"text-xs px-2 py-1 rounded-full font-medium",style:{backgroundColor:$.bg,color:$.text},children:r.classification.toUpperCase()},"classification")),r.type==="file"){const E=I("blue");b.push(e.jsxs("span",{className:"text-xs px-2 py-1 rounded-full font-medium",style:{backgroundColor:E.bg,color:E.text},children:["Score: ",r.usage.score]},"score"))}if((A=r.similarity)!=null&&A.duplicates.length||(J=r.similarity)!=null&&J.nearMatches.length){const E=I("red");b.push(e.jsxs("span",{className:"text-xs px-2 py-1 rounded-full font-medium flex items-center gap-1",style:{backgroundColor:E.bg,color:E.text},children:[e.jsx(Ct,{className:"w-3 h-3"}),"Dupes"]},"duplicates"))}if(r.featurePathMatch){const E=I("green");b.push(e.jsx("span",{className:"text-xs px-2 py-1 rounded-full font-medium",style:{backgroundColor:E.bg,color:E.text},children:"Feature"},"feature"))}return e.jsx("div",{className:"flex gap-1 flex-wrap",children:b})};return e.jsxs("div",{className:"flex items-center gap-2 py-2 px-3 cursor-pointer group",style:ce(Z({},u),{color:m,backgroundColor:"transparent",transition:"background-color 0.15s"}),onMouseEnter:b=>{d(!0),b.currentTarget.style.backgroundColor=o?"rgba(55, 65, 81, 0.5)":"#f9fafb"},onMouseLeave:b=>{d(!1),b.currentTarget.style.backgroundColor="transparent"},children:[j&&e.jsx("button",{onClick:b=>{b.stopPropagation(),t(r.path)},className:"flex items-center justify-center w-4 h-4 rounded transition-colors",style:{color:o?"#9ca3af":"#6b7280"},onMouseEnter:b=>{b.currentTarget.style.backgroundColor=o?"#4b5563":"#e5e7eb"},onMouseLeave:b=>{b.currentTarget.style.backgroundColor="transparent"},children:p?e.jsx(Ke,{className:"w-3 h-3"}):e.jsx(nr,{className:"w-3 h-3"})}),!j&&e.jsx("div",{className:"w-4 h-4"}),e.jsx("div",{className:"flex items-center",children:M?e.jsx(Ur,{className:"w-4 h-4 text-blue-500"}):xa(r.path)}),r.recoveryStatus&&e.jsx("div",{className:"flex items-center",children:da(r.recoveryStatus)}),e.jsx("div",{className:"flex items-center",children:ha(r.classification)}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("div",{className:"text-sm font-medium truncate",style:{color:m},children:r.type==="dir"?ss(r.path):ss(r.relPath)}),r.type==="file"&&e.jsx("div",{className:"text-xs truncate",style:{color:o?"#9ca3af":"#6b7280"},children:r.relPath})]}),l&&e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("button",{onClick:b=>w(b,"copy"),className:"p-1 rounded",style:{color:o?"#d1d5db":"#4b5563"},onMouseEnter:b=>b.currentTarget.style.backgroundColor=o?"#4b5563":"#e5e7eb",onMouseLeave:b=>b.currentTarget.style.backgroundColor="transparent",title:"Copy relative path",children:e.jsx(Ir,{className:"w-4 h-4"})}),r.type==="file"&&e.jsx("button",{onClick:b=>w(b,"open"),className:"p-1 rounded",style:{color:o?"#d1d5db":"#4b5563"},onMouseEnter:b=>b.currentTarget.style.backgroundColor=o?"#4b5563":"#e5e7eb",onMouseLeave:b=>b.currentTarget.style.backgroundColor="transparent",title:"Open in editor",children:e.jsx(St,{className:"w-4 h-4"})}),r.recoveryStatus==="missing_in_prod"&&r.type==="file"&&e.jsx("button",{onClick:b=>w(b,"restore"),className:"p-1 rounded",style:{color:o?"#c084fc":"#9333ea"},onMouseEnter:b=>b.currentTarget.style.backgroundColor=o?"rgba(147, 51, 234, 0.3)":"#e9d5ff",onMouseLeave:b=>b.currentTarget.style.backgroundColor="transparent",title:"Restore from backup",children:e.jsx(ta,{className:"w-4 h-4"})}),e.jsx("button",{onClick:b=>w(b,"reasons"),className:"p-1 rounded",style:{color:o?"#d1d5db":"#4b5563"},onMouseEnter:b=>b.currentTarget.style.backgroundColor=o?"#4b5563":"#e5e7eb",onMouseLeave:b=>b.currentTarget.style.backgroundColor="transparent",title:"View classification reasons",children:e.jsx(Pt,{className:"w-4 h-4"})})]}),e.jsx("div",{className:"flex-shrink-0 mr-2",children:P()})]})}),It=c.memo(({treeItems:r,expandedPaths:s,onToggleExpanded:t,onNodeAction:a,className:i="",isDark:o})=>{const l=we(),d=o!==void 0?o:l.palette.mode==="dark",[p,j]=c.useState([]),M=(u,y=0)=>{const m=[];return u.forEach(w=>{const P=ce(Z({},w),{level:y});m.push(P),w.children&&w.children.length>0&&w.expanded&&m.push(...M(w.children,y+1))}),m};return c.useEffect(()=>{const u=M(r);j(u)},[r,s]),r.length===0?e.jsx("div",{className:"flex items-center justify-center h-64 rounded-lg",style:{backgroundColor:d?"#1f2937":"#ffffff",border:`1px solid ${d?"#374151":"#e5e7eb"}`,color:d?"#9ca3af":"#6b7280"},children:e.jsxs("div",{className:"text-center",children:[e.jsx(me,{className:"w-8 h-8 mx-auto mb-2",style:{color:d?"#6b7280":"#9ca3af"}}),e.jsx("p",{children:"No files found matching current filters"})]})}):e.jsxs("div",{className:`rounded-lg ${i}`,style:{backgroundColor:d?"#1f2937":"#ffffff",border:`1px solid ${d?"#374151":"#e5e7eb"}`},children:[e.jsx("div",{className:"p-4",style:{backgroundColor:d?"rgba(55, 65, 81, 0.5)":"#f9fafb",borderBottom:`1px solid ${d?"#374151":"#e5e7eb"}`},children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("h3",{className:"font-medium",style:{color:d?"#f3f4f6":"#111827"},children:["File Tree (",p.length," items)"]}),e.jsxs("div",{className:"text-sm",style:{color:d?"#9ca3af":"#6b7280"},children:[r.length," root items"]})]})}),e.jsx("div",{className:"overflow-auto",style:{maxHeight:"600px",backgroundColor:d?"#1f2937":"#ffffff"},children:p.map((u,y)=>e.jsx(Tt,{item:u,level:u.level||0,onToggleExpanded:t,onNodeAction:a,isDark:d},`${u.path}-${y}`))})]})});It.displayName="Tree";Tt.displayName="TreeNode";const pa=({scanData:r,filterState:s,onFilterChange:t,className:a=""})=>{const i=we(),o=i.palette.mode==="dark";if(!r)return null;const l=[{key:"green",label:"Production Ready",icon:de,description:"Likely in production and actively used",color:"green",count:r.summary.likelyInProd},{key:"orange",label:"High Risk",icon:ve,description:"May be used by multiple feature areas",color:"orange",count:r.summary.highRisk},{key:"yellow",label:"In Development",icon:kt,description:"Development files or low usage, recent edits",color:"yellow",count:r.summary.inDevelopment},{key:"red",label:"Legacy/Duplicate",icon:ye,description:"Duplicates, legacy patterns, or old files",color:"red",count:r.summary.legacyOrDupes}],d=u=>{const y=s.classifications.includes(u)?s.classifications.filter(m=>m!==u):[...s.classifications,u];t({classifications:y})},p=()=>{t({classifications:["green","orange","yellow","red"]})},j=()=>{t({classifications:[]})},M=u=>{const m={green:{main:i.palette.success.main,light:i.palette.success.light,dark:i.palette.success.dark},orange:{main:i.palette.warning.main,light:i.palette.warning.light,dark:i.palette.warning.dark},yellow:{main:i.palette.warning.main,light:i.palette.warning.light,dark:i.palette.warning.dark},red:{main:i.palette.error.main,light:i.palette.error.light,dark:i.palette.error.dark}}[u]||{main:i.palette.grey[500],light:i.palette.grey[100],dark:i.palette.grey[700]};return{bgcolor:z(m.main,o?.15:.12),color:o?m.light:m.dark,borderColor:z(m.main,o?.5:.4),iconColor:o?m.light:m.main}};return e.jsxs(se,{elevation:0,sx:{bgcolor:"background.paper",border:1,borderColor:"divider",borderRadius:1},className:a,children:[e.jsx(n,{sx:{p:2,borderBottom:1,borderColor:"divider"},children:e.jsxs(n,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[e.jsx(f,{variant:"subtitle1",fontWeight:600,children:"Classification Legend"}),e.jsxs(ir,{size:"small",variant:"outlined",children:[e.jsx(U,{onClick:p,color:"info",sx:{textTransform:"none",fontSize:"0.75rem"},children:"All"}),e.jsx(U,{onClick:j,color:"inherit",sx:{textTransform:"none",fontSize:"0.75rem"},children:"None"})]})]})}),e.jsx(n,{sx:{p:2,display:"flex",flexDirection:"column",gap:1.5},children:l.map(u=>{const y=M(u.color),m=u.icon,w=s.classifications.includes(u.key);return e.jsx(n,{onClick:()=>d(u.key),sx:{p:1.5,borderRadius:1,border:2,cursor:"pointer",transition:"all 0.2s",bgcolor:w?y.bgcolor:"action.hover",borderColor:w?y.borderColor:"divider","&:hover":{bgcolor:w?y.bgcolor:"action.selected"}},children:e.jsxs(n,{sx:{display:"flex",alignItems:"center",gap:1.5},children:[e.jsx(n,{sx:{display:"flex",alignItems:"center",justifyContent:"center",width:24,height:24,borderRadius:.5,bgcolor:w?y.bgcolor:"action.selected"},children:e.jsx(m,{className:"w-4 h-4",style:{color:w?y.iconColor:i.palette.text.disabled}})}),e.jsxs(n,{sx:{flex:1},children:[e.jsx(f,{variant:"body2",fontWeight:500,color:w?y.color:"text.primary",children:u.label}),e.jsx(f,{variant:"caption",color:w?y.color:"text.secondary",children:u.description})]}),e.jsx(f,{variant:"body2",fontWeight:500,color:w?y.color:"text.secondary",children:u.count})]})},u.key)})}),e.jsx(n,{sx:{p:2,borderTop:1,borderColor:"divider",bgcolor:"action.hover"},children:e.jsxs(n,{sx:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:2,textAlign:"center"},children:[e.jsxs(n,{children:[e.jsx(f,{variant:"h5",fontWeight:700,children:r.summary.totalFiles}),e.jsx(f,{variant:"body2",color:"text.secondary",children:"Total Files"})]}),e.jsxs(n,{children:[e.jsx(f,{variant:"h5",fontWeight:700,children:r.summary.totalDirs}),e.jsx(f,{variant:"body2",color:"text.secondary",children:"Directories"})]}),e.jsx(n,{sx:{gridColumn:"span 2",mt:1},children:e.jsxs(n,{sx:{display:"flex",alignItems:"center",gap:2,justifyContent:"center"},children:[e.jsxs(n,{sx:{display:"flex",alignItems:"center",gap:.5},children:[e.jsx(Ct,{className:"w-4 h-4"}),e.jsxs(f,{variant:"body2",color:"text.secondary",children:[r.summary.duplicates," duplicates"]})]}),e.jsxs(n,{sx:{display:"flex",alignItems:"center",gap:.5},children:[e.jsx(Ae,{className:"w-4 h-4"}),e.jsxs(f,{variant:"body2",color:"text.secondary",children:["Last scan: ",new Date(r.generatedAt).toLocaleTimeString()]})]})]})})]})})]})},ma=({searchQuery:r,onSearchChange:s,sortOptions:t,currentSort:a,onSortChange:i,filterState:o,onFilterChange:l,isLoading:d,onRefresh:p,onAnalyze:j,filteredCount:M,totalCount:u,compareWithBackup:y=!1,onToggleRecoveryMode:m,className:w=""})=>{var oe,xe,ke,ne,ie,pe;const P=we(),[b,I]=c.useState(!1),[$,A]=c.useState(!1),[J,E]=c.useState(!1),X=[{label:"All Files",value:""},{label:"TypeScript",value:".ts"},{label:"TSX Components",value:".tsx"},{label:"JavaScript",value:".js"},{label:"JSX Components",value:".jsx"},{label:"CSS/SCSS",value:".css"},{label:"JSON",value:".json"},{label:"Configuration",value:[".json",".yaml",".yml",".toml"]}],T=[{label:"All Time",value:0},{label:"Last 24 Hours",value:1},{label:"Last 7 Days",value:7},{label:"Last 30 Days",value:30},{label:"Last 90 Days",value:90}],S=v=>{l({fileType:Array.isArray(v)?v[0]:v}),A(!1)},G=v=>{i(v),E(!1)},te=v=>{l({modifiedDays:v})},re=()=>{l({classifications:["green","orange","yellow","red"],searchQuery:"",fileType:"",modifiedDays:0,showDuplicates:!1})},he=o.searchQuery.trim()!==""||o.fileType!==""||o.modifiedDays>0||o.showDuplicates||o.classifications.length<4;return e.jsxs(se,{elevation:0,sx:{bgcolor:"background.paper",border:1,borderColor:"divider",borderRadius:1},className:w,children:[e.jsxs(n,{sx:{p:2},children:[e.jsxs(n,{sx:{display:"flex",alignItems:"center",gap:2},children:[e.jsxs(n,{sx:{flex:1,position:"relative"},children:[e.jsx(aa,{style:{position:"absolute",left:12,top:"50%",transform:"translateY(-50%)",color:P.palette.text.disabled,width:16,height:16,zIndex:1}}),e.jsx(Ne,{fullWidth:!0,placeholder:"Search files by name or path...",value:r,onChange:v=>s(v.target.value),size:"small",sx:{"& .MuiOutlinedInput-root":{pl:5}}})]}),e.jsxs(n,{sx:{display:"flex",alignItems:"center",gap:1},children:[e.jsxs(n,{sx:{position:"relative"},children:[e.jsx(U,{variant:"outlined",color:"inherit",onClick:()=>E(!J),endIcon:e.jsx(Ke,{className:"w-4 h-4"}),startIcon:a.key==="score"?e.jsx(Qe,{className:"w-4 h-4"}):a.key==="name"?e.jsx($e,{className:"w-4 h-4"}):a.key==="mtime"?e.jsx(Ae,{className:"w-4 h-4"}):e.jsx(je,{className:"w-4 h-4"}),sx:{textTransform:"none"},children:a.label}),J&&e.jsx(se,{elevation:8,sx:{position:"absolute",right:0,top:"100%",mt:.5,width:256,bgcolor:"background.paper",border:1,borderColor:"divider",borderRadius:1,zIndex:1300,p:1},children:t.map(v=>e.jsx(U,{onClick:()=>G(v),fullWidth:!0,startIcon:v.key==="score"?e.jsx(Qe,{className:"w-4 h-4"}):v.key==="name"?e.jsx($e,{className:"w-4 h-4"}):v.key==="mtime"?e.jsx(Ae,{className:"w-4 h-4"}):e.jsx(je,{className:"w-4 h-4"}),endIcon:v.direction==="asc"?e.jsx(vr,{className:"w-4 h-4"}):e.jsx(br,{className:"w-4 h-4"}),sx:{textTransform:"none",justifyContent:"flex-start",px:1.5,py:1,color:a.key===v.key&&a.direction===v.direction?"primary.main":"text.primary",bgcolor:a.key===v.key&&a.direction===v.direction?z(P.palette.primary.main,.1):"transparent","&:hover":{bgcolor:"action.hover"}},children:v.label},`${v.key}-${v.direction}`))})]}),e.jsxs(n,{sx:{position:"relative"},children:[e.jsx(U,{variant:"outlined",color:"inherit",onClick:()=>A(!$),endIcon:e.jsx(Ke,{className:"w-4 h-4"}),startIcon:e.jsx($e,{className:"w-4 h-4"}),sx:{textTransform:"none"},children:o.fileType||"All Types"}),$&&e.jsx(se,{elevation:8,sx:{position:"absolute",right:0,top:"100%",mt:.5,width:192,bgcolor:"background.paper",border:1,borderColor:"divider",borderRadius:1,zIndex:1300,p:1},children:X.map(v=>e.jsx(U,{onClick:()=>S(v.value),fullWidth:!0,sx:{textTransform:"none",justifyContent:"flex-start",px:1.5,py:1,color:(Array.isArray(v.value)?v.value.includes(o.fileType):o.fileType===v.value)?"primary.main":"text.primary",bgcolor:(Array.isArray(v.value)?v.value.includes(o.fileType):o.fileType===v.value)?z(P.palette.primary.main,.1):"transparent","&:hover":{bgcolor:"action.hover"}},children:v.label},v.label))})]}),e.jsx(U,{variant:he?"contained":"outlined",color:he?"primary":"inherit",onClick:()=>I(!b),startIcon:e.jsx(qr,{className:"w-4 h-4"}),sx:{textTransform:"none"},children:"Filters"}),he&&e.jsx(U,{variant:"text",onClick:re,sx:{textTransform:"none",color:"text.secondary","&:hover":{color:"text.primary"}},children:"Clear"}),e.jsx(U,{variant:"outlined",color:"inherit",onClick:p,disabled:d,startIcon:e.jsx(Ie,{className:`w-4 h-4 ${d?"animate-spin":""}`}),sx:{textTransform:"none"},children:"Refresh"}),m&&e.jsx(U,{variant:y?"contained":"outlined",color:y?"secondary":"inherit",onClick:m,disabled:d,startIcon:e.jsx(wt,{className:"w-4 h-4"}),sx:{textTransform:"none"},title:"Compare with September 2025 backup (Gap Analysis)",children:"Recovery Mode"}),e.jsx(U,{variant:"contained",color:"primary",onClick:j,disabled:d,startIcon:e.jsx(Qe,{className:"w-4 h-4"}),sx:{textTransform:"none"},children:"Analyze"})]})]}),e.jsxs(n,{sx:{mt:2,display:"flex",alignItems:"center",justifyContent:"space-between",fontSize:"0.875rem",color:"text.secondary"},children:[e.jsxs(n,{children:["Showing ",M.toLocaleString()," of ",u.toLocaleString()," files",he&&" (filtered)"]}),d&&e.jsxs(n,{sx:{display:"flex",alignItems:"center",gap:1},children:[e.jsx(Ie,{className:"w-4 h-4 animate-spin"}),e.jsx("span",{children:"Analyzing codebase..."})]})]})]}),b&&e.jsx(n,{sx:{borderTop:1,borderColor:"divider",p:2,bgcolor:"action.hover"},children:e.jsxs(n,{sx:{display:"grid",gridTemplateColumns:{xs:"1fr",md:"repeat(3, 1fr)"},gap:2},children:[e.jsxs(Yt,{fullWidth:!0,children:[e.jsx(Kt,{children:"Modified Within"}),e.jsx(er,{value:o.modifiedDays,onChange:v=>te(Number(v.target.value)),label:"Modified Within",children:T.map(v=>e.jsx(sr,{value:v.value,children:v.label},v.value))})]}),e.jsxs(n,{sx:{display:"flex",alignItems:"center",gap:1},children:[e.jsx("input",{type:"checkbox",id:"showDuplicates",checked:o.showDuplicates,onChange:v=>l({showDuplicates:v.target.checked}),style:{width:16,height:16,accentColor:P.palette.primary.main,cursor:"pointer"}}),e.jsx("label",{htmlFor:"showDuplicates",style:{fontSize:"0.875rem",fontWeight:500,color:P.palette.text.primary,cursor:"pointer"},children:"Show duplicates only"})]}),y&&e.jsx(e.Fragment,{children:e.jsxs(n,{sx:{display:"flex",alignItems:"center",gap:1},children:[e.jsx("input",{type:"checkbox",id:"showMissingOnly",checked:o.showMissingOnly||!1,onChange:v=>l({showMissingOnly:v.target.checked}),style:{width:16,height:16,accentColor:P.palette.secondary.main,cursor:"pointer"}}),e.jsx("label",{htmlFor:"showMissingOnly",style:{fontSize:"0.875rem",fontWeight:500,color:P.palette.text.primary,cursor:"pointer"},children:"Show missing files only"})]})}),e.jsxs(n,{children:[e.jsx(n,{sx:{fontSize:"0.875rem",fontWeight:500,color:"text.primary",mb:.5},children:"Quick Filters"}),e.jsxs(n,{sx:{display:"flex",flexWrap:"wrap",gap:1},children:[e.jsx(Y,{label:"Duplicates",onClick:()=>o.showDuplicates?null:l({showDuplicates:!0}),color:o.showDuplicates?"error":"default",size:"small",sx:{bgcolor:o.showDuplicates?z(P.palette.error.main,.1):void 0,color:o.showDuplicates?"error.main":void 0}}),e.jsx(Y,{label:"Recent (7d)",onClick:()=>l({modifiedDays:o.modifiedDays===7?0:7}),color:o.modifiedDays===7?"primary":"default",size:"small",sx:{bgcolor:o.modifiedDays===7?z(P.palette.primary.main,.1):void 0,color:o.modifiedDays===7?"primary.main":void 0}}),e.jsx(Y,{label:"Legacy Only",onClick:()=>l({classifications:["red"]}),color:"error",size:"small",sx:{bgcolor:z(P.palette.error.main,.1),color:"error.main"}}),y&&e.jsxs(e.Fragment,{children:[e.jsx(Y,{label:"Missing",onClick:()=>l({recoveryStatus:["missing_in_prod"],showMissingOnly:!0}),color:o.showMissingOnly?"secondary":"default",size:"small",sx:{bgcolor:o.showMissingOnly?z(P.palette.secondary.main,.1):void 0,color:o.showMissingOnly?"secondary.main":void 0}}),e.jsx(Y,{label:"Modified",onClick:()=>l({recoveryStatus:["modified_since_backup"]}),color:(oe=o.recoveryStatus)!=null&&oe.includes("modified_since_backup")?"warning":"default",size:"small",sx:{bgcolor:(xe=o.recoveryStatus)!=null&&xe.includes("modified_since_backup")?z(P.palette.warning.main,.1):void 0,color:(ke=o.recoveryStatus)!=null&&ke.includes("modified_since_backup")?"warning.main":void 0}}),e.jsx(Y,{label:"New Files",onClick:()=>l({recoveryStatus:["new_file"]}),color:(ne=o.recoveryStatus)!=null&&ne.includes("new_file")?"success":"default",size:"small",sx:{bgcolor:(ie=o.recoveryStatus)!=null&&ie.includes("new_file")?z(P.palette.success.main,.1):void 0,color:(pe=o.recoveryStatus)!=null&&pe.includes("new_file")?"success.main":void 0}})]})]})]})]})})]})},Rt=r=>{const s=r.split("/");return s[s.length-1]||"/"},ua=({fileAnalysis:r,integrationPoints:s,onClose:t})=>{if(!r)return null;const{file:a,imports:i,endpoints:o}=r,l=i.every(p=>p.resolved),d=o.every(p=>p.existsInServer);return e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 dark:bg-opacity-70 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg max-w-4xl w-full mx-4 max-h-[90vh] overflow-y-auto",children:[e.jsxs("div",{className:"sticky top-0 bg-white dark:bg-gray-800 border-b border-gray-200 dark:border-gray-700 p-6 flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900 dark:text-gray-100",children:"Requirement Preview"}),e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mt-1",children:a.relPath})]}),e.jsx("button",{onClick:t,className:"text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-gray-300 p-2 hover:bg-gray-100 dark:hover:bg-gray-700 rounded",children:e.jsx(lr,{className:"w-5 h-5"})})]}),e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsxs("div",{className:"bg-gray-50 dark:bg-gray-700/50 p-4 rounded-lg",children:[e.jsx("h3",{className:"font-semibold text-gray-900 dark:text-gray-100 mb-2",children:"File Information"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:"Status:"}),e.jsx("span",{className:`ml-2 font-medium ${a.status==="missing_in_target"?"text-purple-600":"text-orange-600"}`,children:a.status==="missing_in_target"?"Missing in Target":"Modified in Target"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:"Size:"}),e.jsxs("span",{className:"ml-2 font-medium text-gray-900 dark:text-gray-100",children:[(a.size/1024).toFixed(2)," KB"]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:"Source Path:"}),e.jsx("span",{className:"ml-2 font-mono text-xs text-gray-900 dark:text-gray-100",children:a.sourcePath})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:"Target Path:"}),e.jsx("span",{className:"ml-2 font-mono text-xs text-gray-900 dark:text-gray-100",children:a.targetPath||"N/A"})]})]})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100 flex items-center gap-2",children:[e.jsx(Cr,{className:"w-5 h-5"}),"Import Dependencies"]}),l?e.jsxs("span",{className:"flex items-center gap-1 text-green-600 dark:text-green-400",children:[e.jsx(de,{className:"w-4 h-4"}),"All Resolved"]}):e.jsxs("span",{className:"flex items-center gap-1 text-orange-600 dark:text-orange-400",children:[e.jsx(je,{className:"w-4 h-4"}),"Some Unresolved"]})]}),i.length===0?e.jsx("p",{className:"text-gray-500 dark:text-gray-400 text-sm",children:"No imports found"}):e.jsx("div",{className:"space-y-2",children:i.map((p,j)=>e.jsx("div",{className:`p-3 rounded-lg border ${p.resolved?"bg-green-50 dark:bg-green-900/20 border-green-200 dark:border-green-800":"bg-orange-50 dark:bg-orange-900/20 border-orange-200 dark:border-orange-800"}`,children:e.jsx("div",{className:"flex items-start justify-between",children:e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[p.resolved?e.jsx(de,{className:"w-4 h-4 text-green-600 dark:text-green-400"}):e.jsx(ye,{className:"w-4 h-4 text-orange-600 dark:text-orange-400"}),e.jsx("code",{className:"text-sm font-mono text-gray-900 dark:text-gray-100",children:p.importPath})]}),p.resolved&&p.resolvedPath&&e.jsxs("p",{className:"text-xs text-gray-600 dark:text-gray-400 mt-1 ml-6",children:["â†’ ",p.resolvedPath]}),!p.resolved&&p.error&&e.jsxs("p",{className:"text-xs text-red-600 dark:text-red-400 mt-1 ml-6",children:["Error: ",p.error]})]})})},j))})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100 flex items-center gap-2",children:[e.jsx(St,{className:"w-5 h-5"}),"API Endpoints"]}),o.length>0&&e.jsx("span",{className:`flex items-center gap-1 ${d?"text-green-600 dark:text-green-400":"text-orange-600 dark:text-orange-400"}`,children:d?e.jsxs(e.Fragment,{children:[e.jsx(de,{className:"w-4 h-4"}),"All Verified"]}):e.jsxs(e.Fragment,{children:[e.jsx(je,{className:"w-4 h-4"}),"Some Missing"]})})]}),o.length===0?e.jsx("p",{className:"text-gray-500 dark:text-gray-400 text-sm",children:"No endpoints referenced in documentation"}):e.jsx("div",{className:"space-y-2",children:o.map((p,j)=>e.jsx("div",{className:`p-3 rounded-lg border ${p.existsInServer?"bg-green-50 dark:bg-green-900/20 border-green-200 dark:border-green-800":"bg-orange-50 dark:bg-orange-900/20 border-orange-200 dark:border-orange-800"}`,children:e.jsx("div",{className:"flex items-start justify-between",children:e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[p.existsInServer?e.jsx(de,{className:"w-4 h-4 text-green-600 dark:text-green-400"}):e.jsx(ye,{className:"w-4 h-4 text-orange-600 dark:text-orange-400"}),e.jsxs("span",{className:"font-mono text-sm font-semibold text-gray-900 dark:text-gray-100",children:[p.method," ",p.path]})]}),p.existsInServer&&p.routeFile&&e.jsxs("p",{className:"text-xs text-gray-600 dark:text-gray-400 mt-1 ml-6",children:["Found in: ",p.routeFile]}),!p.existsInServer&&e.jsx("p",{className:"text-xs text-orange-600 dark:text-orange-400 mt-1 ml-6",children:"Not found in server routes"}),p.foundInDocs.length>0&&e.jsxs("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1 ml-6",children:["Referenced in: ",p.foundInDocs.join(", ")]})]})})},j))})]}),(s.menuItems||s.router)&&e.jsxs("div",{children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100 mb-3 flex items-center gap-2",children:[e.jsx(me,{className:"w-5 h-5"}),"Integration Points"]}),e.jsxs("div",{className:"space-y-4",children:[s.menuItems&&e.jsxs("div",{className:"bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-800 rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("h4",{className:"font-semibold text-blue-900 dark:text-blue-300",children:"MenuItems.ts"}),e.jsxs("span",{className:"text-xs text-blue-600 dark:text-blue-400",children:["Line ",s.menuItems.lineNumber]})]}),e.jsx("pre",{className:"text-xs bg-white dark:bg-gray-900 p-3 rounded border border-blue-100 dark:border-blue-800 overflow-x-auto text-gray-900 dark:text-gray-100",children:e.jsx("code",{children:s.menuItems.codeBlock})})]}),s.router&&e.jsxs("div",{className:"bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-800 rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("h4",{className:"font-semibold text-blue-900 dark:text-blue-300",children:"Router.tsx"}),e.jsxs("span",{className:"text-xs text-blue-600 dark:text-blue-400",children:["Line ",s.router.lineNumber]})]}),e.jsx("pre",{className:"text-xs bg-white dark:bg-gray-900 p-3 rounded border border-blue-100 dark:border-blue-800 overflow-x-auto text-gray-900 dark:text-gray-100",children:e.jsx("code",{children:s.router.codeBlock})})]})]})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100 mb-3",children:"Projected Integration Code"}),e.jsxs("div",{className:"space-y-4",children:[s.router&&e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Router.tsx Addition"}),e.jsx("pre",{className:"text-xs bg-gray-900 dark:bg-gray-950 text-green-400 dark:text-green-300 p-4 rounded overflow-x-auto",children:e.jsx("code",{children:`// Add to Router.tsx (around line ${s.router.lineNumber})
{
  path: '/apps/${a.relPath.replace(/\.(tsx?|jsx?)$/,"").replace(/\\//g,"/")}',
  element: <${ga(a.relPath)} />,
}`})})]}),s.menuItems&&e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-gray-700 dark:text-gray-300 mb-2",children:"MenuItems.ts Addition"}),e.jsx("pre",{className:"text-xs bg-gray-900 dark:bg-gray-950 text-green-400 dark:text-green-300 p-4 rounded overflow-x-auto",children:e.jsx("code",{children:`// Add to MenuItems array (around line ${s.menuItems.lineNumber})
{
  label: '${ya(a.relPath)}',
  path: '/apps/${a.relPath.replace(/\.(tsx?|jsx?)$/,"").replace(/\\//g,"/")}',
  icon: 'FileCode', // Update with appropriate icon
}`})})]})]})]})]}),e.jsx("div",{className:"sticky bottom-0 bg-gray-50 dark:bg-gray-700/50 border-t border-gray-200 dark:border-gray-700 px-6 py-4 flex justify-end",children:e.jsx("button",{onClick:t,className:"px-4 py-2 bg-gray-200 dark:bg-gray-600 text-gray-800 dark:text-gray-200 rounded hover:bg-gray-300 dark:hover:bg-gray-500 transition-colors",children:"Close"})})]})})};function ga(r){return Rt(r).replace(/\.(tsx?|jsx?)$/,"")}function ya(r){return Rt(r).replace(/\.(tsx?|jsx?)$/,"").replace(/([A-Z])/g," $1").trim()}function Et(r){const{imports:s,endpoints:t}=r,a=s.every(l=>l.resolved),i=s.filter(l=>{var d;return!l.resolved&&!((d=l.error)!=null&&d.includes("node_modules"))});return t.filter(l=>!l.existsInServer).length>0?"server_blocker":!a&&i.length>0?"missing_deps":a&&t.every(l=>l.existsInServer||t.length===0)?"ready":"unknown"}const gt=({fileAnalysis:r,bundleSize:s,className:t=""})=>{const a=Et(r),o={ready:{icon:de,label:"Ready",color:"text-green-600",bgColor:"bg-green-50",borderColor:"border-green-200",description:"All dependencies resolved and endpoints verified"},missing_deps:{icon:ve,label:"Missing Deps",color:"text-yellow-600",bgColor:"bg-yellow-50",borderColor:"border-yellow-200",description:"Some imports missing (may exist in backup bundle)"},server_blocker:{icon:ye,label:"Server Blocker",color:"text-red-600",bgColor:"bg-red-50",borderColor:"border-red-200",description:"Required API endpoints not found in server"},unknown:{icon:ve,label:"Unknown",color:"text-gray-600 dark:text-gray-400",bgColor:"bg-gray-50 dark:bg-gray-700/50",borderColor:"border-gray-200 dark:border-gray-700",description:"Status cannot be determined"}}[a],l=o.icon;return e.jsxs("div",{className:`inline-flex items-center gap-2 px-3 py-1.5 rounded-lg border ${o.bgColor} ${o.borderColor} ${t}`,title:o.description,children:[e.jsx(l,{className:`w-4 h-4 ${o.color}`}),e.jsx("span",{className:`text-sm font-medium ${o.color}`,children:o.label}),s&&s>1&&e.jsxs("div",{className:"flex items-center gap-1 ml-1",children:[e.jsx(rs,{className:"w-3 h-3 text-gray-500 dark:text-gray-400"}),e.jsx("span",{className:"text-xs text-gray-600 dark:text-gray-400",children:s})]})]})},Te={sourcePath:"/var/www/orthodoxmetrics/prod/refactor-src/",destinationPath:"/var/www/orthodoxmetrics/prod/front-end/src/",backupPath:"/var/www/orthodoxmetrics/backup"},Xe="refactor-console-paths";class fa{constructor(){pt(this,"baseUrl","/api/refactor-console")}getSavedPaths(){try{const s=localStorage.getItem(Xe);if(s){const t=JSON.parse(s);return{sourcePath:t.sourcePath||Te.sourcePath,destinationPath:t.destinationPath||Te.destinationPath,backupPath:t.backupPath||Te.backupPath}}}catch(s){console.warn("Failed to parse saved path config:",s)}return Z({},Te)}savePaths(s){try{const t=this.getSavedPaths(),a=Z(Z({},t),s);localStorage.setItem(Xe,JSON.stringify(a)),console.log("[RefactorConsole] Paths saved:",a)}catch(t){console.error("Failed to save path config:",t)}}clearSavedPaths(){localStorage.removeItem(Xe),console.log("[RefactorConsole] Paths reset to defaults")}getDefaultPaths(){return F(this,null,function*(){try{const s=yield fetch(`${this.baseUrl}/config/paths`,{method:"GET",headers:{"Content-Type":"application/json"},credentials:"include"});if(!s.ok)throw new Error(`HTTP error! status: ${s.status}`);return yield s.json()}catch(s){throw console.error("Failed to get default paths:",s),s}})}validatePaths(s){return F(this,null,function*(){try{const t=yield fetch(`${this.baseUrl}/config/validate-paths`,{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify(s)});if(!t.ok)throw new Error(`HTTP error! status: ${t.status}`);return yield t.json()}catch(t){throw console.error("Failed to validate paths:",t),t}})}fetchSnapshots(s="local",t){return F(this,null,function*(){try{const a=new URLSearchParams;a.append("sourceType",s),t&&a.append("sourcePath",t);const i=yield fetch(`${this.baseUrl}/snapshots?${a}`,{method:"GET",headers:{"Content-Type":"application/json"},credentials:"include"});if(!i.ok){const l=yield this.safeParseResponse(i);throw new Error(l.message||`HTTP error! status: ${i.status}`)}return yield this.safeParseResponse(i)}catch(a){throw console.error("Failed to fetch snapshots:",a),new Error(a instanceof Error?a.message:"Failed to fetch snapshots")}})}scan(s=!1,t=!1,a,i,o){return F(this,null,function*(){try{const l=new URLSearchParams;s&&l.append("rebuild","1"),t&&l.append("compareWithBackup","1");const d=a||this.getSavedPaths(),p=i||d.sourceType||"local",j=o||d.snapshotId;l.append("sourceType",p),j&&l.append("snapshotId",j),d.sourcePath&&l.append("sourcePath",d.sourcePath),d.destinationPath&&l.append("destinationPath",d.destinationPath),d.backupPath&&l.append("backupPath",d.backupPath);const M=yield fetch(`${this.baseUrl}/scan?${l}`,{method:"GET",headers:{"Content-Type":"application/json"},credentials:"include"});if(!M.ok){const y=yield this.safeParseResponse(M);throw new Error(y.message||`HTTP error! status: ${M.status}`)}return yield this.safeParseResponse(M)}catch(l){throw console.error("Failed to fetch refactor scan:",l),new Error(l instanceof Error?l.message:"Failed to fetch scan data")}})}previewRestore(s,t,a,i){return F(this,null,function*(){try{const o=t||this.getSavedPaths(),l=a||o.sourceType||"local",d=i||o.snapshotId,p=yield fetch(`${this.baseUrl}/preview-restore`,{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({relPath:s,sourcePath:o.sourcePath||o.backupPath,destinationPath:o.destinationPath,sourceType:l,snapshotId:d})});if(!p.ok){const M=yield this.safeParseResponse(p);throw new Error(M.message||`HTTP error! status: ${p.status}`)}return yield this.safeParseResponse(p)}catch(o){throw console.error("Failed to preview restore:",o),new Error(o instanceof Error?o.message:"Failed to preview restore")}})}restore(s,t,a,i){return F(this,null,function*(){try{const o=t||this.getSavedPaths(),l=a||o.sourceType||"local",d=i||o.snapshotId,p=yield fetch(`${this.baseUrl}/restore`,{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({relPath:s,sourcePath:o.sourcePath||o.backupPath,destinationPath:o.destinationPath,sourceType:l,snapshotId:d})});if(!p.ok){const M=yield this.safeParseResponse(p);throw new Error(M.message||`HTTP error! status: ${p.status}`)}return yield this.safeParseResponse(p)}catch(o){throw console.error("Failed to restore file:",o),new Error(o instanceof Error?o.message:"Failed to restore file")}})}safeParseResponse(s){return F(this,null,function*(){const t=s.headers.get("content-type")||"";if(t.includes("application/json"))try{return yield s.json()}catch(a){const i=yield s.text();throw new Error(`Invalid JSON response: ${i.substring(0,200)}`)}else{const a=yield s.text();throw new Error(`Non-JSON response (${t}): ${a.substring(0,500)}`)}})}startPhase1Analysis(){return F(this,null,function*(){try{const s=yield fetch(`${this.baseUrl}/phase1/start`,{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include"});if(!s.ok){const a=yield this.safeParseResponse(s);throw new Error(a.message||`HTTP error! status: ${s.status}`)}return yield this.safeParseResponse(s)}catch(s){throw console.error("Failed to start Phase 1 analysis:",s),new Error(s instanceof Error?s.message:"Failed to start Phase 1 analysis")}})}getPhase1JobStatus(s){return F(this,null,function*(){try{const t=yield fetch(`${this.baseUrl}/jobs/${s}`,{method:"GET",headers:{"Content-Type":"application/json"},credentials:"include"});if(!t.ok){const i=yield this.safeParseResponse(t);throw new Error(i.message||`HTTP error! status: ${t.status}`)}return yield this.safeParseResponse(t)}catch(t){throw console.error(`Failed to get Phase 1 job ${s} status:`,t),new Error(t instanceof Error?t.message:"Failed to get Phase 1 job status")}})}getPhase1JobResult(s){return F(this,null,function*(){try{const t=yield fetch(`${this.baseUrl}/jobs/${s}/result`,{method:"GET",headers:{"Content-Type":"application/json"},credentials:"include"});if(t.status===409){const i=yield this.safeParseResponse(t);throw new Error(`Job not ready: ${i.status} (${i.progress}%)`)}if(!t.ok){const i=yield this.safeParseResponse(t);throw new Error(i.message||`HTTP error! status: ${t.status}`)}return yield this.safeParseResponse(t)}catch(t){throw console.error(`Failed to get Phase 1 job ${s} result:`,t),new Error(t instanceof Error?t.message:"Failed to get Phase 1 job result")}})}restoreBundle(s){return F(this,null,function*(){try{const t=yield fetch(`${this.baseUrl}/restore-bundle`,{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify(s)});if(!t.ok){const i=yield t.json();throw new Error(i.message||`HTTP error! status: ${t.status}`)}return yield t.json()}catch(t){throw console.error("Failed to restore bundle:",t),new Error(t instanceof Error?t.message:"Failed to restore bundle")}})}healthCheck(){return F(this,null,function*(){try{const s=yield fetch(`${this.baseUrl}/health`,{method:"GET",headers:{"Content-Type":"application/json"},credentials:"include"});if(!s.ok)throw new Error(`Health check failed: ${s.status} ${s.statusText}`);const t=yield s.json();return ce(Z({},t),{status:t.ok?"ok":"error"})}catch(s){throw console.error("Health check error:",s),new Error(s instanceof Error?s.message:"Health check failed")}})}checkCacheStatus(){return F(this,null,function*(){try{const s=yield fetch(`${this.baseUrl}/scan`,{method:"HEAD",credentials:"include"}),t=s.status===200?0:-1;return{exists:s.status===200,age:t}}catch(s){return{exists:!1,age:-1}}})}getRestoreHistory(s=50,t=0){return F(this,null,function*(){try{const a=new URLSearchParams;a.append("limit",s.toString()),a.append("offset",t.toString());const i=yield fetch(`${this.baseUrl}/restore-history?${a}`,{method:"GET",headers:{"Content-Type":"application/json"},credentials:"include"});if(!i.ok){const l=yield this.safeParseResponse(i);throw new Error(l.message||`HTTP error! status: ${i.status}`)}return yield this.safeParseResponse(i)}catch(a){throw console.error("Failed to get restore history:",a),new Error(a instanceof Error?a.message:"Failed to get restore history")}})}getFileRestoreHistory(s){return F(this,null,function*(){try{const t=yield fetch(`${this.baseUrl}/restore-history/file/${s}`,{method:"GET",headers:{"Content-Type":"application/json"},credentials:"include"});if(!t.ok){const i=yield this.safeParseResponse(t);throw new Error(i.message||`HTTP error! status: ${t.status}`)}return yield this.safeParseResponse(t)}catch(t){throw console.error("Failed to get file restore history:",t),new Error(t instanceof Error?t.message:"Failed to get file restore history")}})}getRestoreHistoryStats(){return F(this,null,function*(){try{const s=yield fetch(`${this.baseUrl}/restore-history/stats`,{method:"GET",headers:{"Content-Type":"application/json"},credentials:"include"});if(!s.ok){const a=yield this.safeParseResponse(s);throw new Error(a.message||`HTTP error! status: ${s.status}`)}return yield this.safeParseResponse(s)}catch(s){throw console.error("Failed to get restore history stats:",s),new Error(s instanceof Error?s.message:"Failed to get restore history stats")}})}exportRestoreHistory(s=1e3){return F(this,null,function*(){try{const t=new URLSearchParams;t.append("limit",s.toString());const a=`${this.baseUrl}/restore-history/export?${t}`;window.open(a,"_blank")}catch(t){throw console.error("Failed to export restore history:",t),new Error(t instanceof Error?t.message:"Failed to export restore history")}})}}const q=new fa,ba=({bundle:r,onRestoreComplete:s})=>{const[t,a]=c.useState(!1),[i,o]=c.useState(!1),l=Et({file:r.rootFile,imports:r.missingImports,endpoints:r.requiredEndpoints}),d=l==="ready"||l==="missing_deps",p=()=>F(void 0,null,function*(){if(!d){W.error("Cannot restore bundle: dependencies or endpoints missing");return}a(!0);try{const M=`/apps/${r.rootFile.relPath.replace(/\.(tsx?|jsx?)$/,"").replace(/^src\//,"").replace(/\//g,"/")}`,u=r.rootFile.relPath.split("/").pop().replace(/\.(tsx?|jsx?)$/,"").replace(/([A-Z])/g," $1").trim(),y=yield q.restoreBundle({bundleFiles:r.files.map(m=>m.relPath),routePath:M,menuLabel:u,menuIcon:"FileCode"});y.success?(W.success(`Successfully restored ${y.restoredFiles.length} files`),s&&s()):W.error(y.message||"Restoration failed")}catch(j){W.error(`Failed to restore bundle: ${j instanceof Error?j.message:"Unknown error"}`)}finally{a(!1),o(!1)}});return d?i?e.jsxs("div",{className:"flex items-center gap-2 p-3 bg-yellow-50 border border-yellow-200 rounded-lg",children:[e.jsx(je,{className:"w-5 h-5 text-yellow-600"}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("p",{className:"text-sm font-medium text-yellow-900",children:["Restore ",r.files.length," files?"]}),e.jsx("p",{className:"text-xs text-yellow-700 mt-1",children:"This will copy files from backup and update Router.tsx and MenuItems.ts"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>o(!1),className:"px-3 py-1 text-sm bg-gray-200 dark:bg-gray-600 text-gray-800 dark:text-gray-200 rounded hover:bg-gray-300 dark:hover:bg-gray-500",children:"Cancel"}),e.jsx("button",{onClick:p,disabled:t,className:"px-3 py-1 text-sm bg-green-600 text-white rounded hover:bg-green-700 disabled:opacity-50 flex items-center gap-2",children:t?e.jsxs(e.Fragment,{children:[e.jsx(Kr,{className:"w-4 h-4 animate-spin"}),"Restoring..."]}):e.jsxs(e.Fragment,{children:[e.jsx(de,{className:"w-4 h-4"}),"Confirm"]})})]})]}):e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(gt,{fileAnalysis:{file:r.rootFile,imports:r.missingImports,endpoints:r.requiredEndpoints,integrationPoints:[]},bundleSize:r.files.length}),e.jsxs("button",{onClick:()=>o(!0),disabled:t||!d,className:"px-4 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700 disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-2",children:[e.jsx(rs,{className:"w-4 h-4"}),e.jsx("span",{children:"Restore Bundle"})]})]}):e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(gt,{fileAnalysis:{file:r.rootFile,imports:r.missingImports,endpoints:r.requiredEndpoints,integrationPoints:[]},bundleSize:r.files.length}),e.jsx("span",{className:"text-sm text-gray-500 dark:text-gray-400",children:l==="server_blocker"?"Required endpoints missing in server":"Cannot restore"})]})};function Ze(r){const o=r,{children:s,value:t,index:a}=o,i=xt(o,["children","value","index"]);return e.jsx("div",ce(Z({role:"tabpanel",hidden:t!==a,id:`diff-tabpanel-${a}`,"aria-labelledby":`diff-tab-${a}`},i),{children:t===a&&e.jsx(n,{sx:{pt:2},children:s})}))}const ja=({open:r,onClose:s,onConfirmRestore:t,preview:a,dependencies:i,isRestoring:o=!1})=>{const l=we(),[d,p]=c.useState(0),j=c.useMemo(()=>{if(!a)return{source:[],target:[],unified:[]};const m=a.sourceContent.split(`
`),w=a.targetContent?a.targetContent.split(`
`):[],P=Math.max(m.length,w.length),b=[];for(let I=0;I<P;I++){const $=m[I]||"",A=w[I]||"";let J="unchanged";I>=w.length&&I<m.length?J="add":I>=m.length&&I<w.length?J="remove":$!==A&&(J="add"),b.push({type:J,sourceNum:I<m.length?I+1:null,targetNum:I<w.length?I+1:null,sourceLine:$,targetLine:A})}return{source:m,target:w,unified:b}},[a]),M=(m,w)=>{p(w)};if(!a||!i)return null;const u=i.missingCount>0,y=!a.targetExists;return e.jsxs(ft,{open:r,onClose:s,maxWidth:"xl",fullWidth:!0,PaperProps:{sx:{height:"90vh",bgcolor:"background.paper"}},children:[e.jsxs(bt,{children:[e.jsxs(n,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[e.jsxs(n,{sx:{display:"flex",alignItems:"center",gap:1},children:[e.jsx(ut,{className:"w-5 h-5"}),e.jsx(f,{variant:"h6",children:"Preview Restore"})]}),e.jsxs(n,{sx:{display:"flex",gap:1},children:[y&&e.jsx(Y,{label:"New File",color:"success",size:"small"}),a.diffStats.identical&&!y&&e.jsx(Y,{label:"Identical",color:"info",size:"small"}),u&&e.jsx(Y,{label:`${i.missingCount} Missing Dep${i.missingCount>1?"s":""}`,color:"warning",size:"small",icon:e.jsx(ve,{className:"w-3 h-3"})})]})]}),e.jsx(f,{variant:"body2",sx:{color:"text.secondary",mt:.5,fontFamily:"monospace"},children:a.relPath})]}),e.jsxs(jt,{dividers:!0,children:[u&&e.jsxs(be,{severity:"warning",sx:{mb:2},children:[e.jsx(qe,{children:"Missing Dependencies Detected"}),"This file imports ",i.missingCount," component(s) that don't exist in the target directory. Restoring this file may cause runtime errors."]}),e.jsx(n,{sx:{borderBottom:1,borderColor:"divider"},children:e.jsxs(dr,{value:d,onChange:M,children:[e.jsx(Ge,{label:"Side-by-Side Diff",icon:e.jsx(ut,{className:"w-4 h-4"}),iconPosition:"start"}),e.jsx(Ge,{label:"Dependencies",icon:e.jsx(rs,{className:"w-4 h-4"}),iconPosition:"start"}),e.jsx(Ge,{label:"File Info",icon:e.jsx(Nt,{className:"w-4 h-4"}),iconPosition:"start"})]})}),e.jsx(Ze,{value:d,index:0,children:e.jsxs(n,{sx:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:2,height:"60vh",overflow:"auto"},children:[e.jsxs(n,{sx:{border:1,borderColor:"divider",borderRadius:1,overflow:"hidden"},children:[e.jsxs(n,{sx:{bgcolor:z(l.palette.success.main,.1),p:1,borderBottom:1,borderColor:"divider"},children:[e.jsx(f,{variant:"subtitle2",sx:{fontWeight:600},children:"Source (Snapshot)"}),e.jsxs(f,{variant:"caption",sx:{color:"text.secondary"},children:[a.sourceSize," bytes â€¢ ",j.source.length," lines"]})]}),e.jsx(n,{sx:{fontFamily:"monospace",fontSize:"0.8rem",p:1,bgcolor:"background.default",maxHeight:"100%",overflow:"auto"},children:j.source.map((m,w)=>{const P=j.unified[w],b=(P==null?void 0:P.type)==="add";return e.jsxs(n,{sx:{display:"flex",bgcolor:b?z(l.palette.success.main,.1):"transparent","&:hover":{bgcolor:z(l.palette.primary.main,.05)}},children:[e.jsx(n,{sx:{width:40,color:"text.secondary",textAlign:"right",pr:1,flexShrink:0,userSelect:"none",borderRight:1,borderColor:"divider"},children:w+1}),e.jsx(n,{sx:{flex:1,pl:1,whiteSpace:"pre",overflowX:"auto"},children:m||" "})]},w)})})]}),e.jsxs(n,{sx:{border:1,borderColor:"divider",borderRadius:1,overflow:"hidden"},children:[e.jsxs(n,{sx:{bgcolor:y?z(l.palette.info.main,.1):z(l.palette.error.main,.1),p:1,borderBottom:1,borderColor:"divider"},children:[e.jsx(f,{variant:"subtitle2",sx:{fontWeight:600},children:"Target (Current)"}),e.jsx(f,{variant:"caption",sx:{color:"text.secondary"},children:y?"File does not exist":`${a.targetSize} bytes â€¢ ${j.target.length} lines`})]}),e.jsx(n,{sx:{fontFamily:"monospace",fontSize:"0.8rem",p:1,bgcolor:"background.default",maxHeight:"100%",overflow:"auto"},children:y?e.jsx(n,{sx:{p:2,textAlign:"center",color:"text.secondary"},children:e.jsx(f,{variant:"body2",children:"File will be created"})}):j.target.map((m,w)=>{const P=j.unified[w],b=(P==null?void 0:P.type)==="add";return e.jsxs(n,{sx:{display:"flex",bgcolor:b?z(l.palette.error.main,.1):"transparent","&:hover":{bgcolor:z(l.palette.primary.main,.05)}},children:[e.jsx(n,{sx:{width:40,color:"text.secondary",textAlign:"right",pr:1,flexShrink:0,userSelect:"none",borderRight:1,borderColor:"divider"},children:w+1}),e.jsx(n,{sx:{flex:1,pl:1,whiteSpace:"pre",overflowX:"auto"},children:m||" "})]},w)})})]})]})}),e.jsx(Ze,{value:d,index:1,children:e.jsx(n,{sx:{maxHeight:"60vh",overflow:"auto"},children:i.hasImports?e.jsxs(n,{children:[e.jsxs(f,{variant:"subtitle1",sx:{mb:2},children:["Found ",i.totalImports," import",i.totalImports!==1?"s":""]}),i.missingCount>0&&e.jsxs(be,{severity:"warning",sx:{mb:2},children:[e.jsxs(qe,{children:["âš ï¸ ",i.missingCount," Missing Dependencies"]}),"The following imports could not be resolved in the target directory:"]}),e.jsx(tr,{children:i.imports.map((m,w)=>e.jsxs(or.Fragment,{children:[e.jsx(hr,{children:e.jsxs(n,{sx:{display:"flex",alignItems:"center",width:"100%",gap:2},children:[m.exists?e.jsx(de,{className:"w-5 h-5",style:{color:l.palette.success.main}}):e.jsx(ye,{className:"w-5 h-5",style:{color:l.palette.error.main}}),e.jsxs(n,{sx:{flex:1},children:[e.jsx(f,{variant:"body2",sx:{fontFamily:"monospace",color:m.exists?"text.primary":"error.main"},children:m.importPath}),m.resolvedPath&&e.jsxs(f,{variant:"caption",sx:{color:"text.secondary"},children:["Line ",m.lineNumber," â†’ ",m.resolvedPath]}),!m.exists&&!m.resolvedPath&&m.importType!=="package"&&e.jsxs(f,{variant:"caption",sx:{color:"error.main"},children:["Line ",m.lineNumber," â†’ Not found in target"]})]}),e.jsx(Y,{label:m.importType,size:"small",variant:"outlined",color:m.importType==="package"?"default":"primary"})]})}),w<i.imports.length-1&&e.jsx(Je,{})]},w))})]}):e.jsxs(be,{severity:"info",children:[e.jsx(qe,{children:"No Dependencies"}),"This file does not import any other files."]})})}),e.jsx(Ze,{value:d,index:2,children:e.jsxs(n,{sx:{display:"flex",flexDirection:"column",gap:2},children:[e.jsxs(n,{children:[e.jsx(f,{variant:"subtitle2",sx:{fontWeight:600,mb:1},children:"Source File (Snapshot)"}),e.jsxs(n,{sx:{display:"grid",gridTemplateColumns:"auto 1fr",gap:1,fontSize:"0.875rem"},children:[e.jsx(f,{variant:"body2",sx:{color:"text.secondary"},children:"Path:"}),e.jsx(f,{variant:"body2",sx:{fontFamily:"monospace"},children:a.sourcePath}),e.jsx(f,{variant:"body2",sx:{color:"text.secondary"},children:"Size:"}),e.jsxs(f,{variant:"body2",children:[a.sourceSize," bytes"]}),e.jsx(f,{variant:"body2",sx:{color:"text.secondary"},children:"Lines:"}),e.jsx(f,{variant:"body2",children:j.source.length}),e.jsx(f,{variant:"body2",sx:{color:"text.secondary"},children:"Modified:"}),e.jsx(f,{variant:"body2",children:new Date(a.sourceModified).toLocaleString()})]})]}),e.jsx(Je,{}),e.jsxs(n,{children:[e.jsx(f,{variant:"subtitle2",sx:{fontWeight:600,mb:1},children:"Target File (Current)"}),y?e.jsx(be,{severity:"info",children:"File does not exist in target directory - it will be created"}):e.jsxs(n,{sx:{display:"grid",gridTemplateColumns:"auto 1fr",gap:1,fontSize:"0.875rem"},children:[e.jsx(f,{variant:"body2",sx:{color:"text.secondary"},children:"Path:"}),e.jsx(f,{variant:"body2",sx:{fontFamily:"monospace"},children:a.targetPath}),e.jsx(f,{variant:"body2",sx:{color:"text.secondary"},children:"Size:"}),e.jsxs(f,{variant:"body2",children:[a.targetSize," bytes"]}),e.jsx(f,{variant:"body2",sx:{color:"text.secondary"},children:"Lines:"}),e.jsx(f,{variant:"body2",children:j.target.length}),e.jsx(f,{variant:"body2",sx:{color:"text.secondary"},children:"Modified:"}),e.jsx(f,{variant:"body2",children:a.targetModified?new Date(a.targetModified).toLocaleString():"N/A"})]})]}),e.jsx(Je,{}),e.jsxs(n,{children:[e.jsx(f,{variant:"subtitle2",sx:{fontWeight:600,mb:1},children:"Restore Impact"}),e.jsx(n,{sx:{display:"flex",flexDirection:"column",gap:1},children:e.jsxs(be,{severity:y?"info":a.diffStats.identical?"success":"warning",children:[y&&"New file will be created",!y&&a.diffStats.identical&&"Files are identical - no changes needed",!y&&!a.diffStats.identical&&e.jsxs(e.Fragment,{children:[a.diffStats.linesAdded>0?`${a.diffStats.linesAdded} lines will be added`:"",a.diffStats.linesAdded<0?`${Math.abs(a.diffStats.linesAdded)} lines will be removed`:"",a.diffStats.linesAdded===0?"Same number of lines, but content differs":""]})]})})]})]})})]}),e.jsxs(vt,{sx:{p:2,gap:1},children:[e.jsx(U,{onClick:s,disabled:o,children:"Cancel"}),e.jsx(U,{variant:"contained",color:u?"warning":"primary",onClick:t,disabled:o,startIcon:o?e.jsx(ts,{size:16}):null,children:o?"Restoring...":u?"Restore Anyway":"Confirm Restore"})]})]})},va=({open:r,onClose:s})=>{const t=we(),[a,i]=c.useState([]),[o,l]=c.useState(null),[d,p]=c.useState(!1),[j,M]=c.useState(null),[u,y]=c.useState(0),[m,w]=c.useState(25),[P,b]=c.useState(0);c.useEffect(()=>{r&&(I(),$())},[r,u,m]);const I=()=>F(void 0,null,function*(){p(!0),M(null);try{const S=yield q.getRestoreHistory(m,u*m);i(S.entries),b(S.total)}catch(S){console.error("Failed to load restore history:",S),M(S instanceof Error?S.message:"Failed to load history")}finally{p(!1)}}),$=()=>F(void 0,null,function*(){try{const S=yield q.getRestoreHistoryStats();l(S.stats)}catch(S){console.error("Failed to load stats:",S)}}),A=()=>F(void 0,null,function*(){try{yield q.exportRestoreHistory(1e3)}catch(S){console.error("Failed to export history:",S)}}),J=(S,G)=>{y(G)},E=S=>{w(parseInt(S.target.value,10)),y(0)},X=S=>new Date(S).toLocaleString(),T=S=>{if(S===0)return"0 B";const G=1024,te=["B","KB","MB","GB"],re=Math.floor(Math.log(S)/Math.log(G));return`${parseFloat((S/Math.pow(G,re)).toFixed(2))} ${te[re]}`};return e.jsxs(ft,{open:r,onClose:s,maxWidth:"xl",fullWidth:!0,PaperProps:{sx:{height:"90vh",bgcolor:"background.paper"}},children:[e.jsx(bt,{children:e.jsxs(n,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[e.jsxs(n,{sx:{display:"flex",alignItems:"center",gap:1},children:[e.jsx(es,{className:"w-5 h-5"}),e.jsx(f,{variant:"h6",children:"Restore History"})]}),e.jsxs(n,{sx:{display:"flex",gap:1,alignItems:"center"},children:[e.jsx(Ce,{title:"Export to CSV",children:e.jsx(Ye,{size:"small",onClick:A,children:e.jsx(Er,{className:"w-4 h-4"})})}),e.jsx(Ce,{title:"Refresh",children:e.jsx(Ye,{size:"small",onClick:()=>{I(),$()},children:e.jsx(Ie,{className:"w-4 h-4"})})})]})]})}),e.jsxs(jt,{dividers:!0,children:[o&&e.jsxs(n,{sx:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(150px, 1fr))",gap:2,mb:3},children:[e.jsxs(se,{elevation:0,sx:{p:2,bgcolor:z(t.palette.primary.main,.1),border:1,borderColor:"divider"},children:[e.jsx(f,{variant:"caption",sx:{color:"text.secondary"},children:"Total Restores"}),e.jsx(f,{variant:"h6",sx:{fontWeight:600},children:o.totalRestores})]}),e.jsxs(se,{elevation:0,sx:{p:2,bgcolor:z(t.palette.success.main,.1),border:1,borderColor:"divider"},children:[e.jsx(f,{variant:"caption",sx:{color:"text.secondary"},children:"Successful"}),e.jsx(f,{variant:"h6",sx:{fontWeight:600,color:"success.main"},children:o.successfulRestores})]}),e.jsxs(se,{elevation:0,sx:{p:2,bgcolor:z(t.palette.error.main,.1),border:1,borderColor:"divider"},children:[e.jsx(f,{variant:"caption",sx:{color:"text.secondary"},children:"Failed"}),e.jsx(f,{variant:"h6",sx:{fontWeight:600,color:"error.main"},children:o.failedRestores})]}),e.jsxs(se,{elevation:0,sx:{p:2,bgcolor:z(t.palette.info.main,.1),border:1,borderColor:"divider"},children:[e.jsx(f,{variant:"caption",sx:{color:"text.secondary"},children:"Unique Files"}),e.jsx(f,{variant:"h6",sx:{fontWeight:600},children:o.uniqueFiles})]}),e.jsxs(se,{elevation:0,sx:{p:2,bgcolor:z(t.palette.secondary.main,.1),border:1,borderColor:"divider"},children:[e.jsx(f,{variant:"caption",sx:{color:"text.secondary"},children:"Users"}),e.jsx(f,{variant:"h6",sx:{fontWeight:600},children:o.uniqueUsers})]})]}),j&&e.jsx(be,{severity:"error",sx:{mb:2},onClose:()=>M(null),children:j}),d&&e.jsx(n,{sx:{display:"flex",justifyContent:"center",p:4},children:e.jsx(ts,{})}),!d&&a.length>0&&e.jsx(xr,{component:se,variant:"outlined",children:e.jsxs(pr,{size:"small",children:[e.jsx(mr,{children:e.jsxs(mt,{sx:{bgcolor:"action.hover"},children:[e.jsx(ee,{children:"Status"}),e.jsx(ee,{children:"Timestamp"}),e.jsx(ee,{children:"User"}),e.jsx(ee,{children:"File Path"}),e.jsx(ee,{children:"Source"}),e.jsx(ee,{children:"Snapshot"}),e.jsx(ee,{align:"right",children:"Size"})]})}),e.jsx(ur,{children:a.map(S=>e.jsxs(mt,{hover:!0,sx:{"&:hover":{bgcolor:z(t.palette.primary.main,.05)}},children:[e.jsx(ee,{children:S.success?e.jsx(Ce,{title:"Success",children:e.jsx(de,{className:"w-4 h-4",style:{color:t.palette.success.main}})}):e.jsx(Ce,{title:S.error||"Failed",children:e.jsx(ye,{className:"w-4 h-4",style:{color:t.palette.error.main}})})}),e.jsx(ee,{children:e.jsxs(n,{sx:{display:"flex",alignItems:"center",gap:.5},children:[e.jsx(Ae,{className:"w-3 h-3",style:{color:t.palette.text.secondary}}),e.jsx(f,{variant:"caption",children:X(S.timestamp)})]})}),e.jsx(ee,{children:e.jsxs(n,{sx:{display:"flex",alignItems:"center",gap:.5},children:[e.jsx(la,{className:"w-3 h-3",style:{color:t.palette.text.secondary}}),e.jsx(f,{variant:"caption",children:S.user||S.userEmail||"anonymous"})]})}),e.jsx(ee,{children:e.jsxs(n,{sx:{display:"flex",alignItems:"center",gap:.5},children:[e.jsx(Nt,{className:"w-3 h-3",style:{color:t.palette.text.secondary}}),e.jsx(f,{variant:"caption",sx:{fontFamily:"monospace",maxWidth:300,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},title:S.relPath,children:S.relPath})]})}),e.jsx(ee,{children:e.jsx(Y,{label:S.sourceType,size:"small",color:S.sourceType==="remote"?"secondary":"default",sx:{height:20,fontSize:"0.65rem"}})}),e.jsx(ee,{children:S.snapshotId?e.jsx(Y,{label:S.snapshotId,size:"small",color:"primary",sx:{height:20,fontSize:"0.65rem"}}):e.jsx(f,{variant:"caption",sx:{color:"text.secondary"},children:"â€”"})}),e.jsx(ee,{align:"right",children:e.jsxs(n,{sx:{display:"flex",alignItems:"center",gap:.5,justifyContent:"flex-end"},children:[e.jsx(Xr,{className:"w-3 h-3",style:{color:t.palette.text.secondary}}),e.jsx(f,{variant:"caption",children:T(S.fileSize)})]})})]},S.id))})]})}),!d&&a.length===0&&e.jsxs(n,{sx:{textAlign:"center",py:6},children:[e.jsx(es,{className:"w-12 h-12 mx-auto mb-2",style:{color:t.palette.text.secondary,opacity:.5}}),e.jsx(f,{variant:"body1",sx:{color:"text.secondary"},children:"No restore history yet"}),e.jsx(f,{variant:"body2",sx:{color:"text.secondary",mt:1},children:"Restore operations will be logged here for audit purposes"})]}),!d&&a.length>0&&e.jsx(gr,{rowsPerPageOptions:[10,25,50,100],component:"div",count:P,rowsPerPage:m,page:u,onPageChange:J,onRowsPerPageChange:E})]}),e.jsx(vt,{sx:{p:2},children:e.jsx(U,{onClick:s,children:"Close"})})]})};function Fe(r){const s=r.toLowerCase();return s.includes("/pages/")||s.includes("/page/")?"page":s.includes("/components/")||s.includes("/component/")?"component":s.includes("/hooks/")||s.includes("/hook/")||s.includes("use")&&r.endsWith(".ts")?"hook":s.includes("/services/")||s.includes("/service/")||s.includes("/api/")?"service":"other"}function wa(r,s,t){if(!r.startsWith(".")&&!r.startsWith("/")&&!r.startsWith("@/"))return null;if(r.startsWith("@/")){const l=r.replace("@/","");for(const[d]of t)if(d.includes(l))return d;return null}const a=s.substring(0,s.lastIndexOf("/")),i=r.startsWith("/")?r.substring(1):`${a}/${r}`.replace(/\/\.\//g,"/").replace(/\/[^/]+\/\.\.\//g,"/");if(t.has(i))return i;const o=[".ts",".tsx",".js",".jsx"];for(const l of o)if(t.has(i+l))return i+l;for(const l of o){const d=`${i}/index${l}`;if(t.has(d))return d}return null}function yt(r,s,t){const a={rootFile:r,files:[r],components:[],hooks:[],services:[],pages:[],allImportsResolved:!0,missingImports:[],requiredEndpoints:[],status:"unknown"},i=new Set([r.relPath]),o=[r.relPath];for(;o.length>0;){const p=o.shift(),j=t.get(p);if(j){a.requiredEndpoints.push(...j.endpoints);for(const M of j.imports)if(M.resolved){if(M.resolvedPath&&s.has(M.resolvedPath)){const u=M.resolvedPath;if(!i.has(u)){const y=s.get(u);a.files.push(y),i.add(u),o.push(u);const m=Fe(u);m==="component"?a.components.push(y):m==="hook"?a.hooks.push(y):m==="service"?a.services.push(y):m==="page"&&a.pages.push(y)}}}else{a.allImportsResolved=!1;const u=wa(M.importPath,p,s);if(u&&s.has(u)){if(!i.has(u)){const y=s.get(u);a.files.push(y),i.add(u),o.push(u);const m=Fe(u);m==="component"?a.components.push(y):m==="hook"?a.hooks.push(y):m==="service"?a.services.push(y):m==="page"&&a.pages.push(y)}}else a.missingImports.push(M)}}}const l=Fe(r.relPath);return l==="page"?a.pages.push(r):l==="component"?a.components.push(r):l==="hook"?a.hooks.push(r):l==="service"&&a.services.push(r),a.requiredEndpoints.filter(p=>!p.existsInServer).length>0?a.status="server_blocker":!a.allImportsResolved&&a.missingImports.length>0?a.status="missing_deps":a.allImportsResolved&&(a.status="ready"),a}function ka(r,s){const t=new Map,a=new Map,i=new Map;r.forEach(l=>{a.set(l.relPath,l)}),s.forEach(l=>{i.set(l.file.relPath,l)});const o=new Set;return r.forEach(l=>{if(o.has(l.relPath))return;const d=Fe(l.relPath);if(d==="page"||d==="other"&&!l.relPath.includes("/components/")&&!l.relPath.includes("/hooks/")&&!l.relPath.includes("/services/")){const p=yt(l,a,i);t.set(l.relPath,p),p.files.forEach(j=>o.add(j.relPath))}}),r.forEach(l=>{if(!o.has(l.relPath)){const d=yt(l,a,i);t.set(l.relPath,d)}}),t}const Sa=()=>{const[r,s]=c.useState(null),[t,a]=c.useState(!1),[i,o]=c.useState(null),[l,d]=c.useState(null),[p,j]=c.useState("idle"),[M,u]=c.useState(0),[y,m]=c.useState(""),[w,P]=c.useState(null),[b,I]=c.useState(null),$=c.useRef(null),[A,J]=c.useState({classifications:["green","orange","yellow","red"],searchQuery:"",fileType:"",modifiedDays:0,showDuplicates:!1,recoveryStatus:void 0,showMissingOnly:!1}),[E,X]=c.useState(!1),[T,S]=c.useState({key:"score",direction:"desc",label:"Usage Score (High to Low)"}),[G,te]=c.useState(new Set),re=c.useCallback((N=!1,k=!1,C,H)=>F(void 0,null,function*(){a(!0),o(null);try{const B=yield q.scan(N,k,void 0,C,H);s(B);const _=new Set;B.nodes&&B.nodes.filter(R=>R.type==="dir").slice(0,5).forEach(R=>_.add(R.path)),te(_)}catch(B){o(B instanceof Error?B.message:"Failed to load scan data"),console.error("Scan error:",B)}finally{a(!1)}}),[]),he=c.useCallback(()=>re(!0),[re]),oe=c.useMemo(()=>{if(!(r!=null&&r.nodes))return[];let N=r.nodes;if(N=N.filter(k=>A.classifications.includes(k.classification)),A.searchQuery.trim()){const k=A.searchQuery.toLowerCase();N=N.filter(C=>C.relPath.toLowerCase().includes(k)||C.reasons.some(H=>H.toLowerCase().includes(k)))}if(A.fileType&&(N=N.filter(k=>k.type==="file"&&k.relPath.toLowerCase().endsWith(A.fileType.toLowerCase()))),A.modifiedDays>0){const k=Date.now()-A.modifiedDays*24*60*60*1e3;N=N.filter(C=>C.mtimeMs>=k)}return A.showDuplicates&&(N=N.filter(k=>{var C,H;return((C=k.similarity)==null?void 0:C.duplicates.length)||((H=k.similarity)==null?void 0:H.nearMatches.length)})),A.recoveryStatus&&A.recoveryStatus.length>0&&(N=N.filter(k=>k.recoveryStatus&&A.recoveryStatus.includes(k.recoveryStatus))),A.showMissingOnly&&(N=N.filter(k=>k.recoveryStatus==="missing_in_prod")),N.sort((k,C)=>{let H=0;switch(T.key){case"score":H=k.usage.score-C.usage.score;break;case"name":H=k.relPath.localeCompare(C.relPath);break;case"mtime":H=k.mtimeMs-C.mtimeMs;break;case"classification":const B={red:0,orange:1,yellow:2,green:3};H=B[k.classification]-B[C.classification];break;case"recoveryStatus":const _={missing_in_prod:0,modified_since_backup:1,new_file:2,unchanged:3},R=k.recoveryStatus||"unchanged",ue=C.recoveryStatus||"unchanged";H=(_[R]||3)-(_[ue]||3);break;default:H=0}return T.direction==="desc"?-H:H}),N},[r==null?void 0:r.nodes,A,T]),xe=c.useMemo(()=>{if(!oe.length)return[];const N=new Map,k=[];return oe.forEach(C=>{const H=ce(Z({},C),{children:[],expanded:G.has(C.path),visible:!0,parentPath:void 0});N.set(C.path,H)}),oe.forEach(C=>{const H=N.get(C.path),B=C.path.split("/");let _="";for(let R=B.length-1;R>0;R--){_=B.slice(0,R).join("/");const ue=N.get(_+"/");if(ue){ue.children.push(H),H.parentPath=_;break}_=B.slice(0,R).join("/");const ge=N.get(_);if(ge&&ge.type==="dir"){ge.children.push(H),H.parentPath=_;break}}H.parentPath||k.push(H)}),k},[oe,G]),ke=c.useCallback(N=>{te(k=>{const C=new Set(k);return C.has(N)?C.delete(N):C.add(N),C})},[]),ne=c.useCallback(()=>{var k;const N=((k=r==null?void 0:r.nodes)==null?void 0:k.filter(C=>C.type==="dir").map(C=>C.path))||[];te(new Set(N))},[r==null?void 0:r.nodes]),ie=c.useCallback(()=>{te(new Set)},[]);c.useEffect(()=>{re(!1,E)},[re,E]),c.useEffect(()=>()=>{$.current&&clearInterval($.current)},[]);const pe=c.useCallback(()=>F(void 0,null,function*(){$.current&&(clearInterval($.current),$.current=null),j("starting"),u(0),m("Starting analysis..."),P(null),d(null),I(null);try{const k=(yield q.startPhase1Analysis()).jobId;if(!k)throw new Error("No jobId returned from server");I(k),j("running"),console.log(`[useRefactorScan] Phase 1 job started: ${k}`);let C=0;const H=600;$.current=setInterval(()=>F(void 0,null,function*(){var B;if(C++,C>H){$.current&&(clearInterval($.current),$.current=null),j("error"),P("Polling timeout: Analysis took too long"),I(null),console.error("[useRefactorScan] Polling timeout");return}try{const _=yield q.getPhase1JobStatus(k);if(!_||typeof _!="object"){console.warn("[useRefactorScan] Invalid status response, continuing...");return}if(u((B=_.progress)!=null?B:0),m(_.currentStep||"Processing..."),_.status==="done"){if(_.progress!==void 0&&_.progress<100){console.log(`[useRefactorScan] Status 'done' but progress ${_.progress}%, waiting...`);return}try{$.current&&(clearInterval($.current),$.current=null);const R=yield q.getPhase1JobResult(k);if(R&&typeof R=="object"&&R.summary)u(100),m("Complete"),j("done"),d(R),I(null),console.log(`[useRefactorScan] Phase 1 complete: ${R.summary.missingInTarget} restorable files`);else throw new Error("Invalid result structure")}catch(R){if(R instanceof Error&&R.message.includes("not ready")){console.log("[useRefactorScan] Result not ready, continuing...");return}$.current&&(clearInterval($.current),$.current=null),j("error"),P(R instanceof Error?R.message:"Failed to fetch result"),I(null),console.error("[useRefactorScan] Error fetching result:",R)}}else _.status==="error"&&($.current&&(clearInterval($.current),$.current=null),j("error"),P(_.error||"Unknown error"),I(null),console.error("[useRefactorScan] Job error:",_.error))}catch(_){console.error(`[useRefactorScan] Poll error (attempt ${C}):`,_)}}),2e3)}catch(N){j("error"),P(N instanceof Error?N.message:"Failed to start analysis"),I(null),console.error("[useRefactorScan] Failed to start Phase 1:",N)}}),[]),v=c.useMemo(()=>!l||!l.restorableFiles||!l.files?new Map:ka(l.restorableFiles,l.files),[l]),Se=c.useCallback(N=>v.get(N)||null,[v]);return{scanData:r,isLoading:t,error:i,filterState:A,setFilterState:J,sortOption:T,setSortOption:S,treeItems:xe,expandedPaths:G,setExpandedPaths:te,loadScanData:re,refreshScan:he,toggleExpanded:ke,expandAll:ne,collapseAll:ie,filteredCount:oe.length,visibleNodes:oe,compareWithBackup:E,setCompareWithBackup:X,phase1Report:l,phase1Status:p,phase1Progress:M,phase1CurrentStep:y,phase1Error:w,startPhase1Analysis:pe,bundles:v,calculateBundle:Se}},Ba=()=>{var us,gs,ys,fs,bs,js,vs,ws,ks,Ss,Ps,Ns,Cs,Ts,Is,Rs,Es,Ms,$s,Fs,As,zs,_s,Ls,Ws,Ds,Hs,Os,Bs,Us,Vs;const{activeMode:r}=c.useContext(rr),s=we();c.useEffect(()=>{},[r,s.palette.mode]);const{scanData:t,isLoading:a,error:i,filterState:o,setFilterState:l,sortOption:d,setSortOption:p,treeItems:j,expandedPaths:M,loadScanData:u,refreshScan:y,toggleExpanded:m,filteredCount:w,compareWithBackup:P,setCompareWithBackup:b,phase1Report:I,bundles:$}=Sa(),[A,J]=c.useState(null),[E,X]=c.useState("idle"),[T,S]=c.useState(I),[G,te]=c.useState(0),[re,he]=c.useState(""),[oe,xe]=c.useState(null),[ke,ne]=c.useState(null),[ie,pe]=c.useState("checking"),[v,Se]=c.useState(null),[N,k]=c.useState(null),[C,H]=c.useState(!1),[B,_]=c.useState(()=>q.getSavedPaths()),[R,ue]=c.useState({}),[ge,as]=c.useState(!1),[ae,ze]=c.useState("local"),[le,_e]=c.useState(null),[Re,os]=c.useState([]),[ns,ls]=c.useState(!1),[Le,is]=c.useState(null),[Mt,We]=c.useState(!1),[fe,De]=c.useState(null),[Pa,cs]=c.useState(!1),[$t,ds]=c.useState(!1),[He,Oe]=c.useState(null),[Ft,hs]=c.useState(!1),xs=c.useCallback(h=>F(void 0,null,function*(){as(!0);try{const x=yield q.validatePaths(h);return ue({sourcePath:x.validations.sourcePath,destinationPath:x.validations.destinationPath,backupPath:x.validations.backupPath}),x.ok}catch(x){return console.error("Path validation error:",x),W.error("Failed to validate paths"),!1}finally{as(!1)}}),[]),At=c.useCallback(()=>F(void 0,null,function*(){(yield xs(B))?(q.savePaths(B),W.success("Path configuration saved"),H(!1)):W.warning("Some paths are invalid. Please check the validation messages.")}),[B,xs]),zt=c.useCallback(()=>{_(Z({},Te)),ue({}),q.clearSavedPaths(),W.info("Paths reset to defaults")},[]);c.useEffect(()=>{I&&S(I)},[I]),c.useEffect(()=>{F(void 0,null,function*(){try{pe("checking"),Se(null);const x=yield q.healthCheck();x.ok||x.status==="ok"?pe("ok"):(pe("error"),Se(x.message||"Unknown error"))}catch(x){pe("error"),Se(x instanceof Error?x.message:"Connection failed"),console.error("Health check failed:",x),x instanceof Error&&x.message.includes("TypeError")&&(console.warn("[RefactorConsole] Health check failed with TypeError. Server may need rebuild."),W.error("API connection error detected. Server may need rebuild.",{autoClose:5e3}))}})},[]),c.useEffect(()=>{const h=q.getSavedPaths();h.sourceType&&ze(h.sourceType),h.snapshotId&&_e(h.snapshotId)},[]),c.useEffect(()=>{F(void 0,null,function*(){ls(!0),is(null);try{const x=yield q.fetchSnapshots(ae);os(x.snapshots),x.defaultSnapshot&&!le&&(_e(x.defaultSnapshot.id),W.info(`Auto-selected most recent snapshot: ${x.defaultSnapshot.label}`))}catch(x){console.error("Failed to load snapshots:",x),is(x instanceof Error?x.message:"Failed to load snapshots"),os([]),ae==="remote"&&x instanceof Error&&x.message.includes("mount")&&W.warning("Remote Samba share is not mounted. Please ensure /mnt/refactor-remote is accessible.")}finally{ls(!1)}})},[ae]);const _t=[{key:"score",direction:"desc",label:"Usage Score (High to Low)"},{key:"score",direction:"asc",label:"Usage Score (Low to High)"},{key:"name",direction:"asc",label:"File Name (A-Z)"},{key:"name",direction:"desc",label:"File Name (Z-A)"},{key:"mtime",direction:"desc",label:"Recently Modified"},{key:"mtime",direction:"asc",label:"Oldest Modified"},{key:"classification",direction:"asc",label:"Classification Priority"},...P?[{key:"recoveryStatus",direction:"asc",label:"Recovery Status (Missing First)"},{key:"recoveryStatus",direction:"desc",label:"Recovery Status (New First)"}]:[]],Lt=h=>{l(x=>ce(Z({},x),{searchQuery:h}))},ps=h=>{l(x=>Z(Z({},x),h))},Wt=h=>{p(h)},Be=()=>F(void 0,null,function*(){try{const h=ce(Z({},B),{sourceType:ae,snapshotId:le||void 0});q.savePaths(h),yield u(!0,P,ae,le||void 0),W.success("Scan data refreshed")}catch(h){W.error("Failed to refresh scan data")}}),Dt=()=>{b(!P),W.info(`Recovery Mode ${P?"disabled":"enabled"}`)},Ht=()=>F(void 0,null,function*(){try{yield y(),W.success("Codebase analysis completed")}catch(h){W.error("Failed to analyze codebase")}}),ms=()=>F(void 0,null,function*(){N&&(clearInterval(N),k(null)),X("starting"),te(0),he("Starting analysis..."),xe(null),S(null),ne(null);try{const x=(yield q.startPhase1Analysis()).jobId;if(!x)throw new Error("No jobId returned from server");ne(x),X("running"),W.info("Phase 1 analysis started in background");let L=0;const V=600,K=setInterval(()=>F(void 0,null,function*(){var Pe,qs,Js,Gs,Qs,Xs,Zs,Ys,Ks,et,st,tt,rt,at,ot,nt,lt,it,ct;if(L++,L>V){clearInterval(K),k(null),X("error"),xe("Polling timeout: Analysis took too long"),ne(null),W.error("Phase 1 analysis timed out"),console.error("[Phase1] Polling timeout after",V,"attempts");return}try{const Q=yield q.getPhase1JobStatus(x);if(!Q||typeof Q!="object"){console.warn("[Phase1] Invalid status response format, continuing to poll...");return}if(te((Pe=Q.progress)!=null?Pe:0),he(Q.currentStep||"Processing..."),Q.status==="done"){if(Q.progress!==void 0&&Q.progress<100){console.log(`[Phase1] Status is 'done' but progress is ${Q.progress}%, continuing to poll...`);return}try{clearInterval(K),k(null);const O=yield q.getPhase1JobResult(x);if(!O||typeof O!="object")throw new Error("Invalid result format: result is not an object");const Ue={generatedAt:O.generatedAt||new Date().toISOString(),sourcePath:O.sourcePath||"",targetPath:O.targetPath||"",summary:{totalFilesInSource:(Js=(qs=O.summary)==null?void 0:qs.totalFilesInSource)!=null?Js:0,missingInTarget:(Qs=(Gs=O.summary)==null?void 0:Gs.missingInTarget)!=null?Qs:0,modifiedInTarget:(Zs=(Xs=O.summary)==null?void 0:Xs.modifiedInTarget)!=null?Zs:0,identical:(Ks=(Ys=O.summary)==null?void 0:Ys.identical)!=null?Ks:0,existsOnlyInTarget:(st=(et=O.summary)==null?void 0:et.existsOnlyInTarget)!=null?st:0},restorableFiles:Array.isArray(O.restorableFiles)?O.restorableFiles:[],modifiedFiles:Array.isArray(O.modifiedFiles)?O.modifiedFiles:[],documentation:{endpointsFound:(rt=(tt=O.documentation)==null?void 0:tt.endpointsFound)!=null?rt:0,endpointsVerified:(ot=(at=O.documentation)==null?void 0:at.endpointsVerified)!=null?ot:0,endpointsMissing:(lt=(nt=O.documentation)==null?void 0:nt.endpointsMissing)!=null?lt:0},files:Array.isArray(O.files)?O.files:[],integrationPoints:{menuItems:((it=O.integrationPoints)==null?void 0:it.menuItems)||null,router:((ct=O.integrationPoints)==null?void 0:ct.router)||null}};if(!Ue.summary)throw new Error("Result validation failed: summary is missing");te(100),he("Complete"),X("done"),S(Ue),ne(null),W.success(`Phase 1 analysis complete: ${Ue.summary.missingInTarget} restorable files found`)}catch(O){if(O instanceof Error&&O.message.includes("not ready")){console.log("[Phase1] Result not ready yet, continuing to poll...");return}clearInterval(K),k(null),X("error"),xe(O instanceof Error?O.message:"Failed to fetch results"),ne(null),W.error(`Failed to fetch Phase 1 results: ${O instanceof Error?O.message:"Unknown error"}`),console.error("Phase 1 result fetch error:",O)}}else Q.status==="error"&&(clearInterval(K),k(null),X("error"),xe(Q.error||"Unknown error"),ne(null),W.error(`Phase 1 analysis failed: ${Q.error||"Unknown error"}`),console.error("Phase 1 error:",Q.error))}catch(Q){console.error(`[Phase1] Error polling status (attempt ${L}):`,Q),Q instanceof Error&&!Q.message.includes("not ready")&&!Q.message.includes("Failed to fetch")&&console.warn("[Phase1] Non-transient error during polling, will retry:",Q.message)}}),2e3);k(K)}catch(h){X("error"),xe(h instanceof Error?h.message:"Failed to start Phase 1 analysis"),ne(null),W.error(h instanceof Error?h.message:"Failed to start Phase 1 analysis"),console.error("Phase 1 start error:",h)}});c.useEffect(()=>()=>{N&&clearInterval(N)},[N]);const Ot=h=>{var x;if(E!=="done"||!T||!T.summary){W.warning("Phase 1 analysis must be completed before viewing requirements");return}J({type:"requirementPreview",data:{fileAnalysis:h,integrationPoints:(x=T.integrationPoints)!=null?x:{menuItems:null,router:null}}})},Bt=(h,x)=>F(void 0,null,function*(){var L,V,K,Pe;switch(h){case"copy":navigator.clipboard.writeText(x.relPath),W.success("Path copied to clipboard");break;case"open":W.info(`Would open ${x.relPath} in editor`);break;case"restore":x.recoveryStatus==="missing_in_prod"&&x.backupPath&&Vt(x.relPath);break;case"reasons":J({type:"reasons",data:{node:x,reasons:x.reasons,classification:x.classification,usage:x.usage}});break;case"duplicates":((L=x.similarity)!=null&&L.duplicates.length||(V=x.similarity)!=null&&V.nearMatches.length)&&J({type:"replicates",data:{node:x,duplicates:((K=x.similarity)==null?void 0:K.duplicates)||[],nearMatches:((Pe=x.similarity)==null?void 0:Pe.nearMatches)||[]}});break;default:console.log("Unknown action:",h)}}),Ut=h=>{m(h)},Vt=h=>F(void 0,null,function*(){cs(!0),Oe(h);try{const x=yield q.previewRestore(h,void 0,ae,le||void 0);De(x),We(!0)}catch(x){console.error("Preview failed:",x),W.error(`Failed to preview file: ${x instanceof Error?x.message:"Unknown error"}`)}finally{cs(!1)}}),qt=()=>F(void 0,null,function*(){if(He){ds(!0);try{yield q.restore(He,void 0,ae,le||void 0),W.success(`File restored: ${He}`),We(!1),De(null),Oe(null),yield u(!0,P,ae,le||void 0)}catch(h){console.error("Restore failed:",h),W.error(`Failed to restore file: ${h instanceof Error?h.message:"Unknown error"}`)}finally{ds(!1)}}}),Jt=()=>{We(!1),De(null),Oe(null)},Gt=({onClose:h})=>{if(!A||A.type==="requirementPreview")return null;const{type:x,data:L}=A;return e.jsx(n,{sx:{position:"fixed",inset:0,bgcolor:"rgba(0, 0, 0, 0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1300},children:e.jsxs(se,{elevation:8,sx:{bgcolor:"background.paper",borderRadius:1,maxWidth:"42rem",width:"100%",mx:2,maxHeight:"80vh",overflow:"auto"},children:[e.jsxs(n,{sx:{p:3},children:[e.jsxs(n,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:2},children:[e.jsx("h2",{style:{fontSize:"1.25rem",fontWeight:600,color:s.palette.text.primary},children:x==="reasons"?"Classification Details":"Duplicate Analysis"}),e.jsx("button",{onClick:h,style:{background:"none",border:"none",color:s.palette.text.secondary,cursor:"pointer",fontSize:"1.5rem",lineHeight:1,padding:0,width:24,height:24},onMouseEnter:V=>{V.currentTarget.style.color=s.palette.text.primary},onMouseLeave:V=>{V.currentTarget.style.color=s.palette.text.secondary},children:"Ã—"})]}),x==="reasons"&&e.jsxs(n,{sx:{display:"flex",flexDirection:"column",gap:2},children:[e.jsxs("div",{children:[e.jsx("h3",{style:{fontWeight:500,color:s.palette.text.primary,marginBottom:"0.5rem"},children:"File Information"}),e.jsxs(n,{sx:{bgcolor:s.palette.mode==="dark"?"rgba(255,255,255,0.05)":s.palette.grey[50],p:1.5,borderRadius:1},children:[e.jsx("p",{style:{fontSize:"0.875rem",fontFamily:"monospace",color:s.palette.text.primary},children:L.node.relPath}),e.jsxs("p",{style:{fontSize:"0.875rem",color:s.palette.text.secondary,marginTop:"0.25rem"},children:["Classification: ",e.jsx("span",{style:{fontWeight:500},children:L.classification})]})]})]}),e.jsxs("div",{children:[e.jsx("h3",{style:{fontWeight:500,color:s.palette.text.primary,marginBottom:"0.5rem"},children:"Usage Statistics"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs(n,{sx:{bgcolor:z(s.palette.info.main,.1),p:1.5,borderRadius:1},children:[e.jsx("p",{style:{fontSize:"0.875rem",color:s.palette.info.main},children:"Import References"}),e.jsx("p",{style:{fontSize:"1.125rem",fontWeight:600,color:s.palette.info.main},children:L.usage.importRefs})]}),e.jsxs(n,{sx:{bgcolor:z(s.palette.success.main,.1),p:1.5,borderRadius:1},children:[e.jsx("p",{style:{fontSize:"0.875rem",color:s.palette.success.main},children:"Server References"}),e.jsx("p",{style:{fontSize:"1.125rem",fontWeight:600,color:s.palette.success.main},children:L.usage.serverRefs})]}),e.jsxs(n,{sx:{bgcolor:z(s.palette.secondary.main,.1),p:1.5,borderRadius:1},children:[e.jsx("p",{style:{fontSize:"0.875rem",color:s.palette.secondary.main},children:"Route References"}),e.jsx("p",{style:{fontSize:"1.125rem",fontWeight:600,color:s.palette.secondary.main},children:L.usage.routeRefs})]}),e.jsxs(n,{sx:{bgcolor:z(s.palette.warning.main,.1),p:1.5,borderRadius:1},children:[e.jsx("p",{style:{fontSize:"0.875rem",color:s.palette.warning.main},children:"Usage Score"}),e.jsx("p",{style:{fontSize:"1.125rem",fontWeight:600,color:s.palette.warning.main},children:L.usage.score})]})]})]}),e.jsxs("div",{children:[e.jsx("h3",{style:{fontWeight:500,color:s.palette.text.primary,marginBottom:"0.5rem"},children:"Classification Reasons"}),e.jsx("ul",{className:"space-y-1",children:L.reasons.map((V,K)=>e.jsxs("li",{className:"flex items-start gap-2 text-sm",style:{color:s.palette.text.primary},children:[e.jsx("span",{style:{color:s.palette.info.main,marginTop:"0.125rem"},children:"â€¢"}),e.jsx("span",{children:V})]},K))})]})]}),x==="duplicates"&&e.jsxs(n,{sx:{display:"flex",flexDirection:"column",gap:2},children:[e.jsxs("div",{children:[e.jsx("h3",{style:{fontWeight:500,color:s.palette.text.primary,marginBottom:"0.5rem"},children:"Duplicate Analysis"}),e.jsx(n,{sx:{bgcolor:s.palette.mode==="dark"?"rgba(255,255,255,0.05)":s.palette.grey[50],p:1.5,borderRadius:1},children:e.jsx("p",{style:{fontSize:"0.875rem",fontFamily:"monospace",color:s.palette.text.primary},children:L.node.relPath})})]}),L.duplicates.length>0&&e.jsxs("div",{children:[e.jsx("h3",{style:{fontWeight:500,color:s.palette.text.primary,marginBottom:"0.5rem"},children:"Exact Duplicates"}),e.jsx("ul",{className:"space-y-1",children:L.duplicates.map((V,K)=>e.jsxs("li",{className:"flex items-start gap-2 text-sm",style:{color:s.palette.text.primary},children:[e.jsx("span",{style:{color:s.palette.error.main,marginTop:"0.125rem"},children:"â€¢"}),e.jsx("span",{className:"font-mono",children:V})]},K))})]}),L.nearMatches.length>0&&e.jsxs("div",{children:[e.jsx("h3",{style:{fontWeight:500,color:s.palette.text.primary,marginBottom:"0.5rem"},children:"Near Matches"}),e.jsx("ul",{className:"space-y-2",children:L.nearMatches.map((V,K)=>e.jsx("li",{children:e.jsxs(n,{sx:{bgcolor:s.palette.mode==="dark"?s.palette.warning.dark+"20":s.palette.warning.light,p:1.5,borderRadius:1,display:"flex",justifyContent:"space-between",alignItems:"flex-start"},children:[e.jsx("span",{className:"font-mono text-sm",style:{color:s.palette.text.primary},children:V.target}),e.jsxs(n,{sx:{fontSize:"0.75rem",bgcolor:s.palette.mode==="dark"?s.palette.warning.dark+"40":s.palette.warning.main,color:s.palette.mode==="dark"?s.palette.warning.light:s.palette.warning.contrastText,px:1,py:.5,borderRadius:.5},children:[Math.round(V.similarity*100),"% similar"]})]})},K))})]})]})]}),e.jsx(n,{sx:{px:3,py:2,borderTop:1,borderColor:"divider",bgcolor:"action.hover"},children:e.jsx(U,{variant:"outlined",onClick:h,sx:{textTransform:"none"},children:"Close"})})]})})};return e.jsxs(n,{sx:{minHeight:"100vh",bgcolor:"background.default",color:"text.primary"},className:"min-h-screen",children:[e.jsx(n,{sx:{bgcolor:"background.paper",borderBottom:1,borderColor:"divider"},className:"border-b",children:e.jsx(n,{sx:{px:3,py:2},children:e.jsxs(n,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[e.jsxs(n,{children:[e.jsxs(n,{sx:{display:"flex",alignItems:"center",gap:1.5},children:[e.jsx("h1",{className:"text-2xl font-bold",style:{color:s.palette.text.primary},children:"Refactor Console"}),!1,e.jsxs(n,{sx:{display:"flex",alignItems:"center",gap:1},children:[ie==="checking"&&e.jsx(n,{sx:{width:12,height:12,borderRadius:"50%",bgcolor:"warning.main",animation:"pulse 2s infinite"},title:"Checking connection..."}),ie==="ok"&&e.jsx(n,{sx:{width:12,height:12,borderRadius:"50%",bgcolor:"success.main"},title:"API connection healthy"}),ie==="error"&&e.jsx(n,{sx:{width:12,height:12,borderRadius:"50%",bgcolor:"error.main",cursor:"help"},title:v||"API connection failed"})]})]}),e.jsxs(n,{sx:{display:"flex",alignItems:"center",gap:1,mt:.5,flexWrap:"wrap"},children:[e.jsx("p",{style:{color:s.palette.text.secondary,margin:0},children:"Analyze your codebase for duplicates, usage patterns, and refactoring opportunities"}),e.jsx(Ce,{title:"Configure source and destination paths",children:e.jsx(Ye,{size:"small",onClick:()=>H(!C),sx:{color:C?s.palette.primary.main:s.palette.text.secondary,bgcolor:C?z(s.palette.primary.main,.1):"transparent"},children:e.jsx(cr,{className:"w-4 h-4"})})}),e.jsxs(n,{sx:{display:"flex",gap:.5,ml:1},children:[e.jsx(Y,{label:ae==="local"?"Local":"Remote",size:"small",color:ae==="remote"?"secondary":"default",sx:{height:20,fontSize:"0.7rem"}}),le&&e.jsx(Y,{label:`ðŸ“… ${le}`,size:"small",color:"primary",sx:{height:20,fontSize:"0.7rem"}})]})]}),ie==="error"&&v&&e.jsxs("p",{style:{fontSize:"0.75rem",marginTop:"0.25rem",color:s.palette.error.main},children:["âš ï¸ ",v]})]}),e.jsxs(n,{sx:{display:"flex",alignItems:"center",gap:2},children:[t&&e.jsxs(n,{sx:{textAlign:"right"},children:[e.jsx("div",{style:{fontSize:"0.875rem",color:s.palette.text.secondary},children:"Last scan"}),e.jsx("div",{style:{fontSize:"0.875rem",fontWeight:500,color:s.palette.text.primary},children:new Date(t.generatedAt).toLocaleString()})]}),e.jsxs(n,{sx:{display:"flex",gap:1},children:[e.jsx(U,{variant:"outlined",onClick:()=>hs(!0),startIcon:e.jsx(es,{className:"w-4 h-4"}),sx:{textTransform:"none"},title:"View restore history",children:"History"}),e.jsxs(n,{sx:{display:"flex",flexDirection:"column",alignItems:"flex-end",gap:.5},children:[e.jsx(U,{variant:"contained",color:"primary",onClick:ms,disabled:E==="running"||E==="starting"||ie!=="ok",startIcon:e.jsx(wt,{className:`w-4 h-4 ${E==="running"||E==="starting"?"animate-spin":""}`}),sx:{textTransform:"none"},title:ie!=="ok"?"Please wait for API health check to complete":E==="running"||E==="starting"?"Phase 1 analysis in progress":"Phase 1: Discovery & Gap Analysis",children:"Phase 1 Analysis"}),(E==="running"||E==="starting")&&e.jsxs(n,{sx:{fontSize:"0.75rem",color:"text.secondary",width:"100%"},children:[e.jsxs("div",{className:"flex items-center justify-between mb-1",children:[e.jsx("span",{children:re||"Processing..."}),e.jsxs("span",{children:[G,"%"]})]}),e.jsx(n,{sx:{width:"100%",bgcolor:"action.hover",borderRadius:"9999px",height:6},children:e.jsx(n,{sx:{bgcolor:s.palette.secondary.main,height:6,borderRadius:"9999px",transition:"width 0.3s"},style:{width:`${G}%`}})})]}),E==="error"&&oe&&e.jsxs(n,{sx:{fontSize:"0.75rem",color:"error.main",width:"100%"},children:["Error: ",oe]})]})]}),e.jsx(U,{variant:"contained",color:"primary",onClick:Be,disabled:a,startIcon:e.jsx(Ie,{className:`w-4 h-4 ${a?"animate-spin":""}`}),sx:{textTransform:"none",fontWeight:500,px:2,py:1},children:"Refresh"})]})]})})}),e.jsx(ar,{in:C,children:e.jsxs(se,{elevation:0,sx:{mx:3,mt:2,p:2,bgcolor:z(s.palette.primary.main,.05),border:1,borderColor:z(s.palette.primary.main,.2),borderRadius:1},children:[e.jsxs(n,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between",mb:2},children:[e.jsxs(n,{sx:{display:"flex",alignItems:"center",gap:1},children:[e.jsx(Or,{className:"w-5 h-5",style:{color:s.palette.primary.main}}),e.jsx("h3",{style:{fontWeight:600,color:s.palette.text.primary,margin:0},children:"Path Configuration"}),e.jsx(Y,{label:"Persisted in localStorage",size:"small",sx:{fontSize:"0.7rem",height:20}})]}),e.jsxs(n,{sx:{display:"flex",gap:1},children:[e.jsx(U,{variant:"outlined",size:"small",onClick:zt,sx:{textTransform:"none"},children:"Reset to Defaults"}),e.jsx(U,{variant:"contained",size:"small",onClick:At,disabled:ge,startIcon:ge?e.jsx(ts,{size:14}):e.jsx(Me,{className:"w-4 h-4"}),sx:{textTransform:"none"},children:ge?"Validating...":"Save & Validate"})]})]}),e.jsxs(n,{sx:{display:"grid",gridTemplateColumns:{xs:"1fr",md:"repeat(2, 1fr)"},gap:2,mb:2},children:[e.jsxs(n,{children:[e.jsx("label",{style:{display:"block",fontSize:"0.875rem",fontWeight:500,color:s.palette.text.primary,marginBottom:"0.5rem"},children:"Source Type"}),e.jsxs(n,{sx:{display:"flex",gap:1},children:[e.jsx(U,{variant:ae==="local"?"contained":"outlined",size:"small",onClick:()=>ze("local"),sx:{flex:1,textTransform:"none"},children:"Local File System"}),e.jsx(U,{variant:ae==="remote"?"contained":"outlined",size:"small",onClick:()=>ze("remote"),sx:{flex:1,textTransform:"none"},color:"secondary",children:"Remote Samba"})]}),e.jsx(n,{sx:{fontSize:"0.75rem",color:"text.secondary",mt:.5},children:ae==="local"?"Using local production files":"Using remote Samba mount (192.168.1.221)"})]}),e.jsxs(n,{children:[e.jsx("label",{style:{display:"block",fontSize:"0.875rem",fontWeight:500,color:s.palette.text.primary,marginBottom:"0.5rem"},children:"Snapshot (MM-YYYY)"}),e.jsxs(Ne,{select:!0,fullWidth:!0,size:"small",value:le||"",onChange:h=>_e(h.target.value||null),disabled:ns||Re.length===0,helperText:ns?"Loading snapshots...":Le?`Error: ${Le}`:Re.length===0?"No snapshots available":le?`Selected: ${((us=Re.find(h=>h.id===le))==null?void 0:us.label)||le}`:"Select a snapshot to scan",error:!!Le,SelectProps:{displayEmpty:!0},children:[e.jsx("option",{value:"",children:"Current / Latest"}),Re.map(h=>e.jsxs("option",{value:h.id,children:[h.label," (",h.id,")"]},h.id))]})]})]}),e.jsxs(n,{sx:{display:"grid",gridTemplateColumns:{xs:"1fr",md:"repeat(3, 1fr)"},gap:2},children:[e.jsx(n,{children:e.jsx(Ne,{fullWidth:!0,size:"small",label:"Source Directory",placeholder:"/var/www/orthodoxmetrics/prod/refactor-src/",value:B.sourcePath,onChange:h=>_(x=>ce(Z({},x),{sourcePath:h.target.value})),helperText:((gs=R.sourcePath)==null?void 0:gs.error)||((ys=R.sourcePath)!=null&&ys.isValid?R.sourcePath.exists?"âœ“ Valid & exists":"âš  Valid but does not exist":"Directory containing files to restore from"),error:((fs=R.sourcePath)==null?void 0:fs.isValid)===!1,InputProps:{sx:{fontFamily:"monospace",fontSize:"0.85rem"},endAdornment:((bs=R.sourcePath)==null?void 0:bs.isValid)&&e.jsx(Me,{className:"w-4 h-4",style:{color:s.palette.success.main}})}})}),e.jsx(n,{children:e.jsx(Ne,{fullWidth:!0,size:"small",label:"Destination Directory",placeholder:"/var/www/orthodoxmetrics/prod/front-end/src/",value:B.destinationPath,onChange:h=>_(x=>ce(Z({},x),{destinationPath:h.target.value})),helperText:((js=R.destinationPath)==null?void 0:js.error)||((vs=R.destinationPath)!=null&&vs.isValid?R.destinationPath.exists?"âœ“ Valid & exists":"âš  Valid but does not exist":"Directory where files will be restored to"),error:((ws=R.destinationPath)==null?void 0:ws.isValid)===!1,InputProps:{sx:{fontFamily:"monospace",fontSize:"0.85rem"},endAdornment:((ks=R.destinationPath)==null?void 0:ks.isValid)&&e.jsx(Me,{className:"w-4 h-4",style:{color:s.palette.success.main}})}})}),e.jsx(n,{children:e.jsx(Ne,{fullWidth:!0,size:"small",label:"Backup Directory (for Gap Analysis)",placeholder:"/var/www/orthodoxmetrics/backup",value:B.backupPath||"",onChange:h=>_(x=>ce(Z({},x),{backupPath:h.target.value})),helperText:((Ss=R.backupPath)==null?void 0:Ss.error)||((Ps=R.backupPath)!=null&&Ps.isValid?R.backupPath.exists?"âœ“ Valid & exists":"âš  Valid but does not exist":"September 2025 backup location for recovery"),error:((Ns=R.backupPath)==null?void 0:Ns.isValid)===!1,InputProps:{sx:{fontFamily:"monospace",fontSize:"0.85rem"},endAdornment:((Cs=R.backupPath)==null?void 0:Cs.isValid)&&e.jsx(Me,{className:"w-4 h-4",style:{color:s.palette.success.main}})}})})]}),e.jsx(n,{sx:{mt:2,p:1.5,bgcolor:"background.paper",borderRadius:1,border:1,borderColor:"divider"},children:e.jsxs("p",{style:{fontSize:"0.75rem",color:s.palette.text.secondary,margin:0},children:[e.jsx("strong",{children:"Security:"})," All paths must be within ",e.jsx("code",{style:{backgroundColor:z(s.palette.primary.main,.1),padding:"0 4px",borderRadius:2},children:"/var/www/orthodoxmetrics/"}),". Path traversal and shell injection are blocked."]})})]})}),e.jsxs(n,{sx:{px:3,py:3},children:[i&&e.jsxs(n,{sx:{mb:3,bgcolor:z(s.palette.error.main,.1),border:1,borderColor:s.palette.error.main,borderRadius:1,p:2},children:[e.jsxs(n,{sx:{display:"flex",alignItems:"center",gap:1},children:[e.jsx(je,{style:{width:20,height:20,color:s.palette.error.main}}),e.jsx("h3",{style:{fontWeight:500,color:s.palette.error.main},children:"Error Loading Data"})]}),e.jsx("p",{style:{color:s.palette.error.main,marginTop:"0.25rem"},children:i}),e.jsx(U,{variant:"contained",color:"error",onClick:Be,sx:{mt:1.5,textTransform:"none"},children:"Try Again"})]}),a&&!t&&e.jsx(n,{sx:{display:"flex",alignItems:"center",justifyContent:"center",minHeight:400},children:e.jsxs(n,{sx:{textAlign:"center"},children:[e.jsx(Ie,{className:"w-8 h-8 animate-spin mx-auto mb-4",style:{color:s.palette.primary.main}}),e.jsx("h3",{style:{fontWeight:500,color:s.palette.text.primary,marginBottom:"0.5rem"},children:"Analyzing Codebase"}),e.jsx("p",{style:{color:s.palette.text.secondary},children:"This may take a few moments..."})]})}),t&&e.jsxs(n,{sx:{display:"flex",flexDirection:"column",gap:3},children:[e.jsx(ma,{searchQuery:o.searchQuery,onSearchChange:Lt,sortOptions:_t,currentSort:d,onSortChange:Wt,filterState:o,onFilterChange:ps,isLoading:a,onRefresh:Be,onAnalyze:Ht,filteredCount:w,totalCount:t.summary.totalFiles+t.summary.totalDirs,compareWithBackup:P,onToggleRecoveryMode:Dt}),e.jsx(se,{elevation:0,sx:{bgcolor:"background.paper",border:1,borderColor:"divider",p:2},className:"rounded-lg",children:E==="done"&&T&&T.summary&&G===100?e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-5 gap-4",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{style:{fontSize:"1.5rem",fontWeight:700,color:s.palette.mode==="dark"?s.palette.secondary.light:s.palette.secondary.main},children:(Is=(Ts=T.summary)==null?void 0:Ts.missingInTarget)!=null?Is:0}),e.jsx("div",{className:"text-sm",style:{color:s.palette.text.secondary},children:"Restorable Files"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{style:{fontSize:"1.5rem",fontWeight:700,color:s.palette.mode==="dark"?s.palette.warning.light:s.palette.warning.main},children:(Es=(Rs=T.summary)==null?void 0:Rs.modifiedInTarget)!=null?Es:0}),e.jsx("div",{className:"text-sm",style:{color:s.palette.text.secondary},children:"Modified (Protected)"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{style:{fontSize:"1.5rem",fontWeight:700,color:s.palette.mode==="dark"?s.palette.success.light:s.palette.success.main},children:($s=(Ms=T.summary)==null?void 0:Ms.identical)!=null?$s:0}),e.jsx("div",{className:"text-sm",style:{color:s.palette.text.secondary},children:"Identical"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{style:{fontSize:"1.5rem",fontWeight:700,color:s.palette.mode==="dark"?s.palette.info.light:s.palette.info.main},children:(As=(Fs=T.documentation)==null?void 0:Fs.endpointsVerified)!=null?As:0}),e.jsx("div",{className:"text-sm",style:{color:s.palette.text.secondary},children:"Endpoints Verified"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{style:{fontSize:"1.5rem",fontWeight:700,color:s.palette.mode==="dark"?s.palette.error.light:s.palette.error.main},children:(_s=(zs=T.documentation)==null?void 0:zs.endpointsMissing)!=null?_s:0}),e.jsx("div",{className:"text-sm",style:{color:s.palette.text.secondary},children:"Endpoints Missing"})]})]}),((Ws=(Ls=T.documentation)==null?void 0:Ls.endpointsFound)!=null?Ws:0)>0&&e.jsxs("div",{className:"text-center text-sm",style:{color:s.palette.text.secondary},children:["Found ",(Hs=(Ds=T.documentation)==null?void 0:Ds.endpointsFound)!=null?Hs:0," endpoints in documentation"]})]}):E==="running"||E==="starting"?e.jsx(n,{sx:{textAlign:"center",py:4},children:e.jsxs("div",{className:"flex flex-col items-center gap-4",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2",style:{borderColor:s.palette.secondary.main}}),e.jsx("div",{className:"text-lg font-medium",style:{color:s.palette.text.primary},children:re||"Processing..."}),e.jsxs("div",{className:"w-full max-w-md",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:"text-sm",style:{color:s.palette.text.secondary},children:"Progress"}),e.jsxs("span",{className:"text-sm font-medium",style:{color:s.palette.text.primary},children:[G,"%"]})]}),e.jsx(n,{sx:{width:"100%",bgcolor:"action.hover",borderRadius:"9999px",height:8},children:e.jsx(n,{sx:{bgcolor:s.palette.secondary.main,height:8,borderRadius:"9999px",transition:"width 0.3s"},style:{width:`${G}%`}})})]})]})}):t!=null&&t.gapAnalysisEnabled?e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-5 gap-4",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{style:{fontSize:"1.5rem",fontWeight:700,color:s.palette.mode==="dark"?s.palette.secondary.light:s.palette.secondary.main},children:t.summary.missingInProd||0}),e.jsx("div",{className:"text-sm",style:{color:s.palette.text.secondary},children:"Missing in Prod"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{style:{fontSize:"1.5rem",fontWeight:700,color:s.palette.mode==="dark"?s.palette.warning.light:s.palette.warning.main},children:t.summary.modifiedSinceBackup||0}),e.jsx("div",{className:"text-sm",style:{color:s.palette.text.secondary},children:"Modified"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{style:{fontSize:"1.5rem",fontWeight:700,color:s.palette.mode==="dark"?s.palette.success.light:s.palette.success.main},children:t.summary.newFiles||0}),e.jsx("div",{className:"text-sm",style:{color:s.palette.text.secondary},children:"New Files"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{style:{fontSize:"1.5rem",fontWeight:700,color:s.palette.mode==="dark"?s.palette.success.light:s.palette.success.main},children:t.summary.likelyInProd}),e.jsx("div",{className:"text-sm",style:{color:s.palette.text.secondary},children:"Production Ready"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{style:{fontSize:"1.5rem",fontWeight:700,color:s.palette.mode==="dark"?s.palette.error.light:s.palette.error.main},children:t.summary.legacyOrDupes}),e.jsx("div",{className:"text-sm",style:{color:s.palette.text.secondary},children:"Legacy/Duplicates"})]})]}):e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{style:{fontSize:"1.5rem",fontWeight:700,color:s.palette.mode==="dark"?s.palette.success.light:s.palette.success.main},children:t.summary.likelyInProd}),e.jsx("div",{className:"text-sm",style:{color:s.palette.text.secondary},children:"Production Ready"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{style:{fontSize:"1.5rem",fontWeight:700,color:s.palette.mode==="dark"?s.palette.warning.light:s.palette.warning.main},children:t.summary.highRisk}),e.jsx("div",{className:"text-sm",style:{color:s.palette.text.secondary},children:"High Risk"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{style:{fontSize:"1.5rem",fontWeight:700,color:s.palette.mode==="dark"?s.palette.warning.light:s.palette.warning.main},children:t.summary.inDevelopment}),e.jsx("div",{className:"text-sm",style:{color:s.palette.text.secondary},children:"In Development"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{style:{fontSize:"1.5rem",fontWeight:700,color:s.palette.mode==="dark"?s.palette.error.light:s.palette.error.main},children:t.summary.legacyOrDupes}),e.jsx("div",{className:"text-sm",style:{color:s.palette.text.secondary},children:"Legacy/Duplicates"})]})]})}),E==="done"&&G===100&&T&&T.summary&&Array.isArray(T.restorableFiles)&&T.restorableFiles.length>0&&e.jsxs(se,{elevation:0,sx:{bgcolor:"background.paper",border:1,borderColor:"divider",p:2},className:"rounded-lg",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("h3",{className:"text-lg font-semibold flex items-center gap-2",style:{color:s.palette.text.primary},children:[e.jsx($e,{className:"w-5 h-5",style:{color:s.palette.secondary.main}}),"Restorable Bundles (",$.size>0?$.size:(Bs=(Os=T.restorableFiles)==null?void 0:Os.length)!=null?Bs:0," ",$.size>0?"bundles":"files",")"]}),e.jsx(U,{variant:"contained",color:"secondary",onClick:()=>{if(E!=="done"||!T||!T.summary){W.warning("Phase 1 analysis must be completed before exporting");return}try{const h=JSON.stringify(T,null,2),x=new Blob([h],{type:"application/json"}),L=URL.createObjectURL(x),V=document.createElement("a");V.href=L,V.download=`phase1-report-${new Date().toISOString().split("T")[0]}.json`,V.click(),URL.revokeObjectURL(L),W.success("Report exported successfully")}catch(h){console.error("Export error:",h),W.error("Failed to export report")}},sx:{textTransform:"none"},children:"Export JSON Report"})]}),$.size>0?e.jsx("div",{className:"space-y-3 max-h-96 overflow-y-auto",children:Array.from($.values()).map((h,x)=>e.jsxs(n,{sx:{p:2,bgcolor:s.palette.mode==="dark"?s.palette.secondary.dark+"20":s.palette.secondary.light,border:1,borderColor:s.palette.mode==="dark"?s.palette.secondary.dark:s.palette.secondary.main,borderRadius:1},children:[e.jsxs("div",{className:"flex items-start justify-between mb-3",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"font-mono text-sm font-semibold mb-1",style:{color:s.palette.text.primary},children:h.rootFile.relPath}),e.jsxs("div",{className:"text-xs space-y-1",style:{color:s.palette.text.secondary},children:[e.jsxs("div",{children:[h.files.length," files â€¢ ",h.components.length," components â€¢ ",h.hooks.length," hooks â€¢ ",h.services.length," services"]}),h.requiredEndpoints.length>0&&e.jsxs("div",{children:[h.requiredEndpoints.filter(L=>L.existsInServer).length," / ",h.requiredEndpoints.length," endpoints verified"]})]})]}),e.jsx("button",{onClick:()=>{var L,V;return Ot({file:h.rootFile,imports:h.missingImports,endpoints:h.requiredEndpoints,integrationPoints:(L=T.integrationPoints)!=null&&L.menuItems||(V=T.integrationPoints)!=null&&V.router?[T.integrationPoints.menuItems,T.integrationPoints.router].filter(Boolean):[]})},style:{padding:"0.5rem",color:s.palette.secondary.main,background:"none",border:"none",cursor:"pointer",borderRadius:"0.25rem"},onMouseEnter:L=>{L.currentTarget.style.backgroundColor=s.palette.mode==="dark"?s.palette.secondary.dark+"30":s.palette.secondary.light},onMouseLeave:L=>{L.currentTarget.style.backgroundColor="transparent"},title:"View requirements",children:e.jsx(Pt,{className:"w-4 h-4"})})]}),e.jsx(ba,{bundle:h,onRestoreComplete:()=>{ms(),y()}})]},x))}):e.jsxs(n,{sx:{textAlign:"center",py:4,color:"text.secondary"},children:[e.jsx("p",{children:"No bundles calculated yet. Bundles are created for page files."}),e.jsxs("p",{style:{fontSize:"0.875rem",marginTop:"0.5rem"},children:["Individual files: ",(Vs=(Us=T.restorableFiles)==null?void 0:Us.length)!=null?Vs:0]})]})]}),e.jsxs(n,{sx:{display:"grid",gridTemplateColumns:{xs:"1fr",lg:"repeat(4, 1fr)"},gap:3},children:[e.jsx(n,{sx:{gridColumn:{lg:"span 1"}},children:e.jsx(pa,{scanData:t,filterState:o,onFilterChange:ps})}),e.jsx(n,{sx:{gridColumn:{lg:"span 3"}},children:e.jsx(It,{treeItems:j,expandedPaths:M,onToggleExpanded:Ut,onNodeAction:Bt,isDark:r==="dark"})})]})]})]}),e.jsx(Gt,{onClose:()=>J(null)}),(A==null?void 0:A.type)==="requirementPreview"&&e.jsx(ua,{fileAnalysis:A.data.fileAnalysis,integrationPoints:A.data.integrationPoints,onClose:()=>J(null)}),e.jsx(ja,{open:Mt,onClose:Jt,onConfirmRestore:qt,preview:(fe==null?void 0:fe.preview)||null,dependencies:(fe==null?void 0:fe.dependencies)||null,isRestoring:$t}),e.jsx(va,{open:Ft,onClose:()=>hs(!1)})]})};export{Ba as default};
//# sourceMappingURL=RefactorConsole-BowBXWvi.js.map
