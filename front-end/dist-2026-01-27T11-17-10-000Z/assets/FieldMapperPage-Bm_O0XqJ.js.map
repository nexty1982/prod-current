{"version":3,"file":"FieldMapperPage-Bm_O0XqJ.js","sources":["../../node_modules/@mui/icons-material/esm/ArrowDownward.js","../../node_modules/@mui/icons-material/esm/ArrowUpward.js","../../node_modules/@mui/icons-material/esm/GridView.js","../../node_modules/@mui/icons-material/esm/Sort.js","../../node_modules/@mui/icons-material/esm/ViewList.js","../../node_modules/@mui/icons-material/esm/VisibilityOff.js","../../src/shared/lib/fetchWithChurchContext.ts","../../src/store/enhancedTableStore.ts","../../src/features/church/RecordHeaderBanner.tsx","../../src/features/church/RecordHeaderPreview.tsx","../../src/features/church/FieldMapperPage.tsx"],"sourcesContent":["\"use client\";\n\nimport createSvgIcon from './utils/createSvgIcon';\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nexport default createSvgIcon( /*#__PURE__*/_jsx(\"path\", {\n  d: \"m20 12-1.41-1.41L13 16.17V4h-2v12.17l-5.58-5.59L4 12l8 8z\"\n}), 'ArrowDownward');","\"use client\";\n\nimport createSvgIcon from './utils/createSvgIcon';\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nexport default createSvgIcon( /*#__PURE__*/_jsx(\"path\", {\n  d: \"m4 12 1.41 1.41L11 7.83V20h2V7.83l5.58 5.59L20 12l-8-8z\"\n}), 'ArrowUpward');","\"use client\";\n\nimport createSvgIcon from './utils/createSvgIcon';\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nexport default createSvgIcon( /*#__PURE__*/_jsx(\"path\", {\n  fillRule: \"evenodd\",\n  d: \"M3 3v8h8V3zm6 6H5V5h4zm-6 4v8h8v-8zm6 6H5v-4h4zm4-16v8h8V3zm6 6h-4V5h4zm-6 4v8h8v-8zm6 6h-4v-4h4z\"\n}), 'GridView');","\"use client\";\n\nimport createSvgIcon from './utils/createSvgIcon';\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nexport default createSvgIcon( /*#__PURE__*/_jsx(\"path\", {\n  d: \"M3 18h6v-2H3zM3 6v2h18V6zm0 7h12v-2H3z\"\n}), 'Sort');","\"use client\";\n\nimport createSvgIcon from './utils/createSvgIcon';\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nexport default createSvgIcon( /*#__PURE__*/_jsx(\"path\", {\n  d: \"M3 14h4v-4H3zm0 5h4v-4H3zM3 9h4V5H3zm5 5h13v-4H8zm0 5h13v-4H8zM8 5v4h13V5z\"\n}), 'ViewList');","\"use client\";\n\nimport createSvgIcon from './utils/createSvgIcon';\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nexport default createSvgIcon( /*#__PURE__*/_jsx(\"path\", {\n  d: \"M12 7c2.76 0 5 2.24 5 5 0 .65-.13 1.26-.36 1.83l2.92 2.92c1.51-1.26 2.7-2.89 3.43-4.75-1.73-4.39-6-7.5-11-7.5-1.4 0-2.74.25-3.98.7l2.16 2.16C10.74 7.13 11.35 7 12 7M2 4.27l2.28 2.28.46.46C3.08 8.3 1.78 10.02 1 12c1.73 4.39 6 7.5 11 7.5 1.55 0 3.03-.3 4.38-.84l.42.42L19.73 22 21 20.73 3.27 3zM7.53 9.8l1.55 1.55c-.05.21-.08.43-.08.65 0 1.66 1.34 3 3 3 .22 0 .44-.03.65-.08l1.55 1.55c-.67.33-1.41.53-2.2.53-2.76 0-5-2.24-5-5 0-.79.2-1.53.53-2.2m4.31-.78 3.15 3.15.02-.16c0-1.66-1.34-3-3-3z\"\n}), 'VisibilityOff');","/**\r\n * Utility function to add church context headers to fetch requests\r\n * This helps prevent \"Record request without church context\" warnings\r\n */\r\n\r\ninterface FetchWithChurchContextOptions extends RequestInit {\r\n  churchId?: number | string | null;\r\n  skipChurchContext?: boolean; // For routes that shouldn't have church context\r\n}\r\n\r\n/**\r\n * Wraps fetch() to automatically add church context headers\r\n * @param url - The URL to fetch\r\n * @param options - Fetch options, including optional churchId\r\n * @returns Promise<Response>\r\n */\r\nexport async function fetchWithChurchContext(\r\n  url: string,\r\n  options: FetchWithChurchContextOptions = {}\r\n): Promise<Response> {\r\n  const { churchId, skipChurchContext, ...fetchOptions } = options;\r\n\r\n  // Get churchId from various sources if not provided\r\n  let finalChurchId: number | string | null | undefined = churchId;\r\n\r\n  // If churchId is not provided, try to get it from:\r\n  // 1. URL path (e.g., /api/admin/churches/46/...)\r\n  const urlMatch = url.match(/\\/churches\\/(\\d+)/);\r\n  if (!finalChurchId && urlMatch) {\r\n    finalChurchId = urlMatch[1];\r\n  }\r\n\r\n  // 2. localStorage (from user object)\r\n  if (!finalChurchId && typeof window !== 'undefined') {\r\n    try {\r\n      const authUser = localStorage.getItem('auth_user');\r\n      if (authUser) {\r\n        const user = JSON.parse(authUser);\r\n        finalChurchId = user?.church_id || user?.churchId;\r\n      }\r\n    } catch (e) {\r\n      // Ignore parse errors\r\n    }\r\n  }\r\n\r\n  // 3. sessionStorage\r\n  if (!finalChurchId && typeof window !== 'undefined') {\r\n    try {\r\n      const sessionChurchId = sessionStorage.getItem('church_id') || sessionStorage.getItem('churchId');\r\n      if (sessionChurchId) {\r\n        finalChurchId = sessionChurchId;\r\n      }\r\n    } catch (e) {\r\n      // Ignore errors\r\n    }\r\n  }\r\n\r\n  // Prepare headers\r\n  const headers = new Headers(fetchOptions.headers);\r\n\r\n  // Add church context header if we have a churchId and shouldn't skip it\r\n  if (!skipChurchContext && finalChurchId) {\r\n    const churchIdStr = String(finalChurchId).trim();\r\n    // Only add if it's a valid church ID (not empty, 'none', 'undefined', etc.)\r\n    if (churchIdStr && !['none', 'undefined', 'null', 'nan', ''].includes(churchIdStr.toLowerCase())) {\r\n      headers.set('X-Church-Id', churchIdStr);\r\n    }\r\n  }\r\n\r\n  // Ensure credentials are included for session-based auth\r\n  const finalOptions: RequestInit = {\r\n    ...fetchOptions,\r\n    credentials: fetchOptions.credentials || 'include',\r\n    headers,\r\n  };\r\n\r\n  return fetch(url, finalOptions);\r\n}\r\n\r\n/**\r\n * Helper to get churchId from URL or storage\r\n */\r\nexport function getChurchIdFromContext(): number | string | null {\r\n  // Try localStorage first\r\n  if (typeof window !== 'undefined') {\r\n    try {\r\n      const authUser = localStorage.getItem('auth_user');\r\n      if (authUser) {\r\n        const user = JSON.parse(authUser);\r\n        if (user?.church_id || user?.churchId) {\r\n          return user.church_id || user.churchId;\r\n        }\r\n      }\r\n    } catch (e) {\r\n      // Ignore parse errors\r\n    }\r\n\r\n    // Try sessionStorage\r\n    try {\r\n      const sessionChurchId = sessionStorage.getItem('church_id') || sessionStorage.getItem('churchId');\r\n      if (sessionChurchId) {\r\n        return sessionChurchId;\r\n      }\r\n    } catch (e) {\r\n      // Ignore errors\r\n    }\r\n  }\r\n\r\n  return null;\r\n}\r\n","/**\r\n * Enhanced Table Store with Liturgical Themes, Branding & Field Rules\r\n * localStorage-based persistence for cross-session configuration\r\n */\r\n\r\nexport type LiturgicalThemeKey = \r\n  | 'orthodox_traditional'\r\n  | 'great_lent'\r\n  | 'pascha'\r\n  | 'nativity'\r\n  | 'palm_sunday'\r\n  | 'theotokos_feasts';\r\n\r\nexport interface ThemeTokens {\r\n  headerBg: string;\r\n  headerText: string;\r\n  rowOddBg: string;\r\n  rowEvenBg: string;\r\n  border: string;\r\n  accent: string;\r\n  cellText: string;\r\n}\r\n\r\nexport interface FieldStyleRule {\r\n  field: string;\r\n  weight?: 'regular' | 'bold';\r\n  italic?: boolean;\r\n  uppercase?: boolean;\r\n  color?: string;\r\n  bg?: string;\r\n}\r\n\r\nexport interface Branding {\r\n  churchName?: string;\r\n  logoUrl?: string;\r\n  logoPreview?: string;\r\n  logoAlign?: 'left' | 'center' | 'right';\r\n  showBrandHeader?: boolean;\r\n}\r\n\r\nexport interface ButtonConfig {\r\n  backgroundColor?: string;\r\n  hoverColor?: string;\r\n  textColor?: string;\r\n  size?: 'small' | 'medium' | 'large';\r\n  padding?: string;\r\n  fontSize?: string;\r\n}\r\n\r\nexport interface ActionButtonConfigs {\r\n  switchToAG?: ButtonConfig;\r\n  fieldSettings?: ButtonConfig;\r\n  addRecords?: ButtonConfig;\r\n  advancedGrid?: ButtonConfig;\r\n  searchRecords?: ButtonConfig;\r\n  theme?: ButtonConfig;\r\n  recordTableConfig?: ButtonConfig;\r\n}\r\n\r\nexport interface EnhancedTableState {\r\n  liturgicalTheme: LiturgicalThemeKey | string; // Allow custom theme names\r\n  tokens: ThemeTokens;\r\n  fieldRules: FieldStyleRule[];\r\n  branding: Branding;\r\n  customThemes?: Record<string, ThemeTokens & { name: string; description?: string }>; // Store custom themes\r\n  actionButtonConfigs?: ActionButtonConfigs; // Button configurations\r\n}\r\n\r\n// Light mode themes - Neutral colors\r\nexport const THEME_MAP: Record<LiturgicalThemeKey, ThemeTokens> = {\r\n  orthodox_traditional: {\r\n    headerBg: '#6b7280',\r\n    headerText: '#ffffff',\r\n    rowOddBg: '#f9fafb',\r\n    rowEvenBg: '#ffffff',\r\n    border: '#e5e7eb',\r\n    accent: '#6b7280',\r\n    cellText: '#1f2937',\r\n  },\r\n  great_lent: {\r\n    headerBg: '#6b7280',\r\n    headerText: '#ffffff',\r\n    rowOddBg: '#f9fafb',\r\n    rowEvenBg: '#ffffff',\r\n    border: '#e5e7eb',\r\n    accent: '#6b7280',\r\n    cellText: '#1f2937',\r\n  },\r\n  pascha: {\r\n    headerBg: '#6b7280',\r\n    headerText: '#ffffff',\r\n    rowOddBg: '#f9fafb',\r\n    rowEvenBg: '#ffffff',\r\n    border: '#e5e7eb',\r\n    accent: '#6b7280',\r\n    cellText: '#1f2937',\r\n  },\r\n  nativity: {\r\n    headerBg: '#6b7280',\r\n    headerText: '#ffffff',\r\n    rowOddBg: '#f9fafb',\r\n    rowEvenBg: '#ffffff',\r\n    border: '#e5e7eb',\r\n    accent: '#6b7280',\r\n    cellText: '#1f2937',\r\n  },\r\n  palm_sunday: {\r\n    headerBg: '#6b7280',\r\n    headerText: '#ffffff',\r\n    rowOddBg: '#f9fafb',\r\n    rowEvenBg: '#ffffff',\r\n    border: '#e5e7eb',\r\n    accent: '#6b7280',\r\n    cellText: '#1f2937',\r\n  },\r\n  theotokos_feasts: {\r\n    headerBg: '#6b7280',\r\n    headerText: '#ffffff',\r\n    rowOddBg: '#f9fafb',\r\n    rowEvenBg: '#ffffff',\r\n    border: '#e5e7eb',\r\n    accent: '#6b7280',\r\n    cellText: '#1f2937',\r\n  },\r\n};\r\n\r\n// Dark mode themes - Neutral colors\r\nexport const THEME_MAP_DARK: Record<LiturgicalThemeKey, ThemeTokens> = {\r\n  orthodox_traditional: {\r\n    headerBg: '#4b5563',\r\n    headerText: '#ffffff',\r\n    rowOddBg: '#1f2937',\r\n    rowEvenBg: '#111827',\r\n    border: '#374151',\r\n    accent: '#4b5563',\r\n    cellText: '#f3f4f6',\r\n  },\r\n  great_lent: {\r\n    headerBg: '#4b5563',\r\n    headerText: '#ffffff',\r\n    rowOddBg: '#1f2937',\r\n    rowEvenBg: '#111827',\r\n    border: '#374151',\r\n    accent: '#4b5563',\r\n    cellText: '#f3f4f6',\r\n  },\r\n  pascha: {\r\n    headerBg: '#4b5563',\r\n    headerText: '#ffffff',\r\n    rowOddBg: '#1f2937',\r\n    rowEvenBg: '#111827',\r\n    border: '#374151',\r\n    accent: '#4b5563',\r\n    cellText: '#f3f4f6',\r\n  },\r\n  nativity: {\r\n    headerBg: '#4b5563',\r\n    headerText: '#ffffff',\r\n    rowOddBg: '#1f2937',\r\n    rowEvenBg: '#111827',\r\n    border: '#374151',\r\n    accent: '#4b5563',\r\n    cellText: '#f3f4f6',\r\n  },\r\n  palm_sunday: {\r\n    headerBg: '#4b5563',\r\n    headerText: '#ffffff',\r\n    rowOddBg: '#1f2937',\r\n    rowEvenBg: '#111827',\r\n    border: '#374151',\r\n    accent: '#4b5563',\r\n    cellText: '#f3f4f6',\r\n  },\r\n  theotokos_feasts: {\r\n    headerBg: '#4b5563',\r\n    headerText: '#ffffff',\r\n    rowOddBg: '#1f2937',\r\n    rowEvenBg: '#111827',\r\n    border: '#374151',\r\n    accent: '#4b5563',\r\n    cellText: '#f3f4f6',\r\n  },\r\n};\r\n\r\n// Helper to get theme tokens based on mode\r\nexport const getThemeTokens = (theme: LiturgicalThemeKey, isDarkMode: boolean): ThemeTokens => {\r\n  return isDarkMode ? THEME_MAP_DARK[theme] : THEME_MAP[theme];\r\n};\r\n\r\nconst STORAGE_KEY = 'om.dynamicInspector';\r\n\r\nclass EnhancedTableStore {\r\n  private state: EnhancedTableState;\r\n  private listeners: (() => void)[] = [];\r\n\r\n  constructor() {\r\n    this.state = this.loadState();\r\n  }\r\n\r\n  private loadState(): EnhancedTableState {\r\n    try {\r\n      const stored = localStorage.getItem(STORAGE_KEY);\r\n      if (stored) {\r\n        const parsed = JSON.parse(stored);\r\n        const theme = parsed.liturgicalTheme || 'orthodox_traditional';\r\n        \r\n        // If the theme is orthodox_traditional, always use the latest default values from THEME_MAP\r\n        // This ensures theme updates are applied even if localStorage has old values\r\n        // Also check if stored tokens match old defaults and migrate them\r\n        let tokens: ThemeTokens;\r\n        let needsMigration = false;\r\n        \r\n        if (theme === 'orthodox_traditional') {\r\n          // Check if stored tokens match old default values that need migration\r\n          const oldHeaderBgValues = ['#1976d2', '#2c5aa0', '#724eeb', '#866cff'];\r\n          if (parsed.tokens?.headerBg && oldHeaderBgValues.includes(parsed.tokens.headerBg)) {\r\n            needsMigration = true;\r\n          }\r\n          \r\n          // Always use the current default theme values (this ensures updates are applied)\r\n          tokens = THEME_MAP.orthodox_traditional;\r\n        } else {\r\n          // For other themes, use stored tokens or theme defaults\r\n          tokens = parsed.tokens || THEME_MAP[theme as LiturgicalThemeKey] || THEME_MAP.orthodox_traditional;\r\n        }\r\n        \r\n        const state = {\r\n          liturgicalTheme: theme,\r\n          tokens: tokens,\r\n          fieldRules: parsed.fieldRules || [],\r\n          branding: parsed.branding || {},\r\n          customThemes: parsed.customThemes || {},\r\n          actionButtonConfigs: parsed.actionButtonConfigs || {},\r\n        };\r\n        \r\n        // If migration is needed, save the updated state immediately\r\n        if (needsMigration) {\r\n          this.state = state;\r\n          this.saveState();\r\n        }\r\n        \r\n        return state;\r\n      }\r\n    } catch (error) {\r\n      console.warn('Failed to load enhanced table state:', error);\r\n    }\r\n    \r\n    return {\r\n      liturgicalTheme: 'orthodox_traditional',\r\n      tokens: THEME_MAP.orthodox_traditional,\r\n      fieldRules: [],\r\n      branding: {},\r\n      customThemes: {},\r\n      actionButtonConfigs: {},\r\n    };\r\n  }\r\n\r\n  private saveState(): void {\r\n    try {\r\n      localStorage.setItem(STORAGE_KEY, JSON.stringify(this.state));\r\n    } catch (error) {\r\n      console.warn('Failed to save enhanced table state:', error);\r\n    }\r\n  }\r\n\r\n  private notify(): void {\r\n    this.listeners.forEach(listener => listener());\r\n  }\r\n\r\n  public getState(): EnhancedTableState {\r\n    return { ...this.state };\r\n  }\r\n\r\n  public subscribe(listener: () => void): () => void {\r\n    this.listeners.push(listener);\r\n    return () => {\r\n      const index = this.listeners.indexOf(listener);\r\n      if (index > -1) {\r\n        this.listeners.splice(index, 1);\r\n      }\r\n    };\r\n  }\r\n\r\n  public setLiturgicalTheme(theme: LiturgicalThemeKey | string): void {\r\n    this.state.liturgicalTheme = theme;\r\n    \r\n    // Check if it's a pre-defined theme\r\n    if (theme in THEME_MAP) {\r\n      // Always use the current default from THEME_MAP to ensure updates are applied\r\n      this.state.tokens = THEME_MAP[theme as LiturgicalThemeKey];\r\n    } else if (this.state.customThemes && this.state.customThemes[theme]) {\r\n      // Use custom theme if it exists\r\n      const customTheme = this.state.customThemes[theme];\r\n      this.state.tokens = {\r\n        headerBg: customTheme.headerBg,\r\n        headerText: customTheme.headerText,\r\n        rowOddBg: customTheme.rowOddBg,\r\n        rowEvenBg: customTheme.rowEvenBg,\r\n        border: customTheme.border,\r\n        accent: customTheme.accent,\r\n        cellText: customTheme.cellText,\r\n      };\r\n    }\r\n    \r\n    this.saveState();\r\n    this.notify();\r\n  }\r\n  \r\n  public setCustomThemes(themes: Record<string, ThemeTokens & { name: string; description?: string }>): void {\r\n    this.state.customThemes = themes;\r\n    this.saveState();\r\n    this.notify();\r\n  }\r\n  \r\n  public getCustomThemes(): Record<string, ThemeTokens & { name: string; description?: string }> | undefined {\r\n    return this.state.customThemes;\r\n  }\r\n  \r\n  public updatePreDefinedTheme(themeKey: LiturgicalThemeKey, tokens: ThemeTokens): void {\r\n    // Update the THEME_MAP (this is a runtime update, not persisted in code)\r\n    // Note: This only affects the current session. To persist, we'd need backend support.\r\n    (THEME_MAP as any)[themeKey] = tokens;\r\n    \r\n    // If this theme is currently active, update the state\r\n    if (this.state.liturgicalTheme === themeKey) {\r\n      this.state.tokens = tokens;\r\n      this.saveState();\r\n      this.notify();\r\n    }\r\n  }\r\n\r\n  public setFieldRules(rules: FieldStyleRule[]): void {\r\n    this.state.fieldRules = rules;\r\n    this.saveState();\r\n    this.notify();\r\n  }\r\n\r\n  public setBranding(updates: Partial<Branding>): void {\r\n    this.state.branding = { ...this.state.branding, ...updates };\r\n    this.saveState();\r\n    this.notify();\r\n  }\r\n\r\n  public setTokens(tokens: Partial<ThemeTokens>): void {\r\n    this.state.tokens = { ...this.state.tokens, ...tokens };\r\n    this.saveState();\r\n    this.notify();\r\n  }\r\n\r\n  public setState(updater: (state: EnhancedTableState) => EnhancedTableState): void {\r\n    const newState = updater(this.state);\r\n    // If orthodox_traditional theme, ensure headerBg and accent use current defaults\r\n    if (newState.liturgicalTheme === 'orthodox_traditional') {\r\n      newState.tokens.headerBg = THEME_MAP.orthodox_traditional.headerBg;\r\n      newState.tokens.accent = THEME_MAP.orthodox_traditional.accent;\r\n    }\r\n    this.state = newState;\r\n    this.saveState();\r\n    this.notify();\r\n  }\r\n\r\n  public exportConfig(): EnhancedTableState {\r\n    return { ...this.state };\r\n  }\r\n\r\n  public importConfig(config: Partial<EnhancedTableState>): void {\r\n    if (config.liturgicalTheme && THEME_MAP[config.liturgicalTheme]) {\r\n      this.state.liturgicalTheme = config.liturgicalTheme;\r\n      this.state.tokens = THEME_MAP[config.liturgicalTheme];\r\n    }\r\n    if (config.fieldRules) {\r\n      this.state.fieldRules = config.fieldRules;\r\n    }\r\n    if (config.branding) {\r\n      this.state.branding = { ...this.state.branding, ...config.branding };\r\n    }\r\n    if (config.actionButtonConfigs) {\r\n      this.state.actionButtonConfigs = { ...this.state.actionButtonConfigs, ...config.actionButtonConfigs };\r\n    }\r\n    this.saveState();\r\n    this.notify();\r\n  }\r\n\r\n  public setActionButtonConfigs(configs: Partial<ActionButtonConfigs>): void {\r\n    this.state.actionButtonConfigs = { ...this.state.actionButtonConfigs, ...configs };\r\n    this.saveState();\r\n    this.notify();\r\n  }\r\n\r\n  public getActionButtonConfigs(): ActionButtonConfigs | undefined {\r\n    return this.state.actionButtonConfigs;\r\n  }\r\n}\r\n\r\nexport const enhancedTableStore = new EnhancedTableStore();\r\n","/**\r\n * RecordHeaderBanner - Shared header component for records pages\r\n * Renders the header banner with church name, calendar, logos, etc.\r\n * Loads settings from API and listens for updates\r\n */\r\n\r\nimport React, { useState, useEffect, useMemo } from 'react';\r\nimport { Box, Typography } from '@mui/material';\r\nimport { fetchWithChurchContext } from '@/shared/lib/fetchWithChurchContext';\r\n\r\ninterface RecordHeaderBannerProps {\r\n  churchId: number;\r\n  recordType: 'baptism' | 'marriage' | 'funeral';\r\n  churchName?: string;\r\n  recordSettings?: any; // Settings from API or parent component\r\n  interactive?: boolean; // If true, allows double-click configuration (for preview)\r\n  onElementDoubleClick?: (elementType: string) => void; // Callback for double-click events\r\n}\r\n\r\nconst RecordHeaderBanner: React.FC<RecordHeaderBannerProps> = ({\r\n  churchId,\r\n  recordType,\r\n  churchName,\r\n  recordSettings: externalSettings,\r\n  interactive = false,\r\n  onElementDoubleClick,\r\n}) => {\r\n  const [recordSettings, setRecordSettings] = useState<any>(externalSettings || null);\r\n  const [loading, setLoading] = useState(!externalSettings);\r\n\r\n  // Load settings from API if not provided\r\n  useEffect(() => {\r\n    const loadSettings = async (forceReload = false) => {\r\n      // If external settings are provided and we're not forcing a reload, use them\r\n      if (externalSettings && !forceReload) {\r\n        setRecordSettings(externalSettings);\r\n        setLoading(false);\r\n        return;\r\n      }\r\n\r\n      try {\r\n        // Add cache-busting parameter to ensure fresh data\r\n        const cacheBuster = forceReload ? `?t=${Date.now()}` : '';\r\n        const response = await fetchWithChurchContext(`/api/admin/churches/${churchId}/record-settings${cacheBuster}`, {\r\n          churchId,\r\n          credentials: 'include',\r\n          cache: forceReload ? 'no-cache' : 'default',\r\n        });\r\n        if (response.ok) {\r\n          const data = await response.json();\r\n          if (data.settings) {\r\n            setRecordSettings(data.settings);\r\n            console.log('[RecordHeaderBanner] Settings loaded:', data.settings);\r\n            console.log('[RecordHeaderBanner] Logo enabled:', data.settings.logo?.enabled);\r\n            console.log('[RecordHeaderBanner] Calendar enabled:', data.settings.calendar?.enabled);\r\n            console.log('[RecordHeaderBanner] OM Logo enabled:', data.settings.omLogo?.enabled);\r\n          } else {\r\n            console.log('[RecordHeaderBanner] No settings found, using empty object');\r\n            setRecordSettings({});\r\n          }\r\n        } else {\r\n          console.error('[RecordHeaderBanner] Failed to load settings, status:', response.status);\r\n        }\r\n      } catch (err) {\r\n        console.error('[RecordHeaderBanner] Error loading settings:', err);\r\n      } finally {\r\n        setLoading(false);\r\n      }\r\n    };\r\n\r\n    // Initial load\r\n    loadSettings();\r\n\r\n    // Listen for settings updates\r\n    const handleSettingsUpdate = (event: CustomEvent) => {\r\n      console.log('[RecordHeaderBanner] Settings update event received:', event.detail);\r\n      if (event.detail?.churchId === churchId) {\r\n        // Force reload when settings are updated\r\n        loadSettings(true);\r\n      }\r\n    };\r\n\r\n    window.addEventListener('recordSettingsUpdated', handleSettingsUpdate as EventListener);\r\n    return () => {\r\n      window.removeEventListener('recordSettingsUpdated', handleSettingsUpdate as EventListener);\r\n    };\r\n  }, [churchId, externalSettings]);\r\n\r\n  const getImagePath = (type: string): string => {\r\n    if (!recordSettings) return '';\r\n    \r\n    switch (type) {\r\n      case 'logo':\r\n        const logoImages = recordSettings?.imageLibrary?.logo || [];\r\n        const logoIndex = recordSettings?.currentImageIndex?.logo ?? 0;\r\n        if (logoImages.length > 0 && logoImages[logoIndex]) {\r\n          return logoImages[logoIndex];\r\n        }\r\n        return `/images/records/${churchId}-logo.png`;\r\n      case 'recordImage':\r\n        const recordImages = recordSettings?.imageLibrary?.[recordType] || [];\r\n        const recordIndex = recordSettings?.currentImageIndex?.[recordType] ?? 0;\r\n        if (recordImages.length > 0 && recordImages[recordIndex]) {\r\n          return recordImages[recordIndex];\r\n        }\r\n        return `/images/records/${recordType}.png`;\r\n      case 'bg':\r\n        const bgImages = recordSettings?.imageLibrary?.bg || [];\r\n        const bgIndex = recordSettings?.currentImageIndex?.bg ?? 0;\r\n        if (bgImages.length > 0 && bgImages[bgIndex]) {\r\n          return bgImages[bgIndex];\r\n        }\r\n        return `/images/records/${churchId}-bg.png`;\r\n      case 'g1':\r\n        const g1Images = recordSettings?.imageLibrary?.g1 || [];\r\n        const g1Index = recordSettings?.currentImageIndex?.g1 ?? 0;\r\n        if (g1Images.length > 0 && g1Images[g1Index]) {\r\n          return g1Images[g1Index];\r\n        }\r\n        return '/images/records/g1.png';\r\n      case 'omLogo':\r\n        const omImages = recordSettings?.imageLibrary?.omLogo || [];\r\n        const omIndex = recordSettings?.currentImageIndex?.omLogo ?? 0;\r\n        if (omImages.length > 0 && omImages[omIndex]) {\r\n          return omImages[omIndex];\r\n        }\r\n        return '/images/records/om-logo.png';\r\n      default:\r\n        return '';\r\n    }\r\n  };\r\n\r\n  // Get current date for calendar\r\n  const getCalendarDates = () => {\r\n    const today = new Date();\r\n    const dates = [];\r\n    for (let i = 0; i < 3; i++) {\r\n      const date = new Date(today);\r\n      date.setDate(today.getDate() + i);\r\n      dates.push({\r\n        month: date.toLocaleString('en-US', { month: 'short' }).toUpperCase(),\r\n        year: date.getFullYear(),\r\n        weekday: date.toLocaleString('en-US', { weekday: 'short' }).toUpperCase().slice(0, 3),\r\n        day: date.getDate(),\r\n      });\r\n    }\r\n    return dates;\r\n  };\r\n\r\n  const calendarDates = useMemo(() => getCalendarDates(), []);\r\n\r\n  if (loading) {\r\n    return <Box sx={{ height: 200, bgcolor: 'background.paper' }} />;\r\n  }\r\n\r\n  const recordTypeLabel = recordType === 'baptism' ? 'Baptism' : recordType === 'marriage' ? 'Marriage' : 'Funeral';\r\n\r\n  return (\r\n    <Box\r\n      sx={{\r\n        width: '100%',\r\n        position: 'relative',\r\n        display: 'flex',\r\n        alignItems: 'stretch',\r\n        height: 200,\r\n        maxHeight: 200,\r\n        backgroundImage: recordSettings?.backgroundImage?.enabled === true \r\n          ? `url(${getImagePath('bg')})` \r\n          : 'none',\r\n        backgroundRepeat: recordSettings?.backgroundImage?.size === 'auto' ? 'repeat' : 'no-repeat',\r\n        backgroundSize: recordSettings?.backgroundImage?.size || 'auto',\r\n        backgroundPosition: recordSettings?.backgroundImage?.position || 'top left',\r\n        opacity: recordSettings?.backgroundImage?.opacity !== undefined \r\n          ? (recordSettings.backgroundImage.opacity / 100) \r\n          : 1,\r\n        overflow: 'hidden',\r\n        ...(interactive && {\r\n          cursor: 'pointer',\r\n        }),\r\n      }}\r\n      onDoubleClick={interactive ? () => onElementDoubleClick?.('backgroundImage') : undefined}\r\n    >\r\n      {/* Gradient Overlay using g1.png */}\r\n      {recordSettings?.g1Image?.enabled === true && (\r\n        <Box\r\n          sx={{\r\n            position: 'absolute',\r\n            top: 0,\r\n            left: 0,\r\n            right: 0,\r\n            bottom: 0,\r\n            backgroundImage: `url(${getImagePath('g1')})`,\r\n            backgroundSize: recordSettings?.g1Image?.size || 'cover',\r\n            backgroundPosition: recordSettings?.g1Image?.position || 'center',\r\n            opacity: recordSettings?.g1Image?.opacity !== undefined \r\n              ? recordSettings.g1Image.opacity \r\n              : 0.85,\r\n            zIndex: 0,\r\n            ...(interactive && {\r\n              cursor: 'pointer',\r\n            }),\r\n          }}\r\n          onDoubleClick={interactive ? (e) => {\r\n            e.stopPropagation();\r\n            onElementDoubleClick?.('g1Image');\r\n          } : undefined}\r\n        />\r\n      )}\r\n      \r\n      {/* Top Gold Horizontal Border */}\r\n      <Box\r\n        sx={{\r\n          position: 'absolute',\r\n          top: 0,\r\n          left: 0,\r\n          right: 0,\r\n          height: '20px',\r\n          backgroundImage: 'url(/images/records/gold-hor.png)',\r\n          backgroundRepeat: 'repeat-x',\r\n          backgroundSize: 'auto 100%',\r\n          zIndex: 10,\r\n        }}\r\n      />\r\n      \r\n      {/* Left Gold Vertical Border */}\r\n      <Box\r\n        sx={{\r\n          position: 'absolute',\r\n          left: 0,\r\n          top: 0,\r\n          bottom: 0,\r\n          width: '20px',\r\n          backgroundImage: 'url(/images/records/gold-vertical.png)',\r\n          backgroundRepeat: 'repeat-y',\r\n          backgroundSize: '100% auto',\r\n          zIndex: 10,\r\n        }}\r\n      />\r\n      \r\n      {/* Right Gold Vertical Border */}\r\n      <Box\r\n        sx={{\r\n          position: 'absolute',\r\n          right: 0,\r\n          top: 0,\r\n          bottom: 0,\r\n          width: '20px',\r\n          backgroundImage: 'url(/images/records/gold-vertical.png)',\r\n          backgroundRepeat: 'repeat-y',\r\n          backgroundSize: '100% auto',\r\n          zIndex: 10,\r\n        }}\r\n      />\r\n      \r\n      {/* Bottom Gold Horizontal Border */}\r\n      <Box\r\n        sx={{\r\n          position: 'absolute',\r\n          bottom: 0,\r\n          left: 0,\r\n          right: 0,\r\n          height: '20px',\r\n          backgroundImage: 'url(/images/records/gold-hor.png)',\r\n          backgroundRepeat: 'repeat-x',\r\n          backgroundSize: 'auto 100%',\r\n          zIndex: 10,\r\n        }}\r\n      />\r\n\r\n      {/* Main Header Content Area - 4 Column Layout */}\r\n      <Box\r\n        sx={{\r\n          width: '100%',\r\n          ml: '20px',\r\n          mr: '20px',\r\n          mt: '10px',\r\n          mb: '10px',\r\n          pl: 2,\r\n          pr: 2,\r\n          display: 'grid',\r\n          gridTemplateColumns: '1fr 1fr 1fr 1fr',\r\n          gap: 2,\r\n          alignItems: 'stretch',\r\n          position: 'relative',\r\n          zIndex: 1,\r\n          height: '100%',\r\n        }}\r\n      >\r\n        {/* Record Image */}\r\n        {recordSettings?.recordImages?.enabled !== false && (\r\n          <Box\r\n            sx={{\r\n              display: 'flex',\r\n              flexDirection: 'column',\r\n              alignItems: 'center',\r\n              justifyContent: 'center',\r\n              gridColumn: recordSettings?.recordImages?.column || 1,\r\n              position: 'relative',\r\n              height: '100%',\r\n              zIndex: 2,\r\n              ...(interactive && {\r\n                cursor: 'pointer',\r\n                '&:hover': {\r\n                  outline: '2px dashed #1976d2',\r\n                  outlineOffset: '2px',\r\n                },\r\n              }),\r\n            }}\r\n            onDoubleClick={interactive ? (e) => {\r\n              e.stopPropagation();\r\n              onElementDoubleClick?.('recordImage');\r\n            } : undefined}\r\n          >\r\n            <Box\r\n              component=\"img\"\r\n              src={getImagePath('recordImage')}\r\n              alt=\"Record Image\"\r\n              sx={{\r\n                width: `${recordSettings?.recordImages?.width || 60}px`,\r\n                height: `${recordSettings?.recordImages?.height || 60}px`,\r\n                objectFit: (recordSettings?.recordImages?.objectFit || 'contain') as any,\r\n                border: `${recordSettings?.recordImages?.borderWidth || 3}px solid #4C1D95`,\r\n                borderRadius: 2,\r\n                boxShadow: '0 4px 12px rgba(76, 29, 149, 0.3)',\r\n              }}\r\n              onError={(e) => {\r\n                (e.target as HTMLImageElement).src = `/images/records/${recordType}.png`;\r\n              }}\r\n            />\r\n            {interactive && (\r\n              <Typography variant=\"caption\" sx={{ mt: 0.5, bgcolor: 'rgba(255,255,255,0.8)', px: 0.5, borderRadius: 0.5 }}>\r\n                Record Image\r\n              </Typography>\r\n            )}\r\n          </Box>\r\n        )}\r\n\r\n        {/* Calendar Cards */}\r\n        {recordSettings?.calendar?.enabled === true && (\r\n          <Box\r\n            sx={{\r\n              display: 'flex',\r\n              flexDirection: 'column',\r\n              alignItems: 'center',\r\n              justifyContent: 'center',\r\n              gridColumn: recordSettings?.calendar?.column || 2,\r\n              position: 'relative',\r\n              height: '100%',\r\n              zIndex: 2,\r\n              gap: 0.5,\r\n              ...(interactive && {\r\n                cursor: 'pointer',\r\n                '&:hover': {\r\n                  outline: '2px dashed #1976d2',\r\n                  outlineOffset: '2px',\r\n                },\r\n              }),\r\n            }}\r\n            onDoubleClick={interactive ? (e) => {\r\n              e.stopPropagation();\r\n              onElementDoubleClick?.('calendar');\r\n            } : undefined}\r\n          >\r\n            <Box sx={{ display: 'flex', flexDirection: 'column', gap: 0.5, alignItems: 'center' }}>\r\n              {calendarDates.map((date, index) => (\r\n                <Box\r\n                  key={index}\r\n                  sx={{\r\n                    width: '50px',\r\n                    height: '55px',\r\n                    background: 'linear-gradient(145deg, #ffffff 0%, #f5f0e6 50%, #e8dcc8 100%)',\r\n                    borderRadius: '8px',\r\n                    display: 'flex',\r\n                    flexDirection: 'column',\r\n                    alignItems: 'center',\r\n                    justifyContent: 'center',\r\n                    boxShadow: '0 4px 12px rgba(0,0,0,0.2)',\r\n                    border: '2px solid #DAA520',\r\n                    transform: `translateY(${index * -2}px) rotate(${(index - 1) * 1.5}deg)`,\r\n                    position: 'relative',\r\n                    overflow: 'hidden',\r\n                    '&::before': {\r\n                      content: '\"\"',\r\n                      position: 'absolute',\r\n                      top: 0,\r\n                      left: 0,\r\n                      right: 0,\r\n                      height: '14px',\r\n                      background: 'linear-gradient(180deg, #8B0000 0%, #5c0000 100%)',\r\n                      borderRadius: '6px 6px 0 0',\r\n                    },\r\n                  }}\r\n                >\r\n                  <Typography sx={{ fontSize: '6px', fontWeight: 800, color: '#fff', zIndex: 1, mt: '-1px' }}>\r\n                    {date.month} {date.year}\r\n                  </Typography>\r\n                  <Typography sx={{ fontSize: '7px', fontWeight: 700, color: '#4C1D95', mt: 0.25 }}>\r\n                    {date.weekday}\r\n                  </Typography>\r\n                  <Typography sx={{ fontSize: '16px', fontWeight: 900, color: '#1a1a2e', lineHeight: 1 }}>\r\n                    {date.day}\r\n                  </Typography>\r\n                </Box>\r\n              ))}\r\n            </Box>\r\n          </Box>\r\n        )}\r\n\r\n        {/* Church Logo */}\r\n        {recordSettings?.logo?.enabled === true && (\r\n          <Box\r\n            sx={{\r\n              display: 'flex',\r\n              flexDirection: 'column',\r\n              alignItems: 'center',\r\n              justifyContent: 'center',\r\n              gridColumn: recordSettings?.logo?.column || 3,\r\n              position: 'relative',\r\n              height: '100%',\r\n              zIndex: 2,\r\n              ...(interactive && {\r\n                cursor: 'pointer',\r\n                '&:hover': {\r\n                  outline: '2px dashed #1976d2',\r\n                  outlineOffset: '2px',\r\n                },\r\n              }),\r\n            }}\r\n            onDoubleClick={interactive ? (e) => {\r\n              e.stopPropagation();\r\n              onElementDoubleClick?.('logo');\r\n            } : undefined}\r\n          >\r\n            <Box\r\n              component=\"img\"\r\n              src={getImagePath('logo')}\r\n              alt=\"Church Logo\"\r\n              sx={{\r\n                width: `${recordSettings?.logo?.width || 120}px`,\r\n                height: recordSettings?.logo?.height === 'auto' ? 'auto' : `${recordSettings?.logo?.height || 120}px`,\r\n                maxHeight: '160px',\r\n                objectFit: (recordSettings?.logo?.objectFit || 'contain') as any,\r\n                opacity: (recordSettings?.logo?.opacity || 100) / 100,\r\n              }}\r\n              onError={(e) => {\r\n                (e.target as HTMLImageElement).src = '/images/records/om-logo.png';\r\n              }}\r\n            />\r\n          </Box>\r\n        )}\r\n\r\n        {/* OM Logo */}\r\n        {recordSettings?.omLogo?.enabled === true && (\r\n          <Box\r\n            sx={{\r\n              display: 'flex',\r\n              flexDirection: 'column',\r\n              alignItems: 'center',\r\n              justifyContent: 'center',\r\n              gridColumn: recordSettings?.omLogo?.column || 4,\r\n              position: 'relative',\r\n              height: '100%',\r\n              zIndex: 2,\r\n              ...(interactive && {\r\n                cursor: 'pointer',\r\n                '&:hover': {\r\n                  outline: '2px dashed #1976d2',\r\n                  outlineOffset: '2px',\r\n                },\r\n              }),\r\n            }}\r\n            onDoubleClick={interactive ? (e) => {\r\n              e.stopPropagation();\r\n              onElementDoubleClick?.('omLogo');\r\n            } : undefined}\r\n          >\r\n            <Box\r\n              component=\"img\"\r\n              src={getImagePath('omLogo')}\r\n              alt=\"OM Logo\"\r\n              sx={{\r\n                width: `${recordSettings?.omLogo?.width || 68}px`,\r\n                height: recordSettings?.omLogo?.height === 'auto' ? 'auto' : `${recordSettings?.omLogo?.height || 68}px`,\r\n                objectFit: (recordSettings?.omLogo?.objectFit || 'contain') as any,\r\n                opacity: (recordSettings?.omLogo?.opacity || 100) / 100,\r\n              }}\r\n            />\r\n          </Box>\r\n        )}\r\n\r\n        {/* Church Name Text - Removed per user request */}\r\n        {/* Text can be re-enabled via recordSettings.headerText.enabled if needed in the future */}\r\n      </Box>\r\n    </Box>\r\n  );\r\n};\r\n\r\nexport default RecordHeaderBanner;\r\n\r\n","import React, { useState } from 'react';\r\nimport {\r\n  Box,\r\n  Paper,\r\n  Typography,\r\n  Dialog,\r\n  DialogTitle,\r\n  DialogContent,\r\n  DialogActions,\r\n  Button,\r\n  TextField,\r\n  Slider,\r\n  FormControl,\r\n  InputLabel,\r\n  Select,\r\n  MenuItem,\r\n  Stack,\r\n  IconButton,\r\n  Tooltip,\r\n  Switch,\r\n  FormControlLabel,\r\n  Drawer,\r\n  Divider,\r\n} from '@mui/material';\r\nimport {\r\n  Close as CloseIcon,\r\n  CloudUpload as CloudUploadIcon,\r\n  Settings as SettingsIcon,\r\n} from '@mui/icons-material';\r\nimport RecordHeaderBanner from './RecordHeaderBanner';\r\n\r\ninterface RecordHeaderPreviewProps {\r\n  churchId: number;\r\n  recordSettings: any;\r\n  setRecordSettings: (updater: (prev: any) => any) => void;\r\n  onImageUpload: (type: string, file: File) => void;\r\n  recordType?: 'baptism' | 'marriage' | 'funeral'; // Record type for correct image\r\n  churchName?: string; // Church name to display in header\r\n}\r\n\r\nconst RecordHeaderPreview: React.FC<RecordHeaderPreviewProps> = ({\r\n  churchId,\r\n  recordSettings,\r\n  setRecordSettings,\r\n  onImageUpload,\r\n  recordType = 'baptism',\r\n  churchName,\r\n}) => {\r\n  const [configDialogOpen, setConfigDialogOpen] = useState(false);\r\n  const [configType, setConfigType] = useState<string | null>(null);\r\n  const [imageDialogOpen, setImageDialogOpen] = useState(false);\r\n  const [imageType, setImageType] = useState<string | null>(null);\r\n\r\n  const handleDoubleClick = (type: string) => {\r\n    setConfigType(type);\r\n    setConfigDialogOpen(true);\r\n  };\r\n\r\n  const handleImageReplace = (type: string) => {\r\n    setImageType(type);\r\n    setImageDialogOpen(true);\r\n  };\r\n\r\n  const getImagePath = (type: string): string => {\r\n    switch (type) {\r\n      case 'logo':\r\n        // Use image library if available, otherwise fallback to default path\r\n        const logoImages = recordSettings?.imageLibrary?.logo || [];\r\n        const logoIndex = recordSettings?.currentImageIndex?.logo ?? 0;\r\n        if (logoImages.length > 0 && logoImages[logoIndex]) {\r\n          return logoImages[logoIndex];\r\n        }\r\n        return `/images/records/${churchId}-logo.png`;\r\n      case 'recordImage':\r\n        // Use record type-specific image from library\r\n        const recordImages = recordSettings?.imageLibrary?.[recordType] || [];\r\n        const recordIndex = recordSettings?.currentImageIndex?.[recordType] ?? 0;\r\n        if (recordImages.length > 0 && recordImages[recordIndex]) {\r\n          return recordImages[recordIndex];\r\n        }\r\n        // Fallback to default based on record type\r\n        return `/images/records/${recordType}.png`;\r\n      case 'baptism':\r\n      case 'marriage':\r\n      case 'funeral':\r\n        return `/images/records/${type}.png`;\r\n      case 'bg':\r\n        // Use background image from library if available\r\n        const bgImages = recordSettings?.imageLibrary?.bg || [];\r\n        const bgIndex = recordSettings?.currentImageIndex?.bg ?? 0;\r\n        if (bgImages.length > 0 && bgImages[bgIndex]) {\r\n          return bgImages[bgIndex];\r\n        }\r\n        return `/images/records/${churchId}-bg.png`;\r\n      case 'g1':\r\n        // Use G1 overlay from library if available\r\n        const g1Images = recordSettings?.imageLibrary?.g1 || [];\r\n        const g1Index = recordSettings?.currentImageIndex?.g1 ?? 0;\r\n        if (g1Images.length > 0 && g1Images[g1Index]) {\r\n          return g1Images[g1Index];\r\n        }\r\n        return '/images/records/g1.png';\r\n      case 'omLogo':\r\n        // Use OM logo from library if available\r\n        const omImages = recordSettings?.imageLibrary?.omLogo || [];\r\n        const omIndex = recordSettings?.currentImageIndex?.omLogo ?? 0;\r\n        if (omImages.length > 0 && omImages[omIndex]) {\r\n          return omImages[omIndex];\r\n        }\r\n        return '/images/records/om-logo.png';\r\n      default:\r\n        return '';\r\n    }\r\n  };\r\n\r\n  // Sample calendar dates for preview\r\n  const sampleDates = [\r\n    { month: 'Dec', year: 2025, weekday: 'Mon', day: 15 },\r\n    { month: 'Dec', year: 2025, weekday: 'Tue', day: 16 },\r\n    { month: 'Dec', year: 2025, weekday: 'Wed', day: 17 },\r\n  ];\r\n\r\n  return (\r\n    <Box sx={{ mb: 4 }}>\r\n      <Typography variant=\"h6\" gutterBottom sx={{ mb: 2 }}>\r\n        Live Preview\r\n      </Typography>\r\n      <Typography variant=\"body2\" color=\"text.secondary\" sx={{ mb: 2 }}>\r\n        Double-click any element to configure it. This preview matches the actual header on the records page.\r\n      </Typography>\r\n      \r\n      {/* Actual Header Preview - Using shared RecordHeaderBanner component */}\r\n      <Paper\r\n        variant=\"outlined\"\r\n        sx={{\r\n          overflow: 'hidden',\r\n          borderRadius: 1,\r\n          position: 'relative',\r\n        }}\r\n      >\r\n        {/* Use shared header component for accurate preview with interactive mode */}\r\n        <Box sx={{ position: 'relative' }}>\r\n          <RecordHeaderBanner\r\n            churchId={churchId}\r\n            recordType={recordType}\r\n            churchName={churchName}\r\n            recordSettings={recordSettings}\r\n            interactive={true}\r\n            onElementDoubleClick={handleDoubleClick}\r\n          />\r\n          \r\n          {/* Column labels for configuration */}\r\n          {[1, 2, 3, 4].map((col) => (\r\n            <Box\r\n              key={`label-${col}`}\r\n              sx={{\r\n                position: 'absolute',\r\n                top: -8,\r\n                left: `calc(${(col - 1) * 25}% + ${col === 1 ? '8px' : col === 4 ? '-8px' : '0px'})`,\r\n                width: '25%',\r\n                textAlign: 'center',\r\n                zIndex: 20,\r\n                pointerEvents: 'none',\r\n              }}\r\n            >\r\n              <Typography\r\n                variant=\"caption\"\r\n                sx={{\r\n                  bgcolor: 'rgba(255,255,255,0.9)',\r\n                  px: 1,\r\n                  py: 0.25,\r\n                  borderRadius: 1,\r\n                  fontSize: '0.65rem',\r\n                  color: 'text.secondary',\r\n                }}\r\n              >\r\n                Col {col}\r\n              </Typography>\r\n            </Box>\r\n          ))}\r\n        </Box>\r\n      </Paper>\r\n\r\n      {/* Quick Settings Bar */}\r\n      <Box sx={{ mt: 2, display: 'flex', gap: 1, flexWrap: 'wrap' }}>\r\n        <Button\r\n          size=\"small\"\r\n          variant=\"outlined\"\r\n          startIcon={<SettingsIcon />}\r\n          onClick={() => handleDoubleClick('recordImage')}\r\n        >\r\n          Record Image\r\n        </Button>\r\n        <Button\r\n          size=\"small\"\r\n          variant=\"outlined\"\r\n          startIcon={<SettingsIcon />}\r\n          onClick={() => handleDoubleClick('calendar')}\r\n        >\r\n          Calendar\r\n        </Button>\r\n        <Button\r\n          size=\"small\"\r\n          variant=\"outlined\"\r\n          startIcon={<SettingsIcon />}\r\n          onClick={() => handleDoubleClick('logo')}\r\n        >\r\n          Church Logo\r\n        </Button>\r\n        <Button\r\n          size=\"small\"\r\n          variant=\"outlined\"\r\n          startIcon={<SettingsIcon />}\r\n          onClick={() => handleDoubleClick('omLogo')}\r\n        >\r\n          OM Logo\r\n        </Button>\r\n        <Button\r\n          size=\"small\"\r\n          variant=\"outlined\"\r\n          startIcon={<SettingsIcon />}\r\n          onClick={() => handleDoubleClick('backgroundImage')}\r\n        >\r\n          Background\r\n        </Button>\r\n        <Button\r\n          size=\"small\"\r\n          variant=\"outlined\"\r\n          startIcon={<SettingsIcon />}\r\n          onClick={() => handleDoubleClick('g1Image')}\r\n        >\r\n          G1 Overlay\r\n        </Button>\r\n      </Box>\r\n\r\n      {/* Configuration Drawer */}\r\n      <Drawer\r\n        anchor=\"right\"\r\n        open={configDialogOpen}\r\n        onClose={() => setConfigDialogOpen(false)}\r\n        PaperProps={{\r\n          sx: {\r\n            width: { xs: '90%', sm: 400 },\r\n            maxWidth: 500,\r\n          },\r\n        }}\r\n      >\r\n        <Box sx={{ p: 3 }}>\r\n          <Box sx={{ display: 'flex', alignItems: 'center', justifyContent: 'space-between', mb: 2 }}>\r\n            <Typography variant=\"h6\">\r\n              Configure {\r\n                configType === 'logo' ? 'Church Logo' : \r\n                configType === 'calendar' ? 'Calendar Cards' : \r\n                configType === 'omLogo' ? 'OM Logo' : \r\n                configType === 'recordImage' ? 'Record Image' : \r\n                configType === 'backgroundImage' ? 'Background Image' : \r\n                configType === 'g1Image' ? 'G1 Overlay' : \r\n                'Element'\r\n              }\r\n            </Typography>\r\n            <IconButton onClick={() => setConfigDialogOpen(false)}>\r\n              <CloseIcon />\r\n            </IconButton>\r\n          </Box>\r\n          <Divider sx={{ mb: 2 }} />\r\n          \r\n          <Box sx={{ maxHeight: 'calc(100vh - 120px)', overflowY: 'auto' }}>\r\n            {/* Logo Configuration */}\r\n            {configType === 'logo' && (\r\n              <Stack spacing={2}>\r\n                <FormControlLabel\r\n                  control={\r\n                    <Switch\r\n                      checked={recordSettings.logo?.enabled ?? true}\r\n                      onChange={(e) => setRecordSettings(prev => ({\r\n                        ...prev,\r\n                        logo: { ...prev.logo, enabled: e.target.checked }\r\n                      }))}\r\n                    />\r\n                  }\r\n                  label=\"Display Church Logo\"\r\n                />\r\n                {recordSettings.logo?.enabled !== false && (\r\n                  <>\r\n                    <FormControl fullWidth>\r\n                      <InputLabel>Column Position</InputLabel>\r\n                      <Select\r\n                        value={recordSettings.logo?.column || 3}\r\n                        onChange={(e) => setRecordSettings(prev => ({\r\n                          ...prev,\r\n                          logo: { ...prev.logo, column: Number(e.target.value) }\r\n                        }))}\r\n                        label=\"Column Position\"\r\n                      >\r\n                        <MenuItem value={1}>Column 1 (Left)</MenuItem>\r\n                        <MenuItem value={2}>Column 2</MenuItem>\r\n                        <MenuItem value={3}>Column 3</MenuItem>\r\n                        <MenuItem value={4}>Column 4 (Right)</MenuItem>\r\n                      </Select>\r\n                    </FormControl>\r\n                    <TextField\r\n                      label=\"Width (px)\"\r\n                      type=\"number\"\r\n                      value={recordSettings.logo?.width || 120}\r\n                      onChange={(e) => setRecordSettings(prev => ({\r\n                        ...prev,\r\n                        logo: { ...prev.logo, width: Number(e.target.value) }\r\n                      }))}\r\n                      fullWidth\r\n                    />\r\n                    <TextField\r\n                      label=\"Height (px or 'auto')\"\r\n                      value={recordSettings.logo?.height || 'auto'}\r\n                      onChange={(e) => setRecordSettings(prev => ({\r\n                        ...prev,\r\n                        logo: { ...prev.logo, height: e.target.value === 'auto' ? 'auto' : (isNaN(Number(e.target.value)) ? e.target.value : Number(e.target.value)) }\r\n                      }))}\r\n                      fullWidth\r\n                    />\r\n                    <FormControl fullWidth>\r\n                      <InputLabel>Object Fit</InputLabel>\r\n                      <Select\r\n                        value={recordSettings.logo?.objectFit || 'contain'}\r\n                        onChange={(e) => setRecordSettings(prev => ({\r\n                          ...prev,\r\n                          logo: { ...prev.logo, objectFit: e.target.value }\r\n                        }))}\r\n                        label=\"Object Fit\"\r\n                      >\r\n                        <MenuItem value=\"contain\">Contain</MenuItem>\r\n                        <MenuItem value=\"cover\">Cover</MenuItem>\r\n                        <MenuItem value=\"fill\">Fill</MenuItem>\r\n                        <MenuItem value=\"none\">None</MenuItem>\r\n                      </Select>\r\n                    </FormControl>\r\n                    <Box>\r\n                      <Typography gutterBottom>Opacity: {recordSettings.logo?.opacity || 100}%</Typography>\r\n                      <Slider\r\n                        value={recordSettings.logo?.opacity || 100}\r\n                        onChange={(e, value) => setRecordSettings(prev => ({\r\n                          ...prev,\r\n                          logo: { ...prev.logo, opacity: value as number }\r\n                        }))}\r\n                        min={10}\r\n                        max={100}\r\n                        step={5}\r\n                      />\r\n                    </Box>\r\n                    <Button\r\n                      variant=\"outlined\"\r\n                      component=\"label\"\r\n                      startIcon={<CloudUploadIcon />}\r\n                      fullWidth\r\n                    >\r\n                      Upload Logo Image\r\n                      <input\r\n                        type=\"file\"\r\n                        hidden\r\n                        accept=\"image/*\"\r\n                        onChange={(e) => {\r\n                          const file = e.target.files?.[0];\r\n                          if (file) onImageUpload('logo', file);\r\n                        }}\r\n                      />\r\n                    </Button>\r\n                  </>\r\n                )}\r\n              </Stack>\r\n            )}\r\n\r\n            {/* Calendar Configuration */}\r\n            {configType === 'calendar' && (\r\n              <Stack spacing={2}>\r\n                <FormControlLabel\r\n                  control={\r\n                    <Switch\r\n                      checked={recordSettings.calendar?.enabled ?? true}\r\n                      onChange={(e) => setRecordSettings(prev => ({\r\n                        ...prev,\r\n                        calendar: { ...prev.calendar, enabled: e.target.checked }\r\n                      }))}\r\n                    />\r\n                  }\r\n                  label=\"Display Calendar Cards\"\r\n                />\r\n                {recordSettings.calendar?.enabled !== false && (\r\n                  <FormControl fullWidth>\r\n                    <InputLabel>Column Position</InputLabel>\r\n                    <Select\r\n                      value={recordSettings.calendar?.column || 2}\r\n                      onChange={(e) => setRecordSettings(prev => ({\r\n                        ...prev,\r\n                        calendar: { ...prev.calendar, column: Number(e.target.value) }\r\n                      }))}\r\n                      label=\"Column Position\"\r\n                    >\r\n                      <MenuItem value={1}>Column 1 (Left)</MenuItem>\r\n                      <MenuItem value={2}>Column 2</MenuItem>\r\n                      <MenuItem value={3}>Column 3</MenuItem>\r\n                      <MenuItem value={4}>Column 4 (Right)</MenuItem>\r\n                    </Select>\r\n                  </FormControl>\r\n                )}\r\n              </Stack>\r\n            )}\r\n\r\n            {/* OM Logo Configuration */}\r\n            {configType === 'omLogo' && (\r\n              <Stack spacing={2}>\r\n                <FormControlLabel\r\n                  control={\r\n                    <Switch\r\n                      checked={recordSettings.omLogo?.enabled ?? true}\r\n                      onChange={(e) => setRecordSettings(prev => ({\r\n                        ...prev,\r\n                        omLogo: { ...prev.omLogo, enabled: e.target.checked }\r\n                      }))}\r\n                    />\r\n                  }\r\n                  label=\"Display OM Logo\"\r\n                />\r\n                {recordSettings.omLogo?.enabled !== false && (\r\n                  <>\r\n                    <FormControl fullWidth>\r\n                      <InputLabel>Column Position</InputLabel>\r\n                      <Select\r\n                        value={recordSettings.omLogo?.column || 4}\r\n                        onChange={(e) => setRecordSettings(prev => ({\r\n                          ...prev,\r\n                          omLogo: { ...prev.omLogo, column: Number(e.target.value) }\r\n                        }))}\r\n                        label=\"Column Position\"\r\n                      >\r\n                        <MenuItem value={1}>Column 1 (Left)</MenuItem>\r\n                        <MenuItem value={2}>Column 2</MenuItem>\r\n                        <MenuItem value={3}>Column 3</MenuItem>\r\n                        <MenuItem value={4}>Column 4 (Right)</MenuItem>\r\n                      </Select>\r\n                    </FormControl>\r\n                    <TextField\r\n                      label=\"Width (px)\"\r\n                      type=\"number\"\r\n                      value={recordSettings.omLogo?.width || 68}\r\n                      onChange={(e) => setRecordSettings(prev => ({\r\n                        ...prev,\r\n                        omLogo: { ...prev.omLogo, width: Number(e.target.value) }\r\n                      }))}\r\n                      fullWidth\r\n                    />\r\n                    <TextField\r\n                      label=\"Height (px)\"\r\n                      type=\"number\"\r\n                      value={recordSettings.omLogo?.height || 68}\r\n                      onChange={(e) => setRecordSettings(prev => ({\r\n                        ...prev,\r\n                        omLogo: { ...prev.omLogo, height: Number(e.target.value) }\r\n                      }))}\r\n                      fullWidth\r\n                    />\r\n                    <FormControl fullWidth>\r\n                      <InputLabel>Object Fit</InputLabel>\r\n                      <Select\r\n                        value={recordSettings.omLogo?.objectFit || 'contain'}\r\n                        onChange={(e) => setRecordSettings(prev => ({\r\n                          ...prev,\r\n                          omLogo: { ...prev.omLogo, objectFit: e.target.value }\r\n                        }))}\r\n                        label=\"Object Fit\"\r\n                      >\r\n                        <MenuItem value=\"contain\">Contain</MenuItem>\r\n                        <MenuItem value=\"cover\">Cover</MenuItem>\r\n                        <MenuItem value=\"fill\">Fill</MenuItem>\r\n                        <MenuItem value=\"none\">None</MenuItem>\r\n                      </Select>\r\n                    </FormControl>\r\n                    <Box>\r\n                      <Typography gutterBottom>Opacity: {recordSettings.omLogo?.opacity || 100}%</Typography>\r\n                      <Slider\r\n                        value={recordSettings.omLogo?.opacity || 100}\r\n                        onChange={(e, value) => setRecordSettings(prev => ({\r\n                          ...prev,\r\n                          omLogo: { ...prev.omLogo, opacity: value as number }\r\n                        }))}\r\n                        min={10}\r\n                        max={100}\r\n                        step={5}\r\n                      />\r\n                    </Box>\r\n                    <Button\r\n                      variant=\"outlined\"\r\n                      component=\"label\"\r\n                      startIcon={<CloudUploadIcon />}\r\n                      fullWidth\r\n                    >\r\n                      Upload OM Logo\r\n                      <input\r\n                        type=\"file\"\r\n                        hidden\r\n                        accept=\"image/*\"\r\n                        onChange={(e) => {\r\n                          const file = e.target.files?.[0];\r\n                          if (file) onImageUpload('omLogo', file);\r\n                        }}\r\n                      />\r\n                    </Button>\r\n                  </>\r\n                )}\r\n              </Stack>\r\n            )}\r\n\r\n            {/* Record Image Configuration */}\r\n            {configType === 'recordImage' && (\r\n              <Stack spacing={2}>\r\n                <FormControlLabel\r\n                  control={\r\n                    <Switch\r\n                      checked={recordSettings.recordImages?.enabled !== false}\r\n                      onChange={(e) => setRecordSettings(prev => ({\r\n                        ...prev,\r\n                        recordImages: { ...prev.recordImages, enabled: e.target.checked }\r\n                      }))}\r\n                    />\r\n                  }\r\n                  label=\"Display Record Image\"\r\n                />\r\n                {recordSettings.recordImages?.enabled !== false && (\r\n                  <>\r\n                    <FormControl fullWidth>\r\n                      <InputLabel>Column Position</InputLabel>\r\n                      <Select\r\n                        value={recordSettings.recordImages?.column || 1}\r\n                        onChange={(e) => setRecordSettings(prev => ({\r\n                          ...prev,\r\n                          recordImages: { ...prev.recordImages, column: Number(e.target.value) }\r\n                        }))}\r\n                        label=\"Column Position\"\r\n                      >\r\n                        <MenuItem value={1}>Column 1 (Left)</MenuItem>\r\n                        <MenuItem value={2}>Column 2</MenuItem>\r\n                        <MenuItem value={3}>Column 3</MenuItem>\r\n                        <MenuItem value={4}>Column 4 (Right)</MenuItem>\r\n                      </Select>\r\n                    </FormControl>\r\n                    <TextField\r\n                      label=\"Width (px)\"\r\n                      type=\"number\"\r\n                      value={recordSettings.recordImages?.width || 60}\r\n                      onChange={(e) => setRecordSettings(prev => ({\r\n                        ...prev,\r\n                        recordImages: { ...prev.recordImages, width: Number(e.target.value) }\r\n                      }))}\r\n                      fullWidth\r\n                    />\r\n                    <TextField\r\n                      label=\"Height (px)\"\r\n                      type=\"number\"\r\n                      value={recordSettings.recordImages?.height || 60}\r\n                      onChange={(e) => setRecordSettings(prev => ({\r\n                        ...prev,\r\n                        recordImages: { ...prev.recordImages, height: Number(e.target.value) }\r\n                      }))}\r\n                      fullWidth\r\n                    />\r\n                    <FormControl fullWidth>\r\n                      <InputLabel>Object Fit</InputLabel>\r\n                      <Select\r\n                        value={recordSettings.recordImages?.objectFit || 'contain'}\r\n                        onChange={(e) => setRecordSettings(prev => ({\r\n                          ...prev,\r\n                          recordImages: { ...prev.recordImages, objectFit: e.target.value }\r\n                        }))}\r\n                        label=\"Object Fit\"\r\n                      >\r\n                        <MenuItem value=\"contain\">Contain</MenuItem>\r\n                        <MenuItem value=\"cover\">Cover</MenuItem>\r\n                        <MenuItem value=\"fill\">Fill</MenuItem>\r\n                        <MenuItem value=\"none\">None</MenuItem>\r\n                      </Select>\r\n                    </FormControl>\r\n                    <Box>\r\n                      <Typography gutterBottom>Border Width: {recordSettings.recordImages?.borderWidth || 3}px</Typography>\r\n                      <Slider\r\n                        value={recordSettings.recordImages?.borderWidth || 3}\r\n                        onChange={(e, value) => setRecordSettings(prev => ({\r\n                          ...prev,\r\n                          recordImages: { ...prev.recordImages, borderWidth: value as number }\r\n                        }))}\r\n                        min={0}\r\n                        max={10}\r\n                        step={1}\r\n                      />\r\n                    </Box>\r\n                    <Button\r\n                      variant=\"outlined\"\r\n                      component=\"label\"\r\n                      startIcon={<CloudUploadIcon />}\r\n                      fullWidth\r\n                    >\r\n                      Upload Record Image\r\n                      <input\r\n                        type=\"file\"\r\n                        hidden\r\n                        accept=\"image/*\"\r\n                        onChange={(e) => {\r\n                          const file = e.target.files?.[0];\r\n                          if (file) onImageUpload(recordType || 'baptism', file);\r\n                        }}\r\n                      />\r\n                    </Button>\r\n                  </>\r\n                )}\r\n              </Stack>\r\n            )}\r\n\r\n            {/* Background Image Configuration */}\r\n            {configType === 'backgroundImage' && (\r\n              <Stack spacing={2}>\r\n                <FormControlLabel\r\n                  control={\r\n                    <Switch\r\n                      checked={recordSettings.backgroundImage?.enabled ?? true}\r\n                      onChange={(e) => setRecordSettings(prev => ({\r\n                        ...prev,\r\n                        backgroundImage: { ...prev.backgroundImage, enabled: e.target.checked }\r\n                      }))}\r\n                    />\r\n                  }\r\n                  label=\"Display Background Image\"\r\n                />\r\n                {recordSettings.backgroundImage?.enabled !== false && (\r\n                  <>\r\n                    <FormControl fullWidth>\r\n                      <InputLabel>Background Size</InputLabel>\r\n                      <Select\r\n                        value={recordSettings.backgroundImage?.size || 'auto'}\r\n                        onChange={(e) => setRecordSettings(prev => ({\r\n                          ...prev,\r\n                          backgroundImage: { ...prev.backgroundImage, size: e.target.value }\r\n                        }))}\r\n                        label=\"Background Size\"\r\n                      >\r\n                        <MenuItem value=\"auto\">Auto (Repeat)</MenuItem>\r\n                        <MenuItem value=\"cover\">Cover</MenuItem>\r\n                        <MenuItem value=\"contain\">Contain</MenuItem>\r\n                        <MenuItem value=\"100% 100%\">Stretch</MenuItem>\r\n                      </Select>\r\n                    </FormControl>\r\n                    <FormControl fullWidth>\r\n                      <InputLabel>Background Position</InputLabel>\r\n                      <Select\r\n                        value={recordSettings.backgroundImage?.position || 'top left'}\r\n                        onChange={(e) => setRecordSettings(prev => ({\r\n                          ...prev,\r\n                          backgroundImage: { ...prev.backgroundImage, position: e.target.value }\r\n                        }))}\r\n                        label=\"Background Position\"\r\n                      >\r\n                        <MenuItem value=\"top left\">Top Left</MenuItem>\r\n                        <MenuItem value=\"top center\">Top Center</MenuItem>\r\n                        <MenuItem value=\"top right\">Top Right</MenuItem>\r\n                        <MenuItem value=\"center left\">Center Left</MenuItem>\r\n                        <MenuItem value=\"center center\">Center</MenuItem>\r\n                        <MenuItem value=\"center right\">Center Right</MenuItem>\r\n                        <MenuItem value=\"bottom left\">Bottom Left</MenuItem>\r\n                        <MenuItem value=\"bottom center\">Bottom Center</MenuItem>\r\n                        <MenuItem value=\"bottom right\">Bottom Right</MenuItem>\r\n                      </Select>\r\n                    </FormControl>\r\n                    <Box>\r\n                      <Typography gutterBottom>Opacity: {recordSettings.backgroundImage?.opacity || 100}%</Typography>\r\n                      <Slider\r\n                        value={recordSettings.backgroundImage?.opacity || 100}\r\n                        onChange={(e, value) => setRecordSettings(prev => ({\r\n                          ...prev,\r\n                          backgroundImage: { ...prev.backgroundImage, opacity: value as number }\r\n                        }))}\r\n                        min={0}\r\n                        max={100}\r\n                        step={5}\r\n                      />\r\n                    </Box>\r\n                    <Button\r\n                      variant=\"outlined\"\r\n                      component=\"label\"\r\n                      startIcon={<CloudUploadIcon />}\r\n                      fullWidth\r\n                    >\r\n                      Upload Background Image\r\n                      <input\r\n                        type=\"file\"\r\n                        hidden\r\n                        accept=\"image/*\"\r\n                        onChange={(e) => {\r\n                          const file = e.target.files?.[0];\r\n                          if (file) onImageUpload('bg', file);\r\n                        }}\r\n                      />\r\n                    </Button>\r\n                    <Typography variant=\"caption\" color=\"text.secondary\">\r\n                      Background image will be saved as: {churchId}-bg.png\r\n                    </Typography>\r\n                  </>\r\n                )}\r\n              </Stack>\r\n            )}\r\n\r\n            {/* G1 Image Configuration */}\r\n            {configType === 'g1Image' && (\r\n              <Stack spacing={2}>\r\n                <FormControlLabel\r\n                  control={\r\n                    <Switch\r\n                      checked={recordSettings.g1Image?.enabled ?? true}\r\n                      onChange={(e) => setRecordSettings(prev => ({\r\n                        ...prev,\r\n                        g1Image: { ...prev.g1Image, enabled: e.target.checked }\r\n                      }))}\r\n                    />\r\n                  }\r\n                  label=\"Display G1 Overlay\"\r\n                />\r\n                {recordSettings.g1Image?.enabled !== false && (\r\n                  <>\r\n                    <Typography variant=\"body2\" color=\"text.secondary\">\r\n                      The G1 overlay provides a gradient effect over the background image.\r\n                    </Typography>\r\n                    <FormControl fullWidth>\r\n                      <InputLabel>Overlay Size</InputLabel>\r\n                      <Select\r\n                        value={recordSettings.g1Image?.size || 'cover'}\r\n                        onChange={(e) => setRecordSettings(prev => ({\r\n                          ...prev,\r\n                          g1Image: { ...prev.g1Image, size: e.target.value }\r\n                        }))}\r\n                        label=\"Overlay Size\"\r\n                      >\r\n                        <MenuItem value=\"cover\">Cover</MenuItem>\r\n                        <MenuItem value=\"contain\">Contain</MenuItem>\r\n                        <MenuItem value=\"100% 100%\">Stretch</MenuItem>\r\n                      </Select>\r\n                    </FormControl>\r\n                    <FormControl fullWidth>\r\n                      <InputLabel>Overlay Position</InputLabel>\r\n                      <Select\r\n                        value={recordSettings.g1Image?.position || 'center'}\r\n                        onChange={(e) => setRecordSettings(prev => ({\r\n                          ...prev,\r\n                          g1Image: { ...prev.g1Image, position: e.target.value }\r\n                        }))}\r\n                        label=\"Overlay Position\"\r\n                      >\r\n                        <MenuItem value=\"top left\">Top Left</MenuItem>\r\n                        <MenuItem value=\"top center\">Top Center</MenuItem>\r\n                        <MenuItem value=\"top right\">Top Right</MenuItem>\r\n                        <MenuItem value=\"center left\">Center Left</MenuItem>\r\n                        <MenuItem value=\"center\">Center</MenuItem>\r\n                        <MenuItem value=\"center right\">Center Right</MenuItem>\r\n                        <MenuItem value=\"bottom left\">Bottom Left</MenuItem>\r\n                        <MenuItem value=\"bottom center\">Bottom Center</MenuItem>\r\n                        <MenuItem value=\"bottom right\">Bottom Right</MenuItem>\r\n                      </Select>\r\n                    </FormControl>\r\n                    <Box>\r\n                      <Typography gutterBottom>Opacity: {Math.round((recordSettings.g1Image?.opacity || 0.85) * 100)}%</Typography>\r\n                      <Slider\r\n                        value={(recordSettings.g1Image?.opacity || 0.85) * 100}\r\n                        onChange={(e, value) => setRecordSettings(prev => ({\r\n                          ...prev,\r\n                          g1Image: { ...prev.g1Image, opacity: (value as number) / 100 }\r\n                        }))}\r\n                        min={0}\r\n                        max={100}\r\n                        step={5}\r\n                      />\r\n                    </Box>\r\n                    <Button\r\n                      variant=\"outlined\"\r\n                      component=\"label\"\r\n                      startIcon={<CloudUploadIcon />}\r\n                      fullWidth\r\n                    >\r\n                      Upload G1 Overlay Image\r\n                      <input\r\n                        type=\"file\"\r\n                        hidden\r\n                        accept=\"image/*\"\r\n                        onChange={(e) => {\r\n                          const file = e.target.files?.[0];\r\n                          if (file) onImageUpload('g1', file);\r\n                        }}\r\n                      />\r\n                    </Button>\r\n                  </>\r\n                )}\r\n              </Stack>\r\n            )}\r\n          </Box>\r\n        </Box>\r\n      </Drawer>\r\n\r\n      {/* Image Replacement Dialog */}\r\n      <Dialog open={imageDialogOpen} onClose={() => setImageDialogOpen(false)} maxWidth=\"sm\" fullWidth>\r\n        <DialogTitle>\r\n          Upload Image\r\n          <IconButton\r\n            onClick={() => setImageDialogOpen(false)}\r\n            sx={{ position: 'absolute', right: 8, top: 8 }}\r\n          >\r\n            <CloseIcon />\r\n          </IconButton>\r\n        </DialogTitle>\r\n        <DialogContent>\r\n          <Stack spacing={2} sx={{ mt: 1 }}>\r\n            <Button\r\n              variant=\"outlined\"\r\n              component=\"label\"\r\n              startIcon={<CloudUploadIcon />}\r\n              fullWidth\r\n            >\r\n              Select Image File\r\n              <input\r\n                type=\"file\"\r\n                hidden\r\n                accept=\"image/*\"\r\n                onChange={(e) => {\r\n                  const file = e.target.files?.[0];\r\n                  if (file && imageType) {\r\n                    onImageUpload(imageType, file);\r\n                    setImageDialogOpen(false);\r\n                  }\r\n                }}\r\n              />\r\n            </Button>\r\n            <Box sx={{ textAlign: 'center', p: 2, border: '1px dashed', borderColor: 'divider', borderRadius: 1 }}>\r\n              <Typography variant=\"body2\" color=\"text.secondary\">\r\n                Current: {getImagePath(imageType || 'logo')}\r\n              </Typography>\r\n              <Box\r\n                component=\"img\"\r\n                src={getImagePath(imageType || 'logo')}\r\n                alt=\"Current\"\r\n                sx={{ maxWidth: '100%', maxHeight: 200, mt: 1, objectFit: 'contain' }}\r\n                onError={(e) => {\r\n                  (e.target as HTMLImageElement).style.display = 'none';\r\n                }}\r\n              />\r\n            </Box>\r\n          </Stack>\r\n        </DialogContent>\r\n        <DialogActions>\r\n          <Button onClick={() => setImageDialogOpen(false)}>Cancel</Button>\r\n        </DialogActions>\r\n      </Dialog>\r\n    </Box>\r\n  );\r\n};\r\n\r\nexport default RecordHeaderPreview;\r\n","import React, { useState, useEffect } from 'react';\r\nimport {\r\n  Box, Typography, TextField, Button, Table, TableBody, TableCell, TableContainer,\r\n  TableHead, TableRow, Paper, Alert, CircularProgress, Select, MenuItem, FormControl,\r\n  InputLabel, Stack, Card, CardContent, Divider, Checkbox, FormControlLabel, Radio,\r\n  RadioGroup, Chip, Tooltip, Tabs, Tab, Slider, Switch, Grid, IconButton, Dialog,\r\n  DialogTitle, DialogContent, DialogActions, useTheme,\r\n} from '@mui/material';\r\nimport {\r\n  Save as SaveIcon, Refresh as RefreshIcon, Cancel as CancelIcon, Storage as StorageIcon,\r\n  Visibility as VisibilityIcon, VisibilityOff as VisibilityOffIcon, Sort as SortIcon,\r\n  ArrowUpward as ArrowUpIcon, ArrowDownward as ArrowDownIcon, Settings as SettingsIcon,\r\n  Image as ImageIcon, CalendarToday as CalendarIcon, PhotoLibrary as PhotoLibraryIcon,\r\n  CloudUpload as CloudUploadIcon, Palette as PaletteIcon, Business as BusinessIcon,\r\n  Add as AddIcon, Delete as DeleteIcon, Download as DownloadIcon, Upload as UploadIcon,\r\n  ViewList as ViewListIcon, GridView as GridViewIcon, Search as SearchIcon,\r\n  ArrowBack as ArrowBackIcon,\r\n} from '@mui/icons-material';\r\nimport { useParams, useSearchParams, useNavigate } from 'react-router-dom';\r\nimport adminAPI from '@/api/admin.api';\r\nimport { enhancedTableStore, THEME_MAP, type LiturgicalThemeKey, type ThemeTokens, type FieldStyleRule, type Branding } from '@/store/enhancedTableStore';\r\nimport { useAuth } from '@/context/AuthContext';\r\nimport { fetchWithChurchContext } from '@/shared/lib/fetchWithChurchContext';\r\nimport RecordHeaderPreview from './RecordHeaderPreview';\r\n\r\ninterface Column {\r\n  column_name: string;\r\n  ordinal_position: number;\r\n  new_name: string;\r\n  is_visible: boolean;\r\n  is_sortable: boolean;\r\n}\r\n\r\ninterface ApiResponse {\r\n  columns: Array<{ column_name: string; ordinal_position: number }>;\r\n  mappings?: Record<string, string>;\r\n  field_settings?: {\r\n    visibility?: Record<string, boolean>;\r\n    sortable?: Record<string, boolean>;\r\n    default_sort_field?: string;\r\n    default_sort_direction?: 'asc' | 'desc';\r\n  };\r\n}\r\n\r\n// Sample data for Live Preview\r\nconst BAPTISM_RECORDS_PREVIEW = [\r\n  { id: 1, first_name: 'Paul', last_name: 'Harris', birth_date: '3/30/1952', reception_date: '2/4/1953', birthplace: 'New York', entry_type: 'Chrismation', sponsors: 'Katherine Owens; James Franklin', parents: 'Christopher Harris & Claire Franklin', clergy: 'Fr. Michael Taylor' },\r\n  { id: 2, first_name: 'Mary', last_name: 'Fletcher', birth_date: '8/13/1969', reception_date: '5/8/1970', birthplace: 'Detroit', entry_type: 'Baptism', sponsors: 'Jonathan Thompson; Mary Powers', parents: 'Andrew Fletcher & Madeline Warren', clergy: 'Fr. George Davis' },\r\n  { id: 3, first_name: 'Lydia', last_name: 'Richards', birth_date: '8/1/1950', reception_date: '2/10/1951', birthplace: 'Pittsburgh', entry_type: 'Baptism', sponsors: 'Luke Griffin; Olivia Richards', parents: 'Anna Richards & Laura Vaughn', clergy: 'Fr. Michael Brown' },\r\n];\r\n\r\nconst MARRIAGE_RECORDS_PREVIEW = [\r\n  { id: 1, married_date_name: '11/20/2004 Emily Griffin', last_name: 'Nathan Bennett', parents_groom: 'Olivia Griffin & Joseph Bates', parents: 'Charlotte Bennett & Victoria Ellis', witnesses: 'Daniel Ingram; James Ulrich', marriage_license: 'ML-720644', clergy: 'Fr. John Ta' },\r\n  { id: 2, married_date_name: '6/14/2008 Benjamin York', last_name: 'Mary Fletcher', parents_groom: 'James York & Naomi Ingram', parents: 'Rachel Fletcher & Elizabeth Quinn', witnesses: 'Samuel Underwood; Laura Ingram', marriage_license: 'ML-898207', clergy: 'Fr. Andrew' },\r\n  { id: 3, married_date_name: '8/19/1992 Samuel Richards', last_name: 'Philis Bishop', parents_groom: 'Gabriella Richards & Sarah Knight', parents: 'Mary Bishop & Caroline Ortega', witnesses: 'Elizabeth Walker; Matthew Warren', marriage_license: 'ML-890870', clergy: 'Fr. Michae' },\r\n  { id: 4, married_date_name: '9/3/1983 Mary Parker', last_name: 'Andrew Bennett', parents_groom: 'Katherine Parker & James Knight', parents: 'Joseph Bennett & Rebecca Reeves', witnesses: 'Laura Ingram; Luke Quinn', marriage_license: 'ML-735324', clergy: 'Fr. Andrew' },\r\n];\r\n\r\nconst FUNERAL_RECORDS_PREVIEW = [\r\n  { id: 1, date_of_deceased: '11/1/2068', date_of_burial: '11/3/2068', first_name: 'Adam', last_name: 'Ingram', age: 77, clergy: 'Fr. Andrew Taylor', burial_location: 'Resurrection Cemetery' },\r\n  { id: 2, date_of_deceased: '10/28/2040', date_of_burial: '11/5/2040', first_name: 'Joseph', last_name: 'Quinn', age: 53, clergy: 'Fr. Michael Brown', burial_location: 'St. George Cemetery' },\r\n  { id: 3, date_of_deceased: '9/23/2010', date_of_burial: '9/26/2010', first_name: 'Sarah', last_name: 'Griffin', age: 73, clergy: 'Fr. John Moore', burial_location: 'St. George Cemetery' },\r\n  { id: 4, date_of_deceased: '6/21/2040', date_of_burial: '6/26/2040', first_name: 'Peter', last_name: 'Walker', age: 44, clergy: 'Fr. Thomas Moore', burial_location: 'St. George Cemetery' },\r\n  { id: 5, date_of_deceased: '1/10/2012', date_of_burial: '1/18/2012', first_name: 'Benjamin', last_name: 'Morris', age: 53, clergy: 'Fr. Peter Brown', burial_location: 'Resurrection Cemetery' },\r\n  { id: 6, date_of_deceased: '3/24/2036', date_of_burial: '3/29/2036', first_name: 'Patrick', last_name: 'Powers', age: 50, clergy: 'Fr. Peter Taylor', burial_location: 'St. Nicholas Cemetery' },\r\n];\r\n\r\nconst FieldMapperPage: React.FC = () => {\r\n  const { id } = useParams<{ id: string }>();\r\n  const [searchParams, setSearchParams] = useSearchParams();\r\n  const navigate = useNavigate();\r\n  const theme = useTheme();\r\n  const { user } = useAuth();\r\n  \r\n  // Helper to ensure church ID is valid\r\n  const getValidChurchId = (churchId: any): number | null => {\r\n    if (churchId === null || churchId === undefined || churchId === '') return null;\r\n    const num = typeof churchId === 'string' ? parseInt(churchId, 10) : Number(churchId);\r\n    return !isNaN(num) && num > 0 ? num : null;\r\n  };\r\n  \r\n  // Get church ID from URL param, fallback to user's church_id if available\r\n  const urlChurchId = getValidChurchId(id);\r\n  const userChurchId = getValidChurchId(user?.church_id);\r\n  const churchId = urlChurchId || userChurchId;\r\n  \r\n  // Get table name from URL parameter, default to 'baptism_records'\r\n  const urlTableName = searchParams.get('table') || 'baptism_records';\r\n  const [tableName, setTableName] = useState<string>(urlTableName);\r\n  \r\n  // Map table name to record type for navigation\r\n  const getRecordType = (table: string): string => {\r\n    if (table === 'baptism_records') return 'baptism';\r\n    if (table === 'marriage_records') return 'marriage';\r\n    if (table === 'funeral_records') return 'funeral';\r\n    return 'baptism'; // default fallback\r\n  };\r\n  \r\n  // Handle back to records navigation\r\n  const handleBackToRecords = () => {\r\n    const recordType = getRecordType(urlTableName);\r\n    navigate(`/apps/records/${recordType}`);\r\n  };\r\n  const [rows, setRows] = useState<Column[]>([]);\r\n  const [defaultSortField, setDefaultSortField] = useState<string>('');\r\n  const [defaultSortDirection, setDefaultSortDirection] = useState<'asc' | 'desc'>('asc');\r\n  const [saving, setSaving] = useState<boolean>(false);\r\n  const [loading, setLoading] = useState<boolean>(false);\r\n  const [error, setError] = useState<string | null>(null);\r\n  const [success, setSuccess] = useState<string | null>(null);\r\n  const [activeTab, setActiveTab] = useState<number>(0);\r\n  // Church name state (for header display)\r\n  const [churchName, setChurchName] = useState<string>('');\r\n  \r\n  // Export to Template state\r\n  const [exportLanguage, setExportLanguage] = useState<string>('en');\r\n  const [exportDialogOpen, setExportDialogOpen] = useState<boolean>(false);\r\n  const [exporting, setExporting] = useState<boolean>(false);\r\n  const [exportOverwrite, setExportOverwrite] = useState<boolean>(false);\r\n  \r\n  // Record Settings State\r\n  const [recordSettings, setRecordSettings] = useState({\r\n    logo: {\r\n      enabled: true,\r\n      column: 3,\r\n      file: null as File | null,\r\n      width: 200,\r\n      height: 200,\r\n      objectFit: 'contain' as 'contain' | 'cover' | 'fill' | 'none' | 'scale-down',\r\n      opacity: 100,\r\n      quadrant: 'middle' as 'top' | 'middle' | 'bottom',\r\n      horizontalPosition: 'center' as 'left' | 'center' | 'right',\r\n    },\r\n    calendar: {\r\n      enabled: true,\r\n      column: 2,\r\n      quadrant: 'middle' as 'top' | 'middle' | 'bottom',\r\n      horizontalPosition: 'center' as 'left' | 'center' | 'right',\r\n    },\r\n    omLogo: {\r\n      enabled: true,\r\n      column: 4,\r\n      width: 68,\r\n      height: 68,\r\n      quadrant: 'middle' as 'top' | 'middle' | 'bottom',\r\n      horizontalPosition: 'center' as 'left' | 'center' | 'right',\r\n    },\r\n    headerText: {\r\n      fontFamily: 'Arial, sans-serif',\r\n      fontSize: 16,\r\n      fontWeight: 700,\r\n      color: '#4C1D95',\r\n      column: 1,\r\n      position: 'above', // 'above' or 'below' recordImage\r\n      quadrant: 'middle', // 'top', 'middle', or 'bottom'\r\n      horizontalPosition: 'center' as 'left' | 'center' | 'right',\r\n    },\r\n    recordImages: {\r\n      column: 1,\r\n      quadrant: 'middle', // 'top', 'middle', or 'bottom'\r\n      horizontalPosition: 'center' as 'left' | 'center' | 'right',\r\n      width: 160, // Width in pixels (default 160x160)\r\n      height: 160, // Height in pixels (default 160x160)\r\n    },\r\n    backgroundImage: {\r\n      enabled: true,\r\n      column: 0, // 0 means span all columns\r\n      images: [] as string[], // Array of image paths\r\n      currentIndex: 0,\r\n      quadrant: 'middle' as 'top' | 'middle' | 'bottom',\r\n    },\r\n    g1Image: {\r\n      enabled: true,\r\n      column: 0, // 0 means span all columns\r\n      images: [] as string[], // Array of image paths\r\n      currentIndex: 0,\r\n      quadrant: 'middle' as 'top' | 'middle' | 'bottom',\r\n    },\r\n    // Support for multiple images per type\r\n    imageLibrary: {\r\n      logo: [] as string[],\r\n      omLogo: [] as string[],\r\n      baptism: [] as string[],\r\n      marriage: [] as string[],\r\n      funeral: [] as string[],\r\n      bg: [] as string[],\r\n      g1: [] as string[],\r\n      recordImage: [] as string[], // General record images library\r\n    },\r\n    currentImageIndex: {\r\n      logo: 0,\r\n      omLogo: 0,\r\n      baptism: 0,\r\n      marriage: 0,\r\n      funeral: 0,\r\n      bg: 0,\r\n      g1: 0,\r\n      recordImage: 0,\r\n    },\r\n  });\r\n\r\n  // Dynamic Records Config State\r\n  const [dynamicConfig, setDynamicConfig] = useState<{\r\n    branding: Branding;\r\n    liturgicalTheme: LiturgicalThemeKey;\r\n    fieldRules: FieldStyleRule[];\r\n  }>({\r\n    branding: {\r\n      churchName: '',\r\n      logoUrl: undefined,\r\n      logoPreview: undefined,\r\n      logoAlign: 'left',\r\n      showBrandHeader: true,\r\n    },\r\n    liturgicalTheme: 'orthodox_traditional',\r\n    fieldRules: [],\r\n  });\r\n  \r\n  const [editingRule, setEditingRule] = useState<FieldStyleRule | null>(null);\r\n  const [ruleDialogOpen, setRuleDialogOpen] = useState(false);\r\n\r\n  // Theme Studio State\r\n  const [themeStudio, setThemeStudio] = useState<{\r\n    isGlobal: boolean;\r\n    themes: Record<string, ThemeTokens & { name: string; description?: string }>;\r\n    selectedTheme: string;\r\n  }>({\r\n    isGlobal: false,\r\n    themes: {},\r\n    selectedTheme: '',\r\n  });\r\n  \r\n  const [editingTheme, setEditingTheme] = useState<{\r\n    name: string;\r\n    description: string;\r\n    tokens: ThemeTokens;\r\n    isPreDefined?: boolean; // Track if editing a pre-defined theme\r\n    originalKey?: string; // Original key for pre-defined themes\r\n  } | null>(null);\r\n  const [themeDialogOpen, setThemeDialogOpen] = useState(false);\r\n  const [saveAsDialogOpen, setSaveAsDialogOpen] = useState(false);\r\n  const [newThemeName, setNewThemeName] = useState('');\r\n  const [previewTheme, setPreviewTheme] = useState<ThemeTokens | null>(null);\r\n  const [colorConfigDialogOpen, setColorConfigDialogOpen] = useState(false);\r\n  const [configuringColorKey, setConfiguringColorKey] = useState<keyof ThemeTokens | null>(null);\r\n  \r\n  // UI Theme State - for real-time preview updates\r\n  const [uiThemeState, setUiThemeState] = useState(enhancedTableStore.getState());\r\n  const [configuringButton, setConfiguringButton] = useState<string | null>(null);\r\n  const [configuringColumn, setConfiguringColumn] = useState<string | null>(null);\r\n\r\n  // Subscribe to enhancedTableStore changes for real-time preview updates\r\n  useEffect(() => {\r\n    const unsubscribe = enhancedTableStore.subscribe(() => {\r\n      setUiThemeState(enhancedTableStore.getState());\r\n      // Reset preview theme when store theme changes\r\n      setPreviewTheme(null);\r\n    });\r\n    return () => unsubscribe();\r\n  }, []);\r\n\r\n  // Load themes\r\n  const loadThemes = async (isGlobal: boolean) => {\r\n    if (!isGlobal && !churchId) {\r\n      console.error('Cannot load church themes: invalid church ID');\r\n      return;\r\n    }\r\n    \r\n    try {\r\n      const endpoint = isGlobal \r\n        ? '/api/admin/churches/themes/global'\r\n        : `/api/admin/churches/${churchId}/themes`;\r\n      \r\n      const response = await fetch(endpoint, {\r\n        credentials: 'include',\r\n      });\r\n      \r\n      if (response.ok) {\r\n        const data = await response.json();\r\n        if (data.themes) {\r\n          setThemeStudio(prev => ({\r\n            ...prev,\r\n            themes: data.themes,\r\n            isGlobal: isGlobal,\r\n          }));\r\n          \r\n          // Sync church-specific themes to enhancedTableStore so they appear in dropdown\r\n          if (!isGlobal) {\r\n            enhancedTableStore.setCustomThemes(data.themes);\r\n          }\r\n        } else {\r\n          // Initialize with empty themes\r\n          setThemeStudio(prev => ({\r\n            ...prev,\r\n            themes: {},\r\n            isGlobal: isGlobal,\r\n          }));\r\n          \r\n          // Clear custom themes if no themes found\r\n          if (!isGlobal) {\r\n            enhancedTableStore.setCustomThemes({});\r\n          }\r\n        }\r\n      } else {\r\n        // Initialize with empty themes\r\n        setThemeStudio(prev => ({\r\n          ...prev,\r\n          themes: {},\r\n          isGlobal: isGlobal,\r\n        }));\r\n        \r\n        // Clear custom themes if request failed\r\n        if (!isGlobal) {\r\n          enhancedTableStore.setCustomThemes({});\r\n        }\r\n      }\r\n    } catch (err) {\r\n      console.error('Error loading themes:', err);\r\n      setThemeStudio(prev => ({\r\n        ...prev,\r\n        themes: {},\r\n        isGlobal: isGlobal,\r\n      }));\r\n      \r\n      // Clear custom themes on error\r\n      if (!isGlobal) {\r\n        enhancedTableStore.setCustomThemes({});\r\n      }\r\n    }\r\n  };\r\n\r\n  // Save themes\r\n  const saveThemes = async () => {\r\n    if (!themeStudio.isGlobal && !churchId) {\r\n      setError('Invalid church ID. Cannot save themes.');\r\n      return;\r\n    }\r\n    \r\n    try {\r\n      setSaving(true);\r\n      setError(null);\r\n      setSuccess(null);\r\n\r\n      const endpoint = themeStudio.isGlobal\r\n        ? '/api/admin/churches/themes/global'\r\n        : `/api/admin/churches/${churchId}/themes`;\r\n\r\n      // Convert themes object/map to array for API\r\n      // themeStudio.themes is Record<string, ThemeTokens> - convert to Theme[]\r\n      const themesArray = Object.values(themeStudio.themes || {}).filter(theme => theme && theme.name);\r\n      \r\n      const response = await fetch(endpoint, {\r\n        method: 'POST',\r\n        headers: { 'Content-Type': 'application/json' },\r\n        credentials: 'include',\r\n        body: JSON.stringify({\r\n          themes: themesArray,\r\n        }),\r\n      });\r\n\r\n      if (!response.ok) {\r\n        const errorData = await response.json().catch(() => ({}));\r\n        throw new Error(errorData.error || 'Failed to save themes');\r\n      }\r\n\r\n      setSuccess(`Themes saved successfully as ${themeStudio.isGlobal ? 'global' : 'church-specific'} themes!`);\r\n      \r\n      // Also update enhancedTableStore with custom themes so they appear in dropdown\r\n      if (!themeStudio.isGlobal) {\r\n        // Only sync church-specific themes to the store\r\n        enhancedTableStore.setCustomThemes(themeStudio.themes);\r\n      }\r\n    } catch (err: any) {\r\n      console.error('Error saving themes:', err);\r\n      setError(err?.message || 'Failed to save themes');\r\n    } finally {\r\n      setSaving(false);\r\n    }\r\n  };\r\n\r\n  // Load themes on mount and when isGlobal changes\r\n  useEffect(() => {\r\n    if (churchId) {\r\n      loadThemes(themeStudio.isGlobal);\r\n    }\r\n  }, [churchId, themeStudio.isGlobal]);\r\n  \r\n  // Load custom themes from enhancedTableStore on mount\r\n  useEffect(() => {\r\n    const customThemes = enhancedTableStore.getCustomThemes();\r\n    if (customThemes && Object.keys(customThemes).length > 0 && !themeStudio.isGlobal) {\r\n      // Merge custom themes with loaded themes\r\n      setThemeStudio(prev => ({\r\n        ...prev,\r\n        themes: { ...prev.themes, ...customThemes },\r\n      }));\r\n    }\r\n  }, []);\r\n\r\n  // Load church info and dynamic records config\r\n  useEffect(() => {\r\n    const loadChurchInfoAndConfig = async () => {\r\n      if (!churchId) return;\r\n\r\n      try {\r\n        // Load church information\r\n        const churchResponse = await fetch(`/api/admin/churches/${churchId}`, {\r\n          credentials: 'include',\r\n        });\r\n        let loadedChurchName = '';\r\n        if (churchResponse.ok) {\r\n          const churchData = await churchResponse.json();\r\n          loadedChurchName = churchData.church?.church_name || churchData.church?.name || '';\r\n          setChurchName(loadedChurchName);\r\n        }\r\n\r\n        // Check if logo exists - try multiple methods\r\n        const logoUrl = `/images/records/${churchId}-logo.png`;\r\n        let logoExists = false;\r\n        try {\r\n          // Try HEAD request first\r\n          const logoCheck = await fetch(logoUrl, { method: 'HEAD', cache: 'no-cache' });\r\n          logoExists = logoCheck.ok;\r\n        } catch {\r\n          // If HEAD fails, try GET request\r\n          try {\r\n            const logoCheck = await fetch(logoUrl, { method: 'GET', cache: 'no-cache' });\r\n            logoExists = logoCheck.ok;\r\n          } catch {\r\n            // Logo doesn't exist or can't be checked\r\n            logoExists = false;\r\n          }\r\n        }\r\n\r\n        // Load dynamic records config\r\n        const configResponse = await fetch(`/api/admin/churches/${churchId}/dynamic-records-config`, {\r\n          credentials: 'include',\r\n        });\r\n        \r\n        if (configResponse.ok) {\r\n          const data = await configResponse.json();\r\n          if (data.config) {\r\n            // Merge with church info\r\n            setDynamicConfig(prev => ({\r\n              ...data.config,\r\n              branding: {\r\n                ...data.config.branding,\r\n                churchName: data.config.branding?.churchName || loadedChurchName,\r\n                logoUrl: data.config.branding?.logoUrl || (logoExists ? logoUrl : undefined),\r\n              },\r\n            }));\r\n          } else {\r\n            // Use defaults with church info\r\n            const storeState = enhancedTableStore.getState();\r\n            setDynamicConfig({\r\n              branding: {\r\n                ...storeState.branding,\r\n                churchName: loadedChurchName,\r\n                logoUrl: logoExists ? logoUrl : undefined,\r\n              },\r\n              liturgicalTheme: storeState.liturgicalTheme,\r\n              fieldRules: storeState.fieldRules,\r\n            });\r\n          }\r\n        } else {\r\n          // Use defaults with church info\r\n          const storeState = enhancedTableStore.getState();\r\n          setDynamicConfig({\r\n            branding: {\r\n              ...storeState.branding,\r\n              churchName: loadedChurchName,\r\n              logoUrl: logoExists ? logoUrl : undefined,\r\n            },\r\n            liturgicalTheme: storeState.liturgicalTheme,\r\n            fieldRules: storeState.fieldRules,\r\n          });\r\n        }\r\n      } catch (err) {\r\n        console.error('Error loading church info and dynamic records config:', err);\r\n        // Load from enhancedTableStore as fallback\r\n        const storeState = enhancedTableStore.getState();\r\n        setDynamicConfig({\r\n          branding: storeState.branding,\r\n          liturgicalTheme: storeState.liturgicalTheme,\r\n          fieldRules: storeState.fieldRules,\r\n        });\r\n      }\r\n    };\r\n    \r\n    if (churchId) {\r\n      loadChurchInfoAndConfig();\r\n    }\r\n  }, [churchId]);\r\n\r\n  // --- Load columns using adminAPI with smart backend fallbacks ---\r\n  const loadColumns = async () => {\r\n    if (!churchId) return;\r\n\r\n    try {\r\n      setLoading(true);\r\n      setError(null);\r\n      setSuccess(null);\r\n\r\n      // 1) Get column names (works across /admin and /api/admin variants)\r\n      const { columns: normalizedColumns } = await adminAPI.churches.getTableColumns(churchId, tableName);\r\n\r\n      // 2) Try to fetch existing mappings/settings (optional)\r\n      //    We probe two URLs; whichever returns JSON wins.\r\n      const mappingCandidates = [\r\n        `/admin/churches/${churchId}/field-mapper?table=${encodeURIComponent(tableName)}`,\r\n        `/api/admin/churches/${churchId}/field-mapper?table=${encodeURIComponent(tableName)}`,\r\n      ];\r\n\r\n      let mappingData: ApiResponse | null = null;\r\n      for (const url of mappingCandidates) {\r\n        try {\r\n          const res = await fetchWithChurchContext(url, { churchId, credentials: 'include' });\r\n          if (res.ok) {\r\n            mappingData = await res.json();\r\n            break;\r\n          }\r\n        } catch {\r\n          /* try next candidate */\r\n        }\r\n      }\r\n\r\n      const data: ApiResponse = mappingData ?? { columns: normalizedColumns.map((name, i) => ({ column_name: name, ordinal_position: i + 1 })) };\r\n\r\n      // 3) Map into UI rows with defaults\r\n      const rowsMapped: Column[] = (data.columns ?? normalizedColumns.map((name, i) => ({\r\n        column_name: name, ordinal_position: i + 1,\r\n      }))).map((col, idx) => {\r\n        const column_name = (col as any).column_name ?? (typeof col === 'string' ? col : `col_${idx + 1}`);\r\n        const ordinal_position = (col as any).ordinal_position ?? (idx + 1);\r\n\r\n        return {\r\n          column_name,\r\n          ordinal_position,\r\n          new_name: data.mappings?.[column_name] || '',\r\n          is_visible: data.field_settings?.visibility?.[column_name] ?? true,\r\n          is_sortable: data.field_settings?.sortable?.[column_name] ?? true,\r\n        };\r\n      });\r\n\r\n      setRows(rowsMapped);\r\n\r\n      if (data.field_settings?.default_sort_field) {\r\n        setDefaultSortField(data.field_settings.default_sort_field);\r\n      } else {\r\n        setDefaultSortField('');\r\n      }\r\n      if (data.field_settings?.default_sort_direction) {\r\n        setDefaultSortDirection(data.field_settings.default_sort_direction);\r\n      } else {\r\n        setDefaultSortDirection('asc');\r\n      }\r\n    } catch (err: any) {\r\n      console.error('Error loading columns:', err);\r\n      setError(err?.message || 'Failed to load columns');\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  // --- Export to Template handler ---\r\n  const handleExportToTemplate = async () => {\r\n    if (!churchId || !tableName) return;\r\n\r\n    try {\r\n      setExporting(true);\r\n      setError(null);\r\n      setSuccess(null);\r\n\r\n      // Generate slug and name\r\n      const slug = `${exportLanguage}_${tableName}`;\r\n      const recordType = getRecordType(tableName);\r\n      const langName = exportLanguage === 'en' ? 'English' : \r\n                      exportLanguage === 'gr' ? 'Greek' :\r\n                      exportLanguage === 'ru' ? 'Russian' :\r\n                      exportLanguage === 'ro' ? 'Romanian' :\r\n                      exportLanguage === 'ka' ? 'Georgian' : exportLanguage.toUpperCase();\r\n      const name = `${langName} ${recordType.charAt(0).toUpperCase() + recordType.slice(1)} Records`;\r\n\r\n      const response = await adminAPI.churches.exportTemplate(churchId, {\r\n        table: tableName,\r\n        language: exportLanguage,\r\n        template_slug: slug,\r\n        template_name: name,\r\n        overwrite: exportOverwrite\r\n      });\r\n\r\n      if (response.success) {\r\n        setSuccess(`Exported template: ${response.slug}`);\r\n        setExportDialogOpen(false);\r\n        setExportOverwrite(false);\r\n        setTimeout(() => setSuccess(null), 5000);\r\n      } else {\r\n        setError(response.error || 'Failed to export template');\r\n      }\r\n    } catch (err: any) {\r\n      console.error('Error exporting template:', err);\r\n      setError(err?.response?.data?.error || err?.message || 'Failed to export template');\r\n    } finally {\r\n      setExporting(false);\r\n    }\r\n  };\r\n\r\n  // --- Save mapping with a minimal dual-path fallback (/admin then /api/admin) ---\r\n  const handleSave = async () => {\r\n    if (!churchId) return;\r\n\r\n    try {\r\n      setSaving(true);\r\n      setError(null);\r\n      setSuccess(null);\r\n\r\n      const mapping: Record<string, string> = {};\r\n      const visibility: Record<string, boolean> = {};\r\n      const sortable: Record<string, boolean> = {};\r\n      rows.forEach((row) => {\r\n        if (row.new_name.trim()) mapping[row.column_name] = row.new_name.trim();\r\n        visibility[row.column_name] = row.is_visible;\r\n        sortable[row.column_name] = row.is_sortable;\r\n      });\r\n\r\n      const body = JSON.stringify({\r\n        table: tableName,\r\n        mapping,\r\n        field_settings: {\r\n          visibility,\r\n          sortable,\r\n          default_sort_field: defaultSortField,\r\n          default_sort_direction: defaultSortDirection,\r\n        },\r\n      });\r\n\r\n      const saveCandidates = [\r\n        `/api/admin/churches/${churchId}/field-mapper`,\r\n      ];\r\n\r\n      let ok = false;\r\n      let lastErr: any = null;\r\n      for (const url of saveCandidates) {\r\n        try {\r\n          const res = await fetchWithChurchContext(url, {\r\n            churchId,\r\n            method: 'POST',\r\n            headers: { 'Content-Type': 'application/json' },\r\n            credentials: 'include',\r\n            body,\r\n          });\r\n          if (res.ok) {\r\n            ok = true;\r\n            break;\r\n          } else {\r\n            const e = await res.json().catch(() => ({}));\r\n            lastErr = new Error(e?.error || `HTTP ${res.status}: ${res.statusText}`);\r\n          }\r\n        } catch (e) {\r\n          lastErr = e;\r\n        }\r\n      }\r\n      if (!ok) throw lastErr || new Error('Failed to save mapping');\r\n\r\n      setSuccess('Field mapping saved successfully!');\r\n\r\n      // Optional: notify opener\r\n      if (window.opener) {\r\n        try {\r\n          window.opener.postMessage(\r\n            { type: 'FIELD_MAPPING_SAVED', table: tableName, churchId, timestamp: new Date().toISOString() },\r\n            '*'\r\n          );\r\n        } catch {}\r\n      }\r\n\r\n      // Auto-close after 1.5s\r\n      setTimeout(() => window.close(), 1500);\r\n    } catch (err: any) {\r\n      console.error('Error saving mapping:', err);\r\n      setError(err?.message || 'Failed to save mapping');\r\n    } finally {\r\n      setSaving(false);\r\n    }\r\n  };\r\n\r\n  const handleCancel = () => window.close();\r\n\r\n  // Reset header settings to defaults (matching simple header: record image left, text center, no other elements)\r\n  const handleResetDefaults = () => {\r\n    if (!window.confirm('Are you sure you want to reset the header display to default settings? This will clear all customizations.')) {\r\n      return;\r\n    }\r\n\r\n    setRecordSettings({\r\n      logo: {\r\n        enabled: false, // Disabled - not shown in default simple header\r\n        column: 3,\r\n        file: null as File | null,\r\n        width: 200,\r\n        height: 200,\r\n        objectFit: 'contain' as 'contain' | 'cover' | 'fill' | 'none' | 'scale-down',\r\n        opacity: 100,\r\n        quadrant: 'middle' as 'top' | 'middle' | 'bottom',\r\n        horizontalPosition: 'center' as 'left' | 'center' | 'right',\r\n      },\r\n      calendar: {\r\n        enabled: false, // Disabled - not shown in default simple header\r\n        column: 2,\r\n        quadrant: 'middle' as 'top' | 'middle' | 'bottom',\r\n        horizontalPosition: 'center' as 'left' | 'center' | 'right',\r\n      },\r\n      omLogo: {\r\n        enabled: false, // Disabled - not shown in default simple header\r\n        column: 4,\r\n        width: 68,\r\n        height: 68,\r\n        quadrant: 'middle' as 'top' | 'middle' | 'bottom',\r\n        horizontalPosition: 'center' as 'left' | 'center' | 'right',\r\n      },\r\n      headerText: {\r\n        fontFamily: 'Arial, sans-serif',\r\n        fontSize: 16,\r\n        fontWeight: 700,\r\n        color: '#4C1D95',\r\n        column: 1, // Text spans across, centered\r\n        position: 'above',\r\n        quadrant: 'middle',\r\n        horizontalPosition: 'center' as 'left' | 'center' | 'right',\r\n      },\r\n      recordImages: {\r\n        column: 1, // Left side\r\n        quadrant: 'middle',\r\n        horizontalPosition: 'center' as 'left' | 'center' | 'right',\r\n        width: 160, // Updated to 160x160 px\r\n        height: 160, // Updated to 160x160 px\r\n      },\r\n      backgroundImage: {\r\n        enabled: true, // Enabled - gradient background\r\n        column: 0,\r\n        images: [] as string[],\r\n        currentIndex: 0,\r\n        quadrant: 'middle' as 'top' | 'middle' | 'bottom',\r\n      },\r\n      g1Image: {\r\n        enabled: true, // Enabled - overlay effect\r\n        column: 0,\r\n        images: [] as string[],\r\n        currentIndex: 0,\r\n        quadrant: 'middle' as 'top' | 'middle' | 'bottom',\r\n      },\r\n      imageLibrary: {\r\n        logo: [] as string[],\r\n        omLogo: [] as string[],\r\n        baptism: [] as string[],\r\n        marriage: [] as string[],\r\n        funeral: [] as string[],\r\n        bg: [] as string[],\r\n        g1: [] as string[],\r\n        recordImage: [] as string[],\r\n      },\r\n      currentImageIndex: {\r\n        logo: 0,\r\n        omLogo: 0,\r\n        baptism: 0,\r\n        marriage: 0,\r\n        funeral: 0,\r\n        bg: 0,\r\n        g1: 0,\r\n        recordImage: 0,\r\n      },\r\n    });\r\n\r\n    setSuccess('Header display reset to default settings. Click \"Save Record Settings\" to apply changes.');\r\n    setError(null);\r\n  };\r\n\r\n  const updateNewName = (columnName: string, newName: string) => {\r\n    setRows((prev) =>\r\n      prev.map((r) => (r.column_name === columnName ? { ...r, new_name: newName } : r))\r\n    );\r\n  };\r\n  const toggleColumnVisibility = (columnName: string) => {\r\n    setRows((prev) =>\r\n      prev.map((r) => (r.column_name === columnName ? { ...r, is_visible: !r.is_visible } : r))\r\n    );\r\n  };\r\n  const toggleColumnSortable = (columnName: string) => {\r\n    setRows((prev) =>\r\n      prev.map((r) => (r.column_name === columnName ? { ...r, is_sortable: !r.is_sortable } : r))\r\n    );\r\n  };\r\n\r\n  // Update tableName when URL parameter changes\r\n  useEffect(() => {\r\n    const urlTable = searchParams.get('table') || 'baptism_records';\r\n    if (urlTable !== tableName) {\r\n      setTableName(urlTable);\r\n      // Clear rows when table changes to avoid showing stale data\r\n      setRows([]);\r\n      setDefaultSortField('');\r\n      setDefaultSortDirection('asc');\r\n    }\r\n    // eslint-disable-next-line react-hooks/exhaustive-deps\r\n  }, [searchParams]);\r\n\r\n  // Load columns on mount and when table changes\r\n  useEffect(() => {\r\n    if (tableName) {\r\n      loadColumns();\r\n    }\r\n    // eslint-disable-next-line react-hooks/exhaustive-deps\r\n  }, [churchId, tableName]);\r\n\r\n  if (!churchId) {\r\n    return (\r\n      <Box p={3}>\r\n        <Alert severity=\"error\">\r\n          Invalid church ID. Please check the URL or ensure you have access to a church.\r\n          {user?.church_id && (\r\n            <Typography variant=\"body2\" sx={{ mt: 1 }}>\r\n              Your assigned church ID: {user.church_id}\r\n            </Typography>\r\n          )}\r\n        </Alert>\r\n      </Box>\r\n    );\r\n  }\r\n\r\n  // Handle logo file upload\r\n  const handleLogoUpload = (event: React.ChangeEvent<HTMLInputElement>) => {\r\n    const file = event.target.files?.[0];\r\n    if (file) {\r\n      // Validate it's an image\r\n      if (!file.type.startsWith('image/')) {\r\n        setError('Please upload an image file');\r\n        return;\r\n      }\r\n      setRecordSettings(prev => ({\r\n        ...prev,\r\n        logo: { ...prev.logo, file }\r\n      }));\r\n    }\r\n  };\r\n\r\n  // Handle image upload from preview component\r\n  const handleImageUpload = async (type: string, file: File) => {\r\n    if (!churchId) {\r\n      throw new Error('Invalid church ID. Cannot upload image.');\r\n    }\r\n    \r\n    if (!file.type.startsWith('image/')) {\r\n      throw new Error('Please upload an image file');\r\n    }\r\n\r\n    const formData = new FormData();\r\n    formData.append('image', file);\r\n    formData.append('type', type);\r\n    // churchId is already in the URL path, no need to include in formData\r\n\r\n    const response = await fetch(`/api/admin/churches/${churchId}/record-images`, {\r\n        method: 'POST',\r\n        credentials: 'include',\r\n        body: formData,\r\n      });\r\n\r\n      if (!response.ok) {\r\n        let errorMessage = 'Failed to upload image';\r\n      let errorDetails: any = null;\r\n      \r\n      // Try to get the response as text first (in case it's not JSON)\r\n      const responseText = await response.text();\r\n      \r\n      // Check if it's an HTML error page (nginx/apache)\r\n      if (responseText.trim().startsWith('<html') || responseText.trim().startsWith('<!DOCTYPE')) {\r\n        // Extract title from HTML if possible\r\n        const titleMatch = responseText.match(/<title>(.*?)<\\/title>/i);\r\n        const title = titleMatch ? titleMatch[1] : 'Internal Server Error';\r\n        \r\n        errorMessage = `Server error (${response.status}): ${title}. The server is experiencing issues. Please check the server logs or contact support.`;\r\n        \r\n        console.error('Received HTML error page instead of JSON:', {\r\n          status: response.status,\r\n          statusText: response.statusText,\r\n          htmlTitle: title,\r\n          responsePreview: responseText.substring(0, 300),\r\n        });\r\n      } else {\r\n        try {\r\n          // Try to parse as JSON\r\n          errorDetails = JSON.parse(responseText);\r\n          errorMessage = errorDetails.message || errorDetails.error || errorDetails.error?.message || errorMessage;\r\n        } catch (parseError) {\r\n          // If not JSON and not HTML, use the text response (but limit length)\r\n          if (responseText && responseText.trim() && responseText.length < 500) {\r\n            errorMessage = responseText.trim();\r\n          } else {\r\n          errorMessage = `Server error: ${response.status} ${response.statusText}`;\r\n        }\r\n        }\r\n      }\r\n      \r\n      // Log full error details for debugging (but don't include full HTML in message)\r\n      console.error('Upload error details:', {\r\n        status: response.status,\r\n        statusText: response.statusText,\r\n        errorDetails,\r\n        responsePreview: responseText.substring(0, 500),\r\n        isHtml: responseText.trim().startsWith('<html') || responseText.trim().startsWith('<!DOCTYPE'),\r\n      });\r\n      \r\n        throw new Error(errorMessage);\r\n      }\r\n\r\n      const result = await response.json();\r\n      const imageUrl = result.url || result.path || `/images/records/${churchId}-${type === 'logo' ? 'logo' : type === 'bg' ? 'bg' : type}.png`;\r\n      \r\n      // Add the new image to the image library\r\n      setRecordSettings(prev => {\r\n        const imageLibrary = prev.imageLibrary || {\r\n          logo: [],\r\n          omLogo: [],\r\n          baptism: [],\r\n          marriage: [],\r\n          funeral: [],\r\n          bg: [],\r\n          g1: [],\r\n          recordImage: [],\r\n        };\r\n        \r\n        const currentImages = imageLibrary[type as keyof typeof imageLibrary] || [];\r\n        const updatedImages = [...currentImages, imageUrl];\r\n        \r\n        // Update current index to the newly uploaded image\r\n        const currentImageIndex = prev.currentImageIndex || {\r\n          logo: 0,\r\n          omLogo: 0,\r\n          baptism: 0,\r\n          marriage: 0,\r\n          funeral: 0,\r\n          bg: 0,\r\n          g1: 0,\r\n          recordImage: 0,\r\n        };\r\n        \r\n        return {\r\n          ...prev,\r\n          imageLibrary: {\r\n            ...imageLibrary,\r\n            [type]: updatedImages,\r\n          },\r\n          currentImageIndex: {\r\n            ...currentImageIndex,\r\n            [type]: updatedImages.length - 1,\r\n          },\r\n          // Also update the file reference for logo\r\n          ...(type === 'logo' ? {\r\n            logo: { ...prev.logo, file }\r\n          } : {}),\r\n        };\r\n      });\r\n    \r\n    return imageUrl;\r\n  };\r\n\r\n  // Save record settings\r\n  const handleSaveRecordSettings = async () => {\r\n    if (!churchId) {\r\n      setError('Invalid church ID. Please check the URL and ensure you have access to this church.');\r\n      return;\r\n    }\r\n    \r\n    try {\r\n      setSaving(true);\r\n      setError(null);\r\n      setSuccess(null);\r\n\r\n      const formData = new FormData();\r\n      formData.append('settings', JSON.stringify({\r\n        logo: {\r\n          enabled: recordSettings.logo.enabled,\r\n          column: recordSettings.logo.column,\r\n          width: recordSettings.logo.width,\r\n          height: recordSettings.logo.height,\r\n          objectFit: recordSettings.logo.objectFit,\r\n          opacity: recordSettings.logo.opacity,\r\n          order: recordSettings.logo?.order ?? 0,\r\n          quadrant: recordSettings.logo?.quadrant || 'middle',\r\n          horizontalPosition: recordSettings.logo?.horizontalPosition || 'center',\r\n        },\r\n        calendar: {\r\n          ...recordSettings.calendar,\r\n          order: recordSettings.calendar?.order ?? 0,\r\n          quadrant: recordSettings.calendar?.quadrant || 'middle',\r\n          horizontalPosition: recordSettings.calendar?.horizontalPosition || 'center',\r\n        },\r\n        omLogo: {\r\n          ...recordSettings.omLogo,\r\n          order: recordSettings.omLogo?.order ?? 0,\r\n          quadrant: recordSettings.omLogo?.quadrant || 'middle',\r\n          horizontalPosition: recordSettings.omLogo?.horizontalPosition || 'center',\r\n          width: recordSettings.omLogo.width,\r\n          height: recordSettings.omLogo.height,\r\n        },\r\n        headerText: {\r\n          fontFamily: recordSettings.headerText?.fontFamily || 'Arial, sans-serif',\r\n          fontSize: recordSettings.headerText?.fontSize || 16,\r\n          fontWeight: recordSettings.headerText?.fontWeight || 700,\r\n          color: recordSettings.headerText?.color || '#4C1D95',\r\n          column: recordSettings.headerText?.column || 1,\r\n          order: recordSettings.headerText?.order ?? 0,\r\n          position: recordSettings.headerText?.position || 'above',\r\n          quadrant: recordSettings.headerText?.quadrant || 'middle',\r\n          horizontalPosition: recordSettings.headerText?.horizontalPosition || 'center',\r\n        },\r\n        recordImages: {\r\n          column: recordSettings.recordImages?.column || 1,\r\n          order: recordSettings.recordImages?.order ?? 0,\r\n          quadrant: recordSettings.recordImages?.quadrant || 'middle',\r\n          horizontalPosition: recordSettings.recordImages?.horizontalPosition || 'center',\r\n          width: recordSettings.recordImages?.width || 60,\r\n          height: recordSettings.recordImages?.height || 60,\r\n        },\r\n        backgroundImage: {\r\n          enabled: recordSettings.backgroundImage?.enabled ?? true,\r\n          column: recordSettings.backgroundImage?.column ?? 0,\r\n          order: recordSettings.backgroundImage?.order ?? 0,\r\n          quadrant: recordSettings.backgroundImage?.quadrant || 'middle',\r\n        },\r\n        g1Image: {\r\n          enabled: recordSettings.g1Image?.enabled ?? true,\r\n          column: recordSettings.g1Image?.column ?? 0,\r\n          order: recordSettings.g1Image?.order ?? 0,\r\n          quadrant: recordSettings.g1Image?.quadrant || 'middle',\r\n        },\r\n        imageLibrary: recordSettings.imageLibrary || {},\r\n        currentImageIndex: recordSettings.currentImageIndex || {},\r\n      }));\r\n\r\n      if (recordSettings.logo.file) {\r\n        formData.append('logo', recordSettings.logo.file);\r\n      }\r\n\r\n      const response = await fetchWithChurchContext(`/api/admin/churches/${churchId}/record-settings`, {\r\n        churchId,\r\n        method: 'POST',\r\n        credentials: 'include',\r\n        body: formData,\r\n      });\r\n\r\n      if (!response.ok) {\r\n        const errorData = await response.json().catch(() => ({}));\r\n        const errorMessage = errorData.message || errorData.error || `HTTP ${response.status}: ${response.statusText}`;\r\n        throw new Error(errorMessage);\r\n      }\r\n\r\n      const result = await response.json();\r\n      setSuccess('Record settings saved successfully!');\r\n      \r\n      // Reload settings to ensure preview is updated\r\n      if (churchId) {\r\n        const loadRecordSettings = async () => {\r\n          try {\r\n            const response = await fetch(`/api/admin/churches/${churchId}/record-settings`, {\r\n              credentials: 'include',\r\n              cache: 'no-cache',\r\n            });\r\n            if (response.ok) {\r\n              const data = await response.json();\r\n              if (data.settings) {\r\n                setRecordSettings(prev => ({\r\n                  ...prev,\r\n                  ...data.settings,\r\n                  logo: {\r\n                    ...prev.logo,\r\n                    ...(data.settings.logo || {}),\r\n                  },\r\n                  calendar: {\r\n                    ...prev.calendar,\r\n                    ...(data.settings.calendar || {}),\r\n                  },\r\n                  omLogo: {\r\n                    ...prev.omLogo,\r\n                    ...(data.settings.omLogo || {}),\r\n                  },\r\n                  headerText: {\r\n                    fontFamily: 'Arial, sans-serif',\r\n                    fontSize: 16,\r\n                    fontWeight: 700,\r\n                    color: '#4C1D95',\r\n                    ...(data.settings.headerText || {}),\r\n                    column: data.settings.headerText?.column ?? 1,\r\n                  },\r\n                  recordImages: {\r\n                    column: data.settings.recordImages?.column ?? 1,\r\n                    quadrant: data.settings.recordImages?.quadrant || 'middle',\r\n                    horizontalPosition: data.settings.recordImages?.horizontalPosition || 'center',\r\n                    width: data.settings.recordImages?.width ?? 160,\r\n                    height: data.settings.recordImages?.height ?? 160,\r\n                  },\r\n                  backgroundImage: {\r\n                    enabled: data.settings.backgroundImage?.enabled ?? true,\r\n                    column: data.settings.backgroundImage?.column ?? 0,\r\n                    images: data.settings.backgroundImage?.images || [],\r\n                    currentIndex: data.settings.backgroundImage?.currentIndex ?? 0,\r\n                    quadrant: data.settings.backgroundImage?.quadrant || 'middle',\r\n                  },\r\n                  g1Image: {\r\n                    enabled: data.settings.g1Image?.enabled ?? true,\r\n                    column: data.settings.g1Image?.column ?? 0,\r\n                    images: data.settings.g1Image?.images || [],\r\n                    currentIndex: data.settings.g1Image?.currentIndex ?? 0,\r\n                    quadrant: data.settings.g1Image?.quadrant || 'middle',\r\n                  },\r\n                  imageLibrary: {\r\n                    logo: data.settings.imageLibrary?.logo || [],\r\n                    omLogo: data.settings.imageLibrary?.omLogo || [],\r\n                    baptism: data.settings.imageLibrary?.baptism || [],\r\n                    marriage: data.settings.imageLibrary?.marriage || [],\r\n                    funeral: data.settings.imageLibrary?.funeral || [],\r\n                    bg: data.settings.imageLibrary?.bg || [],\r\n                    g1: data.settings.imageLibrary?.g1 || [],\r\n                    recordImage: data.settings.imageLibrary?.recordImage || [],\r\n                  },\r\n                  currentImageIndex: {\r\n                    logo: data.settings.currentImageIndex?.logo ?? 0,\r\n                    omLogo: data.settings.currentImageIndex?.omLogo ?? 0,\r\n                    baptism: data.settings.currentImageIndex?.baptism ?? 0,\r\n                    marriage: data.settings.currentImageIndex?.marriage ?? 0,\r\n                    funeral: data.settings.currentImageIndex?.funeral ?? 0,\r\n                    bg: data.settings.currentImageIndex?.bg ?? 0,\r\n                    g1: data.settings.currentImageIndex?.g1 ?? 0,\r\n                    recordImage: data.settings.currentImageIndex?.recordImage ?? 0,\r\n                  },\r\n                }));\r\n              }\r\n            }\r\n          } catch (err) {\r\n            console.error('Error reloading record settings:', err);\r\n          }\r\n        };\r\n        loadRecordSettings();\r\n      }\r\n      \r\n      // Dispatch custom event to notify other pages that settings have been updated\r\n      window.dispatchEvent(new CustomEvent('recordSettingsUpdated', { \r\n        detail: { churchId, timestamp: Date.now() } \r\n      }));\r\n      \r\n      // Clear the file from state after successful save\r\n      if (recordSettings.logo.file) {\r\n        setRecordSettings(prev => ({\r\n          ...prev,\r\n          logo: { ...prev.logo, file: null }\r\n        }));\r\n      }\r\n    } catch (err: any) {\r\n      console.error('Error saving record settings:', err);\r\n      setError(err?.message || 'Failed to save record settings');\r\n    } finally {\r\n      setSaving(false);\r\n    }\r\n  };\r\n\r\n  // Load record settings\r\n  useEffect(() => {\r\n    if (!churchId) {\r\n      setError('Invalid church ID. Please check the URL and ensure you have access to this church.');\r\n      return;\r\n    }\r\n    \r\n    const loadRecordSettings = async () => {\r\n      try {\r\n        const response = await fetchWithChurchContext(`/api/admin/churches/${churchId}/record-settings`, {\r\n          churchId,\r\n          credentials: 'include',\r\n        });\r\n        if (response.ok) {\r\n          const data = await response.json();\r\n          if (data.settings) {\r\n            // Merge loaded settings with defaults to ensure all properties exist\r\n            setRecordSettings(prev => ({\r\n              ...prev,\r\n              ...data.settings,\r\n              logo: {\r\n                ...prev.logo,\r\n                ...(data.settings.logo || {}),\r\n              },\r\n              calendar: {\r\n                ...prev.calendar,\r\n                ...(data.settings.calendar || {}),\r\n              },\r\n              omLogo: {\r\n                ...prev.omLogo,\r\n                ...(data.settings.omLogo || {}),\r\n              },\r\n              headerText: {\r\n                fontFamily: 'Arial, sans-serif',\r\n                fontSize: 16,\r\n                fontWeight: 700,\r\n                color: '#4C1D95',\r\n                x: 0,\r\n                y: 0,\r\n                ...(data.settings.headerText || {}),\r\n                column: data.settings.headerText?.column ?? 1,\r\n              },\r\n              recordImages: {\r\n                column: data.settings.recordImages?.column ?? 1,\r\n                // Handle both old format (baptism/marriage/funeral) and new format (x, y)\r\n                x: data.settings.recordImages?.x ?? data.settings.recordImages?.baptism?.x ?? 0,\r\n                y: data.settings.recordImages?.y ?? data.settings.recordImages?.baptism?.y ?? 0,\r\n                width: data.settings.recordImages?.width ?? 60,\r\n                height: data.settings.recordImages?.height ?? 60,\r\n              },\r\n              backgroundImage: {\r\n                enabled: true,\r\n                column: 0,\r\n                images: [],\r\n                currentIndex: 0,\r\n                ...(data.settings.backgroundImage || {}),\r\n              },\r\n              g1Image: {\r\n                enabled: true,\r\n                column: 0,\r\n                images: [],\r\n                currentIndex: 0,\r\n                ...(data.settings.g1Image || {}),\r\n              },\r\n              imageLibrary: {\r\n                logo: [],\r\n                omLogo: [],\r\n                baptism: [],\r\n                marriage: [],\r\n                funeral: [],\r\n                bg: [],\r\n                g1: [],\r\n                ...(data.settings.imageLibrary || {}),\r\n              },\r\n              currentImageIndex: {\r\n                logo: 0,\r\n                omLogo: 0,\r\n                baptism: 0,\r\n                marriage: 0,\r\n                funeral: 0,\r\n                bg: 0,\r\n                g1: 0,\r\n                ...(data.settings.currentImageIndex || {}),\r\n              },\r\n            }));\r\n          }\r\n        }\r\n      } catch (err) {\r\n        console.error('Error loading record settings:', err);\r\n      }\r\n    };\r\n    if (churchId) {\r\n      loadRecordSettings();\r\n    }\r\n  }, [churchId]);\r\n\r\n  return (\r\n    <Box sx={{ p: 3, minHeight: '100vh', bgcolor: theme.palette.background.default }}>\r\n      <Card sx={{ bgcolor: theme.palette.background.paper }}>\r\n        <CardContent>\r\n          <Box sx={{ mb: 3 }}>\r\n            <Typography variant=\"h4\" gutterBottom sx={{ display: 'flex', alignItems: 'center', gap: 1 }}>\r\n              <StorageIcon color=\"primary\" />\r\n              Record Table Configuration\r\n            </Typography>\r\n            <Typography variant=\"body2\" color=\"text.secondary\">\r\n              Configure database mappings and record display settings for church ID {churchId}\r\n            </Typography>\r\n          </Box>\r\n\r\n          <Divider sx={{ mb: 3 }} />\r\n\r\n          {/* Tabs */}\r\n          <Box sx={{ borderBottom: 1, borderColor: 'divider', mb: 3 }}>\r\n            <Tabs value={activeTab} onChange={(e, newValue) => setActiveTab(newValue)}>\r\n              <Tab \r\n                icon={<StorageIcon />} \r\n                iconPosition=\"start\"\r\n                label=\"Database  Table Mapping\" \r\n                sx={{ textTransform: 'none', minHeight: 64 }}\r\n              />\r\n              <Tab \r\n                icon={<SettingsIcon />} \r\n                iconPosition=\"start\"\r\n                label=\"Record Settings\" \r\n                sx={{ textTransform: 'none', minHeight: 64 }}\r\n              />\r\n              <Tab \r\n                icon={<PaletteIcon />} \r\n                iconPosition=\"start\"\r\n                label=\"Theme Studio\" \r\n                sx={{ textTransform: 'none', minHeight: 64 }}\r\n              />\r\n              <Tab \r\n                icon={<SettingsIcon />} \r\n                iconPosition=\"start\"\r\n                label=\"UI Theme\" \r\n                sx={{ textTransform: 'none', minHeight: 64 }}\r\n              />\r\n            </Tabs>\r\n          </Box>\r\n\r\n          {/* Tab Panel 0: Database  Table Mapping */}\r\n          {activeTab === 0 && (\r\n            <Box>\r\n\r\n          {/* Table Selection and Reload */}\r\n          <Stack direction=\"row\" spacing={2} sx={{ mb: 3 }} alignItems=\"center\" flexWrap=\"wrap\">\r\n            <FormControl sx={{ minWidth: 200 }}>\r\n              <InputLabel>Select Table</InputLabel>\r\n              <Select\r\n                value={tableName}\r\n                onChange={(e) => {\r\n                  const newTableName = e.target.value;\r\n                  setTableName(newTableName);\r\n                  // Update URL to keep it in sync\r\n                  const newSearchParams = new URLSearchParams(searchParams);\r\n                  newSearchParams.set('table', newTableName);\r\n                  setSearchParams(newSearchParams, { replace: true });\r\n                }}\r\n                label=\"Select Table\"\r\n                disabled={loading || saving}\r\n              >\r\n                <MenuItem value=\"baptism_records\">baptism_records</MenuItem>\r\n                <MenuItem value=\"marriage_records\">marriage_records</MenuItem>\r\n                <MenuItem value=\"funeral_records\">funeral_records</MenuItem>\r\n                <MenuItem value=\"members\">members</MenuItem>\r\n                <MenuItem value=\"families\">families</MenuItem>\r\n                <MenuItem value=\"donations\">donations</MenuItem>\r\n              </Select>\r\n            </FormControl>\r\n\r\n            <Button\r\n              variant=\"outlined\"\r\n              startIcon={loading ? <CircularProgress size={16} /> : <RefreshIcon />}\r\n              onClick={loadColumns}\r\n              disabled={loading || saving}\r\n            >\r\n              Reload Columns\r\n            </Button>\r\n\r\n            {/* Export to Template Button */}\r\n            <FormControl size=\"small\" sx={{ minWidth: 100 }}>\r\n              <InputLabel>Language</InputLabel>\r\n              <Select\r\n                value={exportLanguage}\r\n                onChange={(e) => setExportLanguage(e.target.value)}\r\n                label=\"Language\"\r\n                disabled={loading || saving || exporting}\r\n              >\r\n                <MenuItem value=\"en\">English (en)</MenuItem>\r\n                <MenuItem value=\"gr\">Greek (gr)</MenuItem>\r\n                <MenuItem value=\"ru\">Russian (ru)</MenuItem>\r\n                <MenuItem value=\"ro\">Romanian (ro)</MenuItem>\r\n                <MenuItem value=\"ka\">Georgian (ka)</MenuItem>\r\n              </Select>\r\n            </FormControl>\r\n\r\n            <Button\r\n              variant=\"contained\"\r\n              color=\"primary\"\r\n              startIcon={exporting ? <CircularProgress size={16} /> : <DownloadIcon />}\r\n              onClick={() => setExportDialogOpen(true)}\r\n              disabled={loading || saving || exporting || rows.length === 0}\r\n            >\r\n              Export to Template\r\n            </Button>\r\n          </Stack>\r\n\r\n          {/* Warning Banner for Export */}\r\n          <Alert severity=\"warning\" sx={{ mb: 2, mt: 2 }}>\r\n            <Typography variant=\"body2\">\r\n              <strong>Export to Template:</strong> This exports the current table schema and field mapper configuration \r\n              into a <strong>global template</strong> that will be available to all churches. Only use this for \r\n              standardized, production-ready configurations. Church-specific customizations should not be exported.\r\n            </Typography>\r\n          </Alert>\r\n\r\n          {/* Status Messages */}\r\n          {error && <Alert severity=\"error\" sx={{ mb: 2 }}>{error}</Alert>}\r\n          {success && <Alert severity=\"success\" sx={{ mb: 2 }}>{success}</Alert>}\r\n\r\n          {/* Loading State */}\r\n          {loading && (\r\n            <Box display=\"flex\" justifyContent=\"center\" alignItems=\"center\" py={4}>\r\n              <CircularProgress />\r\n              <Typography sx={{ ml: 2 }}>Loading columns...</Typography>\r\n            </Box>\r\n          )}\r\n\r\n          {/* Mapping Table */}\r\n          {!loading && rows.length > 0 && (\r\n            <>\r\n              {/* Sort Settings Section */}\r\n              <Card variant=\"outlined\" sx={{ mb: 3, p: 2, bgcolor: theme.palette.background.paper }}>\r\n                <Typography variant=\"h6\" gutterBottom sx={{ display: 'flex', alignItems: 'center', gap: 1 }}>\r\n                  <SortIcon color=\"primary\" />\r\n                  Default Sort Settings\r\n                </Typography>\r\n                <Stack direction=\"row\" spacing={3} alignItems=\"center\" flexWrap=\"wrap\">\r\n                  <FormControl sx={{ minWidth: 200 }}>\r\n                    <InputLabel>Default Sort Field</InputLabel>\r\n                    <Select\r\n                      value={defaultSortField}\r\n                      onChange={(e) => setDefaultSortField(e.target.value)}\r\n                      label=\"Default Sort Field\"\r\n                      disabled={saving}\r\n                    >\r\n                      <MenuItem value=\"\">\r\n                        <em>No default sort</em>\r\n                      </MenuItem>\r\n                      {rows.filter(r => r.is_visible && r.is_sortable).map((r) => (\r\n                        <MenuItem key={r.column_name} value={r.column_name}>\r\n                          {r.new_name || r.column_name}\r\n                        </MenuItem>\r\n                      ))}\r\n                    </Select>\r\n                  </FormControl>\r\n\r\n                  {defaultSortField && (\r\n                    <FormControl component=\"fieldset\">\r\n                      <RadioGroup\r\n                        row\r\n                        value={defaultSortDirection}\r\n                        onChange={(e) => setDefaultSortDirection(e.target.value as 'asc' | 'desc')}\r\n                      >\r\n                        <FormControlLabel\r\n                          value=\"asc\"\r\n                          control={<Radio size=\"small\" />}\r\n                          label={<Box sx={{ display: 'flex', alignItems: 'center', gap: 0.5 }}><ArrowUpIcon fontSize=\"small\" /> Ascending</Box>}\r\n                          disabled={saving}\r\n                        />\r\n                        <FormControlLabel\r\n                          value=\"desc\"\r\n                          control={<Radio size=\"small\" />}\r\n                          label={<Box sx={{ display: 'flex', alignItems: 'center', gap: 0.5 }}><ArrowDownIcon fontSize=\"small\" /> Descending</Box>}\r\n                          disabled={saving}\r\n                        />\r\n                      </RadioGroup>\r\n                    </FormControl>\r\n                  )}\r\n                </Stack>\r\n              </Card>\r\n\r\n              {/* Live Preview */}\r\n              <Card variant=\"outlined\" sx={{ mb: 3, p: 3, bgcolor: theme.palette.background.paper }}>\r\n                <Typography variant=\"h6\" gutterBottom sx={{ mb: 2 }}>\r\n                  Live Preview - {tableName}\r\n                </Typography>\r\n                <Typography variant=\"body2\" color=\"text.secondary\" sx={{ mb: 2 }}>\r\n                  Double-click any column header to configure Visible, Sortable, and Default Sort settings.\r\n                </Typography>\r\n                <Box\r\n                  sx={{\r\n                    border: `2px dashed ${theme.palette.divider}`,\r\n                    borderRadius: 2,\r\n                    p: 2,\r\n                    bgcolor: theme.palette.background.paper,\r\n                    overflow: 'auto',\r\n                    maxHeight: 400,\r\n                  }}\r\n                >\r\n                  <TableContainer>\r\n                    <Table size=\"small\" stickyHeader>\r\n                      <TableHead>\r\n                        <TableRow sx={{ bgcolor: theme.palette.action.hover }}>\r\n                          {rows.filter(r => r.is_visible).map((row) => {\r\n                            const fullRow = rows.find(r => r.column_name === row.column_name);\r\n                            return (\r\n                              <TableCell\r\n                                key={row.column_name}\r\n                                onDoubleClick={() => {\r\n                                  setConfiguringColumn(row.column_name);\r\n                                }}\r\n                                sx={{\r\n                                  cursor: 'pointer',\r\n                                  userSelect: 'none',\r\n                                  '&:hover': {\r\n                                    bgcolor: 'action.hover',\r\n                                  },\r\n                                }}\r\n                              >\r\n                                <Tooltip title=\"Double-click to configure\">\r\n                                  <Box sx={{ display: 'flex', alignItems: 'center', gap: 0.5 }}>\r\n                                    <Typography variant=\"subtitle2\" fontWeight=\"bold\">\r\n                                      {fullRow?.new_name || row.column_name}\r\n                                    </Typography>\r\n                                    {fullRow?.is_sortable && <SortIcon fontSize=\"small\" color=\"action\" />}\r\n                                    {defaultSortField === row.column_name && (\r\n                                      <Box sx={{ display: 'flex', alignItems: 'center', gap: 0.5 }}>\r\n                                        {defaultSortDirection === 'asc' ? <ArrowUpIcon fontSize=\"small\" color=\"primary\" /> : <ArrowDownIcon fontSize=\"small\" color=\"primary\" />}\r\n                                      </Box>\r\n                                    )}\r\n                                  </Box>\r\n                                </Tooltip>\r\n                              </TableCell>\r\n                            );\r\n                          })}\r\n                        </TableRow>\r\n                      </TableHead>\r\n                      <TableBody>\r\n                        {(() => {\r\n                          let previewData: any[] = [];\r\n                          let columnMap: Record<string, string> = {};\r\n                          \r\n                          if (tableName === 'baptism_records') {\r\n                            previewData = BAPTISM_RECORDS_PREVIEW;\r\n                            columnMap = {\r\n                              'id': 'id',\r\n                              'first_name': 'first_name',\r\n                              'last_name': 'last_name',\r\n                              'birth_date': 'birth_date',\r\n                              'reception_date': 'reception_date',\r\n                              'birthplace': 'birthplace',\r\n                              'entry_type': 'entry_type',\r\n                              'sponsors': 'sponsors',\r\n                              'parents': 'parents',\r\n                              'clergy': 'clergy',\r\n                            };\r\n                          } else if (tableName === 'marriage_records') {\r\n                            previewData = MARRIAGE_RECORDS_PREVIEW;\r\n                            columnMap = {\r\n                              'id': 'id',\r\n                              'married_date_name': 'married_date_name',\r\n                              'last_name': 'last_name',\r\n                              'parents_groom': 'parents_groom',\r\n                              'parents': 'parents',\r\n                              'witnesses': 'witnesses',\r\n                              'marriage_license': 'marriage_license',\r\n                              'clergy': 'clergy',\r\n                            };\r\n                          } else if (tableName === 'funeral_records') {\r\n                            previewData = FUNERAL_RECORDS_PREVIEW;\r\n                            columnMap = {\r\n                              'id': 'id',\r\n                              'date_of_deceased': 'date_of_deceased',\r\n                              'date_of_burial': 'date_of_burial',\r\n                              'first_name': 'first_name',\r\n                              'last_name': 'last_name',\r\n                              'age': 'age',\r\n                              'clergy': 'clergy',\r\n                              'burial_location': 'burial_location',\r\n                            };\r\n                          }\r\n                          \r\n                          if (previewData.length === 0) {\r\n                            // Fallback to sample data for other tables\r\n                            return [1, 2, 3].map((idx) => (\r\n                              <TableRow key={idx}>\r\n                                {rows.filter(r => r.is_visible).map((row) => (\r\n                                  <TableCell key={row.column_name}>\r\n                                    <Typography variant=\"body2\" color=\"text.secondary\">\r\n                                      Sample {row.new_name || row.column_name}\r\n                                    </Typography>\r\n                                  </TableCell>\r\n                                ))}\r\n                              </TableRow>\r\n                            ));\r\n                          }\r\n                          \r\n                          return previewData.map((rowData) => (\r\n                            <TableRow key={rowData.id}>\r\n                              {rows.filter(r => r.is_visible).map((row) => {\r\n                                const dataKey = columnMap[row.column_name];\r\n                                const cellValue = dataKey ? rowData[dataKey] : '';\r\n                                return (\r\n                                  <TableCell key={row.column_name}>\r\n                                    <Typography variant=\"body2\" color=\"text.secondary\">\r\n                                      {cellValue || '-'}\r\n                                    </Typography>\r\n                                  </TableCell>\r\n                                );\r\n                              })}\r\n                            </TableRow>\r\n                          ));\r\n                        })()}\r\n                      </TableBody>\r\n                    </Table>\r\n                  </TableContainer>\r\n                </Box>\r\n              </Card>\r\n\r\n              <TableContainer component={Paper} variant=\"outlined\" sx={{ mb: 3 }}>\r\n                <Table size=\"small\">\r\n                  <TableHead>\r\n                    <TableRow sx={{ bgcolor: theme.palette.background.paper }}>\r\n                      <TableCell><Typography variant=\"subtitle2\" fontWeight=\"bold\">Column Name</Typography></TableCell>\r\n                      <TableCell align=\"center\"><Typography variant=\"subtitle2\" fontWeight=\"bold\">Column #</Typography></TableCell>\r\n                      <TableCell><Typography variant=\"subtitle2\" fontWeight=\"bold\">New Column Name</Typography></TableCell>\r\n                      <TableCell align=\"center\">\r\n                        <Tooltip title=\"Show/hide this column in data grids\">\r\n                          <Typography variant=\"subtitle2\" fontWeight=\"bold\" sx={{ display: 'flex', alignItems: 'center', gap: 0.5, justifyContent: 'center' }}>\r\n                            <VisibilityIcon fontSize=\"small\" /> Visible\r\n                          </Typography>\r\n                        </Tooltip>\r\n                      </TableCell>\r\n                      <TableCell align=\"center\">\r\n                        <Tooltip title=\"Allow sorting by this column\">\r\n                          <Typography variant=\"subtitle2\" fontWeight=\"bold\" sx={{ display: 'flex', alignItems: 'center', gap: 0.5, justifyContent: 'center' }}>\r\n                            <SortIcon fontSize=\"small\" /> Sortable\r\n                          </Typography>\r\n                        </Tooltip>\r\n                      </TableCell>\r\n                      <TableCell align=\"center\">\r\n                        <Tooltip title=\"Set as default sort field\">\r\n                          <Typography variant=\"subtitle2\" fontWeight=\"bold\" sx={{ display: 'flex', alignItems: 'center', gap: 0.5, justifyContent: 'center' }}>\r\n                            <SortIcon fontSize=\"small\" color=\"primary\" /> Default Sort\r\n                          </Typography>\r\n                        </Tooltip>\r\n                      </TableCell>\r\n                    </TableRow>\r\n                  </TableHead>\r\n                  <TableBody>\r\n                    {rows.map((row) => (\r\n                      <TableRow key={row.column_name} hover>\r\n                        <TableCell>\r\n                          <Typography variant=\"body2\" sx={{ fontFamily: 'monospace', fontSize: '0.875rem', color: 'text.primary' }}>\r\n                            {row.column_name}\r\n                          </Typography>\r\n                        </TableCell>\r\n                        <TableCell align=\"center\">\r\n                          <Typography variant=\"body2\" color=\"text.secondary\">{row.ordinal_position}</Typography>\r\n                        </TableCell>\r\n                        <TableCell>\r\n                          <TextField\r\n                            fullWidth size=\"small\" variant=\"outlined\" value={row.new_name}\r\n                            onChange={(e) => updateNewName(row.column_name, e.target.value)}\r\n                            placeholder={`Display name for ${row.column_name}`}\r\n                            disabled={saving} sx={{ minWidth: 200 }}\r\n                          />\r\n                        </TableCell>\r\n                        <TableCell align=\"center\">\r\n                          <Checkbox\r\n                            checked={row.is_visible}\r\n                            onChange={() => toggleColumnVisibility(row.column_name)}\r\n                            disabled={saving}\r\n                            color=\"primary\" icon={<VisibilityOffIcon />} checkedIcon={<VisibilityIcon />}\r\n                          />\r\n                        </TableCell>\r\n                        <TableCell align=\"center\">\r\n                          <Checkbox\r\n                            checked={row.is_sortable}\r\n                            onChange={() => toggleColumnSortable(row.column_name)}\r\n                            disabled={saving || !row.is_visible}\r\n                            color=\"primary\"\r\n                          />\r\n                        </TableCell>\r\n                        <TableCell align=\"center\">\r\n                          <Radio\r\n                            checked={defaultSortField === row.column_name}\r\n                            onChange={() => setDefaultSortField(row.column_name)}\r\n                            disabled={saving || !row.is_visible || !row.is_sortable}\r\n                            color=\"primary\" size=\"small\"\r\n                          />\r\n                        </TableCell>\r\n                      </TableRow>\r\n                    ))}\r\n                  </TableBody>\r\n                </Table>\r\n              </TableContainer>\r\n\r\n              {/* Stats Summary */}\r\n              <Box sx={{ mb: 3 }}>\r\n                <Stack direction=\"row\" spacing={2} flexWrap=\"wrap\">\r\n                  <Chip icon={<VisibilityIcon />} label={`${rows.filter(r => r.is_visible).length} visible columns`} color=\"primary\" variant=\"outlined\" />\r\n                  <Chip icon={<SortIcon />} label={`${rows.filter(r => r.is_sortable && r.is_visible).length} sortable columns`} color=\"secondary\" variant=\"outlined\" />\r\n                  {defaultSortField && (\r\n                    <Chip\r\n                      icon={defaultSortDirection === 'asc' ? <ArrowUpIcon /> : <ArrowDownIcon />}\r\n                      label={`Default: ${rows.find(r => r.column_name === defaultSortField)?.new_name || defaultSortField} (${defaultSortDirection.toUpperCase()})`}\r\n                      color=\"success\"\r\n                      variant=\"outlined\"\r\n                    />\r\n                  )}\r\n                </Stack>\r\n              </Box>\r\n            </>\r\n          )}\r\n\r\n          {/* No Columns Message */}\r\n          {!loading && rows.length === 0 && !error && (\r\n            <Alert severity=\"info\" sx={{ mb: 2 }}>\r\n              No columns found for table \"{tableName}\". The table may not exist or be empty.\r\n            </Alert>\r\n          )}\r\n\r\n              {/* Column Configuration Dialog */}\r\n              {configuringColumn && (() => {\r\n                const column = rows.find(r => r.column_name === configuringColumn);\r\n                if (!column) return null;\r\n                return (\r\n                  <Dialog open={!!configuringColumn} onClose={() => setConfiguringColumn(null)} maxWidth=\"sm\" fullWidth>\r\n                    <DialogTitle>\r\n                      Configure Column: {column.column_name}\r\n                    </DialogTitle>\r\n                    <DialogContent>\r\n                      <Stack spacing={3} sx={{ mt: 2 }}>\r\n                        <TextField\r\n                          fullWidth\r\n                          label=\"Display Name\"\r\n                          value={column.new_name}\r\n                          onChange={(e) => updateNewName(column.column_name, e.target.value)}\r\n                          placeholder={`Display name for ${column.column_name}`}\r\n                          disabled={saving}\r\n                        />\r\n                        <FormControlLabel\r\n                          control={\r\n                            <Switch\r\n                              checked={column.is_visible}\r\n                              onChange={() => toggleColumnVisibility(column.column_name)}\r\n                              disabled={saving}\r\n                            />\r\n                          }\r\n                          label=\"Visible\"\r\n                        />\r\n                        <FormControlLabel\r\n                          control={\r\n                            <Switch\r\n                              checked={column.is_sortable}\r\n                              onChange={() => toggleColumnSortable(column.column_name)}\r\n                              disabled={saving || !column.is_visible}\r\n                            />\r\n                          }\r\n                          label=\"Sortable\"\r\n                        />\r\n                        <FormControl>\r\n                          <InputLabel>Default Sort</InputLabel>\r\n                          <Select\r\n                            value={defaultSortField === column.column_name ? 'yes' : 'no'}\r\n                            onChange={(e) => {\r\n                              if (e.target.value === 'yes') {\r\n                                setDefaultSortField(column.column_name);\r\n                              } else {\r\n                                setDefaultSortField('');\r\n                              }\r\n                            }}\r\n                            label=\"Default Sort\"\r\n                            disabled={saving || !column.is_visible || !column.is_sortable}\r\n                          >\r\n                            <MenuItem value=\"no\">No</MenuItem>\r\n                            <MenuItem value=\"yes\">Yes</MenuItem>\r\n                          </Select>\r\n                        </FormControl>\r\n                        {defaultSortField === column.column_name && (\r\n                          <FormControl component=\"fieldset\">\r\n                            <RadioGroup\r\n                              row\r\n                              value={defaultSortDirection}\r\n                              onChange={(e) => setDefaultSortDirection(e.target.value as 'asc' | 'desc')}\r\n                            >\r\n                              <FormControlLabel\r\n                                value=\"asc\"\r\n                                control={<Radio size=\"small\" />}\r\n                                label={<Box sx={{ display: 'flex', alignItems: 'center', gap: 0.5 }}><ArrowUpIcon fontSize=\"small\" /> Ascending</Box>}\r\n                                disabled={saving}\r\n                              />\r\n                              <FormControlLabel\r\n                                value=\"desc\"\r\n                                control={<Radio size=\"small\" />}\r\n                                label={<Box sx={{ display: 'flex', alignItems: 'center', gap: 0.5 }}><ArrowDownIcon fontSize=\"small\" /> Descending</Box>}\r\n                                disabled={saving}\r\n                              />\r\n                            </RadioGroup>\r\n                          </FormControl>\r\n                        )}\r\n                      </Stack>\r\n                    </DialogContent>\r\n                    <DialogActions>\r\n                      <Button onClick={() => setConfiguringColumn(null)}>Close</Button>\r\n                    </DialogActions>\r\n                  </Dialog>\r\n                );\r\n              })()}\r\n\r\n              {/* Action Buttons */}\r\n              <Stack direction=\"row\" spacing={2} justifyContent=\"flex-end\">\r\n                <Button variant=\"outlined\" startIcon={<CancelIcon />} onClick={handleCancel} disabled={saving}>Cancel</Button>\r\n                <Button variant=\"contained\" startIcon={saving ? <CircularProgress size={16} /> : <SaveIcon />} onClick={handleSave} disabled={saving || loading || rows.length === 0}>\r\n                  {saving ? 'Saving...' : 'Save Mapping'}\r\n                </Button>\r\n              </Stack>\r\n            </Box>\r\n          )}\r\n\r\n          {/* Tab Panel 1: Record Settings */}\r\n          {activeTab === 1 && (\r\n            <Box>\r\n              <Typography variant=\"h6\" gutterBottom sx={{ mb: 3, display: 'flex', alignItems: 'center', gap: 1 }}>\r\n                <SettingsIcon color=\"primary\" />\r\n                Header Display Configuration\r\n              </Typography>\r\n\r\n              {/* Status Messages */}\r\n              {error && <Alert severity=\"error\" sx={{ mb: 2 }}>{error}</Alert>}\r\n              {success && <Alert severity=\"success\" sx={{ mb: 2 }}>{success}</Alert>}\r\n\r\n              {/* Upload Image Button and Reset Defaults */}\r\n              <Box sx={{ mb: 3 }}>\r\n                <Box sx={{ display: 'flex', gap: 2, alignItems: 'center', flexWrap: 'wrap' }}>\r\n                  <Button\r\n                    variant=\"outlined\"\r\n                    component=\"label\"\r\n                    startIcon={<CloudUploadIcon />}\r\n                    disabled={saving}\r\n                  >\r\n                    Upload Image to Library\r\n                    <input\r\n                      type=\"file\"\r\n                      hidden\r\n                      accept=\".jpg,.jpeg,.png,image/jpeg,image/png\"\r\n                      onChange={async (e) => {\r\n                        const file = e.target.files?.[0];\r\n                        if (file) {\r\n                          // Validate file type\r\n                          const validTypes = ['image/jpeg', 'image/jpg', 'image/png'];\r\n                          if (!validTypes.includes(file.type.toLowerCase())) {\r\n                            setError('Please upload a .jpg or .png image file');\r\n                            return;\r\n                          }\r\n                          \r\n                          // Reset error state\r\n                          setError(null);\r\n                          setSuccess(null);\r\n                          setSaving(true);\r\n                          \r\n                          try {\r\n                            // Upload to image library using a supported type\r\n                            // Using 'baptism' as the type since 'recordImage' might not be supported by backend\r\n                            console.log('Starting image upload:', { churchId, type: 'baptism', fileName: file.name, fileSize: file.size, fileType: file.type });\r\n                            await handleImageUpload('baptism', file);\r\n                            setSuccess('Image uploaded successfully to library!');\r\n                          } catch (err: any) {\r\n                            console.error('Error uploading image:', err);\r\n                            console.error('Error details:', {\r\n                              message: err?.message,\r\n                              stack: err?.stack,\r\n                              name: err?.name\r\n                            });\r\n                            setError(err?.message || 'Failed to upload image. Please try again.');\r\n                          } finally {\r\n                            setSaving(false);\r\n                            // Reset the input so the same file can be selected again\r\n                            e.target.value = '';\r\n                          }\r\n                        }\r\n                      }}\r\n                    />\r\n                  </Button>\r\n                  <Button\r\n                    variant=\"outlined\"\r\n                    color=\"warning\"\r\n                    startIcon={<RefreshIcon />}\r\n                    onClick={handleResetDefaults}\r\n                    disabled={saving}\r\n                  >\r\n                    Reset Defaults\r\n                  </Button>\r\n                </Box>\r\n                <Typography variant=\"caption\" color=\"text.secondary\" display=\"block\" sx={{ mt: 1 }}>\r\n                  Upload .jpg or .png images to your image library\r\n                </Typography>\r\n              </Box>\r\n\r\n              {/* Live Preview */}\r\n              <RecordHeaderPreview\r\n                churchId={churchId}\r\n                recordSettings={recordSettings}\r\n                setRecordSettings={setRecordSettings}\r\n                onImageUpload={handleImageUpload}\r\n                recordType={\r\n                  urlTableName === 'baptism_records' ? 'baptism' :\r\n                  urlTableName === 'marriage_records' ? 'marriage' :\r\n                  urlTableName === 'funeral_records' ? 'funeral' : 'baptism'\r\n                }\r\n                churchName={churchName || `Church ${churchId}`}\r\n              />\r\n\r\n              {/* Action Buttons */}\r\n              <Stack direction=\"row\" spacing={2} justifyContent=\"flex-end\">\r\n                <Button \r\n                  variant=\"outlined\" \r\n                  startIcon={<ArrowBackIcon />} \r\n                  onClick={handleBackToRecords}\r\n                  disabled={saving}\r\n                >\r\n                  Back to Records\r\n                </Button>\r\n                <Button variant=\"outlined\" startIcon={<CancelIcon />} onClick={handleCancel} disabled={saving}>\r\n                  Cancel\r\n                </Button>\r\n                <Button \r\n                  variant=\"contained\" \r\n                  startIcon={saving ? <CircularProgress size={16} /> : <SaveIcon />} \r\n                  onClick={handleSaveRecordSettings} \r\n                  disabled={saving}\r\n                >\r\n                  {saving ? 'Saving...' : 'Save Record Settings'}\r\n                </Button>\r\n              </Stack>\r\n            </Box>\r\n          )}\r\n\r\n          {/* Tab Panel 2: Theme Studio */}\r\n          {activeTab === 2 && (\r\n            <Box>\r\n              <Typography variant=\"h6\" gutterBottom sx={{ mb: 3, display: 'flex', alignItems: 'center', gap: 1 }}>\r\n                <PaletteIcon color=\"primary\" />\r\n                Theme Studio\r\n              </Typography>\r\n\r\n              {/* Status Messages */}\r\n              {error && <Alert severity=\"error\" sx={{ mb: 2 }}>{error}</Alert>}\r\n              {success && <Alert severity=\"success\" sx={{ mb: 2 }}>{success}</Alert>}\r\n\r\n              {/* Live Preview */}\r\n              <Card variant=\"outlined\" sx={{ mb: 3, p: 3, bgcolor: theme.palette.background.paper }}>\r\n                <Typography variant=\"h6\" gutterBottom sx={{ mb: 2 }}>\r\n                  Live Preview\r\n                    </Typography>\r\n                <Typography variant=\"body2\" color=\"text.secondary\" sx={{ mb: 2 }}>\r\n                  Double-click any table element to configure its color.\r\n                        </Typography>\r\n                <Box\r\n                  sx={{\r\n                    border: `2px dashed ${theme.palette.divider}`,\r\n                    borderRadius: 2,\r\n                    p: 2,\r\n                    bgcolor: theme.palette.background.paper,\r\n                    overflow: 'auto',\r\n                  }}\r\n                >\r\n                  {(() => {\r\n                    // Get current theme tokens for preview\r\n                    const currentState = enhancedTableStore.getState();\r\n                    const currentThemeKey = currentState.liturgicalTheme;\r\n                    let previewTokens: ThemeTokens;\r\n                    \r\n                    if (previewTheme) {\r\n                      previewTokens = previewTheme;\r\n                    } else if (currentThemeKey && THEME_MAP[currentThemeKey as LiturgicalThemeKey]) {\r\n                      previewTokens = THEME_MAP[currentThemeKey as LiturgicalThemeKey];\r\n                    } else if (currentState.customThemes && currentThemeKey && currentState.customThemes[currentThemeKey]) {\r\n                      previewTokens = currentState.customThemes[currentThemeKey];\r\n                    } else {\r\n                      previewTokens = {\r\n                        headerBg: '#1976d2',\r\n                        headerText: '#ffffff',\r\n                        rowOddBg: '#fafafa',\r\n                        rowEvenBg: '#ffffff',\r\n                        border: '#e0e0e0',\r\n                        accent: '#1976d2',\r\n                        cellText: '#212121',\r\n                      };\r\n                    }\r\n\r\n                    const handleColorDoubleClick = (colorKey: keyof ThemeTokens) => {\r\n                      setConfiguringColorKey(colorKey);\r\n                      setColorConfigDialogOpen(true);\r\n                    };\r\n\r\n                            return (\r\n                      <TableContainer component={Paper} sx={{ maxHeight: 400 }}>\r\n                        <Table size=\"small\" stickyHeader>\r\n                          <TableHead>\r\n                            <TableRow>\r\n                              <TableCell\r\n                                onDoubleClick={() => handleColorDoubleClick('headerBg')}\r\n                                sx={{\r\n                                  backgroundColor: previewTokens.headerBg,\r\n                                  color: previewTokens.headerText,\r\n                                  cursor: 'pointer',\r\n                                  userSelect: 'none',\r\n                                  fontWeight: 'bold',\r\n                                  '&:hover': {\r\n                                    outline: '2px solid #1976d2',\r\n                                    outlineOffset: '-2px',\r\n                                  },\r\n                                }}\r\n                              >\r\n                                <Tooltip title=\"Double-click to configure Header Background\">\r\n                                  ID\r\n                                </Tooltip>\r\n                              </TableCell>\r\n                              <TableCell\r\n                                onDoubleClick={() => handleColorDoubleClick('headerBg')}\r\n                              sx={{\r\n                                  backgroundColor: previewTokens.headerBg,\r\n                                  color: previewTokens.headerText,\r\n                                  cursor: 'pointer',\r\n                                  userSelect: 'none',\r\n                                  fontWeight: 'bold',\r\n                                  '&:hover': {\r\n                                    outline: '2px solid #1976d2',\r\n                                    outlineOffset: '-2px',\r\n                                  },\r\n                                }}\r\n                              >\r\n                                <Tooltip title=\"Double-click to configure Header Background\">\r\n                                  First Name\r\n                                </Tooltip>\r\n                              </TableCell>\r\n                              <TableCell\r\n                                onDoubleClick={() => handleColorDoubleClick('headerBg')}\r\n                                sx={{\r\n                                  backgroundColor: previewTokens.headerBg,\r\n                                  color: previewTokens.headerText,\r\n                                  cursor: 'pointer',\r\n                                  userSelect: 'none',\r\n                                  fontWeight: 'bold',\r\n                                  '&:hover': {\r\n                                    outline: '2px solid #1976d2',\r\n                                    outlineOffset: '-2px',\r\n                                  },\r\n                                }}\r\n                              >\r\n                                <Tooltip title=\"Double-click to configure Header Background\">\r\n                                  Last Name\r\n                                </Tooltip>\r\n                              </TableCell>\r\n                              <TableCell\r\n                                onDoubleClick={() => handleColorDoubleClick('headerBg')}\r\n                                sx={{\r\n                                  backgroundColor: previewTokens.headerBg,\r\n                                  color: previewTokens.headerText,\r\n                                  cursor: 'pointer',\r\n                                  userSelect: 'none',\r\n                                  fontWeight: 'bold',\r\n                                  '&:hover': {\r\n                                    outline: '2px solid #1976d2',\r\n                                    outlineOffset: '-2px',\r\n                                  },\r\n                                }}\r\n                              >\r\n                                <Tooltip title=\"Double-click to configure Header Background\">\r\n                                  Date\r\n                                </Tooltip>\r\n                              </TableCell>\r\n                            </TableRow>\r\n                          </TableHead>\r\n                          <TableBody>\r\n                            {[1, 2, 3, 4, 5].map((row, idx) => (\r\n                              <TableRow\r\n                                key={row}\r\n                                sx={{\r\n                                  backgroundColor: idx % 2 === 0 ? previewTokens.rowEvenBg : previewTokens.rowOddBg,\r\n                                  '& .MuiTableCell-root': {\r\n                                    color: previewTokens.cellText,\r\n                                    borderColor: previewTokens.border,\r\n                                    cursor: 'pointer',\r\n                                    '&:hover': {\r\n                                      outline: '2px solid #1976d2',\r\n                                      outlineOffset: '-2px',\r\n                                    },\r\n                                  },\r\n                                }}\r\n                                onDoubleClick={(e) => {\r\n                                  const target = e.target as HTMLElement;\r\n                                  if (target.tagName === 'TD') {\r\n                                    handleColorDoubleClick(idx % 2 === 0 ? 'rowEvenBg' : 'rowOddBg');\r\n                                  }\r\n                                }}\r\n                              >\r\n                                <TableCell onDoubleClick={() => handleColorDoubleClick('cellText')}>\r\n                                  {row}\r\n                                </TableCell>\r\n                                <TableCell onDoubleClick={() => handleColorDoubleClick('cellText')}>\r\n                                  Sample {row}\r\n                                </TableCell>\r\n                                <TableCell onDoubleClick={() => handleColorDoubleClick('cellText')}>\r\n                                  Data {row}\r\n                                </TableCell>\r\n                                <TableCell onDoubleClick={() => handleColorDoubleClick('cellText')}>\r\n                                  {new Date().toLocaleDateString()}\r\n                                </TableCell>\r\n                              </TableRow>\r\n                            ))}\r\n                          </TableBody>\r\n                        </Table>\r\n                      </TableContainer>\r\n                    );\r\n                  })()}\r\n            </Box>\r\n              </Card>\r\n\r\n              <Grid container spacing={3}>\r\n                {/* Left Column - Theme Management */}\r\n                <Grid item xs={12} md={8}>\r\n                  <Card variant=\"outlined\" sx={{ mb: 3, p: 3, bgcolor: theme.palette.background.paper }}>\r\n                    <Typography variant=\"h6\" gutterBottom sx={{ mb: 2 }}>\r\n                      Theme Management\r\n                    </Typography>\r\n                    \r\n                    <Stack spacing={3}>\r\n                      {/* Global vs Church-Specific Toggle */}\r\n                      <FormControlLabel\r\n                        control={\r\n                          <Switch\r\n                            checked={themeStudio.isGlobal}\r\n                            onChange={(e) => {\r\n                              setThemeStudio(prev => ({ ...prev, isGlobal: e.target.checked }));\r\n                              // Reload themes when switching\r\n                              loadThemes(e.target.checked);\r\n                            }}\r\n                          />\r\n                        }\r\n                        label=\"Global Theme (applies to all churches unless overridden)\"\r\n                      />\r\n\r\n                      {!themeStudio.isGlobal && (\r\n                        <Alert severity=\"info\">\r\n                          Church-specific themes will override global themes for this church only.\r\n                        </Alert>\r\n                      )}\r\n\r\n                      {/* Theme List */}\r\n                      <Box>\r\n                        <Typography variant=\"subtitle2\" gutterBottom sx={{ display: 'flex', alignItems: 'center', justifyContent: 'space-between' }}>\r\n                          {themeStudio.isGlobal ? 'Global Themes' : 'Church-Specific Themes'}\r\n                          <Button\r\n                            variant=\"outlined\"\r\n                            size=\"small\"\r\n                            startIcon={<AddIcon />}\r\n                            onClick={() => {\r\n                              setEditingTheme({\r\n                                name: '',\r\n                                description: '',\r\n                                tokens: {\r\n                                  headerBg: '#1976d2',\r\n                                  headerText: '#ffffff',\r\n                                  rowOddBg: '#fafafa',\r\n                                  rowEvenBg: '#ffffff',\r\n                                  border: '#e0e0e0',\r\n                                  accent: '#1976d2',\r\n                                  cellText: '#212121',\r\n                                },\r\n                              });\r\n                              setThemeDialogOpen(true);\r\n                            }}\r\n                          >\r\n                            Add Theme\r\n                          </Button>\r\n                        </Typography>\r\n                        <Stack spacing={1} sx={{ mt: 2 }}>\r\n                          {Object.entries(themeStudio.themes).map(([key, theme]) => (\r\n                            <Card key={key} variant=\"outlined\" sx={{ p: 2, bgcolor: theme.palette.background.paper }}>\r\n                              <Stack direction=\"row\" spacing={2} alignItems=\"center\" justifyContent=\"space-between\">\r\n                                <Box sx={{ flex: 1 }}>\r\n                                  <Typography variant=\"subtitle1\" fontWeight=\"bold\">\r\n                                    {theme.name || key}\r\n                                  </Typography>\r\n                                  {theme.description && (\r\n                                    <Typography variant=\"body2\" color=\"text.secondary\">\r\n                                      {theme.description}\r\n                                    </Typography>\r\n                                  )}\r\n                                  <Box sx={{ display: 'flex', gap: 0.5, mt: 1 }}>\r\n                                    <Box sx={{ width: 30, height: 20, bgcolor: theme.headerBg, border: '1px solid #ccc', borderRadius: 1 }} />\r\n                                    <Box sx={{ width: 30, height: 20, bgcolor: theme.accent, border: '1px solid #ccc', borderRadius: 1 }} />\r\n                                    <Box sx={{ width: 30, height: 20, bgcolor: theme.rowOddBg, border: '1px solid #ccc', borderRadius: 1 }} />\r\n                                    <Box sx={{ width: 30, height: 20, bgcolor: theme.rowEvenBg, border: '1px solid #ccc', borderRadius: 1 }} />\r\n                                  </Box>\r\n                                </Box>\r\n                                <Stack direction=\"row\" spacing={1}>\r\n                                  <Button\r\n                                    size=\"small\"\r\n                                    variant=\"outlined\"\r\n                                    onClick={() => {\r\n                                      setEditingTheme({ name: key, description: theme.description || '', tokens: theme });\r\n                                      setThemeDialogOpen(true);\r\n                                    }}\r\n                                  >\r\n                                    Edit\r\n                                  </Button>\r\n                                  <IconButton\r\n                                    size=\"small\"\r\n                                    color=\"error\"\r\n                                    onClick={async () => {\r\n                                      if (window.confirm(`Delete theme \"${theme.name || key}\"?`)) {\r\n                                        const newThemes = { ...themeStudio.themes };\r\n                                        delete newThemes[key];\r\n                                        setThemeStudio(prev => ({ ...prev, themes: newThemes }));\r\n                                        await saveThemes();\r\n                                      }\r\n                                    }}\r\n                                  >\r\n                                    <DeleteIcon fontSize=\"small\" />\r\n                                  </IconButton>\r\n                                </Stack>\r\n                              </Stack>\r\n                            </Card>\r\n                          ))}\r\n                          {Object.keys(themeStudio.themes).length === 0 && (\r\n                            <Alert severity=\"info\">\r\n                              No {themeStudio.isGlobal ? 'global' : 'church-specific'} themes defined. Click \"Add Theme\" to create one.\r\n                            </Alert>\r\n                          )}\r\n                        </Stack>\r\n                      </Box>\r\n                    </Stack>\r\n                  </Card>\r\n                </Grid>\r\n\r\n                {/* Right Column - Pre-defined Themes */}\r\n                <Grid item xs={12} md={4}>\r\n                  <Card variant=\"outlined\" sx={{ mb: 3, p: 3, bgcolor: theme.palette.background.paper }}>\r\n                    <Typography variant=\"h6\" gutterBottom sx={{ mb: 2 }}>\r\n                      Pre-defined Liturgical Themes\r\n                    </Typography>\r\n                    <Stack spacing={2}>\r\n                      {Object.entries(THEME_MAP).map(([key, tokens]) => (\r\n                        <Card\r\n                          key={key}\r\n                          variant=\"outlined\"\r\n                          sx={{\r\n                            p: 2,\r\n                            cursor: 'pointer',\r\n                            border: themeStudio.selectedTheme === key ? '2px solid primary.main' : '1px solid',\r\n                            '&:hover': { bgcolor: 'action.hover' },\r\n                          }}\r\n                          onClick={() => {\r\n                            // Check if theme already exists in custom themes, if not add it\r\n                            if (!themeStudio.themes[key]) {\r\n                              const themeName = key.replace('_', ' ').replace(/\\b\\w/g, l => l.toUpperCase());\r\n                              setThemeStudio(prev => ({\r\n                                ...prev,\r\n                                themes: {\r\n                                  ...prev.themes,\r\n                                  [key]: {\r\n                                    ...tokens,\r\n                                    name: themeName,\r\n                                    description: `Pre-defined ${themeName} theme`,\r\n                                  },\r\n                                },\r\n                              }));\r\n                            }\r\n                          }}\r\n                        >\r\n                          <Typography variant=\"subtitle2\" fontWeight=\"bold\">\r\n                            {key.replace('_', ' ').replace(/\\b\\w/g, l => l.toUpperCase())}\r\n                          </Typography>\r\n                          <Box sx={{ display: 'flex', gap: 0.5, mt: 1 }}>\r\n                            <Box sx={{ width: 30, height: 20, bgcolor: tokens.headerBg, border: '1px solid #ccc', borderRadius: 1 }} />\r\n                            <Box sx={{ width: 30, height: 20, bgcolor: tokens.accent, border: '1px solid #ccc', borderRadius: 1 }} />\r\n                            <Box sx={{ width: 30, height: 20, bgcolor: tokens.rowOddBg, border: '1px solid #ccc', borderRadius: 1 }} />\r\n                            <Box sx={{ width: 30, height: 20, bgcolor: tokens.rowEvenBg, border: '1px solid #ccc', borderRadius: 1 }} />\r\n                          </Box>\r\n                          <Stack direction=\"row\" spacing={1} sx={{ mt: 1 }}>\r\n                            <Button size=\"small\" variant=\"outlined\" onClick={(e) => {\r\n                              e.stopPropagation();\r\n                              const themeName = key.replace('_', ' ').replace(/\\b\\w/g, l => l.toUpperCase());\r\n                              setEditingTheme({\r\n                                name: key, // Use the key as the name to allow editing default themes\r\n                                description: `Pre-defined ${themeName} theme`,\r\n                                tokens: tokens,\r\n                                isPreDefined: true, // Mark as pre-defined theme\r\n                                originalKey: key, // Store original key\r\n                              });\r\n                              setThemeDialogOpen(true);\r\n                            }}>\r\n                              Edit\r\n                            </Button>\r\n                          </Stack>\r\n                        </Card>\r\n                      ))}\r\n                    </Stack>\r\n                  </Card>\r\n                </Grid>\r\n              </Grid>\r\n\r\n              {/* Theme Editor Dialog */}\r\n              <Dialog open={themeDialogOpen} onClose={() => setThemeDialogOpen(false)} maxWidth=\"md\" fullWidth>\r\n                <DialogTitle>\r\n                  {editingTheme?.name ? `Edit Theme: ${editingTheme.name}` : 'Create New Theme'}\r\n                </DialogTitle>\r\n                <DialogContent>\r\n                  <Stack spacing={3} sx={{ mt: 1 }}>\r\n                    <TextField\r\n                      label=\"Theme Name\"\r\n                      value={editingTheme?.name || ''}\r\n                      onChange={(e) => setEditingTheme(prev => prev ? { ...prev, name: e.target.value } : null)}\r\n                      fullWidth\r\n                      required\r\n                    />\r\n                    <TextField\r\n                      label=\"Description\"\r\n                      value={editingTheme?.description || ''}\r\n                      onChange={(e) => setEditingTheme(prev => prev ? { ...prev, description: e.target.value } : null)}\r\n                      fullWidth\r\n                      multiline\r\n                      rows={2}\r\n                    />\r\n                    <Divider />\r\n                    <Typography variant=\"subtitle2\">Theme Colors</Typography>\r\n                    <Grid container spacing={2}>\r\n                      <Grid item xs={12} sm={6}>\r\n                        <TextField\r\n                          label=\"Header Background\"\r\n                          type=\"color\"\r\n                          value={editingTheme?.tokens.headerBg || '#1976d2'}\r\n                          onChange={(e) => setEditingTheme(prev => prev ? {\r\n                            ...prev,\r\n                            tokens: { ...prev.tokens, headerBg: e.target.value }\r\n                          } : null)}\r\n                          fullWidth\r\n                          InputLabelProps={{ shrink: true }}\r\n                        />\r\n                      </Grid>\r\n                      <Grid item xs={12} sm={6}>\r\n                        <TextField\r\n                          label=\"Header Text\"\r\n                          type=\"color\"\r\n                          value={editingTheme?.tokens.headerText || '#ffffff'}\r\n                          onChange={(e) => setEditingTheme(prev => prev ? {\r\n                            ...prev,\r\n                            tokens: { ...prev.tokens, headerText: e.target.value }\r\n                          } : null)}\r\n                          fullWidth\r\n                          InputLabelProps={{ shrink: true }}\r\n                        />\r\n                      </Grid>\r\n                      <Grid item xs={12} sm={6}>\r\n                        <TextField\r\n                          label=\"Row Odd Background\"\r\n                          type=\"color\"\r\n                          value={editingTheme?.tokens.rowOddBg || '#fafafa'}\r\n                          onChange={(e) => setEditingTheme(prev => prev ? {\r\n                            ...prev,\r\n                            tokens: { ...prev.tokens, rowOddBg: e.target.value }\r\n                          } : null)}\r\n                          fullWidth\r\n                          InputLabelProps={{ shrink: true }}\r\n                        />\r\n                      </Grid>\r\n                      <Grid item xs={12} sm={6}>\r\n                        <TextField\r\n                          label=\"Row Even Background\"\r\n                          type=\"color\"\r\n                          value={editingTheme?.tokens.rowEvenBg || '#ffffff'}\r\n                          onChange={(e) => setEditingTheme(prev => prev ? {\r\n                            ...prev,\r\n                            tokens: { ...prev.tokens, rowEvenBg: e.target.value }\r\n                          } : null)}\r\n                          fullWidth\r\n                          InputLabelProps={{ shrink: true }}\r\n                        />\r\n                      </Grid>\r\n                      <Grid item xs={12} sm={6}>\r\n                        <TextField\r\n                          label=\"Border Color\"\r\n                          type=\"color\"\r\n                          value={editingTheme?.tokens.border || '#e0e0e0'}\r\n                          onChange={(e) => setEditingTheme(prev => prev ? {\r\n                            ...prev,\r\n                            tokens: { ...prev.tokens, border: e.target.value }\r\n                          } : null)}\r\n                          fullWidth\r\n                          InputLabelProps={{ shrink: true }}\r\n                        />\r\n                      </Grid>\r\n                      <Grid item xs={12} sm={6}>\r\n                        <TextField\r\n                          label=\"Accent Color\"\r\n                          type=\"color\"\r\n                          value={editingTheme?.tokens.accent || '#1976d2'}\r\n                          onChange={(e) => setEditingTheme(prev => prev ? {\r\n                            ...prev,\r\n                            tokens: { ...prev.tokens, accent: e.target.value }\r\n                          } : null)}\r\n                          fullWidth\r\n                          InputLabelProps={{ shrink: true }}\r\n                        />\r\n                      </Grid>\r\n                      <Grid item xs={12}>\r\n                        <TextField\r\n                          label=\"Cell Text Color\"\r\n                          type=\"color\"\r\n                          value={editingTheme?.tokens.cellText || '#212121'}\r\n                          onChange={(e) => setEditingTheme(prev => prev ? {\r\n                            ...prev,\r\n                            tokens: { ...prev.tokens, cellText: e.target.value }\r\n                          } : null)}\r\n                          fullWidth\r\n                          InputLabelProps={{ shrink: true }}\r\n                        />\r\n                      </Grid>\r\n                    </Grid>\r\n                    <Divider />\r\n                    <Typography variant=\"subtitle2\">Preview</Typography>\r\n                    {editingTheme && (\r\n                      <Box>\r\n                        <Grid container spacing={1}>\r\n                          <Grid item xs={6}>\r\n                            <Box sx={{ bgcolor: editingTheme.tokens.headerBg, color: editingTheme.tokens.headerText, p: 2, borderRadius: 1, textAlign: 'center' }}>\r\n                              Header\r\n                            </Box>\r\n                          </Grid>\r\n                          <Grid item xs={6}>\r\n                            <Box sx={{ bgcolor: editingTheme.tokens.accent, color: editingTheme.tokens.cellText, p: 2, borderRadius: 1, textAlign: 'center' }}>\r\n                              Accent\r\n                            </Box>\r\n                          </Grid>\r\n                          <Grid item xs={6}>\r\n                            <Box sx={{ bgcolor: editingTheme.tokens.rowOddBg, color: editingTheme.tokens.cellText, p: 2, border: `1px solid ${editingTheme.tokens.border}`, borderRadius: 1, textAlign: 'center' }}>\r\n                              Row Odd\r\n                            </Box>\r\n                          </Grid>\r\n                          <Grid item xs={6}>\r\n                            <Box sx={{ bgcolor: editingTheme.tokens.rowEvenBg, color: editingTheme.tokens.cellText, p: 2, border: `1px solid ${editingTheme.tokens.border}`, borderRadius: 1, textAlign: 'center' }}>\r\n                              Row Even\r\n                            </Box>\r\n                          </Grid>\r\n                        </Grid>\r\n                      </Box>\r\n                    )}\r\n                  </Stack>\r\n                </DialogContent>\r\n                <DialogActions>\r\n                  <Button onClick={() => {\r\n                    setThemeDialogOpen(false);\r\n                    setEditingTheme(null);\r\n                    setSaveAsDialogOpen(false);\r\n                    setNewThemeName('');\r\n                  }}>Cancel</Button>\r\n                  \r\n                  {/* Update Template button - only show for pre-defined themes */}\r\n                  {editingTheme?.isPreDefined && editingTheme.originalKey && (\r\n                    <Button\r\n                      variant=\"outlined\"\r\n                      color=\"primary\"\r\n                      onClick={async () => {\r\n                        if (editingTheme && editingTheme.originalKey && editingTheme.originalKey in THEME_MAP) {\r\n                          // Update the pre-defined theme in THEME_MAP\r\n                          enhancedTableStore.updatePreDefinedTheme(\r\n                            editingTheme.originalKey as LiturgicalThemeKey,\r\n                            editingTheme.tokens\r\n                          );\r\n                          \r\n                          // Also save to custom themes for persistence\r\n                          const newThemes = {\r\n                            ...themeStudio.themes,\r\n                            [editingTheme.originalKey]: {\r\n                              ...editingTheme.tokens,\r\n                              name: editingTheme.originalKey.replace('_', ' ').replace(/\\b\\w/g, l => l.toUpperCase()),\r\n                              description: editingTheme.description,\r\n                            },\r\n                          };\r\n                          setThemeStudio(prev => ({ ...prev, themes: newThemes }));\r\n                          await saveThemes();\r\n                          setSuccess(`Template \"${editingTheme.originalKey}\" updated successfully!`);\r\n                          setThemeDialogOpen(false);\r\n                          setEditingTheme(null);\r\n                        }\r\n                      }}\r\n                      disabled={!editingTheme?.name}\r\n                    >\r\n                      Update Template\r\n                    </Button>\r\n                  )}\r\n                  \r\n                  {/* Save Theme button - prompts for new name */}\r\n                  <Button\r\n                    variant=\"contained\"\r\n                    onClick={async () => {\r\n                      if (editingTheme?.isPreDefined) {\r\n                        // For pre-defined themes, open save-as dialog\r\n                        setSaveAsDialogOpen(true);\r\n                      } else {\r\n                        // For custom themes, save directly\r\n                        if (editingTheme && editingTheme.name) {\r\n                          const newThemes = {\r\n                            ...themeStudio.themes,\r\n                            [editingTheme.name]: {\r\n                              ...editingTheme.tokens,\r\n                              name: editingTheme.name,\r\n                              description: editingTheme.description,\r\n                            },\r\n                          };\r\n                          setThemeStudio(prev => ({ ...prev, themes: newThemes }));\r\n                          await saveThemes();\r\n                          setThemeDialogOpen(false);\r\n                          setEditingTheme(null);\r\n                        }\r\n                      }\r\n                    }}\r\n                    disabled={!editingTheme?.name}\r\n                  >\r\n                    {editingTheme?.isPreDefined ? 'Save Theme' : 'Save Theme'}\r\n                  </Button>\r\n                </DialogActions>\r\n                \r\n                {/* Save As Dialog */}\r\n                <Dialog open={saveAsDialogOpen} onClose={() => {\r\n                  setSaveAsDialogOpen(false);\r\n                  setNewThemeName('');\r\n                }}>\r\n                  <DialogTitle>Save Theme As</DialogTitle>\r\n                  <DialogContent>\r\n                    <TextField\r\n                      autoFocus\r\n                      margin=\"dense\"\r\n                      label=\"New Theme Name\"\r\n                      fullWidth\r\n                      variant=\"outlined\"\r\n                      value={newThemeName}\r\n                      onChange={(e) => setNewThemeName(e.target.value)}\r\n                      placeholder=\"Enter a unique theme name\"\r\n                      sx={{ mt: 2 }}\r\n                    />\r\n                  </DialogContent>\r\n                  <DialogActions>\r\n                    <Button onClick={() => {\r\n                      setSaveAsDialogOpen(false);\r\n                      setNewThemeName('');\r\n                    }}>Cancel</Button>\r\n                    <Button\r\n                      variant=\"contained\"\r\n                      onClick={async () => {\r\n                        if (editingTheme && newThemeName.trim()) {\r\n                          // Check if name already exists\r\n                          if (themeStudio.themes[newThemeName.trim()]) {\r\n                            setError(`Theme \"${newThemeName.trim()}\" already exists. Please choose a different name.`);\r\n                            return;\r\n                          }\r\n                          \r\n                          const newThemes = {\r\n                            ...themeStudio.themes,\r\n                            [newThemeName.trim()]: {\r\n                              ...editingTheme.tokens,\r\n                              name: newThemeName.trim(),\r\n                              description: editingTheme.description || `Custom theme: ${newThemeName.trim()}`,\r\n                            },\r\n                          };\r\n                          setThemeStudio(prev => ({ ...prev, themes: newThemes }));\r\n                          await saveThemes();\r\n                          setSuccess(`Theme \"${newThemeName.trim()}\" saved successfully!`);\r\n                          setThemeDialogOpen(false);\r\n                          setSaveAsDialogOpen(false);\r\n                          setEditingTheme(null);\r\n                          setNewThemeName('');\r\n                        }\r\n                      }}\r\n                      disabled={!newThemeName.trim()}\r\n                    >\r\n                      Save\r\n                    </Button>\r\n                  </DialogActions>\r\n                </Dialog>\r\n              </Dialog>\r\n\r\n              {/* Color Configuration Dialog */}\r\n              <Dialog open={colorConfigDialogOpen} onClose={() => setColorConfigDialogOpen(false)} maxWidth=\"sm\" fullWidth>\r\n                <DialogTitle>\r\n                  Configure {configuringColorKey === 'headerBg' ? 'Header Background' :\r\n                            configuringColorKey === 'headerText' ? 'Header Text' :\r\n                            configuringColorKey === 'rowOddBg' ? 'Odd Row Background' :\r\n                            configuringColorKey === 'rowEvenBg' ? 'Even Row Background' :\r\n                            configuringColorKey === 'border' ? 'Border' :\r\n                            configuringColorKey === 'accent' ? 'Accent' :\r\n                            configuringColorKey === 'cellText' ? 'Cell Text' : 'Color'}\r\n                </DialogTitle>\r\n                <DialogContent>\r\n                  {configuringColorKey && (() => {\r\n                    const currentState = enhancedTableStore.getState();\r\n                    const currentThemeKey = currentState.liturgicalTheme;\r\n                    let currentTokens: ThemeTokens;\r\n                    \r\n                    if (previewTheme) {\r\n                      currentTokens = previewTheme;\r\n                    } else if (currentThemeKey && THEME_MAP[currentThemeKey as LiturgicalThemeKey]) {\r\n                      currentTokens = THEME_MAP[currentThemeKey as LiturgicalThemeKey];\r\n                    } else if (currentState.customThemes && currentThemeKey && currentState.customThemes[currentThemeKey]) {\r\n                      currentTokens = currentState.customThemes[currentThemeKey];\r\n                    } else {\r\n                      currentTokens = {\r\n                        headerBg: '#1976d2',\r\n                        headerText: '#ffffff',\r\n                        rowOddBg: '#fafafa',\r\n                        rowEvenBg: '#ffffff',\r\n                        border: '#e0e0e0',\r\n                        accent: '#1976d2',\r\n                        cellText: '#212121',\r\n                      };\r\n                    }\r\n\r\n                    const currentColor = currentTokens[configuringColorKey];\r\n\r\n                    return (\r\n                      <Stack spacing={2} sx={{ mt: 2 }}>\r\n                        <TextField\r\n                          label=\"Color\"\r\n                          type=\"color\"\r\n                          value={currentColor}\r\n                          onChange={(e) => {\r\n                            const newTokens = { ...currentTokens, [configuringColorKey]: e.target.value };\r\n                            setPreviewTheme(newTokens);\r\n                            \r\n                            // Update the current theme in the store if it's a custom theme\r\n                            if (currentThemeKey && currentState.customThemes && currentState.customThemes[currentThemeKey]) {\r\n                              const updatedThemes = {\r\n                                ...currentState.customThemes,\r\n                                [currentThemeKey]: {\r\n                                  ...currentState.customThemes[currentThemeKey],\r\n                                  ...newTokens,\r\n                                },\r\n                              };\r\n                              enhancedTableStore.setCustomThemes(updatedThemes);\r\n                              \r\n                              // Also update in themeStudio\r\n                              setThemeStudio(prev => ({\r\n                                ...prev,\r\n                                themes: {\r\n                                  ...prev.themes,\r\n                                  [currentThemeKey]: {\r\n                                    ...prev.themes[currentThemeKey],\r\n                                    ...newTokens,\r\n                                  },\r\n                                },\r\n                              }));\r\n                            }\r\n                          }}\r\n                          fullWidth\r\n                          InputLabelProps={{ shrink: true }}\r\n                        />\r\n                        <Box sx={{ p: 2, bgcolor: theme.palette.action.hover, borderRadius: 1 }}>\r\n                          <Typography variant=\"caption\" color=\"text.secondary\">\r\n                            Preview: This color will be applied to {configuringColorKey === 'headerBg' ? 'the table header background' :\r\n                                      configuringColorKey === 'headerText' ? 'the table header text' :\r\n                                      configuringColorKey === 'rowOddBg' ? 'odd-numbered table rows' :\r\n                                      configuringColorKey === 'rowEvenBg' ? 'even-numbered table rows' :\r\n                                      configuringColorKey === 'border' ? 'table borders' :\r\n                                      configuringColorKey === 'accent' ? 'accent elements' :\r\n                                      'table cell text'}.\r\n                          </Typography>\r\n                        </Box>\r\n                      </Stack>\r\n                    );\r\n                  })()}\r\n                </DialogContent>\r\n                <DialogActions>\r\n                  <Button onClick={() => {\r\n                    setColorConfigDialogOpen(false);\r\n                    setConfiguringColorKey(null);\r\n                  }}>\r\n                    Close\r\n                  </Button>\r\n                  <Button\r\n                    variant=\"contained\"\r\n                    onClick={async () => {\r\n                      if (configuringColorKey && previewTheme) {\r\n                        const currentState = enhancedTableStore.getState();\r\n                        const currentThemeKey = currentState.liturgicalTheme;\r\n                        \r\n                        // Save the preview theme to the actual theme\r\n                        if (currentThemeKey) {\r\n                          if (currentState.customThemes && currentState.customThemes[currentThemeKey]) {\r\n                            // Update custom theme\r\n                            const updatedThemes = {\r\n                              ...currentState.customThemes,\r\n                              [currentThemeKey]: {\r\n                                ...currentState.customThemes[currentThemeKey],\r\n                                ...previewTheme,\r\n                              },\r\n                            };\r\n                            enhancedTableStore.setCustomThemes(updatedThemes);\r\n                            \r\n                            // Update in themeStudio and save\r\n                            setThemeStudio(prev => ({\r\n                              ...prev,\r\n                              themes: {\r\n                                ...prev.themes,\r\n                                [currentThemeKey]: {\r\n                                  ...prev.themes[currentThemeKey],\r\n                                  ...previewTheme,\r\n                                },\r\n                              },\r\n                            }));\r\n                            await saveThemes();\r\n                          } else if (THEME_MAP[currentThemeKey as LiturgicalThemeKey]) {\r\n                            // Update pre-defined theme\r\n                            enhancedTableStore.updatePreDefinedTheme(\r\n                              currentThemeKey as LiturgicalThemeKey,\r\n                              previewTheme\r\n                            );\r\n                          }\r\n                        }\r\n                        \r\n                        setColorConfigDialogOpen(false);\r\n                        setConfiguringColorKey(null);\r\n                        setPreviewTheme(null);\r\n                        setSuccess('Theme color updated successfully!');\r\n                      }\r\n                    }}\r\n                  >\r\n                    Apply\r\n                  </Button>\r\n                </DialogActions>\r\n              </Dialog>\r\n\r\n              {/* Action Buttons */}\r\n              <Stack direction=\"row\" spacing={2} justifyContent=\"flex-end\" sx={{ mt: 3 }}>\r\n                <Button variant=\"outlined\" startIcon={<CancelIcon />} onClick={handleCancel} disabled={saving}>\r\n                  Cancel\r\n                </Button>\r\n                <Button \r\n                  variant=\"contained\" \r\n                  startIcon={saving ? <CircularProgress size={16} /> : <SaveIcon />} \r\n                  onClick={async () => {\r\n                    await saveThemes();\r\n                  }}\r\n                  disabled={saving}\r\n                >\r\n                  {saving ? 'Saving...' : 'Save Themes'}\r\n                </Button>\r\n              </Stack>\r\n            </Box>\r\n          )}\r\n\r\n          {/* Tab Panel 3: UI Theme */}\r\n          {activeTab === 3 && (\r\n            <Box>\r\n              <Typography variant=\"h6\" gutterBottom sx={{ mb: 3, display: 'flex', alignItems: 'center', gap: 1 }}>\r\n                <SettingsIcon color=\"primary\" />\r\n                UI Theme - Action Buttons Configuration\r\n              </Typography>\r\n\r\n              {/* Status Messages */}\r\n              {error && <Alert severity=\"error\" sx={{ mb: 2 }}>{error}</Alert>}\r\n              {success && <Alert severity=\"success\" sx={{ mb: 2 }}>{success}</Alert>}\r\n\r\n              <Typography variant=\"body2\" color=\"text.secondary\" sx={{ mb: 3 }}>\r\n                Customize the appearance of the four action buttons: Switch to AG, Field Settings, Add Records, and Advanced Grid.\r\n              </Typography>\r\n\r\n              {/* Live Preview */}\r\n              <Card variant=\"outlined\" sx={{ mb: 3, p: 3, bgcolor: theme.palette.background.paper }}>\r\n                <Typography variant=\"h6\" gutterBottom sx={{ mb: 2 }}>\r\n                  Live Preview\r\n                </Typography>\r\n                <Box\r\n                  key={JSON.stringify(uiThemeState.actionButtonConfigs)}\r\n                  sx={{\r\n                    border: `2px dashed ${theme.palette.divider}`,\r\n                    borderRadius: 2,\r\n                    p: 3,\r\n                    bgcolor: theme.palette.background.paper,\r\n                    display: 'flex',\r\n                    flexWrap: 'wrap',\r\n                    gap: 2,\r\n                    alignItems: 'center',\r\n                  }}\r\n                >\r\n                  {(() => {\r\n                    const buttonConfigs = uiThemeState.actionButtonConfigs;\r\n                    const searchRecordsConfig = buttonConfigs?.searchRecords;\r\n                    const themeConfig = buttonConfigs?.theme;\r\n                    const recordTableConfigConfig = buttonConfigs?.recordTableConfig;\r\n                    const switchToAGConfig = buttonConfigs?.switchToAG;\r\n                    const fieldSettingsConfig = buttonConfigs?.fieldSettings;\r\n                    const addRecordsConfig = buttonConfigs?.addRecords;\r\n                    const advancedGridConfig = buttonConfigs?.advancedGrid;\r\n\r\n                    const renderButton = (buttonKey: string, label: string, icon: React.ReactNode, config: ButtonConfig | undefined, defaultBg: string, defaultHover: string) => (\r\n                      <Tooltip title=\"Double-click to configure\">\r\n                        <Box\r\n                          onDoubleClick={() => setConfiguringButton(buttonKey)}\r\n                          sx={{\r\n                            cursor: 'pointer',\r\n                            outline: configuringButton === buttonKey ? '2px solid #4C1D95' : 'none',\r\n                            outlineOffset: '4px',\r\n                            borderRadius: 1,\r\n                            p: 0.5,\r\n                          }}\r\n                        >\r\n                          {buttonKey === 'searchRecords' ? (\r\n                            <Box\r\n                              sx={{\r\n                                display: 'flex',\r\n                                flexDirection: 'column',\r\n                                gap: 0.5,\r\n                                minWidth: 220,\r\n                              }}\r\n                            >\r\n                              <Chip \r\n                                label={label}\r\n                                size=\"small\" \r\n                                sx={{ \r\n                                  width: 'fit-content',\r\n                                  backgroundColor: config?.backgroundColor || '#4C1D95',\r\n                                  color: config?.textColor || '#ffffff',\r\n                                  borderRadius: '20px',\r\n                                  fontWeight: 500,\r\n                                  fontSize: config?.fontSize || '0.75rem',\r\n                                  padding: config?.padding || '4px 8px',\r\n                                  '&:hover': {\r\n                                    backgroundColor: config?.hoverColor || '#5a2ba8',\r\n                                  },\r\n                                }}\r\n                              />\r\n                              <TextField\r\n                                placeholder=\"Search records...\"\r\n                                InputProps={{\r\n                                  startAdornment: <SearchIcon sx={{ mr: 1, color: 'text.secondary' }} />,\r\n                                }}\r\n                                size=\"small\"\r\n                                sx={{ minWidth: 220 }}\r\n                                disabled\r\n                              />\r\n                            </Box>\r\n                          ) : buttonKey === 'theme' ? (\r\n                            <Box\r\n                              sx={{\r\n                                display: 'flex',\r\n                                flexDirection: 'column',\r\n                                gap: 0.5,\r\n                                minWidth: 200,\r\n                              }}\r\n                            >\r\n                              <Chip \r\n                                label={label}\r\n                                size=\"small\" \r\n                                sx={{ \r\n                                  width: 'fit-content',\r\n                                  backgroundColor: config?.backgroundColor || '#4C1D95',\r\n                                  color: config?.textColor || '#ffffff',\r\n                                  borderRadius: '20px',\r\n                                  fontWeight: 500,\r\n                                  fontSize: config?.fontSize || '0.75rem',\r\n                                  padding: config?.padding || '4px 8px',\r\n                                  '&:hover': {\r\n                                    backgroundColor: config?.hoverColor || '#5a2ba8',\r\n                                  },\r\n                                }}\r\n                              />\r\n                              <FormControl size=\"small\" fullWidth>\r\n                                <Select\r\n                                  value={uiThemeState.liturgicalTheme}\r\n                                  disabled\r\n                                  sx={{\r\n                                    borderRadius: 2,\r\n                                    backgroundColor: 'background.paper',\r\n                                  }}\r\n                                >\r\n                                  <MenuItem value={uiThemeState.liturgicalTheme}>\r\n                                    {uiThemeState.liturgicalTheme}\r\n                                  </MenuItem>\r\n                                </Select>\r\n                              </FormControl>\r\n                            </Box>\r\n                          ) : buttonKey === 'recordTableConfig' ? (\r\n                            <Box\r\n                              sx={{\r\n                                display: 'flex',\r\n                                flexDirection: 'column',\r\n                                gap: 0.5,\r\n                              }}\r\n                            >\r\n                              <Chip \r\n                                label={label}\r\n                                size=\"small\" \r\n                                sx={{ \r\n                                  width: 'fit-content',\r\n                                  backgroundColor: config?.backgroundColor || '#4C1D95',\r\n                                  color: config?.textColor || '#ffffff',\r\n                                  borderRadius: '20px',\r\n                                  fontWeight: 500,\r\n                                  fontSize: config?.fontSize || '0.75rem',\r\n                                  padding: config?.padding || '4px 8px',\r\n                                  '&:hover': {\r\n                                    backgroundColor: config?.hoverColor || '#5a2ba8',\r\n                                  },\r\n                                }}\r\n                              />\r\n                              <Button\r\n                                variant=\"outlined\"\r\n                                startIcon={<PaletteIcon />}\r\n                                disabled\r\n                                size={config?.size || 'small'}\r\n                                sx={{\r\n                                  borderRadius: 2,\r\n                                  textTransform: 'none',\r\n                                  borderColor: config?.backgroundColor || 'rgba(76, 29, 149, 0.3)',\r\n                                  color: config?.textColor || '#4C1D95',\r\n                                  padding: config?.padding || '5px 9px',\r\n                                  fontSize: config?.fontSize || '0.75rem',\r\n                                  '&:hover': {\r\n                                    borderColor: config?.hoverColor || '#4C1D95',\r\n                                    backgroundColor: config?.hoverColor ? `${config.hoverColor}15` : 'rgba(76, 29, 149, 0.08)',\r\n                                  },\r\n                                }}\r\n                              >\r\n                                Theme Studio\r\n                              </Button>\r\n                            </Box>\r\n                          ) : (\r\n                            <Button\r\n                              variant=\"contained\"\r\n                              startIcon={icon}\r\n                              size={config?.size || 'small'}\r\n                              disabled\r\n                              sx={{\r\n                                borderRadius: 14,\r\n                                padding: config?.padding || '5px 9px',\r\n                                textTransform: 'none',\r\n                                fontWeight: 600,\r\n                                letterSpacing: 0.2,\r\n                                fontSize: config?.fontSize || '0.75rem',\r\n                                color: config?.textColor || '#fff',\r\n                                background: config?.backgroundColor || defaultBg,\r\n                                boxShadow: '0 6px 16px -6px rgba(25, 118, 210, 0.35)',\r\n                                '&:hover': {\r\n                                  background: config?.hoverColor || defaultHover,\r\n                                },\r\n                                '& .MuiButton-startIcon': { marginRight: 1 },\r\n                              }}\r\n                            >\r\n                              {label}\r\n                            </Button>\r\n                          )}\r\n                        </Box>\r\n                      </Tooltip>\r\n                    );\r\n\r\n                    return (\r\n                      <>\r\n                        {/* Search Records */}\r\n                        {renderButton('searchRecords', 'Search Records', <SearchIcon />, searchRecordsConfig, '#4C1D95', '#5a2ba8')}\r\n                        \r\n                        {/* Theme */}\r\n                        {renderButton('theme', 'Theme', <PaletteIcon />, themeConfig, '#4C1D95', '#5a2ba8')}\r\n                        \r\n                        {/* Record Table Configuration */}\r\n                        {renderButton('recordTableConfig', 'Record Table Configuration', <PaletteIcon />, recordTableConfigConfig, '#4C1D95', '#5a2ba8')}\r\n\r\n                        {/* Switch to AG Button */}\r\n                        {renderButton('switchToAG', 'Switch to AG', <ViewListIcon />, switchToAGConfig, 'linear-gradient(135deg, #1976D2 0%, #1565C0 100%)', 'linear-gradient(135deg, #1565C0 0%, #1976D2 100%)')}\r\n\r\n                        {/* Field Settings Button */}\r\n                        {renderButton('fieldSettings', 'Field Settings', <SettingsIcon />, fieldSettingsConfig, 'linear-gradient(135deg, #4C1D95 0%, #2E1065 100%)', 'linear-gradient(135deg, #2E1065 0%, #4C1D95 100%)')}\r\n\r\n                        {/* Add Records Button */}\r\n                        {renderButton('addRecords', 'Add Records', <AddIcon />, addRecordsConfig, 'linear-gradient(135deg, #4C1D95 0%, #2E1065 100%)', 'linear-gradient(135deg, #2E1065 0%, #4C1D95 100%)')}\r\n\r\n                        {/* Advanced Grid Button */}\r\n                        {renderButton('advancedGrid', 'Advanced Grid', <GridViewIcon />, advancedGridConfig, 'linear-gradient(100deg, #4C1D95 0%, #2E1065 50%, #F6C90E 115%)', 'linear-gradient(100deg, #2E1065 0%, #4C1D95 50%, #D4A80A 115%)')}\r\n                      </>\r\n                    );\r\n                  })()}\r\n                </Box>\r\n              </Card>\r\n\r\n              {['searchRecords', 'theme', 'recordTableConfig', 'switchToAG', 'fieldSettings', 'addRecords', 'advancedGrid'].map((buttonKey) => {\r\n                const buttonName = buttonKey === 'searchRecords' ? 'Search Records' :\r\n                                  buttonKey === 'theme' ? 'Theme' :\r\n                                  buttonKey === 'recordTableConfig' ? 'Record Table Configuration' :\r\n                                  buttonKey === 'switchToAG' ? 'Switch to AG' :\r\n                                  buttonKey === 'fieldSettings' ? 'Field Settings' :\r\n                                  buttonKey === 'addRecords' ? 'Add Records' : 'Advanced Grid';\r\n                const buttonConfigs = uiThemeState.actionButtonConfigs;\r\n                const config = buttonConfigs?.[buttonKey as keyof typeof buttonConfigs];\r\n                \r\n                return (\r\n                  <Card key={buttonKey} variant=\"outlined\" sx={{ mb: 2, p: 2, bgcolor: theme.palette.background.paper }}>\r\n                    <Typography variant=\"subtitle2\" gutterBottom sx={{ mb: 2 }}>\r\n                      {buttonName}\r\n                    </Typography>\r\n                    <Grid container spacing={2}>\r\n                      <Grid item xs={12} sm={6}>\r\n                        <TextField\r\n                          fullWidth\r\n                          size=\"small\"\r\n                          label=\"Background Color\"\r\n                          type=\"color\"\r\n                          value={config?.backgroundColor || ''}\r\n                          onChange={(e) => {\r\n                            enhancedTableStore.setActionButtonConfigs({\r\n                              [buttonKey]: {\r\n                                ...config,\r\n                                backgroundColor: e.target.value,\r\n                              }\r\n                            });\r\n                          }}\r\n                          InputLabelProps={{ shrink: true }}\r\n                        />\r\n                      </Grid>\r\n                      <Grid item xs={12} sm={6}>\r\n                        <TextField\r\n                          fullWidth\r\n                          size=\"small\"\r\n                          label=\"Hover Color\"\r\n                          type=\"color\"\r\n                          value={config?.hoverColor || ''}\r\n                          onChange={(e) => {\r\n                            enhancedTableStore.setActionButtonConfigs({\r\n                              [buttonKey]: {\r\n                                ...config,\r\n                                hoverColor: e.target.value,\r\n                              }\r\n                            });\r\n                          }}\r\n                          InputLabelProps={{ shrink: true }}\r\n                        />\r\n                      </Grid>\r\n                      <Grid item xs={12} sm={6}>\r\n                        <TextField\r\n                          fullWidth\r\n                          size=\"small\"\r\n                          label=\"Text Color\"\r\n                          type=\"color\"\r\n                          value={config?.textColor || ''}\r\n                          onChange={(e) => {\r\n                            enhancedTableStore.setActionButtonConfigs({\r\n                              [buttonKey]: {\r\n                                ...config,\r\n                                textColor: e.target.value,\r\n                              }\r\n                            });\r\n                          }}\r\n                          InputLabelProps={{ shrink: true }}\r\n                        />\r\n                      </Grid>\r\n                      <Grid item xs={12} sm={6}>\r\n                        <FormControl fullWidth size=\"small\">\r\n                          <InputLabel>Button Size</InputLabel>\r\n                          <Select\r\n                            value={config?.size || 'small'}\r\n                            onChange={(e) => {\r\n                              enhancedTableStore.setActionButtonConfigs({\r\n                                [buttonKey]: {\r\n                                  ...config,\r\n                                  size: e.target.value as 'small' | 'medium' | 'large',\r\n                                }\r\n                              });\r\n                            }}\r\n                            label=\"Button Size\"\r\n                          >\r\n                            <MenuItem value=\"small\">Small</MenuItem>\r\n                            <MenuItem value=\"medium\">Medium</MenuItem>\r\n                            <MenuItem value=\"large\">Large</MenuItem>\r\n                          </Select>\r\n                        </FormControl>\r\n                      </Grid>\r\n                      <Grid item xs={12} sm={6}>\r\n                        <TextField\r\n                          fullWidth\r\n                          size=\"small\"\r\n                          label=\"Padding (e.g., 5px 9px)\"\r\n                          value={config?.padding || ''}\r\n                          onChange={(e) => {\r\n                            enhancedTableStore.setActionButtonConfigs({\r\n                              [buttonKey]: {\r\n                                ...config,\r\n                                padding: e.target.value,\r\n                              }\r\n                            });\r\n                          }}\r\n                          placeholder=\"5px 9px\"\r\n                          InputLabelProps={{ shrink: true }}\r\n                        />\r\n                      </Grid>\r\n                      <Grid item xs={12} sm={6}>\r\n                        <TextField\r\n                          fullWidth\r\n                          size=\"small\"\r\n                          label=\"Font Size (e.g., 0.75rem)\"\r\n                          value={config?.fontSize || ''}\r\n                          onChange={(e) => {\r\n                            enhancedTableStore.setActionButtonConfigs({\r\n                              [buttonKey]: {\r\n                                ...config,\r\n                                fontSize: e.target.value,\r\n                              }\r\n                            });\r\n                          }}\r\n                          placeholder=\"0.75rem\"\r\n                          InputLabelProps={{ shrink: true }}\r\n                        />\r\n                      </Grid>\r\n                    </Grid>\r\n                  </Card>\r\n                );\r\n              })}\r\n\r\n              {/* Action Buttons */}\r\n              <Stack direction=\"row\" spacing={2} justifyContent=\"flex-end\" sx={{ mt: 3 }}>\r\n                <Button \r\n                  variant=\"contained\" \r\n                  startIcon={saving ? <CircularProgress size={16} /> : <SaveIcon />} \r\n                  onClick={async () => {\r\n                    setSaving(true);\r\n                    // Button configs are already saved to localStorage via enhancedTableStore\r\n                    // Simulate save operation\r\n                    await new Promise(resolve => setTimeout(resolve, 500));\r\n                    setSuccess('Actionbar saved successfully!');\r\n                    setTimeout(() => setSuccess(null), 3000);\r\n                    setSaving(false);\r\n                  }}\r\n                  disabled={saving}\r\n                >\r\n                  {saving ? 'Saving...' : 'Save Actionbar'}\r\n                </Button>\r\n              </Stack>\r\n\r\n              {/* Quick Configuration Dialog */}\r\n              {configuringButton && (\r\n                <Dialog open={!!configuringButton} onClose={() => setConfiguringButton(null)} maxWidth=\"sm\" fullWidth>\r\n                  <DialogTitle>\r\n                    Configure {configuringButton === 'searchRecords' ? 'Search Records' :\r\n                              configuringButton === 'theme' ? 'Theme' :\r\n                              configuringButton === 'recordTableConfig' ? 'Record Table Configuration' :\r\n                              configuringButton === 'switchToAG' ? 'Switch to AG' :\r\n                              configuringButton === 'fieldSettings' ? 'Field Settings' :\r\n                              configuringButton === 'addRecords' ? 'Add Records' : 'Advanced Grid'}\r\n                  </DialogTitle>\r\n                  <DialogContent>\r\n                    {(() => {\r\n                      const buttonConfigs = uiThemeState.actionButtonConfigs;\r\n                      const config = buttonConfigs?.[configuringButton as keyof typeof buttonConfigs];\r\n                      return (\r\n                        <Grid container spacing={2} sx={{ mt: 1 }}>\r\n                          <Grid item xs={12} sm={6}>\r\n                            <TextField\r\n                              fullWidth\r\n                              size=\"small\"\r\n                              label=\"Background Color\"\r\n                              type=\"color\"\r\n                              value={config?.backgroundColor || ''}\r\n                              onChange={(e) => {\r\n                                enhancedTableStore.setActionButtonConfigs({\r\n                                  [configuringButton]: {\r\n                                    ...config,\r\n                                    backgroundColor: e.target.value,\r\n                                  }\r\n                                });\r\n                              }}\r\n                              InputLabelProps={{ shrink: true }}\r\n                            />\r\n                          </Grid>\r\n                          <Grid item xs={12} sm={6}>\r\n                            <TextField\r\n                              fullWidth\r\n                              size=\"small\"\r\n                              label=\"Hover Color\"\r\n                              type=\"color\"\r\n                              value={config?.hoverColor || ''}\r\n                              onChange={(e) => {\r\n                                enhancedTableStore.setActionButtonConfigs({\r\n                                  [configuringButton]: {\r\n                                    ...config,\r\n                                    hoverColor: e.target.value,\r\n                                  }\r\n                                });\r\n                              }}\r\n                              InputLabelProps={{ shrink: true }}\r\n                            />\r\n                          </Grid>\r\n                          <Grid item xs={12} sm={6}>\r\n                            <TextField\r\n                              fullWidth\r\n                              size=\"small\"\r\n                              label=\"Text Color\"\r\n                              type=\"color\"\r\n                              value={config?.textColor || ''}\r\n                              onChange={(e) => {\r\n                                enhancedTableStore.setActionButtonConfigs({\r\n                                  [configuringButton]: {\r\n                                    ...config,\r\n                                    textColor: e.target.value,\r\n                                  }\r\n                                });\r\n                              }}\r\n                              InputLabelProps={{ shrink: true }}\r\n                            />\r\n                          </Grid>\r\n                          <Grid item xs={12} sm={6}>\r\n                            <FormControl fullWidth size=\"small\">\r\n                              <InputLabel>Button Size</InputLabel>\r\n                              <Select\r\n                                value={config?.size || 'small'}\r\n                                onChange={(e) => {\r\n                                  enhancedTableStore.setActionButtonConfigs({\r\n                                    [configuringButton]: {\r\n                                      ...config,\r\n                                      size: e.target.value as 'small' | 'medium' | 'large',\r\n                                    }\r\n                                  });\r\n                                }}\r\n                                label=\"Button Size\"\r\n                              >\r\n                                <MenuItem value=\"small\">Small</MenuItem>\r\n                                <MenuItem value=\"medium\">Medium</MenuItem>\r\n                                <MenuItem value=\"large\">Large</MenuItem>\r\n                              </Select>\r\n                            </FormControl>\r\n                          </Grid>\r\n                          <Grid item xs={12} sm={6}>\r\n                            <TextField\r\n                              fullWidth\r\n                              size=\"small\"\r\n                              label=\"Padding (e.g., 5px 9px)\"\r\n                              value={config?.padding || ''}\r\n                              onChange={(e) => {\r\n                                enhancedTableStore.setActionButtonConfigs({\r\n                                  [configuringButton]: {\r\n                                    ...config,\r\n                                    padding: e.target.value,\r\n                                  }\r\n                                });\r\n                              }}\r\n                              placeholder=\"5px 9px\"\r\n                              InputLabelProps={{ shrink: true }}\r\n                            />\r\n                          </Grid>\r\n                          <Grid item xs={12} sm={6}>\r\n                            <TextField\r\n                              fullWidth\r\n                              size=\"small\"\r\n                              label=\"Font Size (e.g., 0.75rem)\"\r\n                              value={config?.fontSize || ''}\r\n                              onChange={(e) => {\r\n                                enhancedTableStore.setActionButtonConfigs({\r\n                                  [configuringButton]: {\r\n                                    ...config,\r\n                                    fontSize: e.target.value,\r\n                                  }\r\n                                });\r\n                              }}\r\n                              placeholder=\"0.75rem\"\r\n                              InputLabelProps={{ shrink: true }}\r\n                            />\r\n                          </Grid>\r\n                        </Grid>\r\n                      );\r\n                    })()}\r\n                  </DialogContent>\r\n                  <DialogActions>\r\n                    <Button onClick={() => setConfiguringButton(null)}>Close</Button>\r\n                  </DialogActions>\r\n                </Dialog>\r\n              )}\r\n            </Box>\r\n          )}\r\n        </CardContent>\r\n      </Card>\r\n\r\n      {/* Export to Template Dialog */}\r\n      <Dialog open={exportDialogOpen} onClose={() => !exporting && setExportDialogOpen(false)} maxWidth=\"sm\" fullWidth>\r\n          <DialogTitle>Export to Template</DialogTitle>\r\n          <DialogContent>\r\n            <Box sx={{ pt: 2 }}>\r\n              <Typography variant=\"body2\" color=\"text.secondary\" gutterBottom>\r\n                This will create or update a global template from the current table schema and field mapper configuration.\r\n              </Typography>\r\n              \r\n              <Box sx={{ mt: 3, mb: 2 }}>\r\n                <Typography variant=\"subtitle2\" gutterBottom>Template Details:</Typography>\r\n                <Typography variant=\"body2\">\r\n                  <strong>Table:</strong> {tableName}\r\n                </Typography>\r\n                <Typography variant=\"body2\">\r\n                  <strong>Language:</strong> {exportLanguage}\r\n                </Typography>\r\n                <Typography variant=\"body2\">\r\n                  <strong>Template Slug:</strong> {exportLanguage}_{tableName}\r\n                </Typography>\r\n                <Typography variant=\"body2\">\r\n                  <strong>Template Name:</strong> {\r\n                    exportLanguage === 'en' ? 'English' : \r\n                    exportLanguage === 'gr' ? 'Greek' :\r\n                    exportLanguage === 'ru' ? 'Russian' :\r\n                    exportLanguage === 'ro' ? 'Romanian' :\r\n                    exportLanguage === 'ka' ? 'Georgian' : exportLanguage.toUpperCase()\r\n                  } {getRecordType(tableName).charAt(0).toUpperCase() + getRecordType(tableName).slice(1)} Records\r\n                </Typography>\r\n              </Box>\r\n\r\n              <FormControlLabel\r\n                control={\r\n                  <Checkbox\r\n                    checked={exportOverwrite}\r\n                    onChange={(e) => setExportOverwrite(e.target.checked)}\r\n                    disabled={exporting}\r\n                  />\r\n                }\r\n                label=\"Overwrite existing template if it exists\"\r\n              />\r\n\r\n              <Alert severity=\"warning\" sx={{ mt: 2 }}>\r\n                <Typography variant=\"body2\">\r\n                  <strong>Warning:</strong> This will create a global template available to all churches. \r\n                  Only export standardized, production-ready configurations. Church-specific customizations should not be exported.\r\n                </Typography>\r\n              </Alert>\r\n            </Box>\r\n          </DialogContent>\r\n          <DialogActions>\r\n            <Button onClick={() => setExportDialogOpen(false)} disabled={exporting}>\r\n              Cancel\r\n            </Button>\r\n            <Button \r\n              onClick={handleExportToTemplate} \r\n              variant=\"contained\" \r\n              disabled={exporting}\r\n              startIcon={exporting ? <CircularProgress size={16} /> : <DownloadIcon />}\r\n            >\r\n              {exporting ? 'Exporting...' : 'Export Template'}\r\n            </Button>\r\n          </DialogActions>\r\n        </Dialog>\r\n    </Box>\r\n  );\r\n};\r\n\r\nexport default FieldMapperPage;\r\n"],"names":["ArrowDownIcon","createSvgIcon","_jsx","ArrowUpIcon","GridViewIcon","SortIcon","ViewListIcon","VisibilityOffIcon","fetchWithChurchContext","_0","__async","url","options","_a","churchId","skipChurchContext","fetchOptions","__objRest","finalChurchId","urlMatch","authUser","user","e","sessionChurchId","headers","churchIdStr","finalOptions","__spreadProps","__spreadValues","THEME_MAP","STORAGE_KEY","EnhancedTableStore","__publicField","stored","parsed","theme","tokens","needsMigration","oldHeaderBgValues","state","error","listener","index","customTheme","themes","themeKey","rules","updates","updater","newState","config","configs","enhancedTableStore","RecordHeaderBanner","recordType","churchName","externalSettings","interactive","onElementDoubleClick","recordSettings","setRecordSettings","useState","loading","setLoading","useEffect","loadSettings","forceReload","cacheBuster","response","data","_b","_c","err","handleSettingsUpdate","event","getImagePath","type","logoImages","logoIndex","recordImages","_d","recordIndex","_f","_e","bgImages","_g","bgIndex","_i","_h","g1Images","_j","g1Index","_l","_k","omImages","_m","omIndex","_o","_n","getCalendarDates","today","dates","i","date","calendarDates","useMemo","jsx","Box","jsxs","Typography","_p","_q","_r","_s","_t","_u","_v","_w","_x","_y","_z","_A","_B","_C","_D","_E","RecordHeaderPreview","onImageUpload","configDialogOpen","setConfigDialogOpen","configType","setConfigType","imageDialogOpen","setImageDialogOpen","imageType","setImageType","handleDoubleClick","Paper","col","Button","SettingsIcon","Drawer","IconButton","CloseIcon","Divider","Stack","FormControlLabel","Switch","prev","Fragment","FormControl","InputLabel","Select","MenuItem","TextField","Slider","value","CloudUploadIcon","file","_F","_G","_H","_I","_J","_K","_M","_L","_N","_O","_P","_Q","_R","Dialog","DialogTitle","DialogContent","DialogActions","BAPTISM_RECORDS_PREVIEW","MARRIAGE_RECORDS_PREVIEW","FUNERAL_RECORDS_PREVIEW","FieldMapperPage","id","useParams","searchParams","setSearchParams","useSearchParams","navigate","useNavigate","useTheme","useAuth","getValidChurchId","num","urlChurchId","userChurchId","urlTableName","tableName","setTableName","getRecordType","table","handleBackToRecords","rows","setRows","defaultSortField","setDefaultSortField","defaultSortDirection","setDefaultSortDirection","saving","setSaving","setError","success","setSuccess","activeTab","setActiveTab","setChurchName","exportLanguage","setExportLanguage","exportDialogOpen","setExportDialogOpen","exporting","setExporting","exportOverwrite","setExportOverwrite","dynamicConfig","setDynamicConfig","editingRule","setEditingRule","ruleDialogOpen","setRuleDialogOpen","themeStudio","setThemeStudio","editingTheme","setEditingTheme","themeDialogOpen","setThemeDialogOpen","saveAsDialogOpen","setSaveAsDialogOpen","newThemeName","setNewThemeName","previewTheme","setPreviewTheme","colorConfigDialogOpen","setColorConfigDialogOpen","configuringColorKey","setConfiguringColorKey","uiThemeState","setUiThemeState","configuringButton","setConfiguringButton","configuringColumn","setConfiguringColumn","unsubscribe","loadThemes","isGlobal","endpoint","saveThemes","themesArray","errorData","customThemes","churchResponse","loadedChurchName","churchData","logoUrl","logoExists","configResponse","storeState","loadColumns","normalizedColumns","adminAPI","mappingCandidates","mappingData","res","name","rowsMapped","idx","column_name","ordinal_position","handleExportToTemplate","slug","handleSave","mapping","visibility","sortable","row","body","saveCandidates","ok","lastErr","handleCancel","handleResetDefaults","updateNewName","columnName","newName","r","toggleColumnVisibility","toggleColumnSortable","urlTable","Alert","handleImageUpload","formData","errorMessage","errorDetails","responseText","titleMatch","title","parseError","result","imageUrl","imageLibrary","updatedImages","currentImageIndex","handleSaveRecordSettings","_T","_S","_V","_U","_X","_W","Card","CardContent","StorageIcon","Tabs","newValue","Tab","PaletteIcon","newTableName","newSearchParams","CircularProgress","RefreshIcon","DownloadIcon","RadioGroup","Radio","TableContainer","Table","TableHead","TableRow","fullRow","TableCell","Tooltip","TableBody","previewData","columnMap","rowData","dataKey","cellValue","VisibilityIcon","Checkbox","Chip","column","CancelIcon","SaveIcon","ArrowBackIcon","currentState","currentThemeKey","previewTokens","handleColorDoubleClick","colorKey","Grid","AddIcon","key","newThemes","DeleteIcon","themeName","l","currentTokens","currentColor","newTokens","updatedThemes","buttonConfigs","searchRecordsConfig","themeConfig","recordTableConfigConfig","switchToAGConfig","fieldSettingsConfig","addRecordsConfig","advancedGridConfig","renderButton","buttonKey","label","icon","defaultBg","defaultHover","SearchIcon","buttonName","resolve"],"mappings":"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","x_google_ignoreList":[0,1,2,3,4,5]}