var Wr=Object.defineProperty,Or=Object.defineProperties;var Fr=Object.getOwnPropertyDescriptors;var Ha=Object.getOwnPropertySymbols;var Ir=Object.prototype.hasOwnProperty,yr=Object.prototype.propertyIsEnumerable;var Ja=(L,s,m)=>s in L?Wr(L,s,{enumerable:!0,configurable:!0,writable:!0,value:m}):L[s]=m,r=(L,s)=>{for(var m in s||(s={}))Ir.call(s,m)&&Ja(L,m,s[m]);if(Ha)for(var m of Ha(s))yr.call(s,m)&&Ja(L,m,s[m]);return L},l=(L,s)=>Or(L,Fr(s));var kr=(L,s)=>{var m={};for(var P in L)Ir.call(L,P)&&s.indexOf(P)<0&&(m[P]=L[P]);if(L!=null&&Ha)for(var P of Ha(L))s.indexOf(P)<0&&yr.call(L,P)&&(m[P]=L[P]);return m};var Ya=(L,s,m)=>Ja(L,typeof s!="symbol"?s+"":s,m);var X=(L,s,m)=>new Promise((P,C)=>{var z=$=>{try{ee(m.next($))}catch(j){C(j)}},o=$=>{try{ee(m.throw($))}catch(j){C(j)}},ee=$=>$.done?P($.value):Promise.resolve($.value).then(z,o);ee((m=m.apply(L,s)).next())});import{a as ka,j as e,B as g,d as b,R as rt,e as _,i as Re,I as st,D as Va,S as Y,F as ve,r as He,a0 as Z,a1 as ne,a2 as te,f as x,O as S,J as ua,Y as ma,K as ga,a3 as xa,aK as Ar,b9 as Er,l as Sr,m as $r,k as Nr,$ as je,U as Ae,Q as Hr,C as ta,aH as wr,T as Ne,aJ as Qa,h as ya,b4 as Ma,b3 as Mr,G as E,b8 as Tr}from"./index-CQJq875H.js";import{r as k}from"./vendor-DgfDxsY7.js";import{a as _r}from"./admin.api-DTPb-BCU.js";import{D as Gr}from"./Drawer-BLM2oWWM.js";import{C as Br}from"./Close-DTVzWelY.js";import{S as Pa}from"./Slider-C9M7HeMQ.js";import{C as pa}from"./CloudUpload-onorW2BA.js";import{S as Lr}from"./Storage-BI3MpGzj.js";import{T as Ur,a as Ga}from"./Tabs-Da3Qyh1W.js";import{U as Wa}from"./Palette-DMwJNkIh.js";import{D as zr}from"./Download-Bdr0Llqc.js";import{R as Rr,a as Oa}from"./RadioGroup-D19FSMZE.js";import{T as Ka,a as Xa,b as Za,c as ha,d as et}from"./TableRow-DCPT_a5G.js";import{T as J}from"./TableCell-MgPOxDnu.js";import{V as at}from"./Visibility-Bv0xzUo5.js";import{C as tt}from"./Cancel-BVsoGlMG.js";import{D as qr}from"./Delete-C9NyKRln.js";import{S as Dr}from"./Search-PdWkGsoG.js";import"./api.config-C9UNSeTF.js";import"./KeyboardArrowRight-Z7vVVss9.js";const Ua=ka(e.jsx("path",{d:"m20 12-1.41-1.41L13 16.17V4h-2v12.17l-5.58-5.59L4 12l8 8z"})),qa=ka(e.jsx("path",{d:"m4 12 1.41 1.41L11 7.83V20h2V7.83l5.58 5.59L20 12l-8-8z"})),Vr=ka(e.jsx("path",{fillRule:"evenodd",d:"M3 3v8h8V3zm6 6H5V5h4zm-6 4v8h8v-8zm6 6H5v-4h4zm4-16v8h8V3zm6 6h-4V5h4zm-6 4v8h8v-8zm6 6h-4v-4h4z"})),Fa=ka(e.jsx("path",{d:"M3 18h6v-2H3zM3 6v2h18V6zm0 7h12v-2H3z"})),Jr=ka(e.jsx("path",{d:"M3 14h4v-4H3zm0 5h4v-4H3zM3 9h4V5H3zm5 5h13v-4H8zm0 5h13v-4H8zM8 5v4h13V5z"})),Yr=ka(e.jsx("path",{d:"M12 7c2.76 0 5 2.24 5 5 0 .65-.13 1.26-.36 1.83l2.92 2.92c1.51-1.26 2.7-2.89 3.43-4.75-1.73-4.39-6-7.5-11-7.5-1.4 0-2.74.25-3.98.7l2.16 2.16C10.74 7.13 11.35 7 12 7M2 4.27l2.28 2.28.46.46C3.08 8.3 1.78 10.02 1 12c1.73 4.39 6 7.5 11 7.5 1.55 0 3.03-.3 4.38-.84l.42.42L19.73 22 21 20.73 3.27 3zM7.53 9.8l1.55 1.55c-.05.21-.08.43-.08.65 0 1.66 1.34 3 3 3 .22 0 .44-.03.65-.08l1.55 1.55c-.67.33-1.41.53-2.2.53-2.76 0-5-2.24-5-5 0-.79.2-1.53.53-2.2m4.31-.78 3.15 3.15.02-.16c0-1.66-1.34-3-3-3z"}));function Aa(m){return X(this,arguments,function*(L,s={}){const le=s,{churchId:P,skipChurchContext:C}=le,z=kr(le,["churchId","skipChurchContext"]);let o=P;const ee=L.match(/\/churches\/(\d+)/);if(!o&&ee&&(o=ee[1]),!o&&typeof window!="undefined")try{const w=localStorage.getItem("auth_user");if(w){const ie=JSON.parse(w);o=(ie==null?void 0:ie.church_id)||(ie==null?void 0:ie.churchId)}}catch(w){}if(!o&&typeof window!="undefined")try{const w=sessionStorage.getItem("church_id")||sessionStorage.getItem("churchId");w&&(o=w)}catch(w){}const $=new Headers(z.headers);if(!C&&o){const w=String(o).trim();w&&!["none","undefined","null","nan",""].includes(w.toLowerCase())&&$.set("X-Church-Id",w)}const j=l(r({},z),{credentials:z.credentials||"include",headers:$});return fetch(L,j)})}const re={orthodox_traditional:{headerBg:"#6b7280",headerText:"#ffffff",rowOddBg:"#f9fafb",rowEvenBg:"#ffffff",border:"#e5e7eb",accent:"#6b7280",cellText:"#1f2937"},great_lent:{headerBg:"#6b7280",headerText:"#ffffff",rowOddBg:"#f9fafb",rowEvenBg:"#ffffff",border:"#e5e7eb",accent:"#6b7280",cellText:"#1f2937"},pascha:{headerBg:"#6b7280",headerText:"#ffffff",rowOddBg:"#f9fafb",rowEvenBg:"#ffffff",border:"#e5e7eb",accent:"#6b7280",cellText:"#1f2937"},nativity:{headerBg:"#6b7280",headerText:"#ffffff",rowOddBg:"#f9fafb",rowEvenBg:"#ffffff",border:"#e5e7eb",accent:"#6b7280",cellText:"#1f2937"},palm_sunday:{headerBg:"#6b7280",headerText:"#ffffff",rowOddBg:"#f9fafb",rowEvenBg:"#ffffff",border:"#e5e7eb",accent:"#6b7280",cellText:"#1f2937"},theotokos_feasts:{headerBg:"#6b7280",headerText:"#ffffff",rowOddBg:"#f9fafb",rowEvenBg:"#ffffff",border:"#e5e7eb",accent:"#6b7280",cellText:"#1f2937"}},Pr="om.dynamicInspector";class Qr{constructor(){Ya(this,"state");Ya(this,"listeners",[]);this.state=this.loadState()}loadState(){var s;try{const m=localStorage.getItem(Pr);if(m){const P=JSON.parse(m),C=P.liturgicalTheme||"orthodox_traditional";let z,o=!1;if(C==="orthodox_traditional"){const $=["#1976d2","#2c5aa0","#724eeb","#866cff"];(s=P.tokens)!=null&&s.headerBg&&$.includes(P.tokens.headerBg)&&(o=!0),z=re.orthodox_traditional}else z=P.tokens||re[C]||re.orthodox_traditional;const ee={liturgicalTheme:C,tokens:z,fieldRules:P.fieldRules||[],branding:P.branding||{},customThemes:P.customThemes||{},actionButtonConfigs:P.actionButtonConfigs||{}};return o&&(this.state=ee,this.saveState()),ee}}catch(m){console.warn("Failed to load enhanced table state:",m)}return{liturgicalTheme:"orthodox_traditional",tokens:re.orthodox_traditional,fieldRules:[],branding:{},customThemes:{},actionButtonConfigs:{}}}saveState(){try{localStorage.setItem(Pr,JSON.stringify(this.state))}catch(s){console.warn("Failed to save enhanced table state:",s)}}notify(){this.listeners.forEach(s=>s())}getState(){return r({},this.state)}subscribe(s){return this.listeners.push(s),()=>{const m=this.listeners.indexOf(s);m>-1&&this.listeners.splice(m,1)}}setLiturgicalTheme(s){if(this.state.liturgicalTheme=s,s in re)this.state.tokens=re[s];else if(this.state.customThemes&&this.state.customThemes[s]){const m=this.state.customThemes[s];this.state.tokens={headerBg:m.headerBg,headerText:m.headerText,rowOddBg:m.rowOddBg,rowEvenBg:m.rowEvenBg,border:m.border,accent:m.accent,cellText:m.cellText}}this.saveState(),this.notify()}setCustomThemes(s){this.state.customThemes=s,this.saveState(),this.notify()}getCustomThemes(){return this.state.customThemes}updatePreDefinedTheme(s,m){re[s]=m,this.state.liturgicalTheme===s&&(this.state.tokens=m,this.saveState(),this.notify())}setFieldRules(s){this.state.fieldRules=s,this.saveState(),this.notify()}setBranding(s){this.state.branding=r(r({},this.state.branding),s),this.saveState(),this.notify()}setTokens(s){this.state.tokens=r(r({},this.state.tokens),s),this.saveState(),this.notify()}setState(s){const m=s(this.state);m.liturgicalTheme==="orthodox_traditional"&&(m.tokens.headerBg=re.orthodox_traditional.headerBg,m.tokens.accent=re.orthodox_traditional.accent),this.state=m,this.saveState(),this.notify()}exportConfig(){return r({},this.state)}importConfig(s){s.liturgicalTheme&&re[s.liturgicalTheme]&&(this.state.liturgicalTheme=s.liturgicalTheme,this.state.tokens=re[s.liturgicalTheme]),s.fieldRules&&(this.state.fieldRules=s.fieldRules),s.branding&&(this.state.branding=r(r({},this.state.branding),s.branding)),s.actionButtonConfigs&&(this.state.actionButtonConfigs=r(r({},this.state.actionButtonConfigs),s.actionButtonConfigs)),this.saveState(),this.notify()}setActionButtonConfigs(s){this.state.actionButtonConfigs=r(r({},this.state.actionButtonConfigs),s),this.saveState(),this.notify()}getActionButtonConfigs(){return this.state.actionButtonConfigs}}const A=new Qr,Kr=({churchId:L,recordType:s,churchName:m,recordSettings:P,interactive:C=!1,onElementDoubleClick:z})=>{var Me,ye,K,Te,ce,Ce,ke,_e,T,de,ue,Ge,me,H,pe,G,Be,ra,sa,oa,U,na,la,De,ge,Ue,qe,Ve,v,we,ba;const[o,ee]=k.useState(P||null),[$,j]=k.useState(!P);k.useEffect(()=>{const O=(se=!1)=>X(void 0,null,function*(){var ae,Ee,F;if(P&&!se){ee(P),j(!1);return}try{const q=se?`?t=${Date.now()}`:"",h=yield Aa(`/api/admin/churches/${L}/record-settings${q}`,{churchId:L,credentials:"include",cache:se?"no-cache":"default"});if(h.ok){const N=yield h.json();N.settings?(ee(N.settings),console.log("[RecordHeaderBanner] Settings loaded:",N.settings),console.log("[RecordHeaderBanner] Logo enabled:",(ae=N.settings.logo)==null?void 0:ae.enabled),console.log("[RecordHeaderBanner] Calendar enabled:",(Ee=N.settings.calendar)==null?void 0:Ee.enabled),console.log("[RecordHeaderBanner] OM Logo enabled:",(F=N.settings.omLogo)==null?void 0:F.enabled)):(console.log("[RecordHeaderBanner] No settings found, using empty object"),ee({}))}else console.error("[RecordHeaderBanner] Failed to load settings, status:",h.status)}catch(q){console.error("[RecordHeaderBanner] Error loading settings:",q)}finally{j(!1)}});O();const he=se=>{var ae;console.log("[RecordHeaderBanner] Settings update event received:",se.detail),((ae=se.detail)==null?void 0:ae.churchId)===L&&O(!0)};return window.addEventListener("recordSettingsUpdated",he),()=>{window.removeEventListener("recordSettingsUpdated",he)}},[L,P]);const le=O=>{var he,se,ae,Ee,F,q,h,N,ia,be,ca,Le,xe,ze,fe;if(!o)return"";switch(O){case"logo":const u=((he=o==null?void 0:o.imageLibrary)==null?void 0:he.logo)||[],c=(ae=(se=o==null?void 0:o.currentImageIndex)==null?void 0:se.logo)!=null?ae:0;return u.length>0&&u[c]?u[c]:`/images/records/${L}-logo.png`;case"recordImage":const y=((Ee=o==null?void 0:o.imageLibrary)==null?void 0:Ee[s])||[],V=(q=(F=o==null?void 0:o.currentImageIndex)==null?void 0:F[s])!=null?q:0;return y.length>0&&y[V]?y[V]:`/images/records/${s}.png`;case"bg":const Pe=((h=o==null?void 0:o.imageLibrary)==null?void 0:h.bg)||[],Ie=(ia=(N=o==null?void 0:o.currentImageIndex)==null?void 0:N.bg)!=null?ia:0;return Pe.length>0&&Pe[Ie]?Pe[Ie]:`/images/records/${L}-bg.png`;case"g1":const Je=((be=o==null?void 0:o.imageLibrary)==null?void 0:be.g1)||[],Q=(Le=(ca=o==null?void 0:o.currentImageIndex)==null?void 0:ca.g1)!=null?Le:0;return Je.length>0&&Je[Q]?Je[Q]:"/images/records/g1.png";case"omLogo":const We=((xe=o==null?void 0:o.imageLibrary)==null?void 0:xe.omLogo)||[],Se=(fe=(ze=o==null?void 0:o.currentImageIndex)==null?void 0:ze.omLogo)!=null?fe:0;return We.length>0&&We[Se]?We[Se]:"/images/records/om-logo.png";default:return""}},w=()=>{const O=new Date,he=[];for(let se=0;se<3;se++){const ae=new Date(O);ae.setDate(O.getDate()+se),he.push({month:ae.toLocaleString("en-US",{month:"short"}).toUpperCase(),year:ae.getFullYear(),weekday:ae.toLocaleString("en-US",{weekday:"short"}).toUpperCase().slice(0,3),day:ae.getDate()})}return he},ie=k.useMemo(()=>w(),[]);return $?e.jsx(g,{sx:{height:200,bgcolor:"background.paper"}}):e.jsxs(g,{sx:r({width:"100%",position:"relative",display:"flex",alignItems:"stretch",height:200,maxHeight:200,backgroundImage:((Me=o==null?void 0:o.backgroundImage)==null?void 0:Me.enabled)===!0?`url(${le("bg")})`:"none",backgroundRepeat:((ye=o==null?void 0:o.backgroundImage)==null?void 0:ye.size)==="auto"?"repeat":"no-repeat",backgroundSize:((K=o==null?void 0:o.backgroundImage)==null?void 0:K.size)||"auto",backgroundPosition:((Te=o==null?void 0:o.backgroundImage)==null?void 0:Te.position)||"top left",opacity:((ce=o==null?void 0:o.backgroundImage)==null?void 0:ce.opacity)!==void 0?o.backgroundImage.opacity/100:1,overflow:"hidden"},C&&{cursor:"pointer"}),onDoubleClick:C?()=>z==null?void 0:z("backgroundImage"):void 0,children:[((Ce=o==null?void 0:o.g1Image)==null?void 0:Ce.enabled)===!0&&e.jsx(g,{sx:r({position:"absolute",top:0,left:0,right:0,bottom:0,backgroundImage:`url(${le("g1")})`,backgroundSize:((ke=o==null?void 0:o.g1Image)==null?void 0:ke.size)||"cover",backgroundPosition:((_e=o==null?void 0:o.g1Image)==null?void 0:_e.position)||"center",opacity:((T=o==null?void 0:o.g1Image)==null?void 0:T.opacity)!==void 0?o.g1Image.opacity:.85,zIndex:0},C&&{cursor:"pointer"}),onDoubleClick:C?O=>{O.stopPropagation(),z==null||z("g1Image")}:void 0}),e.jsx(g,{sx:{position:"absolute",top:0,left:0,right:0,height:"20px",backgroundImage:"url(/images/records/gold-hor.png)",backgroundRepeat:"repeat-x",backgroundSize:"auto 100%",zIndex:10}}),e.jsx(g,{sx:{position:"absolute",left:0,top:0,bottom:0,width:"20px",backgroundImage:"url(/images/records/gold-vertical.png)",backgroundRepeat:"repeat-y",backgroundSize:"100% auto",zIndex:10}}),e.jsx(g,{sx:{position:"absolute",right:0,top:0,bottom:0,width:"20px",backgroundImage:"url(/images/records/gold-vertical.png)",backgroundRepeat:"repeat-y",backgroundSize:"100% auto",zIndex:10}}),e.jsx(g,{sx:{position:"absolute",bottom:0,left:0,right:0,height:"20px",backgroundImage:"url(/images/records/gold-hor.png)",backgroundRepeat:"repeat-x",backgroundSize:"auto 100%",zIndex:10}}),e.jsxs(g,{sx:{width:"100%",ml:"20px",mr:"20px",mt:"10px",mb:"10px",pl:2,pr:2,display:"grid",gridTemplateColumns:"1fr 1fr 1fr 1fr",gap:2,alignItems:"stretch",position:"relative",zIndex:1,height:"100%"},children:[((de=o==null?void 0:o.recordImages)==null?void 0:de.enabled)!==!1&&e.jsxs(g,{sx:r({display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",gridColumn:((ue=o==null?void 0:o.recordImages)==null?void 0:ue.column)||1,position:"relative",height:"100%",zIndex:2},C&&{cursor:"pointer","&:hover":{outline:"2px dashed #1976d2",outlineOffset:"2px"}}),onDoubleClick:C?O=>{O.stopPropagation(),z==null||z("recordImage")}:void 0,children:[e.jsx(g,{component:"img",src:le("recordImage"),alt:"Record Image",sx:{width:`${((Ge=o==null?void 0:o.recordImages)==null?void 0:Ge.width)||60}px`,height:`${((me=o==null?void 0:o.recordImages)==null?void 0:me.height)||60}px`,objectFit:((H=o==null?void 0:o.recordImages)==null?void 0:H.objectFit)||"contain",border:`${((pe=o==null?void 0:o.recordImages)==null?void 0:pe.borderWidth)||3}px solid #4C1D95`,borderRadius:2,boxShadow:"0 4px 12px rgba(76, 29, 149, 0.3)"},onError:O=>{O.target.src=`/images/records/${s}.png`}}),C&&e.jsx(b,{variant:"caption",sx:{mt:.5,bgcolor:"rgba(255,255,255,0.8)",px:.5,borderRadius:.5},children:"Record Image"})]}),((G=o==null?void 0:o.calendar)==null?void 0:G.enabled)===!0&&e.jsx(g,{sx:r({display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",gridColumn:((Be=o==null?void 0:o.calendar)==null?void 0:Be.column)||2,position:"relative",height:"100%",zIndex:2,gap:.5},C&&{cursor:"pointer","&:hover":{outline:"2px dashed #1976d2",outlineOffset:"2px"}}),onDoubleClick:C?O=>{O.stopPropagation(),z==null||z("calendar")}:void 0,children:e.jsx(g,{sx:{display:"flex",flexDirection:"column",gap:.5,alignItems:"center"},children:ie.map((O,he)=>e.jsxs(g,{sx:{width:"50px",height:"55px",background:"linear-gradient(145deg, #ffffff 0%, #f5f0e6 50%, #e8dcc8 100%)",borderRadius:"8px",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",boxShadow:"0 4px 12px rgba(0,0,0,0.2)",border:"2px solid #DAA520",transform:`translateY(${he*-2}px) rotate(${(he-1)*1.5}deg)`,position:"relative",overflow:"hidden","&::before":{content:'""',position:"absolute",top:0,left:0,right:0,height:"14px",background:"linear-gradient(180deg, #8B0000 0%, #5c0000 100%)",borderRadius:"6px 6px 0 0"}},children:[e.jsxs(b,{sx:{fontSize:"6px",fontWeight:800,color:"#fff",zIndex:1,mt:"-1px"},children:[O.month," ",O.year]}),e.jsx(b,{sx:{fontSize:"7px",fontWeight:700,color:"#4C1D95",mt:.25},children:O.weekday}),e.jsx(b,{sx:{fontSize:"16px",fontWeight:900,color:"#1a1a2e",lineHeight:1},children:O.day})]},he))})}),((ra=o==null?void 0:o.logo)==null?void 0:ra.enabled)===!0&&e.jsx(g,{sx:r({display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",gridColumn:((sa=o==null?void 0:o.logo)==null?void 0:sa.column)||3,position:"relative",height:"100%",zIndex:2},C&&{cursor:"pointer","&:hover":{outline:"2px dashed #1976d2",outlineOffset:"2px"}}),onDoubleClick:C?O=>{O.stopPropagation(),z==null||z("logo")}:void 0,children:e.jsx(g,{component:"img",src:le("logo"),alt:"Church Logo",sx:{width:`${((oa=o==null?void 0:o.logo)==null?void 0:oa.width)||120}px`,height:((U=o==null?void 0:o.logo)==null?void 0:U.height)==="auto"?"auto":`${((na=o==null?void 0:o.logo)==null?void 0:na.height)||120}px`,maxHeight:"160px",objectFit:((la=o==null?void 0:o.logo)==null?void 0:la.objectFit)||"contain",opacity:(((De=o==null?void 0:o.logo)==null?void 0:De.opacity)||100)/100},onError:O=>{O.target.src="/images/records/om-logo.png"}})}),((ge=o==null?void 0:o.omLogo)==null?void 0:ge.enabled)===!0&&e.jsx(g,{sx:r({display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",gridColumn:((Ue=o==null?void 0:o.omLogo)==null?void 0:Ue.column)||4,position:"relative",height:"100%",zIndex:2},C&&{cursor:"pointer","&:hover":{outline:"2px dashed #1976d2",outlineOffset:"2px"}}),onDoubleClick:C?O=>{O.stopPropagation(),z==null||z("omLogo")}:void 0,children:e.jsx(g,{component:"img",src:le("omLogo"),alt:"OM Logo",sx:{width:`${((qe=o==null?void 0:o.omLogo)==null?void 0:qe.width)||68}px`,height:((Ve=o==null?void 0:o.omLogo)==null?void 0:Ve.height)==="auto"?"auto":`${((v=o==null?void 0:o.omLogo)==null?void 0:v.height)||68}px`,objectFit:((we=o==null?void 0:o.omLogo)==null?void 0:we.objectFit)||"contain",opacity:(((ba=o==null?void 0:o.omLogo)==null?void 0:ba.opacity)||100)/100}})})]})]})},Xr=({churchId:L,recordSettings:s,setRecordSettings:m,onImageUpload:P,recordType:C="baptism",churchName:z})=>{var Te,ce,Ce,ke,_e,T,de,ue,Ge,me,H,pe,G,Be,ra,sa,oa,U,na,la,De,ge,Ue,qe,Ve,v,we,ba,O,he,se,ae,Ee,F,q,h,N,ia,be,ca,Le,xe,ze,fe;const[o,ee]=k.useState(!1),[$,j]=k.useState(null),[le,w]=k.useState(!1),[ie,Me]=k.useState(null),ye=u=>{j(u),ee(!0)},K=u=>{var c,y,V,Pe,Ie,Je,Q,We,Se,fa,wa,$e,Ta,Ea,Sa;switch(u){case"logo":const da=((c=s==null?void 0:s.imageLibrary)==null?void 0:c.logo)||[],$a=(V=(y=s==null?void 0:s.currentImageIndex)==null?void 0:y.logo)!=null?V:0;return da.length>0&&da[$a]?da[$a]:`/images/records/${L}-logo.png`;case"recordImage":const ja=((Pe=s==null?void 0:s.imageLibrary)==null?void 0:Pe[C])||[],_a=(Je=(Ie=s==null?void 0:s.currentImageIndex)==null?void 0:Ie[C])!=null?Je:0;return ja.length>0&&ja[_a]?ja[_a]:`/images/records/${C}.png`;case"baptism":case"marriage":case"funeral":return`/images/records/${u}.png`;case"bg":const va=((Q=s==null?void 0:s.imageLibrary)==null?void 0:Q.bg)||[],Ba=(Se=(We=s==null?void 0:s.currentImageIndex)==null?void 0:We.bg)!=null?Se:0;return va.length>0&&va[Ba]?va[Ba]:`/images/records/${L}-bg.png`;case"g1":const La=((fa=s==null?void 0:s.imageLibrary)==null?void 0:fa.g1)||[],za=($e=(wa=s==null?void 0:s.currentImageIndex)==null?void 0:wa.g1)!=null?$e:0;return La.length>0&&La[za]?La[za]:"/images/records/g1.png";case"omLogo":const a=((Ta=s==null?void 0:s.imageLibrary)==null?void 0:Ta.omLogo)||[],t=(Sa=(Ea=s==null?void 0:s.currentImageIndex)==null?void 0:Ea.omLogo)!=null?Sa:0;return a.length>0&&a[t]?a[t]:"/images/records/om-logo.png";default:return""}};return e.jsxs(g,{sx:{mb:4},children:[e.jsx(b,{variant:"h6",gutterBottom:!0,sx:{mb:2},children:"Live Preview"}),e.jsx(b,{variant:"body2",color:"text.secondary",sx:{mb:2},children:"Double-click any element to configure it. This preview matches the actual header on the records page."}),e.jsx(rt,{variant:"outlined",sx:{overflow:"hidden",borderRadius:1,position:"relative"},children:e.jsxs(g,{sx:{position:"relative"},children:[e.jsx(Kr,{churchId:L,recordType:C,churchName:z,recordSettings:s,interactive:!0,onElementDoubleClick:ye}),[1,2,3,4].map(u=>e.jsx(g,{sx:{position:"absolute",top:-8,left:`calc(${(u-1)*25}% + ${u===1?"8px":u===4?"-8px":"0px"})`,width:"25%",textAlign:"center",zIndex:20,pointerEvents:"none"},children:e.jsxs(b,{variant:"caption",sx:{bgcolor:"rgba(255,255,255,0.9)",px:1,py:.25,borderRadius:1,fontSize:"0.65rem",color:"text.secondary"},children:["Col ",u]})},`label-${u}`))]})}),e.jsxs(g,{sx:{mt:2,display:"flex",gap:1,flexWrap:"wrap"},children:[e.jsx(_,{size:"small",variant:"outlined",startIcon:e.jsx(Re,{}),onClick:()=>ye("recordImage"),children:"Record Image"}),e.jsx(_,{size:"small",variant:"outlined",startIcon:e.jsx(Re,{}),onClick:()=>ye("calendar"),children:"Calendar"}),e.jsx(_,{size:"small",variant:"outlined",startIcon:e.jsx(Re,{}),onClick:()=>ye("logo"),children:"Church Logo"}),e.jsx(_,{size:"small",variant:"outlined",startIcon:e.jsx(Re,{}),onClick:()=>ye("omLogo"),children:"OM Logo"}),e.jsx(_,{size:"small",variant:"outlined",startIcon:e.jsx(Re,{}),onClick:()=>ye("backgroundImage"),children:"Background"}),e.jsx(_,{size:"small",variant:"outlined",startIcon:e.jsx(Re,{}),onClick:()=>ye("g1Image"),children:"G1 Overlay"})]}),e.jsx(Gr,{anchor:"right",open:o,onClose:()=>ee(!1),PaperProps:{sx:{width:{xs:"90%",sm:400},maxWidth:500}},children:e.jsxs(g,{sx:{p:3},children:[e.jsxs(g,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between",mb:2},children:[e.jsxs(b,{variant:"h6",children:["Configure ",$==="logo"?"Church Logo":$==="calendar"?"Calendar Cards":$==="omLogo"?"OM Logo":$==="recordImage"?"Record Image":$==="backgroundImage"?"Background Image":$==="g1Image"?"G1 Overlay":"Element"]}),e.jsx(st,{onClick:()=>ee(!1),children:e.jsx(Br,{})})]}),e.jsx(Va,{sx:{mb:2}}),e.jsxs(g,{sx:{maxHeight:"calc(100vh - 120px)",overflowY:"auto"},children:[$==="logo"&&e.jsxs(Y,{spacing:2,children:[e.jsx(ve,{control:e.jsx(He,{checked:(ce=(Te=s.logo)==null?void 0:Te.enabled)!=null?ce:!0,onChange:u=>m(c=>l(r({},c),{logo:l(r({},c.logo),{enabled:u.target.checked})}))}),label:"Display Church Logo"}),((Ce=s.logo)==null?void 0:Ce.enabled)!==!1&&e.jsxs(e.Fragment,{children:[e.jsxs(Z,{fullWidth:!0,children:[e.jsx(ne,{children:"Column Position"}),e.jsxs(te,{value:((ke=s.logo)==null?void 0:ke.column)||3,onChange:u=>m(c=>l(r({},c),{logo:l(r({},c.logo),{column:Number(u.target.value)})})),label:"Column Position",children:[e.jsx(x,{value:1,children:"Column 1 (Left)"}),e.jsx(x,{value:2,children:"Column 2"}),e.jsx(x,{value:3,children:"Column 3"}),e.jsx(x,{value:4,children:"Column 4 (Right)"})]})]}),e.jsx(S,{label:"Width (px)",type:"number",value:((_e=s.logo)==null?void 0:_e.width)||120,onChange:u=>m(c=>l(r({},c),{logo:l(r({},c.logo),{width:Number(u.target.value)})})),fullWidth:!0}),e.jsx(S,{label:"Height (px or 'auto')",value:((T=s.logo)==null?void 0:T.height)||"auto",onChange:u=>m(c=>l(r({},c),{logo:l(r({},c.logo),{height:u.target.value==="auto"?"auto":isNaN(Number(u.target.value))?u.target.value:Number(u.target.value)})})),fullWidth:!0}),e.jsxs(Z,{fullWidth:!0,children:[e.jsx(ne,{children:"Object Fit"}),e.jsxs(te,{value:((de=s.logo)==null?void 0:de.objectFit)||"contain",onChange:u=>m(c=>l(r({},c),{logo:l(r({},c.logo),{objectFit:u.target.value})})),label:"Object Fit",children:[e.jsx(x,{value:"contain",children:"Contain"}),e.jsx(x,{value:"cover",children:"Cover"}),e.jsx(x,{value:"fill",children:"Fill"}),e.jsx(x,{value:"none",children:"None"})]})]}),e.jsxs(g,{children:[e.jsxs(b,{gutterBottom:!0,children:["Opacity: ",((ue=s.logo)==null?void 0:ue.opacity)||100,"%"]}),e.jsx(Pa,{value:((Ge=s.logo)==null?void 0:Ge.opacity)||100,onChange:(u,c)=>m(y=>l(r({},y),{logo:l(r({},y.logo),{opacity:c})})),min:10,max:100,step:5})]}),e.jsxs(_,{variant:"outlined",component:"label",startIcon:e.jsx(pa,{}),fullWidth:!0,children:["Upload Logo Image",e.jsx("input",{type:"file",hidden:!0,accept:"image/*",onChange:u=>{var y;const c=(y=u.target.files)==null?void 0:y[0];c&&P("logo",c)}})]})]})]}),$==="calendar"&&e.jsxs(Y,{spacing:2,children:[e.jsx(ve,{control:e.jsx(He,{checked:(H=(me=s.calendar)==null?void 0:me.enabled)!=null?H:!0,onChange:u=>m(c=>l(r({},c),{calendar:l(r({},c.calendar),{enabled:u.target.checked})}))}),label:"Display Calendar Cards"}),((pe=s.calendar)==null?void 0:pe.enabled)!==!1&&e.jsxs(Z,{fullWidth:!0,children:[e.jsx(ne,{children:"Column Position"}),e.jsxs(te,{value:((G=s.calendar)==null?void 0:G.column)||2,onChange:u=>m(c=>l(r({},c),{calendar:l(r({},c.calendar),{column:Number(u.target.value)})})),label:"Column Position",children:[e.jsx(x,{value:1,children:"Column 1 (Left)"}),e.jsx(x,{value:2,children:"Column 2"}),e.jsx(x,{value:3,children:"Column 3"}),e.jsx(x,{value:4,children:"Column 4 (Right)"})]})]})]}),$==="omLogo"&&e.jsxs(Y,{spacing:2,children:[e.jsx(ve,{control:e.jsx(He,{checked:(ra=(Be=s.omLogo)==null?void 0:Be.enabled)!=null?ra:!0,onChange:u=>m(c=>l(r({},c),{omLogo:l(r({},c.omLogo),{enabled:u.target.checked})}))}),label:"Display OM Logo"}),((sa=s.omLogo)==null?void 0:sa.enabled)!==!1&&e.jsxs(e.Fragment,{children:[e.jsxs(Z,{fullWidth:!0,children:[e.jsx(ne,{children:"Column Position"}),e.jsxs(te,{value:((oa=s.omLogo)==null?void 0:oa.column)||4,onChange:u=>m(c=>l(r({},c),{omLogo:l(r({},c.omLogo),{column:Number(u.target.value)})})),label:"Column Position",children:[e.jsx(x,{value:1,children:"Column 1 (Left)"}),e.jsx(x,{value:2,children:"Column 2"}),e.jsx(x,{value:3,children:"Column 3"}),e.jsx(x,{value:4,children:"Column 4 (Right)"})]})]}),e.jsx(S,{label:"Width (px)",type:"number",value:((U=s.omLogo)==null?void 0:U.width)||68,onChange:u=>m(c=>l(r({},c),{omLogo:l(r({},c.omLogo),{width:Number(u.target.value)})})),fullWidth:!0}),e.jsx(S,{label:"Height (px)",type:"number",value:((na=s.omLogo)==null?void 0:na.height)||68,onChange:u=>m(c=>l(r({},c),{omLogo:l(r({},c.omLogo),{height:Number(u.target.value)})})),fullWidth:!0}),e.jsxs(Z,{fullWidth:!0,children:[e.jsx(ne,{children:"Object Fit"}),e.jsxs(te,{value:((la=s.omLogo)==null?void 0:la.objectFit)||"contain",onChange:u=>m(c=>l(r({},c),{omLogo:l(r({},c.omLogo),{objectFit:u.target.value})})),label:"Object Fit",children:[e.jsx(x,{value:"contain",children:"Contain"}),e.jsx(x,{value:"cover",children:"Cover"}),e.jsx(x,{value:"fill",children:"Fill"}),e.jsx(x,{value:"none",children:"None"})]})]}),e.jsxs(g,{children:[e.jsxs(b,{gutterBottom:!0,children:["Opacity: ",((De=s.omLogo)==null?void 0:De.opacity)||100,"%"]}),e.jsx(Pa,{value:((ge=s.omLogo)==null?void 0:ge.opacity)||100,onChange:(u,c)=>m(y=>l(r({},y),{omLogo:l(r({},y.omLogo),{opacity:c})})),min:10,max:100,step:5})]}),e.jsxs(_,{variant:"outlined",component:"label",startIcon:e.jsx(pa,{}),fullWidth:!0,children:["Upload OM Logo",e.jsx("input",{type:"file",hidden:!0,accept:"image/*",onChange:u=>{var y;const c=(y=u.target.files)==null?void 0:y[0];c&&P("omLogo",c)}})]})]})]}),$==="recordImage"&&e.jsxs(Y,{spacing:2,children:[e.jsx(ve,{control:e.jsx(He,{checked:((Ue=s.recordImages)==null?void 0:Ue.enabled)!==!1,onChange:u=>m(c=>l(r({},c),{recordImages:l(r({},c.recordImages),{enabled:u.target.checked})}))}),label:"Display Record Image"}),((qe=s.recordImages)==null?void 0:qe.enabled)!==!1&&e.jsxs(e.Fragment,{children:[e.jsxs(Z,{fullWidth:!0,children:[e.jsx(ne,{children:"Column Position"}),e.jsxs(te,{value:((Ve=s.recordImages)==null?void 0:Ve.column)||1,onChange:u=>m(c=>l(r({},c),{recordImages:l(r({},c.recordImages),{column:Number(u.target.value)})})),label:"Column Position",children:[e.jsx(x,{value:1,children:"Column 1 (Left)"}),e.jsx(x,{value:2,children:"Column 2"}),e.jsx(x,{value:3,children:"Column 3"}),e.jsx(x,{value:4,children:"Column 4 (Right)"})]})]}),e.jsx(S,{label:"Width (px)",type:"number",value:((v=s.recordImages)==null?void 0:v.width)||60,onChange:u=>m(c=>l(r({},c),{recordImages:l(r({},c.recordImages),{width:Number(u.target.value)})})),fullWidth:!0}),e.jsx(S,{label:"Height (px)",type:"number",value:((we=s.recordImages)==null?void 0:we.height)||60,onChange:u=>m(c=>l(r({},c),{recordImages:l(r({},c.recordImages),{height:Number(u.target.value)})})),fullWidth:!0}),e.jsxs(Z,{fullWidth:!0,children:[e.jsx(ne,{children:"Object Fit"}),e.jsxs(te,{value:((ba=s.recordImages)==null?void 0:ba.objectFit)||"contain",onChange:u=>m(c=>l(r({},c),{recordImages:l(r({},c.recordImages),{objectFit:u.target.value})})),label:"Object Fit",children:[e.jsx(x,{value:"contain",children:"Contain"}),e.jsx(x,{value:"cover",children:"Cover"}),e.jsx(x,{value:"fill",children:"Fill"}),e.jsx(x,{value:"none",children:"None"})]})]}),e.jsxs(g,{children:[e.jsxs(b,{gutterBottom:!0,children:["Border Width: ",((O=s.recordImages)==null?void 0:O.borderWidth)||3,"px"]}),e.jsx(Pa,{value:((he=s.recordImages)==null?void 0:he.borderWidth)||3,onChange:(u,c)=>m(y=>l(r({},y),{recordImages:l(r({},y.recordImages),{borderWidth:c})})),min:0,max:10,step:1})]}),e.jsxs(_,{variant:"outlined",component:"label",startIcon:e.jsx(pa,{}),fullWidth:!0,children:["Upload Record Image",e.jsx("input",{type:"file",hidden:!0,accept:"image/*",onChange:u=>{var y;const c=(y=u.target.files)==null?void 0:y[0];c&&P(C||"baptism",c)}})]})]})]}),$==="backgroundImage"&&e.jsxs(Y,{spacing:2,children:[e.jsx(ve,{control:e.jsx(He,{checked:(ae=(se=s.backgroundImage)==null?void 0:se.enabled)!=null?ae:!0,onChange:u=>m(c=>l(r({},c),{backgroundImage:l(r({},c.backgroundImage),{enabled:u.target.checked})}))}),label:"Display Background Image"}),((Ee=s.backgroundImage)==null?void 0:Ee.enabled)!==!1&&e.jsxs(e.Fragment,{children:[e.jsxs(Z,{fullWidth:!0,children:[e.jsx(ne,{children:"Background Size"}),e.jsxs(te,{value:((F=s.backgroundImage)==null?void 0:F.size)||"auto",onChange:u=>m(c=>l(r({},c),{backgroundImage:l(r({},c.backgroundImage),{size:u.target.value})})),label:"Background Size",children:[e.jsx(x,{value:"auto",children:"Auto (Repeat)"}),e.jsx(x,{value:"cover",children:"Cover"}),e.jsx(x,{value:"contain",children:"Contain"}),e.jsx(x,{value:"100% 100%",children:"Stretch"})]})]}),e.jsxs(Z,{fullWidth:!0,children:[e.jsx(ne,{children:"Background Position"}),e.jsxs(te,{value:((q=s.backgroundImage)==null?void 0:q.position)||"top left",onChange:u=>m(c=>l(r({},c),{backgroundImage:l(r({},c.backgroundImage),{position:u.target.value})})),label:"Background Position",children:[e.jsx(x,{value:"top left",children:"Top Left"}),e.jsx(x,{value:"top center",children:"Top Center"}),e.jsx(x,{value:"top right",children:"Top Right"}),e.jsx(x,{value:"center left",children:"Center Left"}),e.jsx(x,{value:"center center",children:"Center"}),e.jsx(x,{value:"center right",children:"Center Right"}),e.jsx(x,{value:"bottom left",children:"Bottom Left"}),e.jsx(x,{value:"bottom center",children:"Bottom Center"}),e.jsx(x,{value:"bottom right",children:"Bottom Right"})]})]}),e.jsxs(g,{children:[e.jsxs(b,{gutterBottom:!0,children:["Opacity: ",((h=s.backgroundImage)==null?void 0:h.opacity)||100,"%"]}),e.jsx(Pa,{value:((N=s.backgroundImage)==null?void 0:N.opacity)||100,onChange:(u,c)=>m(y=>l(r({},y),{backgroundImage:l(r({},y.backgroundImage),{opacity:c})})),min:0,max:100,step:5})]}),e.jsxs(_,{variant:"outlined",component:"label",startIcon:e.jsx(pa,{}),fullWidth:!0,children:["Upload Background Image",e.jsx("input",{type:"file",hidden:!0,accept:"image/*",onChange:u=>{var y;const c=(y=u.target.files)==null?void 0:y[0];c&&P("bg",c)}})]}),e.jsxs(b,{variant:"caption",color:"text.secondary",children:["Background image will be saved as: ",L,"-bg.png"]})]})]}),$==="g1Image"&&e.jsxs(Y,{spacing:2,children:[e.jsx(ve,{control:e.jsx(He,{checked:(be=(ia=s.g1Image)==null?void 0:ia.enabled)!=null?be:!0,onChange:u=>m(c=>l(r({},c),{g1Image:l(r({},c.g1Image),{enabled:u.target.checked})}))}),label:"Display G1 Overlay"}),((ca=s.g1Image)==null?void 0:ca.enabled)!==!1&&e.jsxs(e.Fragment,{children:[e.jsx(b,{variant:"body2",color:"text.secondary",children:"The G1 overlay provides a gradient effect over the background image."}),e.jsxs(Z,{fullWidth:!0,children:[e.jsx(ne,{children:"Overlay Size"}),e.jsxs(te,{value:((Le=s.g1Image)==null?void 0:Le.size)||"cover",onChange:u=>m(c=>l(r({},c),{g1Image:l(r({},c.g1Image),{size:u.target.value})})),label:"Overlay Size",children:[e.jsx(x,{value:"cover",children:"Cover"}),e.jsx(x,{value:"contain",children:"Contain"}),e.jsx(x,{value:"100% 100%",children:"Stretch"})]})]}),e.jsxs(Z,{fullWidth:!0,children:[e.jsx(ne,{children:"Overlay Position"}),e.jsxs(te,{value:((xe=s.g1Image)==null?void 0:xe.position)||"center",onChange:u=>m(c=>l(r({},c),{g1Image:l(r({},c.g1Image),{position:u.target.value})})),label:"Overlay Position",children:[e.jsx(x,{value:"top left",children:"Top Left"}),e.jsx(x,{value:"top center",children:"Top Center"}),e.jsx(x,{value:"top right",children:"Top Right"}),e.jsx(x,{value:"center left",children:"Center Left"}),e.jsx(x,{value:"center",children:"Center"}),e.jsx(x,{value:"center right",children:"Center Right"}),e.jsx(x,{value:"bottom left",children:"Bottom Left"}),e.jsx(x,{value:"bottom center",children:"Bottom Center"}),e.jsx(x,{value:"bottom right",children:"Bottom Right"})]})]}),e.jsxs(g,{children:[e.jsxs(b,{gutterBottom:!0,children:["Opacity: ",Math.round((((ze=s.g1Image)==null?void 0:ze.opacity)||.85)*100),"%"]}),e.jsx(Pa,{value:(((fe=s.g1Image)==null?void 0:fe.opacity)||.85)*100,onChange:(u,c)=>m(y=>l(r({},y),{g1Image:l(r({},y.g1Image),{opacity:c/100})})),min:0,max:100,step:5})]}),e.jsxs(_,{variant:"outlined",component:"label",startIcon:e.jsx(pa,{}),fullWidth:!0,children:["Upload G1 Overlay Image",e.jsx("input",{type:"file",hidden:!0,accept:"image/*",onChange:u=>{var y;const c=(y=u.target.files)==null?void 0:y[0];c&&P("g1",c)}})]})]})]})]})]})}),e.jsxs(ua,{open:le,onClose:()=>w(!1),maxWidth:"sm",fullWidth:!0,children:[e.jsxs(ma,{children:["Upload Image",e.jsx(st,{onClick:()=>w(!1),sx:{position:"absolute",right:8,top:8},children:e.jsx(Br,{})})]}),e.jsx(ga,{children:e.jsxs(Y,{spacing:2,sx:{mt:1},children:[e.jsxs(_,{variant:"outlined",component:"label",startIcon:e.jsx(pa,{}),fullWidth:!0,children:["Select Image File",e.jsx("input",{type:"file",hidden:!0,accept:"image/*",onChange:u=>{var y;const c=(y=u.target.files)==null?void 0:y[0];c&&ie&&(P(ie,c),w(!1))}})]}),e.jsxs(g,{sx:{textAlign:"center",p:2,border:"1px dashed",borderColor:"divider",borderRadius:1},children:[e.jsxs(b,{variant:"body2",color:"text.secondary",children:["Current: ",K(ie||"logo")]}),e.jsx(g,{component:"img",src:K(ie||"logo"),alt:"Current",sx:{maxWidth:"100%",maxHeight:200,mt:1,objectFit:"contain"},onError:u=>{u.target.style.display="none"}})]})]})}),e.jsx(xa,{children:e.jsx(_,{onClick:()=>w(!1),children:"Cancel"})})]})]})},Zr=[{id:1,first_name:"Paul",last_name:"Harris",birth_date:"3/30/1952",reception_date:"2/4/1953",birthplace:"New York",entry_type:"Chrismation",sponsors:"Katherine Owens; James Franklin",parents:"Christopher Harris & Claire Franklin",clergy:"Fr. Michael Taylor"},{id:2,first_name:"Mary",last_name:"Fletcher",birth_date:"8/13/1969",reception_date:"5/8/1970",birthplace:"Detroit",entry_type:"Baptism",sponsors:"Jonathan Thompson; Mary Powers",parents:"Andrew Fletcher & Madeline Warren",clergy:"Fr. George Davis"},{id:3,first_name:"Lydia",last_name:"Richards",birth_date:"8/1/1950",reception_date:"2/10/1951",birthplace:"Pittsburgh",entry_type:"Baptism",sponsors:"Luke Griffin; Olivia Richards",parents:"Anna Richards & Laura Vaughn",clergy:"Fr. Michael Brown"}],es=[{id:1,married_date_name:"11/20/2004 Emily Griffin",last_name:"Nathan Bennett",parents_groom:"Olivia Griffin & Joseph Bates",parents:"Charlotte Bennett & Victoria Ellis",witnesses:"Daniel Ingram; James Ulrich",marriage_license:"ML-720644",clergy:"Fr. John Ta"},{id:2,married_date_name:"6/14/2008 Benjamin York",last_name:"Mary Fletcher",parents_groom:"James York & Naomi Ingram",parents:"Rachel Fletcher & Elizabeth Quinn",witnesses:"Samuel Underwood; Laura Ingram",marriage_license:"ML-898207",clergy:"Fr. Andrew"},{id:3,married_date_name:"8/19/1992 Samuel Richards",last_name:"Philis Bishop",parents_groom:"Gabriella Richards & Sarah Knight",parents:"Mary Bishop & Caroline Ortega",witnesses:"Elizabeth Walker; Matthew Warren",marriage_license:"ML-890870",clergy:"Fr. Michae"},{id:4,married_date_name:"9/3/1983 Mary Parker",last_name:"Andrew Bennett",parents_groom:"Katherine Parker & James Knight",parents:"Joseph Bennett & Rebecca Reeves",witnesses:"Laura Ingram; Luke Quinn",marriage_license:"ML-735324",clergy:"Fr. Andrew"}],as=[{id:1,date_of_deceased:"11/1/2068",date_of_burial:"11/3/2068",first_name:"Adam",last_name:"Ingram",age:77,clergy:"Fr. Andrew Taylor",burial_location:"Resurrection Cemetery"},{id:2,date_of_deceased:"10/28/2040",date_of_burial:"11/5/2040",first_name:"Joseph",last_name:"Quinn",age:53,clergy:"Fr. Michael Brown",burial_location:"St. George Cemetery"},{id:3,date_of_deceased:"9/23/2010",date_of_burial:"9/26/2010",first_name:"Sarah",last_name:"Griffin",age:73,clergy:"Fr. John Moore",burial_location:"St. George Cemetery"},{id:4,date_of_deceased:"6/21/2040",date_of_burial:"6/26/2040",first_name:"Peter",last_name:"Walker",age:44,clergy:"Fr. Thomas Moore",burial_location:"St. George Cemetery"},{id:5,date_of_deceased:"1/10/2012",date_of_burial:"1/18/2012",first_name:"Benjamin",last_name:"Morris",age:53,clergy:"Fr. Peter Brown",burial_location:"Resurrection Cemetery"},{id:6,date_of_deceased:"3/24/2036",date_of_burial:"3/29/2036",first_name:"Patrick",last_name:"Powers",age:50,clergy:"Fr. Peter Taylor",burial_location:"St. Nicholas Cemetery"}],ks=()=>{var za;const{id:L}=Ar(),[s,m]=Er(),P=Sr(),C=$r(),{user:z}=Nr(),o=a=>{if(a==null||a==="")return null;const t=typeof a=="string"?parseInt(a,10):Number(a);return!isNaN(t)&&t>0?t:null},ee=o(L),$=o(z==null?void 0:z.church_id),j=ee||$,le=s.get("table")||"baptism_records",[w,ie]=k.useState(le),Me=a=>a==="baptism_records"?"baptism":a==="marriage_records"?"marriage":a==="funeral_records"?"funeral":"baptism",ye=()=>{const a=Me(le);P(`/apps/records/${a}`)},[K,Te]=k.useState([]),[ce,Ce]=k.useState(""),[ke,_e]=k.useState("asc"),[T,de]=k.useState(!1),[ue,Ge]=k.useState(!1),[me,H]=k.useState(null),[pe,G]=k.useState(null),[Be,ra]=k.useState(0),[sa,oa]=k.useState(""),[U,na]=k.useState("en"),[la,De]=k.useState(!1),[ge,Ue]=k.useState(!1),[qe,Ve]=k.useState(!1),[v,we]=k.useState({logo:{enabled:!0,column:3,file:null,width:200,height:200,objectFit:"contain",opacity:100,quadrant:"middle",horizontalPosition:"center"},calendar:{enabled:!0,column:2,quadrant:"middle",horizontalPosition:"center"},omLogo:{enabled:!0,column:4,width:68,height:68,quadrant:"middle",horizontalPosition:"center"},headerText:{fontFamily:"Arial, sans-serif",fontSize:16,fontWeight:700,color:"#4C1D95",column:1,position:"above",quadrant:"middle",horizontalPosition:"center"},recordImages:{column:1,quadrant:"middle",horizontalPosition:"center",width:160,height:160},backgroundImage:{enabled:!0,column:0,images:[],currentIndex:0,quadrant:"middle"},g1Image:{enabled:!0,column:0,images:[],currentIndex:0,quadrant:"middle"},imageLibrary:{logo:[],omLogo:[],baptism:[],marriage:[],funeral:[],bg:[],g1:[],recordImage:[]},currentImageIndex:{logo:0,omLogo:0,baptism:0,marriage:0,funeral:0,bg:0,g1:0,recordImage:0}}),[ba,O]=k.useState({branding:{churchName:"",logoUrl:void 0,logoPreview:void 0,logoAlign:"left",showBrandHeader:!0},liturgicalTheme:"orthodox_traditional",fieldRules:[]}),[he,se]=k.useState(null),[ae,Ee]=k.useState(!1),[F,q]=k.useState({isGlobal:!1,themes:{},selectedTheme:""}),[h,N]=k.useState(null),[ia,be]=k.useState(!1),[ca,Le]=k.useState(!1),[xe,ze]=k.useState(""),[fe,u]=k.useState(null),[c,y]=k.useState(!1),[V,Pe]=k.useState(null),[Ie,Je]=k.useState(A.getState()),[Q,We]=k.useState(null),[Se,fa]=k.useState(null);k.useEffect(()=>{const a=A.subscribe(()=>{Je(A.getState()),u(null)});return()=>a()},[]);const wa=a=>X(void 0,null,function*(){if(!a&&!j){console.error("Cannot load church themes: invalid church ID");return}try{const t=a?"/api/admin/churches/themes/global":`/api/admin/churches/${j}/themes`,n=yield fetch(t,{credentials:"include"});if(n.ok){const i=yield n.json();i.themes?(q(p=>l(r({},p),{themes:i.themes,isGlobal:a})),a||A.setCustomThemes(i.themes)):(q(p=>l(r({},p),{themes:{},isGlobal:a})),a||A.setCustomThemes({}))}else q(i=>l(r({},i),{themes:{},isGlobal:a})),a||A.setCustomThemes({})}catch(t){console.error("Error loading themes:",t),q(n=>l(r({},n),{themes:{},isGlobal:a})),a||A.setCustomThemes({})}}),$e=()=>X(void 0,null,function*(){if(!F.isGlobal&&!j){H("Invalid church ID. Cannot save themes.");return}try{de(!0),H(null),G(null);const a=F.isGlobal?"/api/admin/churches/themes/global":`/api/admin/churches/${j}/themes`,t=Object.values(F.themes||{}).filter(i=>i&&i.name),n=yield fetch(a,{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({themes:t})});if(!n.ok){const i=yield n.json().catch(()=>({}));throw new Error(i.error||"Failed to save themes")}G(`Themes saved successfully as ${F.isGlobal?"global":"church-specific"} themes!`),F.isGlobal||A.setCustomThemes(F.themes)}catch(a){console.error("Error saving themes:",a),H((a==null?void 0:a.message)||"Failed to save themes")}finally{de(!1)}});k.useEffect(()=>{j&&wa(F.isGlobal)},[j,F.isGlobal]),k.useEffect(()=>{const a=A.getCustomThemes();a&&Object.keys(a).length>0&&!F.isGlobal&&q(t=>l(r({},t),{themes:r(r({},t.themes),a)}))},[]),k.useEffect(()=>{j&&X(void 0,null,function*(){var t,n;if(j)try{const i=yield fetch(`/api/admin/churches/${j}`,{credentials:"include"});let p="";if(i.ok){const f=yield i.json();p=((t=f.church)==null?void 0:t.church_name)||((n=f.church)==null?void 0:n.name)||"",oa(p)}const W=`/images/records/${j}-logo.png`;let R=!1;try{R=(yield fetch(W,{method:"HEAD",cache:"no-cache"})).ok}catch(f){try{R=(yield fetch(W,{method:"GET",cache:"no-cache"})).ok}catch(I){R=!1}}const B=yield fetch(`/api/admin/churches/${j}/dynamic-records-config`,{credentials:"include"});if(B.ok){const f=yield B.json();if(f.config)O(I=>{var M,oe;return l(r({},f.config),{branding:l(r({},f.config.branding),{churchName:((M=f.config.branding)==null?void 0:M.churchName)||p,logoUrl:((oe=f.config.branding)==null?void 0:oe.logoUrl)||(R?W:void 0)})})});else{const I=A.getState();O({branding:l(r({},I.branding),{churchName:p,logoUrl:R?W:void 0}),liturgicalTheme:I.liturgicalTheme,fieldRules:I.fieldRules})}}else{const f=A.getState();O({branding:l(r({},f.branding),{churchName:p,logoUrl:R?W:void 0}),liturgicalTheme:f.liturgicalTheme,fieldRules:f.fieldRules})}}catch(i){console.error("Error loading church info and dynamic records config:",i);const p=A.getState();O({branding:p.branding,liturgicalTheme:p.liturgicalTheme,fieldRules:p.fieldRules})}})},[j]);const Ta=()=>X(void 0,null,function*(){var a,t,n;if(j)try{Ge(!0),H(null),G(null);const{columns:i}=yield _r.churches.getTableColumns(j,w),p=[`/admin/churches/${j}/field-mapper?table=${encodeURIComponent(w)}`,`/api/admin/churches/${j}/field-mapper?table=${encodeURIComponent(w)}`];let W=null;for(const f of p)try{const I=yield Aa(f,{churchId:j,credentials:"include"});if(I.ok){W=yield I.json();break}}catch(I){}const R=W!=null?W:{columns:i.map((f,I)=>({column_name:f,ordinal_position:I+1}))},B=((a=R.columns)!=null?a:i.map((f,I)=>({column_name:f,ordinal_position:I+1}))).map((f,I)=>{var d,Oe,Fe,Ye,Qe,Ke,Xe,Ze,ea;const M=(d=f.column_name)!=null?d:typeof f=="string"?f:`col_${I+1}`,oe=(Oe=f.ordinal_position)!=null?Oe:I+1;return{column_name:M,ordinal_position:oe,new_name:((Fe=R.mappings)==null?void 0:Fe[M])||"",is_visible:(Ke=(Qe=(Ye=R.field_settings)==null?void 0:Ye.visibility)==null?void 0:Qe[M])!=null?Ke:!0,is_sortable:(ea=(Ze=(Xe=R.field_settings)==null?void 0:Xe.sortable)==null?void 0:Ze[M])!=null?ea:!0}});Te(B),(t=R.field_settings)!=null&&t.default_sort_field?Ce(R.field_settings.default_sort_field):Ce(""),(n=R.field_settings)!=null&&n.default_sort_direction?_e(R.field_settings.default_sort_direction):_e("asc")}catch(i){console.error("Error loading columns:",i),H((i==null?void 0:i.message)||"Failed to load columns")}finally{Ge(!1)}}),Ea=()=>X(void 0,null,function*(){var a,t;if(!(!j||!w))try{Ue(!0),H(null),G(null);const n=`${U}_${w}`,i=Me(w),W=`${U==="en"?"English":U==="gr"?"Greek":U==="ru"?"Russian":U==="ro"?"Romanian":U==="ka"?"Georgian":U.toUpperCase()} ${i.charAt(0).toUpperCase()+i.slice(1)} Records`,R=yield _r.churches.exportTemplate(j,{table:w,language:U,template_slug:n,template_name:W,overwrite:qe});R.success?(G(`Exported template: ${R.slug}`),De(!1),Ve(!1),setTimeout(()=>G(null),5e3)):H(R.error||"Failed to export template")}catch(n){console.error("Error exporting template:",n),H(((t=(a=n==null?void 0:n.response)==null?void 0:a.data)==null?void 0:t.error)||(n==null?void 0:n.message)||"Failed to export template")}finally{Ue(!1)}}),Sa=()=>X(void 0,null,function*(){if(j)try{de(!0),H(null),G(null);const a={},t={},n={};K.forEach(B=>{B.new_name.trim()&&(a[B.column_name]=B.new_name.trim()),t[B.column_name]=B.is_visible,n[B.column_name]=B.is_sortable});const i=JSON.stringify({table:w,mapping:a,field_settings:{visibility:t,sortable:n,default_sort_field:ce,default_sort_direction:ke}}),p=[`/api/admin/churches/${j}/field-mapper`];let W=!1,R=null;for(const B of p)try{const f=yield Aa(B,{churchId:j,method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:i});if(f.ok){W=!0;break}else{const I=yield f.json().catch(()=>({}));R=new Error((I==null?void 0:I.error)||`HTTP ${f.status}: ${f.statusText}`)}}catch(f){R=f}if(!W)throw R||new Error("Failed to save mapping");if(G("Field mapping saved successfully!"),window.opener)try{window.opener.postMessage({type:"FIELD_MAPPING_SAVED",table:w,churchId:j,timestamp:new Date().toISOString()},"*")}catch(B){}setTimeout(()=>window.close(),1500)}catch(a){console.error("Error saving mapping:",a),H((a==null?void 0:a.message)||"Failed to save mapping")}finally{de(!1)}}),da=()=>window.close(),$a=()=>{window.confirm("Are you sure you want to reset the header display to default settings? This will clear all customizations.")&&(we({logo:{enabled:!1,column:3,file:null,width:200,height:200,objectFit:"contain",opacity:100,quadrant:"middle",horizontalPosition:"center"},calendar:{enabled:!1,column:2,quadrant:"middle",horizontalPosition:"center"},omLogo:{enabled:!1,column:4,width:68,height:68,quadrant:"middle",horizontalPosition:"center"},headerText:{fontFamily:"Arial, sans-serif",fontSize:16,fontWeight:700,color:"#4C1D95",column:1,position:"above",quadrant:"middle",horizontalPosition:"center"},recordImages:{column:1,quadrant:"middle",horizontalPosition:"center",width:160,height:160},backgroundImage:{enabled:!0,column:0,images:[],currentIndex:0,quadrant:"middle"},g1Image:{enabled:!0,column:0,images:[],currentIndex:0,quadrant:"middle"},imageLibrary:{logo:[],omLogo:[],baptism:[],marriage:[],funeral:[],bg:[],g1:[],recordImage:[]},currentImageIndex:{logo:0,omLogo:0,baptism:0,marriage:0,funeral:0,bg:0,g1:0,recordImage:0}}),G('Header display reset to default settings. Click "Save Record Settings" to apply changes.'),H(null))},ja=(a,t)=>{Te(n=>n.map(i=>i.column_name===a?l(r({},i),{new_name:t}):i))},_a=a=>{Te(t=>t.map(n=>n.column_name===a?l(r({},n),{is_visible:!n.is_visible}):n))},va=a=>{Te(t=>t.map(n=>n.column_name===a?l(r({},n),{is_sortable:!n.is_sortable}):n))};if(k.useEffect(()=>{const a=s.get("table")||"baptism_records";a!==w&&(ie(a),Te([]),Ce(""),_e("asc"))},[s]),k.useEffect(()=>{w&&Ta()},[j,w]),!j)return e.jsx(g,{p:3,children:e.jsxs(je,{severity:"error",children:["Invalid church ID. Please check the URL or ensure you have access to a church.",(z==null?void 0:z.church_id)&&e.jsxs(b,{variant:"body2",sx:{mt:1},children:["Your assigned church ID: ",z.church_id]})]})});const Ba=(a,t)=>X(void 0,null,function*(){var R;if(!j)throw new Error("Invalid church ID. Cannot upload image.");if(!t.type.startsWith("image/"))throw new Error("Please upload an image file");const n=new FormData;n.append("image",t),n.append("type",a);const i=yield fetch(`/api/admin/churches/${j}/record-images`,{method:"POST",credentials:"include",body:n});if(!i.ok){let B="Failed to upload image",f=null;const I=yield i.text();if(I.trim().startsWith("<html")||I.trim().startsWith("<!DOCTYPE")){const M=I.match(/<title>(.*?)<\/title>/i),oe=M?M[1]:"Internal Server Error";B=`Server error (${i.status}): ${oe}. The server is experiencing issues. Please check the server logs or contact support.`,console.error("Received HTML error page instead of JSON:",{status:i.status,statusText:i.statusText,htmlTitle:oe,responsePreview:I.substring(0,300)})}else try{f=JSON.parse(I),B=f.message||f.error||((R=f.error)==null?void 0:R.message)||B}catch(M){I&&I.trim()&&I.length<500?B=I.trim():B=`Server error: ${i.status} ${i.statusText}`}throw console.error("Upload error details:",{status:i.status,statusText:i.statusText,errorDetails:f,responsePreview:I.substring(0,500),isHtml:I.trim().startsWith("<html")||I.trim().startsWith("<!DOCTYPE")}),new Error(B)}const p=yield i.json(),W=p.url||p.path||`/images/records/${j}-${a==="logo"?"logo":a==="bg"?"bg":a}.png`;return we(B=>{const f=B.imageLibrary||{logo:[],omLogo:[],baptism:[],marriage:[],funeral:[],bg:[],g1:[],recordImage:[]},M=[...f[a]||[],W],oe=B.currentImageIndex||{logo:0,omLogo:0,baptism:0,marriage:0,funeral:0,bg:0,g1:0,recordImage:0};return r(l(r({},B),{imageLibrary:l(r({},f),{[a]:M}),currentImageIndex:l(r({},oe),{[a]:M.length-1})}),a==="logo"?{logo:l(r({},B.logo),{file:t})}:{})}),W}),La=()=>X(void 0,null,function*(){var a,t,n,i,p,W,R,B,f,I,M,oe,d,Oe,Fe,Ye,Qe,Ke,Xe,Ze,ea,Ra,ot,nt,lt,it,ct,dt,ht,ut,mt,gt,xt,pt,bt,ft,jt,vt,Ct,It,yt,kt,wt;if(!j){H("Invalid church ID. Please check the URL and ensure you have access to this church.");return}try{de(!0),H(null),G(null);const aa=new FormData;aa.append("settings",JSON.stringify({logo:{enabled:v.logo.enabled,column:v.logo.column,width:v.logo.width,height:v.logo.height,objectFit:v.logo.objectFit,opacity:v.logo.opacity,order:(t=(a=v.logo)==null?void 0:a.order)!=null?t:0,quadrant:((n=v.logo)==null?void 0:n.quadrant)||"middle",horizontalPosition:((i=v.logo)==null?void 0:i.horizontalPosition)||"center"},calendar:l(r({},v.calendar),{order:(W=(p=v.calendar)==null?void 0:p.order)!=null?W:0,quadrant:((R=v.calendar)==null?void 0:R.quadrant)||"middle",horizontalPosition:((B=v.calendar)==null?void 0:B.horizontalPosition)||"center"}),omLogo:l(r({},v.omLogo),{order:(I=(f=v.omLogo)==null?void 0:f.order)!=null?I:0,quadrant:((M=v.omLogo)==null?void 0:M.quadrant)||"middle",horizontalPosition:((oe=v.omLogo)==null?void 0:oe.horizontalPosition)||"center",width:v.omLogo.width,height:v.omLogo.height}),headerText:{fontFamily:((d=v.headerText)==null?void 0:d.fontFamily)||"Arial, sans-serif",fontSize:((Oe=v.headerText)==null?void 0:Oe.fontSize)||16,fontWeight:((Fe=v.headerText)==null?void 0:Fe.fontWeight)||700,color:((Ye=v.headerText)==null?void 0:Ye.color)||"#4C1D95",column:((Qe=v.headerText)==null?void 0:Qe.column)||1,order:(Xe=(Ke=v.headerText)==null?void 0:Ke.order)!=null?Xe:0,position:((Ze=v.headerText)==null?void 0:Ze.position)||"above",quadrant:((ea=v.headerText)==null?void 0:ea.quadrant)||"middle",horizontalPosition:((Ra=v.headerText)==null?void 0:Ra.horizontalPosition)||"center"},recordImages:{column:((ot=v.recordImages)==null?void 0:ot.column)||1,order:(lt=(nt=v.recordImages)==null?void 0:nt.order)!=null?lt:0,quadrant:((it=v.recordImages)==null?void 0:it.quadrant)||"middle",horizontalPosition:((ct=v.recordImages)==null?void 0:ct.horizontalPosition)||"center",width:((dt=v.recordImages)==null?void 0:dt.width)||60,height:((ht=v.recordImages)==null?void 0:ht.height)||60},backgroundImage:{enabled:(mt=(ut=v.backgroundImage)==null?void 0:ut.enabled)!=null?mt:!0,column:(xt=(gt=v.backgroundImage)==null?void 0:gt.column)!=null?xt:0,order:(bt=(pt=v.backgroundImage)==null?void 0:pt.order)!=null?bt:0,quadrant:((ft=v.backgroundImage)==null?void 0:ft.quadrant)||"middle"},g1Image:{enabled:(vt=(jt=v.g1Image)==null?void 0:jt.enabled)!=null?vt:!0,column:(It=(Ct=v.g1Image)==null?void 0:Ct.column)!=null?It:0,order:(kt=(yt=v.g1Image)==null?void 0:yt.order)!=null?kt:0,quadrant:((wt=v.g1Image)==null?void 0:wt.quadrant)||"middle"},imageLibrary:v.imageLibrary||{},currentImageIndex:v.currentImageIndex||{}})),v.logo.file&&aa.append("logo",v.logo.file);const Da=yield Aa(`/api/admin/churches/${j}/record-settings`,{churchId:j,method:"POST",credentials:"include",body:aa});if(!Da.ok){const Ca=yield Da.json().catch(()=>({})),Ia=Ca.message||Ca.error||`HTTP ${Da.status}: ${Da.statusText}`;throw new Error(Ia)}const ts=yield Da.json();G("Record settings saved successfully!"),j&&X(void 0,null,function*(){try{const Ia=yield fetch(`/api/admin/churches/${j}/record-settings`,{credentials:"include",cache:"no-cache"});if(Ia.ok){const D=yield Ia.json();D.settings&&we(Na=>{var Tt,_t,Bt,Lt,zt,Rt,Dt,Pt,Wt,Ot,Ft,At,Et,St,$t,Nt,Ht,Mt,Gt,Ut,qt,Vt,Jt,Yt,Qt,Kt,Xt,Zt,er,ar,tr,rr,sr,or,nr,lr,ir,cr,dr,hr,ur,mr,gr,xr,pr,br,fr,jr,vr,Cr;return l(r(r({},Na),D.settings),{logo:r(r({},Na.logo),D.settings.logo||{}),calendar:r(r({},Na.calendar),D.settings.calendar||{}),omLogo:r(r({},Na.omLogo),D.settings.omLogo||{}),headerText:l(r({fontFamily:"Arial, sans-serif",fontSize:16,fontWeight:700,color:"#4C1D95"},D.settings.headerText||{}),{column:(_t=(Tt=D.settings.headerText)==null?void 0:Tt.column)!=null?_t:1}),recordImages:{column:(Lt=(Bt=D.settings.recordImages)==null?void 0:Bt.column)!=null?Lt:1,quadrant:((zt=D.settings.recordImages)==null?void 0:zt.quadrant)||"middle",horizontalPosition:((Rt=D.settings.recordImages)==null?void 0:Rt.horizontalPosition)||"center",width:(Pt=(Dt=D.settings.recordImages)==null?void 0:Dt.width)!=null?Pt:160,height:(Ot=(Wt=D.settings.recordImages)==null?void 0:Wt.height)!=null?Ot:160},backgroundImage:{enabled:(At=(Ft=D.settings.backgroundImage)==null?void 0:Ft.enabled)!=null?At:!0,column:(St=(Et=D.settings.backgroundImage)==null?void 0:Et.column)!=null?St:0,images:(($t=D.settings.backgroundImage)==null?void 0:$t.images)||[],currentIndex:(Ht=(Nt=D.settings.backgroundImage)==null?void 0:Nt.currentIndex)!=null?Ht:0,quadrant:((Mt=D.settings.backgroundImage)==null?void 0:Mt.quadrant)||"middle"},g1Image:{enabled:(Ut=(Gt=D.settings.g1Image)==null?void 0:Gt.enabled)!=null?Ut:!0,column:(Vt=(qt=D.settings.g1Image)==null?void 0:qt.column)!=null?Vt:0,images:((Jt=D.settings.g1Image)==null?void 0:Jt.images)||[],currentIndex:(Qt=(Yt=D.settings.g1Image)==null?void 0:Yt.currentIndex)!=null?Qt:0,quadrant:((Kt=D.settings.g1Image)==null?void 0:Kt.quadrant)||"middle"},imageLibrary:{logo:((Xt=D.settings.imageLibrary)==null?void 0:Xt.logo)||[],omLogo:((Zt=D.settings.imageLibrary)==null?void 0:Zt.omLogo)||[],baptism:((er=D.settings.imageLibrary)==null?void 0:er.baptism)||[],marriage:((ar=D.settings.imageLibrary)==null?void 0:ar.marriage)||[],funeral:((tr=D.settings.imageLibrary)==null?void 0:tr.funeral)||[],bg:((rr=D.settings.imageLibrary)==null?void 0:rr.bg)||[],g1:((sr=D.settings.imageLibrary)==null?void 0:sr.g1)||[],recordImage:((or=D.settings.imageLibrary)==null?void 0:or.recordImage)||[]},currentImageIndex:{logo:(lr=(nr=D.settings.currentImageIndex)==null?void 0:nr.logo)!=null?lr:0,omLogo:(cr=(ir=D.settings.currentImageIndex)==null?void 0:ir.omLogo)!=null?cr:0,baptism:(hr=(dr=D.settings.currentImageIndex)==null?void 0:dr.baptism)!=null?hr:0,marriage:(mr=(ur=D.settings.currentImageIndex)==null?void 0:ur.marriage)!=null?mr:0,funeral:(xr=(gr=D.settings.currentImageIndex)==null?void 0:gr.funeral)!=null?xr:0,bg:(br=(pr=D.settings.currentImageIndex)==null?void 0:pr.bg)!=null?br:0,g1:(jr=(fr=D.settings.currentImageIndex)==null?void 0:fr.g1)!=null?jr:0,recordImage:(Cr=(vr=D.settings.currentImageIndex)==null?void 0:vr.recordImage)!=null?Cr:0}})})}}catch(Ia){console.error("Error reloading record settings:",Ia)}}),window.dispatchEvent(new CustomEvent("recordSettingsUpdated",{detail:{churchId:j,timestamp:Date.now()}})),v.logo.file&&we(Ca=>l(r({},Ca),{logo:l(r({},Ca.logo),{file:null})}))}catch(aa){console.error("Error saving record settings:",aa),H((aa==null?void 0:aa.message)||"Failed to save record settings")}finally{de(!1)}});return k.useEffect(()=>{if(!j){H("Invalid church ID. Please check the URL and ensure you have access to this church.");return}j&&X(void 0,null,function*(){try{const t=yield Aa(`/api/admin/churches/${j}/record-settings`,{churchId:j,credentials:"include"});if(t.ok){const n=yield t.json();n.settings&&we(i=>{var p,W,R,B,f,I,M,oe,d,Oe,Fe,Ye,Qe,Ke,Xe,Ze,ea,Ra;return l(r(r({},i),n.settings),{logo:r(r({},i.logo),n.settings.logo||{}),calendar:r(r({},i.calendar),n.settings.calendar||{}),omLogo:r(r({},i.omLogo),n.settings.omLogo||{}),headerText:l(r({fontFamily:"Arial, sans-serif",fontSize:16,fontWeight:700,color:"#4C1D95",x:0,y:0},n.settings.headerText||{}),{column:(W=(p=n.settings.headerText)==null?void 0:p.column)!=null?W:1}),recordImages:{column:(B=(R=n.settings.recordImages)==null?void 0:R.column)!=null?B:1,x:(d=(oe=(f=n.settings.recordImages)==null?void 0:f.x)!=null?oe:(M=(I=n.settings.recordImages)==null?void 0:I.baptism)==null?void 0:M.x)!=null?d:0,y:(Ke=(Qe=(Oe=n.settings.recordImages)==null?void 0:Oe.y)!=null?Qe:(Ye=(Fe=n.settings.recordImages)==null?void 0:Fe.baptism)==null?void 0:Ye.y)!=null?Ke:0,width:(Ze=(Xe=n.settings.recordImages)==null?void 0:Xe.width)!=null?Ze:60,height:(Ra=(ea=n.settings.recordImages)==null?void 0:ea.height)!=null?Ra:60},backgroundImage:r({enabled:!0,column:0,images:[],currentIndex:0},n.settings.backgroundImage||{}),g1Image:r({enabled:!0,column:0,images:[],currentIndex:0},n.settings.g1Image||{}),imageLibrary:r({logo:[],omLogo:[],baptism:[],marriage:[],funeral:[],bg:[],g1:[]},n.settings.imageLibrary||{}),currentImageIndex:r({logo:0,omLogo:0,baptism:0,marriage:0,funeral:0,bg:0,g1:0},n.settings.currentImageIndex||{})})})}}catch(t){console.error("Error loading record settings:",t)}})},[j]),e.jsxs(g,{sx:{p:3,minHeight:"100vh",bgcolor:C.palette.background.default},children:[e.jsx(Ae,{sx:{bgcolor:C.palette.background.paper},children:e.jsxs(Hr,{children:[e.jsxs(g,{sx:{mb:3},children:[e.jsxs(b,{variant:"h4",gutterBottom:!0,sx:{display:"flex",alignItems:"center",gap:1},children:[e.jsx(Lr,{color:"primary"}),"Record Table Configuration"]}),e.jsxs(b,{variant:"body2",color:"text.secondary",children:["Configure database mappings and record display settings for church ID ",j]})]}),e.jsx(Va,{sx:{mb:3}}),e.jsx(g,{sx:{borderBottom:1,borderColor:"divider",mb:3},children:e.jsxs(Ur,{value:Be,onChange:(a,t)=>ra(t),children:[e.jsx(Ga,{icon:e.jsx(Lr,{}),iconPosition:"start",label:"Database  Table Mapping",sx:{textTransform:"none",minHeight:64}}),e.jsx(Ga,{icon:e.jsx(Re,{}),iconPosition:"start",label:"Record Settings",sx:{textTransform:"none",minHeight:64}}),e.jsx(Ga,{icon:e.jsx(Wa,{}),iconPosition:"start",label:"Theme Studio",sx:{textTransform:"none",minHeight:64}}),e.jsx(Ga,{icon:e.jsx(Re,{}),iconPosition:"start",label:"UI Theme",sx:{textTransform:"none",minHeight:64}})]})}),Be===0&&e.jsxs(g,{children:[e.jsxs(Y,{direction:"row",spacing:2,sx:{mb:3},alignItems:"center",flexWrap:"wrap",children:[e.jsxs(Z,{sx:{minWidth:200},children:[e.jsx(ne,{children:"Select Table"}),e.jsxs(te,{value:w,onChange:a=>{const t=a.target.value;ie(t);const n=new URLSearchParams(s);n.set("table",t),m(n,{replace:!0})},label:"Select Table",disabled:ue||T,children:[e.jsx(x,{value:"baptism_records",children:"baptism_records"}),e.jsx(x,{value:"marriage_records",children:"marriage_records"}),e.jsx(x,{value:"funeral_records",children:"funeral_records"}),e.jsx(x,{value:"members",children:"members"}),e.jsx(x,{value:"families",children:"families"}),e.jsx(x,{value:"donations",children:"donations"})]})]}),e.jsx(_,{variant:"outlined",startIcon:ue?e.jsx(ta,{size:16}):e.jsx(wr,{}),onClick:Ta,disabled:ue||T,children:"Reload Columns"}),e.jsxs(Z,{size:"small",sx:{minWidth:100},children:[e.jsx(ne,{children:"Language"}),e.jsxs(te,{value:U,onChange:a=>na(a.target.value),label:"Language",disabled:ue||T||ge,children:[e.jsx(x,{value:"en",children:"English (en)"}),e.jsx(x,{value:"gr",children:"Greek (gr)"}),e.jsx(x,{value:"ru",children:"Russian (ru)"}),e.jsx(x,{value:"ro",children:"Romanian (ro)"}),e.jsx(x,{value:"ka",children:"Georgian (ka)"})]})]}),e.jsx(_,{variant:"contained",color:"primary",startIcon:ge?e.jsx(ta,{size:16}):e.jsx(zr,{}),onClick:()=>De(!0),disabled:ue||T||ge||K.length===0,children:"Export to Template"})]}),e.jsx(je,{severity:"warning",sx:{mb:2,mt:2},children:e.jsxs(b,{variant:"body2",children:[e.jsx("strong",{children:"Export to Template:"})," This exports the current table schema and field mapper configuration into a ",e.jsx("strong",{children:"global template"})," that will be available to all churches. Only use this for standardized, production-ready configurations. Church-specific customizations should not be exported."]})}),me&&e.jsx(je,{severity:"error",sx:{mb:2},children:me}),pe&&e.jsx(je,{severity:"success",sx:{mb:2},children:pe}),ue&&e.jsxs(g,{display:"flex",justifyContent:"center",alignItems:"center",py:4,children:[e.jsx(ta,{}),e.jsx(b,{sx:{ml:2},children:"Loading columns..."})]}),!ue&&K.length>0&&e.jsxs(e.Fragment,{children:[e.jsxs(Ae,{variant:"outlined",sx:{mb:3,p:2,bgcolor:C.palette.background.paper},children:[e.jsxs(b,{variant:"h6",gutterBottom:!0,sx:{display:"flex",alignItems:"center",gap:1},children:[e.jsx(Fa,{color:"primary"}),"Default Sort Settings"]}),e.jsxs(Y,{direction:"row",spacing:3,alignItems:"center",flexWrap:"wrap",children:[e.jsxs(Z,{sx:{minWidth:200},children:[e.jsx(ne,{children:"Default Sort Field"}),e.jsxs(te,{value:ce,onChange:a=>Ce(a.target.value),label:"Default Sort Field",disabled:T,children:[e.jsx(x,{value:"",children:e.jsx("em",{children:"No default sort"})}),K.filter(a=>a.is_visible&&a.is_sortable).map(a=>e.jsx(x,{value:a.column_name,children:a.new_name||a.column_name},a.column_name))]})]}),ce&&e.jsx(Z,{component:"fieldset",children:e.jsxs(Rr,{row:!0,value:ke,onChange:a=>_e(a.target.value),children:[e.jsx(ve,{value:"asc",control:e.jsx(Oa,{size:"small"}),label:e.jsxs(g,{sx:{display:"flex",alignItems:"center",gap:.5},children:[e.jsx(qa,{fontSize:"small"})," Ascending"]}),disabled:T}),e.jsx(ve,{value:"desc",control:e.jsx(Oa,{size:"small"}),label:e.jsxs(g,{sx:{display:"flex",alignItems:"center",gap:.5},children:[e.jsx(Ua,{fontSize:"small"})," Descending"]}),disabled:T})]})})]})]}),e.jsxs(Ae,{variant:"outlined",sx:{mb:3,p:3,bgcolor:C.palette.background.paper},children:[e.jsxs(b,{variant:"h6",gutterBottom:!0,sx:{mb:2},children:["Live Preview - ",w]}),e.jsx(b,{variant:"body2",color:"text.secondary",sx:{mb:2},children:"Double-click any column header to configure Visible, Sortable, and Default Sort settings."}),e.jsx(g,{sx:{border:`2px dashed ${C.palette.divider}`,borderRadius:2,p:2,bgcolor:C.palette.background.paper,overflow:"auto",maxHeight:400},children:e.jsx(Ka,{children:e.jsxs(Xa,{size:"small",stickyHeader:!0,children:[e.jsx(Za,{children:e.jsx(ha,{sx:{bgcolor:C.palette.action.hover},children:K.filter(a=>a.is_visible).map(a=>{const t=K.find(n=>n.column_name===a.column_name);return e.jsx(J,{onDoubleClick:()=>{fa(a.column_name)},sx:{cursor:"pointer",userSelect:"none","&:hover":{bgcolor:"action.hover"}},children:e.jsx(Ne,{title:"Double-click to configure",children:e.jsxs(g,{sx:{display:"flex",alignItems:"center",gap:.5},children:[e.jsx(b,{variant:"subtitle2",fontWeight:"bold",children:(t==null?void 0:t.new_name)||a.column_name}),(t==null?void 0:t.is_sortable)&&e.jsx(Fa,{fontSize:"small",color:"action"}),ce===a.column_name&&e.jsx(g,{sx:{display:"flex",alignItems:"center",gap:.5},children:ke==="asc"?e.jsx(qa,{fontSize:"small",color:"primary"}):e.jsx(Ua,{fontSize:"small",color:"primary"})})]})})},a.column_name)})})}),e.jsx(et,{children:(()=>{let a=[],t={};return w==="baptism_records"?(a=Zr,t={id:"id",first_name:"first_name",last_name:"last_name",birth_date:"birth_date",reception_date:"reception_date",birthplace:"birthplace",entry_type:"entry_type",sponsors:"sponsors",parents:"parents",clergy:"clergy"}):w==="marriage_records"?(a=es,t={id:"id",married_date_name:"married_date_name",last_name:"last_name",parents_groom:"parents_groom",parents:"parents",witnesses:"witnesses",marriage_license:"marriage_license",clergy:"clergy"}):w==="funeral_records"&&(a=as,t={id:"id",date_of_deceased:"date_of_deceased",date_of_burial:"date_of_burial",first_name:"first_name",last_name:"last_name",age:"age",clergy:"clergy",burial_location:"burial_location"}),a.length===0?[1,2,3].map(n=>e.jsx(ha,{children:K.filter(i=>i.is_visible).map(i=>e.jsx(J,{children:e.jsxs(b,{variant:"body2",color:"text.secondary",children:["Sample ",i.new_name||i.column_name]})},i.column_name))},n)):a.map(n=>e.jsx(ha,{children:K.filter(i=>i.is_visible).map(i=>{const p=t[i.column_name],W=p?n[p]:"";return e.jsx(J,{children:e.jsx(b,{variant:"body2",color:"text.secondary",children:W||"-"})},i.column_name)})},n.id))})()})]})})})]}),e.jsx(Ka,{component:rt,variant:"outlined",sx:{mb:3},children:e.jsxs(Xa,{size:"small",children:[e.jsx(Za,{children:e.jsxs(ha,{sx:{bgcolor:C.palette.background.paper},children:[e.jsx(J,{children:e.jsx(b,{variant:"subtitle2",fontWeight:"bold",children:"Column Name"})}),e.jsx(J,{align:"center",children:e.jsx(b,{variant:"subtitle2",fontWeight:"bold",children:"Column #"})}),e.jsx(J,{children:e.jsx(b,{variant:"subtitle2",fontWeight:"bold",children:"New Column Name"})}),e.jsx(J,{align:"center",children:e.jsx(Ne,{title:"Show/hide this column in data grids",children:e.jsxs(b,{variant:"subtitle2",fontWeight:"bold",sx:{display:"flex",alignItems:"center",gap:.5,justifyContent:"center"},children:[e.jsx(at,{fontSize:"small"})," Visible"]})})}),e.jsx(J,{align:"center",children:e.jsx(Ne,{title:"Allow sorting by this column",children:e.jsxs(b,{variant:"subtitle2",fontWeight:"bold",sx:{display:"flex",alignItems:"center",gap:.5,justifyContent:"center"},children:[e.jsx(Fa,{fontSize:"small"})," Sortable"]})})}),e.jsx(J,{align:"center",children:e.jsx(Ne,{title:"Set as default sort field",children:e.jsxs(b,{variant:"subtitle2",fontWeight:"bold",sx:{display:"flex",alignItems:"center",gap:.5,justifyContent:"center"},children:[e.jsx(Fa,{fontSize:"small",color:"primary"})," Default Sort"]})})})]})}),e.jsx(et,{children:K.map(a=>e.jsxs(ha,{hover:!0,children:[e.jsx(J,{children:e.jsx(b,{variant:"body2",sx:{fontFamily:"monospace",fontSize:"0.875rem",color:"text.primary"},children:a.column_name})}),e.jsx(J,{align:"center",children:e.jsx(b,{variant:"body2",color:"text.secondary",children:a.ordinal_position})}),e.jsx(J,{children:e.jsx(S,{fullWidth:!0,size:"small",variant:"outlined",value:a.new_name,onChange:t=>ja(a.column_name,t.target.value),placeholder:`Display name for ${a.column_name}`,disabled:T,sx:{minWidth:200}})}),e.jsx(J,{align:"center",children:e.jsx(Qa,{checked:a.is_visible,onChange:()=>_a(a.column_name),disabled:T,color:"primary",icon:e.jsx(Yr,{}),checkedIcon:e.jsx(at,{})})}),e.jsx(J,{align:"center",children:e.jsx(Qa,{checked:a.is_sortable,onChange:()=>va(a.column_name),disabled:T||!a.is_visible,color:"primary"})}),e.jsx(J,{align:"center",children:e.jsx(Oa,{checked:ce===a.column_name,onChange:()=>Ce(a.column_name),disabled:T||!a.is_visible||!a.is_sortable,color:"primary",size:"small"})})]},a.column_name))})]})}),e.jsx(g,{sx:{mb:3},children:e.jsxs(Y,{direction:"row",spacing:2,flexWrap:"wrap",children:[e.jsx(ya,{icon:e.jsx(at,{}),label:`${K.filter(a=>a.is_visible).length} visible columns`,color:"primary",variant:"outlined"}),e.jsx(ya,{icon:e.jsx(Fa,{}),label:`${K.filter(a=>a.is_sortable&&a.is_visible).length} sortable columns`,color:"secondary",variant:"outlined"}),ce&&e.jsx(ya,{icon:ke==="asc"?e.jsx(qa,{}):e.jsx(Ua,{}),label:`Default: ${((za=K.find(a=>a.column_name===ce))==null?void 0:za.new_name)||ce} (${ke.toUpperCase()})`,color:"success",variant:"outlined"})]})})]}),!ue&&K.length===0&&!me&&e.jsxs(je,{severity:"info",sx:{mb:2},children:['No columns found for table "',w,'". The table may not exist or be empty.']}),Se&&(()=>{const a=K.find(t=>t.column_name===Se);return a?e.jsxs(ua,{open:!!Se,onClose:()=>fa(null),maxWidth:"sm",fullWidth:!0,children:[e.jsxs(ma,{children:["Configure Column: ",a.column_name]}),e.jsx(ga,{children:e.jsxs(Y,{spacing:3,sx:{mt:2},children:[e.jsx(S,{fullWidth:!0,label:"Display Name",value:a.new_name,onChange:t=>ja(a.column_name,t.target.value),placeholder:`Display name for ${a.column_name}`,disabled:T}),e.jsx(ve,{control:e.jsx(He,{checked:a.is_visible,onChange:()=>_a(a.column_name),disabled:T}),label:"Visible"}),e.jsx(ve,{control:e.jsx(He,{checked:a.is_sortable,onChange:()=>va(a.column_name),disabled:T||!a.is_visible}),label:"Sortable"}),e.jsxs(Z,{children:[e.jsx(ne,{children:"Default Sort"}),e.jsxs(te,{value:ce===a.column_name?"yes":"no",onChange:t=>{t.target.value==="yes"?Ce(a.column_name):Ce("")},label:"Default Sort",disabled:T||!a.is_visible||!a.is_sortable,children:[e.jsx(x,{value:"no",children:"No"}),e.jsx(x,{value:"yes",children:"Yes"})]})]}),ce===a.column_name&&e.jsx(Z,{component:"fieldset",children:e.jsxs(Rr,{row:!0,value:ke,onChange:t=>_e(t.target.value),children:[e.jsx(ve,{value:"asc",control:e.jsx(Oa,{size:"small"}),label:e.jsxs(g,{sx:{display:"flex",alignItems:"center",gap:.5},children:[e.jsx(qa,{fontSize:"small"})," Ascending"]}),disabled:T}),e.jsx(ve,{value:"desc",control:e.jsx(Oa,{size:"small"}),label:e.jsxs(g,{sx:{display:"flex",alignItems:"center",gap:.5},children:[e.jsx(Ua,{fontSize:"small"})," Descending"]}),disabled:T})]})})]})}),e.jsx(xa,{children:e.jsx(_,{onClick:()=>fa(null),children:"Close"})})]}):null})(),e.jsxs(Y,{direction:"row",spacing:2,justifyContent:"flex-end",children:[e.jsx(_,{variant:"outlined",startIcon:e.jsx(tt,{}),onClick:da,disabled:T,children:"Cancel"}),e.jsx(_,{variant:"contained",startIcon:T?e.jsx(ta,{size:16}):e.jsx(Ma,{}),onClick:Sa,disabled:T||ue||K.length===0,children:T?"Saving...":"Save Mapping"})]})]}),Be===1&&e.jsxs(g,{children:[e.jsxs(b,{variant:"h6",gutterBottom:!0,sx:{mb:3,display:"flex",alignItems:"center",gap:1},children:[e.jsx(Re,{color:"primary"}),"Header Display Configuration"]}),me&&e.jsx(je,{severity:"error",sx:{mb:2},children:me}),pe&&e.jsx(je,{severity:"success",sx:{mb:2},children:pe}),e.jsxs(g,{sx:{mb:3},children:[e.jsxs(g,{sx:{display:"flex",gap:2,alignItems:"center",flexWrap:"wrap"},children:[e.jsxs(_,{variant:"outlined",component:"label",startIcon:e.jsx(pa,{}),disabled:T,children:["Upload Image to Library",e.jsx("input",{type:"file",hidden:!0,accept:".jpg,.jpeg,.png,image/jpeg,image/png",onChange:a=>X(void 0,null,function*(){var n;const t=(n=a.target.files)==null?void 0:n[0];if(t){if(!["image/jpeg","image/jpg","image/png"].includes(t.type.toLowerCase())){H("Please upload a .jpg or .png image file");return}H(null),G(null),de(!0);try{console.log("Starting image upload:",{churchId:j,type:"baptism",fileName:t.name,fileSize:t.size,fileType:t.type}),yield Ba("baptism",t),G("Image uploaded successfully to library!")}catch(p){console.error("Error uploading image:",p),console.error("Error details:",{message:p==null?void 0:p.message,stack:p==null?void 0:p.stack,name:p==null?void 0:p.name}),H((p==null?void 0:p.message)||"Failed to upload image. Please try again.")}finally{de(!1),a.target.value=""}}})})]}),e.jsx(_,{variant:"outlined",color:"warning",startIcon:e.jsx(wr,{}),onClick:$a,disabled:T,children:"Reset Defaults"})]}),e.jsx(b,{variant:"caption",color:"text.secondary",display:"block",sx:{mt:1},children:"Upload .jpg or .png images to your image library"})]}),e.jsx(Xr,{churchId:j,recordSettings:v,setRecordSettings:we,onImageUpload:Ba,recordType:le==="baptism_records"?"baptism":le==="marriage_records"?"marriage":le==="funeral_records"?"funeral":"baptism",churchName:sa||`Church ${j}`}),e.jsxs(Y,{direction:"row",spacing:2,justifyContent:"flex-end",children:[e.jsx(_,{variant:"outlined",startIcon:e.jsx(Mr,{}),onClick:ye,disabled:T,children:"Back to Records"}),e.jsx(_,{variant:"outlined",startIcon:e.jsx(tt,{}),onClick:da,disabled:T,children:"Cancel"}),e.jsx(_,{variant:"contained",startIcon:T?e.jsx(ta,{size:16}):e.jsx(Ma,{}),onClick:La,disabled:T,children:T?"Saving...":"Save Record Settings"})]})]}),Be===2&&e.jsxs(g,{children:[e.jsxs(b,{variant:"h6",gutterBottom:!0,sx:{mb:3,display:"flex",alignItems:"center",gap:1},children:[e.jsx(Wa,{color:"primary"}),"Theme Studio"]}),me&&e.jsx(je,{severity:"error",sx:{mb:2},children:me}),pe&&e.jsx(je,{severity:"success",sx:{mb:2},children:pe}),e.jsxs(Ae,{variant:"outlined",sx:{mb:3,p:3,bgcolor:C.palette.background.paper},children:[e.jsx(b,{variant:"h6",gutterBottom:!0,sx:{mb:2},children:"Live Preview"}),e.jsx(b,{variant:"body2",color:"text.secondary",sx:{mb:2},children:"Double-click any table element to configure its color."}),e.jsx(g,{sx:{border:`2px dashed ${C.palette.divider}`,borderRadius:2,p:2,bgcolor:C.palette.background.paper,overflow:"auto"},children:(()=>{const a=A.getState(),t=a.liturgicalTheme;let n;fe?n=fe:t&&re[t]?n=re[t]:a.customThemes&&t&&a.customThemes[t]?n=a.customThemes[t]:n={headerBg:"#1976d2",headerText:"#ffffff",rowOddBg:"#fafafa",rowEvenBg:"#ffffff",border:"#e0e0e0",accent:"#1976d2",cellText:"#212121"};const i=p=>{Pe(p),y(!0)};return e.jsx(Ka,{component:rt,sx:{maxHeight:400},children:e.jsxs(Xa,{size:"small",stickyHeader:!0,children:[e.jsx(Za,{children:e.jsxs(ha,{children:[e.jsx(J,{onDoubleClick:()=>i("headerBg"),sx:{backgroundColor:n.headerBg,color:n.headerText,cursor:"pointer",userSelect:"none",fontWeight:"bold","&:hover":{outline:"2px solid #1976d2",outlineOffset:"-2px"}},children:e.jsx(Ne,{title:"Double-click to configure Header Background",children:"ID"})}),e.jsx(J,{onDoubleClick:()=>i("headerBg"),sx:{backgroundColor:n.headerBg,color:n.headerText,cursor:"pointer",userSelect:"none",fontWeight:"bold","&:hover":{outline:"2px solid #1976d2",outlineOffset:"-2px"}},children:e.jsx(Ne,{title:"Double-click to configure Header Background",children:"First Name"})}),e.jsx(J,{onDoubleClick:()=>i("headerBg"),sx:{backgroundColor:n.headerBg,color:n.headerText,cursor:"pointer",userSelect:"none",fontWeight:"bold","&:hover":{outline:"2px solid #1976d2",outlineOffset:"-2px"}},children:e.jsx(Ne,{title:"Double-click to configure Header Background",children:"Last Name"})}),e.jsx(J,{onDoubleClick:()=>i("headerBg"),sx:{backgroundColor:n.headerBg,color:n.headerText,cursor:"pointer",userSelect:"none",fontWeight:"bold","&:hover":{outline:"2px solid #1976d2",outlineOffset:"-2px"}},children:e.jsx(Ne,{title:"Double-click to configure Header Background",children:"Date"})})]})}),e.jsx(et,{children:[1,2,3,4,5].map((p,W)=>e.jsxs(ha,{sx:{backgroundColor:W%2===0?n.rowEvenBg:n.rowOddBg,"& .MuiTableCell-root":{color:n.cellText,borderColor:n.border,cursor:"pointer","&:hover":{outline:"2px solid #1976d2",outlineOffset:"-2px"}}},onDoubleClick:R=>{R.target.tagName==="TD"&&i(W%2===0?"rowEvenBg":"rowOddBg")},children:[e.jsx(J,{onDoubleClick:()=>i("cellText"),children:p}),e.jsxs(J,{onDoubleClick:()=>i("cellText"),children:["Sample ",p]}),e.jsxs(J,{onDoubleClick:()=>i("cellText"),children:["Data ",p]}),e.jsx(J,{onDoubleClick:()=>i("cellText"),children:new Date().toLocaleDateString()})]},p))})]})})})()})]}),e.jsxs(E,{container:!0,spacing:3,children:[e.jsx(E,{item:!0,xs:12,md:8,children:e.jsxs(Ae,{variant:"outlined",sx:{mb:3,p:3,bgcolor:C.palette.background.paper},children:[e.jsx(b,{variant:"h6",gutterBottom:!0,sx:{mb:2},children:"Theme Management"}),e.jsxs(Y,{spacing:3,children:[e.jsx(ve,{control:e.jsx(He,{checked:F.isGlobal,onChange:a=>{q(t=>l(r({},t),{isGlobal:a.target.checked})),wa(a.target.checked)}}),label:"Global Theme (applies to all churches unless overridden)"}),!F.isGlobal&&e.jsx(je,{severity:"info",children:"Church-specific themes will override global themes for this church only."}),e.jsxs(g,{children:[e.jsxs(b,{variant:"subtitle2",gutterBottom:!0,sx:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[F.isGlobal?"Global Themes":"Church-Specific Themes",e.jsx(_,{variant:"outlined",size:"small",startIcon:e.jsx(Tr,{}),onClick:()=>{N({name:"",description:"",tokens:{headerBg:"#1976d2",headerText:"#ffffff",rowOddBg:"#fafafa",rowEvenBg:"#ffffff",border:"#e0e0e0",accent:"#1976d2",cellText:"#212121"}}),be(!0)},children:"Add Theme"})]}),e.jsxs(Y,{spacing:1,sx:{mt:2},children:[Object.entries(F.themes).map(([a,t])=>e.jsx(Ae,{variant:"outlined",sx:{p:2,bgcolor:t.palette.background.paper},children:e.jsxs(Y,{direction:"row",spacing:2,alignItems:"center",justifyContent:"space-between",children:[e.jsxs(g,{sx:{flex:1},children:[e.jsx(b,{variant:"subtitle1",fontWeight:"bold",children:t.name||a}),t.description&&e.jsx(b,{variant:"body2",color:"text.secondary",children:t.description}),e.jsxs(g,{sx:{display:"flex",gap:.5,mt:1},children:[e.jsx(g,{sx:{width:30,height:20,bgcolor:t.headerBg,border:"1px solid #ccc",borderRadius:1}}),e.jsx(g,{sx:{width:30,height:20,bgcolor:t.accent,border:"1px solid #ccc",borderRadius:1}}),e.jsx(g,{sx:{width:30,height:20,bgcolor:t.rowOddBg,border:"1px solid #ccc",borderRadius:1}}),e.jsx(g,{sx:{width:30,height:20,bgcolor:t.rowEvenBg,border:"1px solid #ccc",borderRadius:1}})]})]}),e.jsxs(Y,{direction:"row",spacing:1,children:[e.jsx(_,{size:"small",variant:"outlined",onClick:()=>{N({name:a,description:t.description||"",tokens:t}),be(!0)},children:"Edit"}),e.jsx(st,{size:"small",color:"error",onClick:()=>X(void 0,null,function*(){if(window.confirm(`Delete theme "${t.name||a}"?`)){const n=r({},F.themes);delete n[a],q(i=>l(r({},i),{themes:n})),yield $e()}}),children:e.jsx(qr,{fontSize:"small"})})]})]})},a)),Object.keys(F.themes).length===0&&e.jsxs(je,{severity:"info",children:["No ",F.isGlobal?"global":"church-specific",' themes defined. Click "Add Theme" to create one.']})]})]})]})]})}),e.jsx(E,{item:!0,xs:12,md:4,children:e.jsxs(Ae,{variant:"outlined",sx:{mb:3,p:3,bgcolor:C.palette.background.paper},children:[e.jsx(b,{variant:"h6",gutterBottom:!0,sx:{mb:2},children:"Pre-defined Liturgical Themes"}),e.jsx(Y,{spacing:2,children:Object.entries(re).map(([a,t])=>e.jsxs(Ae,{variant:"outlined",sx:{p:2,cursor:"pointer",border:F.selectedTheme===a?"2px solid primary.main":"1px solid","&:hover":{bgcolor:"action.hover"}},onClick:()=>{if(!F.themes[a]){const n=a.replace("_"," ").replace(/\b\w/g,i=>i.toUpperCase());q(i=>l(r({},i),{themes:l(r({},i.themes),{[a]:l(r({},t),{name:n,description:`Pre-defined ${n} theme`})})}))}},children:[e.jsx(b,{variant:"subtitle2",fontWeight:"bold",children:a.replace("_"," ").replace(/\b\w/g,n=>n.toUpperCase())}),e.jsxs(g,{sx:{display:"flex",gap:.5,mt:1},children:[e.jsx(g,{sx:{width:30,height:20,bgcolor:t.headerBg,border:"1px solid #ccc",borderRadius:1}}),e.jsx(g,{sx:{width:30,height:20,bgcolor:t.accent,border:"1px solid #ccc",borderRadius:1}}),e.jsx(g,{sx:{width:30,height:20,bgcolor:t.rowOddBg,border:"1px solid #ccc",borderRadius:1}}),e.jsx(g,{sx:{width:30,height:20,bgcolor:t.rowEvenBg,border:"1px solid #ccc",borderRadius:1}})]}),e.jsx(Y,{direction:"row",spacing:1,sx:{mt:1},children:e.jsx(_,{size:"small",variant:"outlined",onClick:n=>{n.stopPropagation();const i=a.replace("_"," ").replace(/\b\w/g,p=>p.toUpperCase());N({name:a,description:`Pre-defined ${i} theme`,tokens:t,isPreDefined:!0,originalKey:a}),be(!0)},children:"Edit"})})]},a))})]})})]}),e.jsxs(ua,{open:ia,onClose:()=>be(!1),maxWidth:"md",fullWidth:!0,children:[e.jsx(ma,{children:h!=null&&h.name?`Edit Theme: ${h.name}`:"Create New Theme"}),e.jsx(ga,{children:e.jsxs(Y,{spacing:3,sx:{mt:1},children:[e.jsx(S,{label:"Theme Name",value:(h==null?void 0:h.name)||"",onChange:a=>N(t=>t?l(r({},t),{name:a.target.value}):null),fullWidth:!0,required:!0}),e.jsx(S,{label:"Description",value:(h==null?void 0:h.description)||"",onChange:a=>N(t=>t?l(r({},t),{description:a.target.value}):null),fullWidth:!0,multiline:!0,rows:2}),e.jsx(Va,{}),e.jsx(b,{variant:"subtitle2",children:"Theme Colors"}),e.jsxs(E,{container:!0,spacing:2,children:[e.jsx(E,{item:!0,xs:12,sm:6,children:e.jsx(S,{label:"Header Background",type:"color",value:(h==null?void 0:h.tokens.headerBg)||"#1976d2",onChange:a=>N(t=>t?l(r({},t),{tokens:l(r({},t.tokens),{headerBg:a.target.value})}):null),fullWidth:!0,InputLabelProps:{shrink:!0}})}),e.jsx(E,{item:!0,xs:12,sm:6,children:e.jsx(S,{label:"Header Text",type:"color",value:(h==null?void 0:h.tokens.headerText)||"#ffffff",onChange:a=>N(t=>t?l(r({},t),{tokens:l(r({},t.tokens),{headerText:a.target.value})}):null),fullWidth:!0,InputLabelProps:{shrink:!0}})}),e.jsx(E,{item:!0,xs:12,sm:6,children:e.jsx(S,{label:"Row Odd Background",type:"color",value:(h==null?void 0:h.tokens.rowOddBg)||"#fafafa",onChange:a=>N(t=>t?l(r({},t),{tokens:l(r({},t.tokens),{rowOddBg:a.target.value})}):null),fullWidth:!0,InputLabelProps:{shrink:!0}})}),e.jsx(E,{item:!0,xs:12,sm:6,children:e.jsx(S,{label:"Row Even Background",type:"color",value:(h==null?void 0:h.tokens.rowEvenBg)||"#ffffff",onChange:a=>N(t=>t?l(r({},t),{tokens:l(r({},t.tokens),{rowEvenBg:a.target.value})}):null),fullWidth:!0,InputLabelProps:{shrink:!0}})}),e.jsx(E,{item:!0,xs:12,sm:6,children:e.jsx(S,{label:"Border Color",type:"color",value:(h==null?void 0:h.tokens.border)||"#e0e0e0",onChange:a=>N(t=>t?l(r({},t),{tokens:l(r({},t.tokens),{border:a.target.value})}):null),fullWidth:!0,InputLabelProps:{shrink:!0}})}),e.jsx(E,{item:!0,xs:12,sm:6,children:e.jsx(S,{label:"Accent Color",type:"color",value:(h==null?void 0:h.tokens.accent)||"#1976d2",onChange:a=>N(t=>t?l(r({},t),{tokens:l(r({},t.tokens),{accent:a.target.value})}):null),fullWidth:!0,InputLabelProps:{shrink:!0}})}),e.jsx(E,{item:!0,xs:12,children:e.jsx(S,{label:"Cell Text Color",type:"color",value:(h==null?void 0:h.tokens.cellText)||"#212121",onChange:a=>N(t=>t?l(r({},t),{tokens:l(r({},t.tokens),{cellText:a.target.value})}):null),fullWidth:!0,InputLabelProps:{shrink:!0}})})]}),e.jsx(Va,{}),e.jsx(b,{variant:"subtitle2",children:"Preview"}),h&&e.jsx(g,{children:e.jsxs(E,{container:!0,spacing:1,children:[e.jsx(E,{item:!0,xs:6,children:e.jsx(g,{sx:{bgcolor:h.tokens.headerBg,color:h.tokens.headerText,p:2,borderRadius:1,textAlign:"center"},children:"Header"})}),e.jsx(E,{item:!0,xs:6,children:e.jsx(g,{sx:{bgcolor:h.tokens.accent,color:h.tokens.cellText,p:2,borderRadius:1,textAlign:"center"},children:"Accent"})}),e.jsx(E,{item:!0,xs:6,children:e.jsx(g,{sx:{bgcolor:h.tokens.rowOddBg,color:h.tokens.cellText,p:2,border:`1px solid ${h.tokens.border}`,borderRadius:1,textAlign:"center"},children:"Row Odd"})}),e.jsx(E,{item:!0,xs:6,children:e.jsx(g,{sx:{bgcolor:h.tokens.rowEvenBg,color:h.tokens.cellText,p:2,border:`1px solid ${h.tokens.border}`,borderRadius:1,textAlign:"center"},children:"Row Even"})})]})})]})}),e.jsxs(xa,{children:[e.jsx(_,{onClick:()=>{be(!1),N(null),Le(!1),ze("")},children:"Cancel"}),(h==null?void 0:h.isPreDefined)&&h.originalKey&&e.jsx(_,{variant:"outlined",color:"primary",onClick:()=>X(void 0,null,function*(){if(h&&h.originalKey&&h.originalKey in re){A.updatePreDefinedTheme(h.originalKey,h.tokens);const a=l(r({},F.themes),{[h.originalKey]:l(r({},h.tokens),{name:h.originalKey.replace("_"," ").replace(/\b\w/g,t=>t.toUpperCase()),description:h.description})});q(t=>l(r({},t),{themes:a})),yield $e(),G(`Template "${h.originalKey}" updated successfully!`),be(!1),N(null)}}),disabled:!(h!=null&&h.name),children:"Update Template"}),e.jsx(_,{variant:"contained",onClick:()=>X(void 0,null,function*(){if(h!=null&&h.isPreDefined)Le(!0);else if(h&&h.name){const a=l(r({},F.themes),{[h.name]:l(r({},h.tokens),{name:h.name,description:h.description})});q(t=>l(r({},t),{themes:a})),yield $e(),be(!1),N(null)}}),disabled:!(h!=null&&h.name),children:(h!=null&&h.isPreDefined,"Save Theme")})]}),e.jsxs(ua,{open:ca,onClose:()=>{Le(!1),ze("")},children:[e.jsx(ma,{children:"Save Theme As"}),e.jsx(ga,{children:e.jsx(S,{autoFocus:!0,margin:"dense",label:"New Theme Name",fullWidth:!0,variant:"outlined",value:xe,onChange:a=>ze(a.target.value),placeholder:"Enter a unique theme name",sx:{mt:2}})}),e.jsxs(xa,{children:[e.jsx(_,{onClick:()=>{Le(!1),ze("")},children:"Cancel"}),e.jsx(_,{variant:"contained",onClick:()=>X(void 0,null,function*(){if(h&&xe.trim()){if(F.themes[xe.trim()]){H(`Theme "${xe.trim()}" already exists. Please choose a different name.`);return}const a=l(r({},F.themes),{[xe.trim()]:l(r({},h.tokens),{name:xe.trim(),description:h.description||`Custom theme: ${xe.trim()}`})});q(t=>l(r({},t),{themes:a})),yield $e(),G(`Theme "${xe.trim()}" saved successfully!`),be(!1),Le(!1),N(null),ze("")}}),disabled:!xe.trim(),children:"Save"})]})]})]}),e.jsxs(ua,{open:c,onClose:()=>y(!1),maxWidth:"sm",fullWidth:!0,children:[e.jsxs(ma,{children:["Configure ",V==="headerBg"?"Header Background":V==="headerText"?"Header Text":V==="rowOddBg"?"Odd Row Background":V==="rowEvenBg"?"Even Row Background":V==="border"?"Border":V==="accent"?"Accent":V==="cellText"?"Cell Text":"Color"]}),e.jsx(ga,{children:V&&(()=>{const a=A.getState(),t=a.liturgicalTheme;let n;fe?n=fe:t&&re[t]?n=re[t]:a.customThemes&&t&&a.customThemes[t]?n=a.customThemes[t]:n={headerBg:"#1976d2",headerText:"#ffffff",rowOddBg:"#fafafa",rowEvenBg:"#ffffff",border:"#e0e0e0",accent:"#1976d2",cellText:"#212121"};const i=n[V];return e.jsxs(Y,{spacing:2,sx:{mt:2},children:[e.jsx(S,{label:"Color",type:"color",value:i,onChange:p=>{const W=l(r({},n),{[V]:p.target.value});if(u(W),t&&a.customThemes&&a.customThemes[t]){const R=l(r({},a.customThemes),{[t]:r(r({},a.customThemes[t]),W)});A.setCustomThemes(R),q(B=>l(r({},B),{themes:l(r({},B.themes),{[t]:r(r({},B.themes[t]),W)})}))}},fullWidth:!0,InputLabelProps:{shrink:!0}}),e.jsx(g,{sx:{p:2,bgcolor:C.palette.action.hover,borderRadius:1},children:e.jsxs(b,{variant:"caption",color:"text.secondary",children:["Preview: This color will be applied to ",V==="headerBg"?"the table header background":V==="headerText"?"the table header text":V==="rowOddBg"?"odd-numbered table rows":V==="rowEvenBg"?"even-numbered table rows":V==="border"?"table borders":V==="accent"?"accent elements":"table cell text","."]})})]})})()}),e.jsxs(xa,{children:[e.jsx(_,{onClick:()=>{y(!1),Pe(null)},children:"Close"}),e.jsx(_,{variant:"contained",onClick:()=>X(void 0,null,function*(){if(V&&fe){const a=A.getState(),t=a.liturgicalTheme;if(t)if(a.customThemes&&a.customThemes[t]){const n=l(r({},a.customThemes),{[t]:r(r({},a.customThemes[t]),fe)});A.setCustomThemes(n),q(i=>l(r({},i),{themes:l(r({},i.themes),{[t]:r(r({},i.themes[t]),fe)})})),yield $e()}else re[t]&&A.updatePreDefinedTheme(t,fe);y(!1),Pe(null),u(null),G("Theme color updated successfully!")}}),children:"Apply"})]})]}),e.jsxs(Y,{direction:"row",spacing:2,justifyContent:"flex-end",sx:{mt:3},children:[e.jsx(_,{variant:"outlined",startIcon:e.jsx(tt,{}),onClick:da,disabled:T,children:"Cancel"}),e.jsx(_,{variant:"contained",startIcon:T?e.jsx(ta,{size:16}):e.jsx(Ma,{}),onClick:()=>X(void 0,null,function*(){yield $e()}),disabled:T,children:T?"Saving...":"Save Themes"})]})]}),Be===3&&e.jsxs(g,{children:[e.jsxs(b,{variant:"h6",gutterBottom:!0,sx:{mb:3,display:"flex",alignItems:"center",gap:1},children:[e.jsx(Re,{color:"primary"}),"UI Theme - Action Buttons Configuration"]}),me&&e.jsx(je,{severity:"error",sx:{mb:2},children:me}),pe&&e.jsx(je,{severity:"success",sx:{mb:2},children:pe}),e.jsx(b,{variant:"body2",color:"text.secondary",sx:{mb:3},children:"Customize the appearance of the four action buttons: Switch to AG, Field Settings, Add Records, and Advanced Grid."}),e.jsxs(Ae,{variant:"outlined",sx:{mb:3,p:3,bgcolor:C.palette.background.paper},children:[e.jsx(b,{variant:"h6",gutterBottom:!0,sx:{mb:2},children:"Live Preview"}),e.jsx(g,{sx:{border:`2px dashed ${C.palette.divider}`,borderRadius:2,p:3,bgcolor:C.palette.background.paper,display:"flex",flexWrap:"wrap",gap:2,alignItems:"center"},children:(()=>{const a=Ie.actionButtonConfigs,t=a==null?void 0:a.searchRecords,n=a==null?void 0:a.theme,i=a==null?void 0:a.recordTableConfig,p=a==null?void 0:a.switchToAG,W=a==null?void 0:a.fieldSettings,R=a==null?void 0:a.addRecords,B=a==null?void 0:a.advancedGrid,f=(I,M,oe,d,Oe,Fe)=>e.jsx(Ne,{title:"Double-click to configure",children:e.jsx(g,{onDoubleClick:()=>We(I),sx:{cursor:"pointer",outline:Q===I?"2px solid #4C1D95":"none",outlineOffset:"4px",borderRadius:1,p:.5},children:I==="searchRecords"?e.jsxs(g,{sx:{display:"flex",flexDirection:"column",gap:.5,minWidth:220},children:[e.jsx(ya,{label:M,size:"small",sx:{width:"fit-content",backgroundColor:(d==null?void 0:d.backgroundColor)||"#4C1D95",color:(d==null?void 0:d.textColor)||"#ffffff",borderRadius:"20px",fontWeight:500,fontSize:(d==null?void 0:d.fontSize)||"0.75rem",padding:(d==null?void 0:d.padding)||"4px 8px","&:hover":{backgroundColor:(d==null?void 0:d.hoverColor)||"#5a2ba8"}}}),e.jsx(S,{placeholder:"Search records...",InputProps:{startAdornment:e.jsx(Dr,{sx:{mr:1,color:"text.secondary"}})},size:"small",sx:{minWidth:220},disabled:!0})]}):I==="theme"?e.jsxs(g,{sx:{display:"flex",flexDirection:"column",gap:.5,minWidth:200},children:[e.jsx(ya,{label:M,size:"small",sx:{width:"fit-content",backgroundColor:(d==null?void 0:d.backgroundColor)||"#4C1D95",color:(d==null?void 0:d.textColor)||"#ffffff",borderRadius:"20px",fontWeight:500,fontSize:(d==null?void 0:d.fontSize)||"0.75rem",padding:(d==null?void 0:d.padding)||"4px 8px","&:hover":{backgroundColor:(d==null?void 0:d.hoverColor)||"#5a2ba8"}}}),e.jsx(Z,{size:"small",fullWidth:!0,children:e.jsx(te,{value:Ie.liturgicalTheme,disabled:!0,sx:{borderRadius:2,backgroundColor:"background.paper"},children:e.jsx(x,{value:Ie.liturgicalTheme,children:Ie.liturgicalTheme})})})]}):I==="recordTableConfig"?e.jsxs(g,{sx:{display:"flex",flexDirection:"column",gap:.5},children:[e.jsx(ya,{label:M,size:"small",sx:{width:"fit-content",backgroundColor:(d==null?void 0:d.backgroundColor)||"#4C1D95",color:(d==null?void 0:d.textColor)||"#ffffff",borderRadius:"20px",fontWeight:500,fontSize:(d==null?void 0:d.fontSize)||"0.75rem",padding:(d==null?void 0:d.padding)||"4px 8px","&:hover":{backgroundColor:(d==null?void 0:d.hoverColor)||"#5a2ba8"}}}),e.jsx(_,{variant:"outlined",startIcon:e.jsx(Wa,{}),disabled:!0,size:(d==null?void 0:d.size)||"small",sx:{borderRadius:2,textTransform:"none",borderColor:(d==null?void 0:d.backgroundColor)||"rgba(76, 29, 149, 0.3)",color:(d==null?void 0:d.textColor)||"#4C1D95",padding:(d==null?void 0:d.padding)||"5px 9px",fontSize:(d==null?void 0:d.fontSize)||"0.75rem","&:hover":{borderColor:(d==null?void 0:d.hoverColor)||"#4C1D95",backgroundColor:d!=null&&d.hoverColor?`${d.hoverColor}15`:"rgba(76, 29, 149, 0.08)"}},children:"Theme Studio"})]}):e.jsx(_,{variant:"contained",startIcon:oe,size:(d==null?void 0:d.size)||"small",disabled:!0,sx:{borderRadius:14,padding:(d==null?void 0:d.padding)||"5px 9px",textTransform:"none",fontWeight:600,letterSpacing:.2,fontSize:(d==null?void 0:d.fontSize)||"0.75rem",color:(d==null?void 0:d.textColor)||"#fff",background:(d==null?void 0:d.backgroundColor)||Oe,boxShadow:"0 6px 16px -6px rgba(25, 118, 210, 0.35)","&:hover":{background:(d==null?void 0:d.hoverColor)||Fe},"& .MuiButton-startIcon":{marginRight:1}},children:M})})});return e.jsxs(e.Fragment,{children:[f("searchRecords","Search Records",e.jsx(Dr,{}),t,"#4C1D95","#5a2ba8"),f("theme","Theme",e.jsx(Wa,{}),n,"#4C1D95","#5a2ba8"),f("recordTableConfig","Record Table Configuration",e.jsx(Wa,{}),i,"#4C1D95","#5a2ba8"),f("switchToAG","Switch to AG",e.jsx(Jr,{}),p,"linear-gradient(135deg, #1976D2 0%, #1565C0 100%)","linear-gradient(135deg, #1565C0 0%, #1976D2 100%)"),f("fieldSettings","Field Settings",e.jsx(Re,{}),W,"linear-gradient(135deg, #4C1D95 0%, #2E1065 100%)","linear-gradient(135deg, #2E1065 0%, #4C1D95 100%)"),f("addRecords","Add Records",e.jsx(Tr,{}),R,"linear-gradient(135deg, #4C1D95 0%, #2E1065 100%)","linear-gradient(135deg, #2E1065 0%, #4C1D95 100%)"),f("advancedGrid","Advanced Grid",e.jsx(Vr,{}),B,"linear-gradient(100deg, #4C1D95 0%, #2E1065 50%, #F6C90E 115%)","linear-gradient(100deg, #2E1065 0%, #4C1D95 50%, #D4A80A 115%)")]})})()},JSON.stringify(Ie.actionButtonConfigs))]}),["searchRecords","theme","recordTableConfig","switchToAG","fieldSettings","addRecords","advancedGrid"].map(a=>{const t=a==="searchRecords"?"Search Records":a==="theme"?"Theme":a==="recordTableConfig"?"Record Table Configuration":a==="switchToAG"?"Switch to AG":a==="fieldSettings"?"Field Settings":a==="addRecords"?"Add Records":"Advanced Grid",n=Ie.actionButtonConfigs,i=n==null?void 0:n[a];return e.jsxs(Ae,{variant:"outlined",sx:{mb:2,p:2,bgcolor:C.palette.background.paper},children:[e.jsx(b,{variant:"subtitle2",gutterBottom:!0,sx:{mb:2},children:t}),e.jsxs(E,{container:!0,spacing:2,children:[e.jsx(E,{item:!0,xs:12,sm:6,children:e.jsx(S,{fullWidth:!0,size:"small",label:"Background Color",type:"color",value:(i==null?void 0:i.backgroundColor)||"",onChange:p=>{A.setActionButtonConfigs({[a]:l(r({},i),{backgroundColor:p.target.value})})},InputLabelProps:{shrink:!0}})}),e.jsx(E,{item:!0,xs:12,sm:6,children:e.jsx(S,{fullWidth:!0,size:"small",label:"Hover Color",type:"color",value:(i==null?void 0:i.hoverColor)||"",onChange:p=>{A.setActionButtonConfigs({[a]:l(r({},i),{hoverColor:p.target.value})})},InputLabelProps:{shrink:!0}})}),e.jsx(E,{item:!0,xs:12,sm:6,children:e.jsx(S,{fullWidth:!0,size:"small",label:"Text Color",type:"color",value:(i==null?void 0:i.textColor)||"",onChange:p=>{A.setActionButtonConfigs({[a]:l(r({},i),{textColor:p.target.value})})},InputLabelProps:{shrink:!0}})}),e.jsx(E,{item:!0,xs:12,sm:6,children:e.jsxs(Z,{fullWidth:!0,size:"small",children:[e.jsx(ne,{children:"Button Size"}),e.jsxs(te,{value:(i==null?void 0:i.size)||"small",onChange:p=>{A.setActionButtonConfigs({[a]:l(r({},i),{size:p.target.value})})},label:"Button Size",children:[e.jsx(x,{value:"small",children:"Small"}),e.jsx(x,{value:"medium",children:"Medium"}),e.jsx(x,{value:"large",children:"Large"})]})]})}),e.jsx(E,{item:!0,xs:12,sm:6,children:e.jsx(S,{fullWidth:!0,size:"small",label:"Padding (e.g., 5px 9px)",value:(i==null?void 0:i.padding)||"",onChange:p=>{A.setActionButtonConfigs({[a]:l(r({},i),{padding:p.target.value})})},placeholder:"5px 9px",InputLabelProps:{shrink:!0}})}),e.jsx(E,{item:!0,xs:12,sm:6,children:e.jsx(S,{fullWidth:!0,size:"small",label:"Font Size (e.g., 0.75rem)",value:(i==null?void 0:i.fontSize)||"",onChange:p=>{A.setActionButtonConfigs({[a]:l(r({},i),{fontSize:p.target.value})})},placeholder:"0.75rem",InputLabelProps:{shrink:!0}})})]})]},a)}),e.jsx(Y,{direction:"row",spacing:2,justifyContent:"flex-end",sx:{mt:3},children:e.jsx(_,{variant:"contained",startIcon:T?e.jsx(ta,{size:16}):e.jsx(Ma,{}),onClick:()=>X(void 0,null,function*(){de(!0),yield new Promise(a=>setTimeout(a,500)),G("Actionbar saved successfully!"),setTimeout(()=>G(null),3e3),de(!1)}),disabled:T,children:T?"Saving...":"Save Actionbar"})}),Q&&e.jsxs(ua,{open:!!Q,onClose:()=>We(null),maxWidth:"sm",fullWidth:!0,children:[e.jsxs(ma,{children:["Configure ",Q==="searchRecords"?"Search Records":Q==="theme"?"Theme":Q==="recordTableConfig"?"Record Table Configuration":Q==="switchToAG"?"Switch to AG":Q==="fieldSettings"?"Field Settings":Q==="addRecords"?"Add Records":"Advanced Grid"]}),e.jsx(ga,{children:(()=>{const a=Ie.actionButtonConfigs,t=a==null?void 0:a[Q];return e.jsxs(E,{container:!0,spacing:2,sx:{mt:1},children:[e.jsx(E,{item:!0,xs:12,sm:6,children:e.jsx(S,{fullWidth:!0,size:"small",label:"Background Color",type:"color",value:(t==null?void 0:t.backgroundColor)||"",onChange:n=>{A.setActionButtonConfigs({[Q]:l(r({},t),{backgroundColor:n.target.value})})},InputLabelProps:{shrink:!0}})}),e.jsx(E,{item:!0,xs:12,sm:6,children:e.jsx(S,{fullWidth:!0,size:"small",label:"Hover Color",type:"color",value:(t==null?void 0:t.hoverColor)||"",onChange:n=>{A.setActionButtonConfigs({[Q]:l(r({},t),{hoverColor:n.target.value})})},InputLabelProps:{shrink:!0}})}),e.jsx(E,{item:!0,xs:12,sm:6,children:e.jsx(S,{fullWidth:!0,size:"small",label:"Text Color",type:"color",value:(t==null?void 0:t.textColor)||"",onChange:n=>{A.setActionButtonConfigs({[Q]:l(r({},t),{textColor:n.target.value})})},InputLabelProps:{shrink:!0}})}),e.jsx(E,{item:!0,xs:12,sm:6,children:e.jsxs(Z,{fullWidth:!0,size:"small",children:[e.jsx(ne,{children:"Button Size"}),e.jsxs(te,{value:(t==null?void 0:t.size)||"small",onChange:n=>{A.setActionButtonConfigs({[Q]:l(r({},t),{size:n.target.value})})},label:"Button Size",children:[e.jsx(x,{value:"small",children:"Small"}),e.jsx(x,{value:"medium",children:"Medium"}),e.jsx(x,{value:"large",children:"Large"})]})]})}),e.jsx(E,{item:!0,xs:12,sm:6,children:e.jsx(S,{fullWidth:!0,size:"small",label:"Padding (e.g., 5px 9px)",value:(t==null?void 0:t.padding)||"",onChange:n=>{A.setActionButtonConfigs({[Q]:l(r({},t),{padding:n.target.value})})},placeholder:"5px 9px",InputLabelProps:{shrink:!0}})}),e.jsx(E,{item:!0,xs:12,sm:6,children:e.jsx(S,{fullWidth:!0,size:"small",label:"Font Size (e.g., 0.75rem)",value:(t==null?void 0:t.fontSize)||"",onChange:n=>{A.setActionButtonConfigs({[Q]:l(r({},t),{fontSize:n.target.value})})},placeholder:"0.75rem",InputLabelProps:{shrink:!0}})})]})})()}),e.jsx(xa,{children:e.jsx(_,{onClick:()=>We(null),children:"Close"})})]})]})]})}),e.jsxs(ua,{open:la,onClose:()=>!ge&&De(!1),maxWidth:"sm",fullWidth:!0,children:[e.jsx(ma,{children:"Export to Template"}),e.jsx(ga,{children:e.jsxs(g,{sx:{pt:2},children:[e.jsx(b,{variant:"body2",color:"text.secondary",gutterBottom:!0,children:"This will create or update a global template from the current table schema and field mapper configuration."}),e.jsxs(g,{sx:{mt:3,mb:2},children:[e.jsx(b,{variant:"subtitle2",gutterBottom:!0,children:"Template Details:"}),e.jsxs(b,{variant:"body2",children:[e.jsx("strong",{children:"Table:"})," ",w]}),e.jsxs(b,{variant:"body2",children:[e.jsx("strong",{children:"Language:"})," ",U]}),e.jsxs(b,{variant:"body2",children:[e.jsx("strong",{children:"Template Slug:"})," ",U,"_",w]}),e.jsxs(b,{variant:"body2",children:[e.jsx("strong",{children:"Template Name:"})," ",U==="en"?"English":U==="gr"?"Greek":U==="ru"?"Russian":U==="ro"?"Romanian":U==="ka"?"Georgian":U.toUpperCase()," ",Me(w).charAt(0).toUpperCase()+Me(w).slice(1)," Records"]})]}),e.jsx(ve,{control:e.jsx(Qa,{checked:qe,onChange:a=>Ve(a.target.checked),disabled:ge}),label:"Overwrite existing template if it exists"}),e.jsx(je,{severity:"warning",sx:{mt:2},children:e.jsxs(b,{variant:"body2",children:[e.jsx("strong",{children:"Warning:"})," This will create a global template available to all churches. Only export standardized, production-ready configurations. Church-specific customizations should not be exported."]})})]})}),e.jsxs(xa,{children:[e.jsx(_,{onClick:()=>De(!1),disabled:ge,children:"Cancel"}),e.jsx(_,{onClick:Ea,variant:"contained",disabled:ge,startIcon:ge?e.jsx(ta,{size:16}):e.jsx(zr,{}),children:ge?"Exporting...":"Export Template"})]})]})]})};export{ks as default};
//# sourceMappingURL=FieldMapperPage-Bm_O0XqJ.js.map
