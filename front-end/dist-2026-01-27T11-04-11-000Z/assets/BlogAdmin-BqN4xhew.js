var T=(h,o,c)=>new Promise((C,d)=>{var D=l=>{try{u(c.next(l))}catch(x){d(x)}},S=l=>{try{u(c.throw(l))}catch(x){d(x)}},u=l=>l.done?C(l.value):Promise.resolve(l.value).then(D,S);u((c=c.apply(h,o)).next())});import{l as J,k as K,j as e,B as r,d as t,e as v,bd as M,G as m,U as f,Q as p,$ as Q,D as q,C as X,R as Z,h as z,I as ee,M as se,f as w,J as te,Y as re,K as ne,a3 as oe,c3 as V}from"./index-BDfVhljI.js";import{r as a}from"./vendor-DgfDxsY7.js";import{B as $}from"./Article-C287aENz.js";import{T as le,D as ie}from"./TrendingUp-DHUZsPVG.js";import{S as ae}from"./Schedule-BVPUy3BF.js";import{T as ce,a as de,b as xe,c as W,d as he}from"./TableRow-CY_CMYLL.js";import{T as n}from"./TableCell-Cc2Re30I.js";import{M as ue}from"./MoreVert-BGrvDORD.js";import{V as je}from"./Visibility-DyzL3Bo2.js";import{E as ge}from"./Edit-hEeKvKl5.js";import{D as me}from"./Delete-BzvjJ98g.js";const Ae=()=>{const h=J(),{user:o}=K(),[c,C]=a.useState([]),[d,D]=a.useState({total:0,published:0,drafts:0,archived:0}),[S,u]=a.useState(!0),[l,x]=a.useState(null),[U,b]=a.useState(!1),[i,I]=a.useState(null),[B,A]=a.useState(null),P=()=>T(void 0,null,function*(){try{u(!0),x(null);const s=yield V.get(`/api/blogs/author/${o==null?void 0:o.id}`);C(s.data);const j=s.data.length,L=s.data.filter(g=>g.status==="published").length,_=s.data.filter(g=>g.status==="draft").length,H=s.data.filter(g=>g.status==="archived").length;D({total:j,published:L,drafts:_,archived:H})}catch(s){console.error("Error loading blog posts:",s),x("Failed to load your blog posts")}finally{u(!1)}});a.useEffect(()=>{o!=null&&o.id&&P()},[o==null?void 0:o.id]);const F=()=>T(void 0,null,function*(){if(i)try{yield V.delete(`/api/blogs/${i.slug}`),yield P(),b(!1),I(null)}catch(s){console.error("Error deleting post:",s),x("Failed to delete blog post")}}),E=()=>{h("/admin/tools/page-editor?contentType=blog")},N=s=>{h(`/admin/tools/page-editor?contentType=blog&slug=${s.slug}`)},O=s=>{s.status==="published"?h(`/blog/${s.slug}`):h(`/admin/tools/page-editor?contentType=blog&slug=${s.slug}&preview=true`)},R=(s,j)=>{A(s.currentTarget),I(j)},y=()=>{A(null),I(null)},k=s=>new Date(s).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}),Y=s=>{switch(s){case"published":return"success";case"draft":return"warning";case"archived":return"default";default:return"default"}},G=s=>{switch(s){case"public":return"success";case"internal":return"warning";case"church-only":return"info";default:return"default"}};return e.jsxs(r,{sx:{p:3},children:[e.jsxs(r,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:4},children:[e.jsxs(r,{children:[e.jsx(t,{variant:"h4",component:"h1",gutterBottom:!0,children:"Blog Administration"}),e.jsx(t,{variant:"body1",color:"text.secondary",children:"Manage your blog posts and track their performance"})]}),e.jsx(v,{variant:"contained",startIcon:e.jsx(M,{}),onClick:E,children:"New Blog Post"})]}),e.jsxs(m,{container:!0,spacing:3,sx:{mb:4},children:[e.jsx(m,{item:!0,xs:12,sm:6,md:3,children:e.jsx(f,{children:e.jsx(p,{children:e.jsxs(r,{sx:{display:"flex",alignItems:"center"},children:[e.jsx($,{sx:{fontSize:40,color:"primary.main",mr:2}}),e.jsxs(r,{children:[e.jsx(t,{variant:"h4",fontWeight:"bold",children:d.total}),e.jsx(t,{variant:"body2",color:"text.secondary",children:"Total Posts"})]})]})})})}),e.jsx(m,{item:!0,xs:12,sm:6,md:3,children:e.jsx(f,{children:e.jsx(p,{children:e.jsxs(r,{sx:{display:"flex",alignItems:"center"},children:[e.jsx(le,{sx:{fontSize:40,color:"success.main",mr:2}}),e.jsxs(r,{children:[e.jsx(t,{variant:"h4",fontWeight:"bold",children:d.published}),e.jsx(t,{variant:"body2",color:"text.secondary",children:"Published"})]})]})})})}),e.jsx(m,{item:!0,xs:12,sm:6,md:3,children:e.jsx(f,{children:e.jsx(p,{children:e.jsxs(r,{sx:{display:"flex",alignItems:"center"},children:[e.jsx(ae,{sx:{fontSize:40,color:"warning.main",mr:2}}),e.jsxs(r,{children:[e.jsx(t,{variant:"h4",fontWeight:"bold",children:d.drafts}),e.jsx(t,{variant:"body2",color:"text.secondary",children:"Drafts"})]})]})})})}),e.jsx(m,{item:!0,xs:12,sm:6,md:3,children:e.jsx(f,{children:e.jsx(p,{children:e.jsxs(r,{sx:{display:"flex",alignItems:"center"},children:[e.jsx(ie,{sx:{fontSize:40,color:"text.secondary",mr:2}}),e.jsxs(r,{children:[e.jsx(t,{variant:"h4",fontWeight:"bold",children:d.archived}),e.jsx(t,{variant:"body2",color:"text.secondary",children:"Archived"})]})]})})})})]}),l&&e.jsx(Q,{severity:"error",sx:{mb:3},children:l}),e.jsx(f,{children:e.jsxs(p,{children:[e.jsx(t,{variant:"h6",gutterBottom:!0,children:"Your Blog Posts"}),e.jsx(q,{sx:{mb:2}}),S?e.jsx(r,{sx:{display:"flex",justifyContent:"center",py:4},children:e.jsx(X,{})}):c.length===0?e.jsxs(r,{sx:{textAlign:"center",py:8},children:[e.jsx($,{sx:{fontSize:80,color:"text.secondary",mb:2}}),e.jsx(t,{variant:"h6",gutterBottom:!0,children:"No blog posts yet"}),e.jsx(t,{variant:"body2",color:"text.secondary",sx:{mb:3},children:"Create your first blog post to get started"}),e.jsx(v,{variant:"contained",startIcon:e.jsx(M,{}),onClick:E,children:"Create Your First Post"})]}):e.jsx(ce,{component:Z,variant:"outlined",children:e.jsxs(de,{children:[e.jsx(xe,{children:e.jsxs(W,{children:[e.jsx(n,{children:e.jsx("strong",{children:"Title"})}),e.jsx(n,{children:e.jsx("strong",{children:"Status"})}),e.jsx(n,{children:e.jsx("strong",{children:"Visibility"})}),e.jsx(n,{children:e.jsx("strong",{children:"Created"})}),e.jsx(n,{children:e.jsx("strong",{children:"Updated"})}),e.jsx(n,{align:"center",children:e.jsx("strong",{children:"Actions"})})]})}),e.jsx(he,{children:c.map(s=>e.jsxs(W,{hover:!0,children:[e.jsxs(n,{children:[e.jsx(t,{variant:"subtitle2",fontWeight:"bold",children:s.title}),e.jsxs(t,{variant:"body2",color:"text.secondary",children:["/",s.slug]})]}),e.jsx(n,{children:e.jsx(z,{label:s.status,size:"small",color:Y(s.status)})}),e.jsx(n,{children:e.jsx(z,{label:s.visibility.replace("-"," "),size:"small",color:G(s.visibility),variant:"outlined"})}),e.jsx(n,{children:k(s.created_at)}),e.jsx(n,{children:k(s.updated_at)}),e.jsx(n,{align:"center",children:e.jsx(ee,{size:"small",onClick:j=>R(j,s),children:e.jsx(ue,{})})})]},s.id))})]})})]})}),e.jsxs(se,{anchorEl:B,open:!!B,onClose:y,children:[e.jsxs(w,{onClick:()=>{O(i),y()},children:[e.jsx(je,{sx:{mr:1}}),(i==null?void 0:i.status)==="published"?"View Post":"Preview"]}),e.jsxs(w,{onClick:()=>{N(i),y()},children:[e.jsx(ge,{sx:{mr:1}}),"Edit"]}),e.jsxs(w,{onClick:()=>{b(!0),y()},sx:{color:"error.main"},children:[e.jsx(me,{sx:{mr:1}}),"Delete"]})]}),e.jsxs(te,{open:U,onClose:()=>b(!1),children:[e.jsx(re,{children:"Delete Blog Post"}),e.jsx(ne,{children:e.jsxs(t,{children:['Are you sure you want to delete "',i==null?void 0:i.title,'"? This action cannot be undone.']})}),e.jsxs(oe,{children:[e.jsx(v,{onClick:()=>b(!1),children:"Cancel"}),e.jsx(v,{onClick:F,color:"error",variant:"contained",children:"Delete"})]})]})]})};export{Ae as default};
//# sourceMappingURL=BlogAdmin-BqN4xhew.js.map
