{"version":3,"file":"BigBookDynamicRoute-D7Nh6IfY.js","sources":["../../src/features/admin/admin/BigBookDynamicRoute.tsx"],"sourcesContent":["import React, { useState, useEffect, Suspense } from 'react';\r\nimport { useParams, useNavigate } from 'react-router-dom';\r\nimport {\r\n  Box,\r\n  Typography,\r\n  Alert,\r\n  CircularProgress,\r\n  Paper,\r\n  Breadcrumbs,\r\n  Link,\r\n  IconButton,\r\n  Tooltip,\r\n  Button\r\n} from '@mui/material';\r\nimport {\r\n  ArrowBack as ArrowBackIcon,\r\n  Refresh as RefreshIcon,\r\n  Home as HomeIcon\r\n} from '@mui/icons-material';\r\n\r\ninterface CustomComponentRegistry {\r\n  components: Record<string, {\r\n    id: string;\r\n    name: string;\r\n    path: string;\r\n    route: string;\r\n    displayName: string;\r\n    description?: string;\r\n    installedAt: string;\r\n    autoInstalled: boolean;\r\n    isDefaultExport: boolean;\r\n    hasJSX: boolean;\r\n    hasHooks: boolean;\r\n    dependencies: string[];\r\n  }>;\r\n  routes: Record<string, string>;\r\n  menu: Array<{\r\n    id: string;\r\n    name: string;\r\n    displayName: string;\r\n    route: string;\r\n    icon?: string;\r\n  }>;\r\n  lastUpdated: string | null;\r\n  version: string;\r\n}\r\n\r\n// Error Boundary for component rendering\r\nclass ComponentErrorBoundary extends React.Component<\r\n  { children: React.ReactNode; componentName: string },\r\n  { hasError: boolean; error?: Error }\r\n> {\r\n  constructor(props: any) {\r\n    super(props);\r\n    this.state = { hasError: false };\r\n  }\r\n\r\n  static getDerivedStateFromError(error: Error) {\r\n    return { hasError: true, error };\r\n  }\r\n\r\n  componentDidCatch(error: Error, errorInfo: any) {\r\n    console.error(`Error in Big Book component \"${this.props.componentName}\":`, error, errorInfo);\r\n  }\r\n\r\n  render() {\r\n    if (this.state.hasError) {\r\n      return (\r\n        <Alert severity=\"error\" sx={{ m: 2 }}>\r\n          <Typography variant=\"subtitle2\" gutterBottom>\r\n            Component Error: {this.props.componentName}\r\n          </Typography>\r\n          <Typography variant=\"body2\">\r\n            {this.state.error?.message || 'Unknown error occurred while rendering component'}\r\n          </Typography>\r\n          <Button\r\n            variant=\"outlined\"\r\n            onClick={() => window.location.reload()}\r\n            sx={{ mt: 1 }}\r\n          >\r\n            Reload Page\r\n          </Button>\r\n        </Alert>\r\n      );\r\n    }\r\n\r\n    return this.props.children;\r\n  }\r\n}\r\n\r\nconst BigBookDynamicRoute: React.FC = () => {\r\n  const { componentId } = useParams<{ componentId: string }>();\r\n  const navigate = useNavigate();\r\n  const [loading, setLoading] = useState(true);\r\n  const [error, setError] = useState<string | null>(null);\r\n  const [componentInfo, setComponentInfo] = useState<any>(null);\r\n  const [CustomComponent, setCustomComponent] = useState<React.ComponentType | null>(null);\r\n\r\n  useEffect(() => {\r\n    if (componentId) {\r\n      loadCustomComponent(componentId);\r\n    } else {\r\n      setError('No component ID provided');\r\n      setLoading(false);\r\n    }\r\n  }, [componentId]);\r\n\r\n  const loadCustomComponent = async (compId: string) => {\r\n    setLoading(true);\r\n    setError(null);\r\n\r\n    try {\r\n      console.log(`ðŸ” Loading Big Book component: ${compId}`);\r\n      \r\n      // Load the custom components registry\r\n      const response = await fetch('/api/bigbook/custom-components-registry', {\r\n        credentials: 'include'\r\n      });\r\n      if (!response.ok) {\r\n        throw new Error(`Failed to load registry: HTTP ${response.status}`);\r\n      }\r\n\r\n      const registry: CustomComponentRegistry = await response.json();\r\n      console.log('ðŸ“‹ Registry loaded:', registry);\r\n\r\n      // Find the component in the registry\r\n      const component = registry.components[compId];\r\n      if (!component) {\r\n        throw new Error(`Component \"${compId}\" not found in registry`);\r\n      }\r\n\r\n      console.log('âœ… Component found:', component);\r\n      setComponentInfo(component);\r\n\r\n      // Dynamically import the component\r\n      try {\r\n        // Convert the server path to a relative import path\r\n        const importPath = component.path.replace('src/', '../');\r\n        console.log(`ðŸ“¦ Importing component from: ${importPath}`);\r\n        \r\n        const module = await import(/* @vite-ignore */ importPath);\r\n        \r\n        let ComponentToRender;\r\n        if (component.isDefaultExport) {\r\n          ComponentToRender = module.default;\r\n        } else {\r\n          ComponentToRender = module[component.name];\r\n        }\r\n\r\n        if (!ComponentToRender) {\r\n          throw new Error(`Component \"${component.name}\" not found in module`);\r\n        }\r\n\r\n        console.log('ðŸŽ‰ Component imported successfully');\r\n        setCustomComponent(() => ComponentToRender);\r\n\r\n      } catch (importError) {\r\n        console.error('âŒ Component import failed:', importError);\r\n        throw new Error(`Failed to load component: ${importError instanceof Error ? importError.message : 'Import failed'}`);\r\n      }\r\n\r\n    } catch (err) {\r\n      const errorMessage = err instanceof Error ? err.message : 'Unknown error occurred';\r\n      console.error('âŒ Big Book component loading failed:', errorMessage);\r\n      setError(errorMessage);\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  const handleBack = () => {\r\n    navigate('/admin/settings');\r\n  };\r\n\r\n  const handleRefresh = () => {\r\n    if (componentId) {\r\n      loadCustomComponent(componentId);\r\n    }\r\n  };\r\n\r\n  if (loading) {\r\n    return (\r\n      <Box\r\n        sx={{\r\n          display: 'flex',\r\n          flexDirection: 'column',\r\n          alignItems: 'center',\r\n          justifyContent: 'center',\r\n          minHeight: '60vh',\r\n          gap: 2\r\n        }}\r\n      >\r\n        <CircularProgress size={48} />\r\n        <Typography variant=\"h6\" color=\"text.secondary\">\r\n          Loading Big Book Component...\r\n        </Typography>\r\n        <Typography variant=\"body2\" color=\"text.secondary\">\r\n          {componentId}\r\n        </Typography>\r\n      </Box>\r\n    );\r\n  }\r\n\r\n  if (error) {\r\n    return (\r\n      <Box sx={{ p: 3 }}>\r\n        <Paper sx={{ p: 3 }}>\r\n          <Box display=\"flex\" alignItems=\"center\" gap={1} mb={2}>\r\n            <IconButton onClick={handleBack} size=\"small\">\r\n              <ArrowBackIcon />\r\n            </IconButton>\r\n            <Breadcrumbs>\r\n              <Link\r\n                color=\"inherit\"\r\n                href=\"#\"\r\n                onClick={(e) => {\r\n                  e.preventDefault();\r\n                  handleBack();\r\n                }}\r\n                sx={{ cursor: 'pointer' }}\r\n              >\r\n                Big Book\r\n              </Link>\r\n              <Typography color=\"text.primary\">Error</Typography>\r\n            </Breadcrumbs>\r\n          </Box>\r\n\r\n          <Alert severity=\"error\">\r\n            <Typography variant=\"subtitle2\" gutterBottom>\r\n              Failed to Load Component\r\n            </Typography>\r\n            <Typography variant=\"body2\" gutterBottom>\r\n              {error}\r\n            </Typography>\r\n            <Box sx={{ mt: 2, display: 'flex', gap: 1 }}>\r\n              <Button variant=\"outlined\" onClick={handleRefresh} startIcon={<RefreshIcon />}>\r\n                Retry\r\n              </Button>\r\n              <Button variant=\"outlined\" onClick={handleBack} startIcon={<HomeIcon />}>\r\n                Back to Big Book\r\n              </Button>\r\n            </Box>\r\n          </Alert>\r\n        </Paper>\r\n      </Box>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <Box sx={{ height: '100vh', display: 'flex', flexDirection: 'column' }}>\r\n      {/* Header */}\r\n      <Paper sx={{ p: 2, mb: 2 }}>\r\n        <Box display=\"flex\" alignItems=\"center\" justifyContent=\"space-between\">\r\n          <Box display=\"flex\" alignItems=\"center\" gap={1}>\r\n            <IconButton onClick={handleBack} size=\"small\">\r\n              <ArrowBackIcon />\r\n            </IconButton>\r\n            <Breadcrumbs>\r\n              <Link\r\n                color=\"inherit\"\r\n                href=\"#\"\r\n                onClick={(e) => {\r\n                  e.preventDefault();\r\n                  handleBack();\r\n                }}\r\n                sx={{ cursor: 'pointer' }}\r\n              >\r\n                Big Book\r\n              </Link>\r\n              <Typography color=\"text.primary\">Custom Components</Typography>\r\n              <Typography color=\"text.primary\" fontWeight={600}>\r\n                {componentInfo?.displayName || componentId}\r\n              </Typography>\r\n            </Breadcrumbs>\r\n          </Box>\r\n          <Box display=\"flex\" alignItems=\"center\" gap={1}>\r\n            <Tooltip title=\"Refresh component\">\r\n              <IconButton onClick={handleRefresh} size=\"small\">\r\n                <RefreshIcon />\r\n              </IconButton>\r\n            </Tooltip>\r\n          </Box>\r\n        </Box>\r\n        {componentInfo?.description && (\r\n          <Typography variant=\"body2\" color=\"text.secondary\" sx={{ mt: 1 }}>\r\n            {componentInfo.description}\r\n          </Typography>\r\n        )}\r\n      </Paper>\r\n\r\n      {/* Component Content */}\r\n      <Paper sx={{ flex: 1, overflow: 'auto' }}>\r\n        <Suspense\r\n          fallback={\r\n            <Box\r\n              display=\"flex\"\r\n              justifyContent=\"center\"\r\n              alignItems=\"center\"\r\n              minHeight={400}\r\n            >\r\n              <CircularProgress />\r\n            </Box>\r\n          }\r\n        >\r\n          {CustomComponent ? (\r\n            <ComponentErrorBoundary componentName={componentInfo?.name || componentId || 'Unknown'}>\r\n              <CustomComponent />\r\n            </ComponentErrorBoundary>\r\n          ) : (\r\n            <Alert severity=\"warning\" sx={{ m: 2 }}>\r\n              <Typography variant=\"body2\">\r\n                Component \"{componentId}\" loaded but is not renderable.\r\n              </Typography>\r\n            </Alert>\r\n          )}\r\n        </Suspense>\r\n      </Paper>\r\n    </Box>\r\n  );\r\n};\r\n\r\nexport default BigBookDynamicRoute; "],"names":["ComponentErrorBoundary","React","props","error","errorInfo","jsxs","Alert","Typography","jsx","Button","BigBookDynamicRoute","componentId","useParams","navigate","useNavigate","loading","setLoading","useState","setError","componentInfo","setComponentInfo","CustomComponent","setCustomComponent","useEffect","loadCustomComponent","compId","__async","response","registry","component","importPath","module","ComponentToRender","importError","err","errorMessage","handleBack","handleRefresh","Box","CircularProgress","Paper","IconButton","ArrowBackIcon","Breadcrumbs","Link","e","RefreshIcon","HomeIcon","Tooltip","Suspense"],"mappings":"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"}