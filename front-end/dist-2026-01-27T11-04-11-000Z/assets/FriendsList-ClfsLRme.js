var ge=Object.defineProperty,je=Object.defineProperties;var ue=Object.getOwnPropertyDescriptors;var B=Object.getOwnPropertySymbols;var K=Object.prototype.hasOwnProperty,X=Object.prototype.propertyIsEnumerable;var J=(a,o,r)=>o in a?ge(a,o,{enumerable:!0,configurable:!0,writable:!0,value:r}):a[o]=r,k=(a,o)=>{for(var r in o||(o={}))K.call(o,r)&&J(a,r,o[r]);if(B)for(var r of B(o))X.call(o,r)&&J(a,r,o[r]);return a},R=(a,o)=>je(a,ue(o));var Z=(a,o)=>{var r={};for(var l in a)K.call(a,l)&&o.indexOf(l)<0&&(r[l]=a[l]);if(a!=null&&B)for(var l of B(a))o.indexOf(l)<0&&X.call(a,l)&&(r[l]=a[l]);return r};var f=(a,o,r)=>new Promise((l,u)=>{var b=m=>{try{A(r.next(m))}catch(w){u(w)}},S=m=>{try{A(r.throw(m))}catch(w){u(w)}},A=m=>m.done?l(m.value):Promise.resolve(m.value).then(b,S);A((r=r.apply(a,o)).next())});import{c as te,k as fe,l as ye,j as e,U as M,B as t,$ as ve,G as y,Q as P,S as j,d as c,e as v,R as ee,O as be,J as we,Y as _e,K as Ce,a3 as Ie,I as ze,A as Fe,h as se,C as ke}from"./index-BDfVhljI.js";import{r as p}from"./vendor-DgfDxsY7.js";import{P as Re}from"./PageContainer-D68R9_Qt.js";import{B as Se}from"./Breadcrumb-BksUUxoN.js";import{s as _}from"./social.api-CuBdSZE7.js";import{T as Ae,a as N}from"./Tabs-VYJhMi1b.js";import{I as re}from"./IconUsers-QySA9rdu.js";import{I as $}from"./IconSearch-B_Nt8Cv2.js";import{S as x}from"./Skeleton-DBJMna3S.js";import{I as Me}from"./InputAdornment-ZC5rvhDf.js";import{I as ie}from"./IconUserPlus-Dws2bqPq.js";import{B as O}from"./Badge-DJp7X618.js";import{A as G}from"./Avatar-TOicZKRH.js";import{f as L}from"./index-B8Cm0CAq.js";import{I as Te}from"./IconMessage-DSWttVJ8.js";import{I as De}from"./IconCheck-CCb7Bi7d.js";import{I as Ee}from"./IconMapPin-8KPxTszF.js";import"./Helmet-DNWYwtrp.js";import"./index-BvdvJza9.js";import"./Breadcrumbs-neNWuVCu.js";import"./Link-UeZU0xE4.js";import"./KeyboardArrowRight-n0bX-S0N.js";import"./usePreviousProps-BWumOsHT.js";import"./typeof-QjJsDpFa.js";import"./index-B9SIr0Qh.js";/**
 * @license @tabler/icons-react v3.34.1 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */const Be=[["path",{d:"M8 7a4 4 0 1 0 8 0a4 4 0 0 0 -8 0",key:"svg-0"}],["path",{d:"M6 21v-2a4 4 0 0 1 4 -4h4",key:"svg-1"}],["path",{d:"M15 19l2 2l4 -4",key:"svg-2"}]],ne=te("outline","user-check","UserCheck",Be);/**
 * @license @tabler/icons-react v3.34.1 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */const Pe=[["path",{d:"M8 7a4 4 0 1 0 8 0a4 4 0 0 0 -8 0",key:"svg-0"}],["path",{d:"M6 21v-2a4 4 0 0 1 4 -4h4c.348 0 .686 .045 1.009 .128",key:"svg-1"}],["path",{d:"M16 19h6",key:"svg-2"}]],$e=te("outline","user-minus","UserMinus",Pe);function W(a){const b=a,{children:o,value:r,index:l}=b,u=Z(b,["children","value","index"]);return e.jsx("div",R(k({role:"tabpanel",hidden:r!==l,id:`friends-tabpanel-${l}`,"aria-labelledby":`friends-tab-${l}`},u),{children:r===l&&e.jsx(t,{children:o})}))}const hs=()=>{const{user:a}=fe(),o=ye(),[r,l]=p.useState(0),[u,b]=p.useState([]),[S,A]=p.useState([]),[m,w]=p.useState([]),[C,ae]=p.useState(""),[U,I]=p.useState(!1),[H,g]=p.useState(null),[z,F]=p.useState(null),[T,D]=p.useState({open:!1,title:"",message:"",action:()=>{}}),oe=[{to:"/",title:"Home"},{title:"Social"},{title:"Friends"}];p.useEffect(()=>{r===0?Q():r===1&&Y()},[r]),p.useEffect(()=>{const s=setTimeout(()=>{C.trim()&&r===2?ce():r===2&&w([])},500);return()=>clearTimeout(s)},[C,r]);const Q=()=>f(void 0,null,function*(){var s,i;try{I(!0),g(null);const n=yield _.friends.getAll();b(n.friends||[])}catch(n){console.error("Error fetching friends:",n),g(((i=(s=n.response)==null?void 0:s.data)==null?void 0:i.message)||"Failed to load friends")}finally{I(!1)}}),Y=()=>f(void 0,null,function*(){var s,i;try{I(!0),g(null);const n=yield _.friends.getRequests();A(n.requests||[])}catch(n){console.error("Error fetching requests:",n),g(((i=(s=n.response)==null?void 0:s.data)==null?void 0:i.message)||"Failed to load friend requests")}finally{I(!1)}}),ce=()=>f(void 0,null,function*(){var s,i;if(C.trim())try{I(!0),g(null);const n=yield _.friends.search(C);w(n.users||[])}catch(n){console.error("Error searching users:",n),g(((i=(s=n.response)==null?void 0:s.data)==null?void 0:i.message)||"Failed to search users")}finally{I(!1)}}),le=s=>f(void 0,null,function*(){var i,n;try{F(s),yield _.friends.sendRequest(s),w(d=>d.map(h=>h.id===s?R(k({},h),{friendship_status:"pending",friendship_direction:"sent"}):h))}catch(d){console.error("Error sending friend request:",d),g(((n=(i=d.response)==null?void 0:i.data)==null?void 0:n.message)||"Failed to send friend request")}finally{F(null)}}),q=(s,i)=>f(void 0,null,function*(){var n,d;try{F(s),yield _.friends.respondToRequest(s,{action:i}),yield Y(),i==="accept"&&(yield Q())}catch(h){console.error("Error responding to request:",h),g(((d=(n=h.response)==null?void 0:n.data)==null?void 0:d.message)||"Failed to respond to friend request")}finally{F(null)}}),de=s=>f(void 0,null,function*(){var i,n;try{F(s),yield _.friends.remove(s),b(d=>d.filter(h=>h.friend_id!==s))}catch(d){console.error("Error removing friend:",d),g(((n=(i=d.response)==null?void 0:i.data)==null?void 0:n.message)||"Failed to remove friend")}finally{F(null)}}),he=s=>f(void 0,null,function*(){var i,n;try{const d=yield _.chat.startConversation(s);o("/social/chat",{state:{conversationId:d.conversation_id}})}catch(d){console.error("Error starting conversation:",d),g(((n=(i=d.response)==null?void 0:i.data)==null?void 0:n.message)||"Failed to start conversation")}}),E=s=>s.display_name||`${s.first_name} ${s.last_name}`,V=(s,i)=>{if(s)return"Online";if(i){const n=new Date(i),h=Math.floor((new Date().getTime()-n.getTime())/(1e3*60*60));return h<1?"Recently active":h<24?`Active ${h}h ago`:`Last seen ${L(n,"MMM dd")}`}return"Offline"},xe=s=>e.jsx(y,{item:!0,xs:12,sm:6,md:4,children:e.jsx(M,{sx:{height:"100%",position:"relative"},children:e.jsx(P,{children:e.jsxs(j,{spacing:2,children:[e.jsxs(t,{display:"flex",alignItems:"center",spacing:2,children:[e.jsx(O,{overlap:"circular",anchorOrigin:{vertical:"bottom",horizontal:"right"},badgeContent:e.jsx(t,{sx:{width:12,height:12,borderRadius:"50%",bgcolor:s.is_online?"success.main":"grey.400",border:"2px solid white"}}),children:e.jsx(G,{src:s.profile_image_url,sx:{width:64,height:64},children:s.first_name[0]})}),e.jsxs(t,{flexGrow:1,ml:2,children:[e.jsx(c,{variant:"h6",children:E(s)}),e.jsx(c,{variant:"caption",color:"text.secondary",children:V(s.is_online,s.last_seen)}),e.jsxs(c,{variant:"caption",display:"block",color:"text.secondary",children:["Friends since ",L(new Date(s.friends_since),"MMM yyyy")]})]})]}),s.bio&&e.jsx(c,{variant:"body2",color:"text.secondary",noWrap:!0,children:s.bio}),e.jsxs(j,{direction:"row",spacing:1,children:[e.jsx(v,{size:"small",startIcon:e.jsx(Te,{size:16}),onClick:()=>he(s.friend_id),variant:"contained",fullWidth:!0,children:"Chat"}),e.jsx(ze,{size:"small",color:"error",onClick:()=>D({open:!0,title:"Remove Friend",message:`Are you sure you want to remove ${E(s)} from your friends?`,action:()=>de(s.friend_id)}),disabled:z===s.friend_id,children:e.jsx($e,{size:16})})]})]})})})},s.friend_id),me=s=>e.jsx(ee,{sx:{p:2,mb:2},children:e.jsxs(j,{direction:"row",spacing:2,alignItems:"center",children:[e.jsx(O,{overlap:"circular",anchorOrigin:{vertical:"bottom",horizontal:"right"},badgeContent:e.jsx(t,{sx:{width:12,height:12,borderRadius:"50%",bgcolor:s.is_online?"success.main":"grey.400",border:"2px solid white"}}),children:e.jsx(G,{src:s.profile_image_url,sx:{width:48,height:48},children:s.first_name[0]})}),e.jsxs(t,{flexGrow:1,children:[e.jsx(c,{variant:"h6",children:E(s)}),e.jsx(c,{variant:"body2",color:"text.secondary",children:s.direction==="received"?"Sent you a friend request":"You sent a friend request"}),e.jsx(c,{variant:"caption",color:"text.secondary",children:L(new Date(s.requested_at),"MMM dd, yyyy HH:mm")})]}),e.jsxs(j,{direction:"row",spacing:1,children:[s.can_accept&&e.jsx(v,{size:"small",startIcon:e.jsx(De,{size:16}),onClick:()=>q(s.id,"accept"),disabled:z===s.id,variant:"contained",color:"success",children:"Accept"}),s.can_decline&&e.jsx(v,{size:"small",startIcon:e.jsx(Fe,{size:16}),onClick:()=>q(s.id,"decline"),disabled:z===s.id,variant:"outlined",color:"error",children:"Decline"}),s.can_cancel&&e.jsx(v,{size:"small",onClick:()=>q(s.id,"decline"),disabled:z===s.id,variant:"outlined",children:"Cancel"})]})]})},s.id),pe=s=>e.jsx(y,{item:!0,xs:12,sm:6,md:4,children:e.jsx(M,{children:e.jsx(P,{children:e.jsxs(j,{spacing:2,children:[e.jsxs(t,{display:"flex",alignItems:"center",spacing:2,children:[e.jsx(O,{overlap:"circular",anchorOrigin:{vertical:"bottom",horizontal:"right"},badgeContent:e.jsx(t,{sx:{width:12,height:12,borderRadius:"50%",bgcolor:s.is_online?"success.main":"grey.400",border:"2px solid white"}}),children:e.jsx(G,{src:s.profile_image_url,sx:{width:48,height:48},children:s.first_name[0]})}),e.jsxs(t,{flexGrow:1,ml:2,children:[e.jsx(c,{variant:"h6",children:E(s)}),e.jsx(c,{variant:"caption",color:"text.secondary",children:V(s.is_online)})]})]}),s.bio&&e.jsx(c,{variant:"body2",color:"text.secondary",noWrap:!0,children:s.bio}),s.location&&e.jsxs(c,{variant:"caption",color:"text.secondary",children:[e.jsx(Ee,{size:14,style:{marginRight:4}}),s.location]}),e.jsx(t,{children:s.friendship_status==="accepted"?e.jsx(se,{label:"Friends",color:"success",size:"small"}):s.friendship_status==="pending"?e.jsx(se,{label:s.friendship_direction==="sent"?"Request Sent":"Request Received",color:"warning",size:"small"}):e.jsx(v,{size:"small",startIcon:e.jsx(ie,{size:16}),onClick:()=>le(s.id),disabled:z===s.id,variant:"contained",fullWidth:!0,children:z===s.id?e.jsx(ke,{size:16}):"Add Friend"})})]})})})},s.id);return e.jsxs(Re,{title:"Friends",description:"Manage your friends",children:[e.jsx(Se,{title:"Friends",items:oe}),e.jsxs(M,{children:[e.jsx(t,{sx:{borderBottom:1,borderColor:"divider"},children:e.jsxs(Ae,{value:r,onChange:(s,i)=>l(i),children:[e.jsx(N,{label:e.jsxs(t,{display:"flex",alignItems:"center",gap:1,children:[e.jsx(re,{size:18}),"Friends (",u.length,")"]})}),e.jsx(N,{label:e.jsxs(t,{display:"flex",alignItems:"center",gap:1,children:[e.jsx(ne,{size:18}),"Requests (",S.filter(s=>s.status==="pending").length,")"]})}),e.jsx(N,{label:e.jsxs(t,{display:"flex",alignItems:"center",gap:1,children:[e.jsx($,{size:18}),"Find Friends"]})})]})}),H&&e.jsx(ve,{severity:"error",sx:{m:2},children:H}),e.jsx(W,{value:r,index:0,children:e.jsx(t,{p:3,children:U?e.jsx(y,{container:!0,spacing:3,children:[...Array(6)].map((s,i)=>e.jsx(y,{item:!0,xs:12,sm:6,md:4,children:e.jsx(M,{children:e.jsx(P,{children:e.jsxs(j,{spacing:2,children:[e.jsxs(t,{display:"flex",alignItems:"center",spacing:2,children:[e.jsx(x,{variant:"circular",width:64,height:64}),e.jsxs(t,{ml:2,children:[e.jsx(x,{variant:"text",width:120}),e.jsx(x,{variant:"text",width:80})]})]}),e.jsx(x,{variant:"rectangular",height:32})]})})})},i))}):u.length===0?e.jsxs(t,{textAlign:"center",py:8,children:[e.jsx(re,{size:64,color:"lightgray"}),e.jsx(c,{variant:"h6",mt:2,color:"text.secondary",children:"No friends yet"}),e.jsx(c,{variant:"body2",color:"text.secondary",mb:3,children:"Start building your network by finding and adding friends"}),e.jsx(v,{variant:"contained",onClick:()=>l(2),startIcon:e.jsx($,{size:18}),children:"Find Friends"})]}):e.jsx(y,{container:!0,spacing:3,children:u.map(xe)})})}),e.jsx(W,{value:r,index:1,children:e.jsx(t,{p:3,children:U?e.jsx(j,{spacing:2,children:[...Array(3)].map((s,i)=>e.jsx(ee,{sx:{p:2},children:e.jsxs(j,{direction:"row",spacing:2,alignItems:"center",children:[e.jsx(x,{variant:"circular",width:48,height:48}),e.jsxs(t,{flexGrow:1,children:[e.jsx(x,{variant:"text",width:150}),e.jsx(x,{variant:"text",width:200})]}),e.jsx(x,{variant:"rectangular",width:80,height:32})]})},i))}):S.filter(s=>s.status==="pending").length===0?e.jsxs(t,{textAlign:"center",py:8,children:[e.jsx(ne,{size:64,color:"lightgray"}),e.jsx(c,{variant:"h6",mt:2,color:"text.secondary",children:"No pending friend requests"}),e.jsx(c,{variant:"body2",color:"text.secondary",children:"You're all caught up!"})]}):e.jsx(j,{spacing:2,children:S.filter(s=>s.status==="pending").map(me)})})}),e.jsx(W,{value:r,index:2,children:e.jsxs(t,{p:3,children:[e.jsx(be,{fullWidth:!0,placeholder:"Search for friends by name or email...",value:C,onChange:s=>ae(s.target.value),InputProps:{startAdornment:e.jsx(Me,{position:"start",children:e.jsx($,{size:20})})},sx:{mb:3}}),U?e.jsx(y,{container:!0,spacing:3,children:[...Array(6)].map((s,i)=>e.jsx(y,{item:!0,xs:12,sm:6,md:4,children:e.jsx(M,{children:e.jsx(P,{children:e.jsxs(j,{spacing:2,children:[e.jsxs(t,{display:"flex",alignItems:"center",children:[e.jsx(x,{variant:"circular",width:48,height:48}),e.jsxs(t,{ml:2,children:[e.jsx(x,{variant:"text",width:120}),e.jsx(x,{variant:"text",width:80})]})]}),e.jsx(x,{variant:"rectangular",height:32})]})})})},i))}):C&&m.length===0?e.jsxs(t,{textAlign:"center",py:8,children:[e.jsx($,{size:64,color:"lightgray"}),e.jsx(c,{variant:"h6",mt:2,color:"text.secondary",children:"No users found"}),e.jsx(c,{variant:"body2",color:"text.secondary",children:"Try searching with different keywords"})]}):m.length>0?e.jsx(y,{container:!0,spacing:3,children:m.map(pe)}):e.jsxs(t,{textAlign:"center",py:8,children:[e.jsx(ie,{size:64,color:"lightgray"}),e.jsx(c,{variant:"h6",mt:2,color:"text.secondary",children:"Discover new friends"}),e.jsx(c,{variant:"body2",color:"text.secondary",children:"Search for people by name or email to connect with them"})]})]})})]}),e.jsxs(we,{open:T.open,onClose:()=>D(s=>R(k({},s),{open:!1})),children:[e.jsx(_e,{children:T.title}),e.jsx(Ce,{children:e.jsx(c,{children:T.message})}),e.jsxs(Ie,{children:[e.jsx(v,{onClick:()=>D(s=>R(k({},s),{open:!1})),children:"Cancel"}),e.jsx(v,{onClick:()=>{T.action(),D(s=>R(k({},s),{open:!1}))},color:"error",variant:"contained",children:"Remove"})]})]})]})};export{hs as default};
//# sourceMappingURL=FriendsList-ClfsLRme.js.map
