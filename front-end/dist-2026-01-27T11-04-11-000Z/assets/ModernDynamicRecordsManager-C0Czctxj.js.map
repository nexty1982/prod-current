{"version":3,"file":"ModernDynamicRecordsManager-C0Czctxj.js","sources":["../../src/features/records-centralized/components/records/RecordTableConfigApiService.ts","../../src/features/records-centralized/components/records/AgGridConfigApiService.ts","../../src/features/records-centralized/components/records/UnifiedRecordsApiService.ts","../../src/features/records-centralized/components/records/useAgGridConfig.ts","../../src/features/records-centralized/components/records/useUnifiedRecords.ts","../../src/features/records-centralized/components/records/ModernDynamicRecordsManager.tsx"],"sourcesContent":["/**\n * Orthodox Metrics - Record Table Configuration API Service\n * Handles all API calls related to record table configurations\n */\n\nimport { apiJson } from '@/sandbox/field-mapper/api/client';\n\nexport interface RecordTableConfig {\n  id: number;\n  table_name: string;\n  display_name: string;\n  description?: string;\n  table_type: 'baptism' | 'marriage' | 'funeral' | 'custom';\n  is_active: boolean;\n  table_config: TableConfig;\n  field_definitions: FieldDefinition[];\n  display_settings: DisplaySettings;\n  search_config: SearchConfig;\n  validation_rules: ValidationRules;\n  import_export_config: ImportExportConfig;\n  certificate_config: CertificateConfig;\n  created_at: string;\n  updated_at: string;\n  created_by?: number;\n  updated_by?: number;\n}\n\nexport interface TableConfig {\n  primary_key: string;\n  church_id_field: string;\n  date_field: string;\n  name_fields: string[];\n  sort_default: string;\n  sort_direction: 'ASC' | 'DESC';\n}\n\nexport interface FieldDefinition {\n  column_name: string;\n  display_name: string;\n  field_type: 'text' | 'number' | 'date' | 'select' | 'textarea' | 'checkbox' | 'email' | 'phone';\n  is_primary: boolean;\n  is_required: boolean;\n  is_searchable: boolean;\n  is_sortable: boolean;\n  display_order: number;\n  column_width: number;\n  is_hidden?: boolean;\n  validation?: FieldValidation;\n  options?: string[];\n  options_source?: 'dropdown' | 'static';\n}\n\nexport interface FieldValidation {\n  min_length?: number;\n  max_length?: number;\n  min?: number;\n  max?: number;\n  pattern?: string;\n  not_future?: boolean;\n  not_past?: boolean;\n}\n\nexport interface DisplaySettings {\n  default_page_size: number;\n  max_page_size: number;\n  show_actions: boolean;\n  actions: string[];\n  bulk_actions: string[];\n  row_height: 'small' | 'medium' | 'large';\n  sticky_header: boolean;\n  show_pagination: boolean;\n  show_search: boolean;\n  show_filters: boolean;\n  theme: string;\n}\n\nexport interface SearchConfig {\n  searchable_fields: string[];\n  filterable_fields: string[];\n  sortable_fields: string[];\n  default_search_field: string;\n  search_placeholder: string;\n  advanced_search: boolean;\n}\n\nexport interface ValidationRules {\n  required_fields: string[];\n  field_validations: Record<string, FieldValidation>;\n}\n\nexport interface ImportExportConfig {\n  supported_formats: string[];\n  export_fields: string[];\n  import_mapping: Record<string, string[]>;\n  bulk_import_limit: number;\n}\n\nexport interface CertificateConfig {\n  enabled: boolean;\n  template_path: string;\n  field_positions: Record<string, { x: number; y: number }>;\n  field_mapping: Record<string, string[]>;\n  output_format: string;\n  quality: number;\n}\n\nexport interface RecordTableConfigResponse {\n  success: boolean;\n  data: RecordTableConfig | RecordTableConfig[];\n  church?: {\n    id: number;\n    db: string;\n  };\n  error?: string;\n  details?: string;\n}\n\nexport interface CreateRecordTableConfigRequest {\n  table_name: string;\n  display_name: string;\n  description?: string;\n  table_type?: 'baptism' | 'marriage' | 'funeral' | 'custom';\n  table_config?: Partial<TableConfig>;\n  field_definitions?: FieldDefinition[];\n  display_settings?: Partial<DisplaySettings>;\n  search_config?: Partial<SearchConfig>;\n  validation_rules?: Partial<ValidationRules>;\n  import_export_config?: Partial<ImportExportConfig>;\n  certificate_config?: Partial<CertificateConfig>;\n}\n\nexport interface UpdateRecordTableConfigRequest extends Partial<CreateRecordTableConfigRequest> {}\n\nclass RecordTableConfigApiService {\n  private baseUrl = '/api/record-table-config';\n\n  /**\n   * Get all record table configurations for a church\n   */\n  async getTableConfigs(churchId: number): Promise<RecordTableConfig[]> {\n    try {\n      const response = await apiJson.get<RecordTableConfigResponse>(\n        `${this.baseUrl}?church_id=${churchId}`\n      );\n      \n      if (!response.success) {\n        throw new Error(response.error || 'Failed to fetch table configurations');\n      }\n      \n      return Array.isArray(response.data) ? response.data : [response.data];\n    } catch (error) {\n      console.error('Error fetching table configurations:', error);\n      throw error;\n    }\n  }\n\n  /**\n   * Get specific table configuration\n   */\n  async getTableConfig(\n    churchId: number, \n    tableName: string\n  ): Promise<RecordTableConfig | null> {\n    try {\n      const response = await apiJson.get<RecordTableConfigResponse>(\n        `${this.baseUrl}/${tableName}?church_id=${churchId}`\n      );\n      \n      if (!response.success) {\n        if (response.error?.includes('not found')) {\n          return null;\n        }\n        throw new Error(response.error || 'Failed to fetch table configuration');\n      }\n      \n      return Array.isArray(response.data) ? response.data[0] : response.data;\n    } catch (error) {\n      console.error('Error fetching table configuration:', error);\n      throw error;\n    }\n  }\n\n  /**\n   * Create new table configuration\n   */\n  async createTableConfig(\n    churchId: number,\n    config: CreateRecordTableConfigRequest\n  ): Promise<RecordTableConfig> {\n    try {\n      const response = await apiJson.post<RecordTableConfigResponse>(\n        `${this.baseUrl}?church_id=${churchId}`,\n        config\n      );\n      \n      if (!response.success) {\n        throw new Error(response.error || 'Failed to create table configuration');\n      }\n      \n      return Array.isArray(response.data) ? response.data[0] : response.data;\n    } catch (error) {\n      console.error('Error creating table configuration:', error);\n      throw error;\n    }\n  }\n\n  /**\n   * Update table configuration\n   */\n  async updateTableConfig(\n    churchId: number,\n    tableName: string,\n    config: UpdateRecordTableConfigRequest\n  ): Promise<RecordTableConfig> {\n    try {\n      const response = await apiJson.put<RecordTableConfigResponse>(\n        `${this.baseUrl}/${tableName}?church_id=${churchId}`,\n        config\n      );\n      \n      if (!response.success) {\n        throw new Error(response.error || 'Failed to update table configuration');\n      }\n      \n      return Array.isArray(response.data) ? response.data[0] : response.data;\n    } catch (error) {\n      console.error('Error updating table configuration:', error);\n      throw error;\n    }\n  }\n\n  /**\n   * Delete table configuration\n   */\n  async deleteTableConfig(churchId: number, tableName: string): Promise<void> {\n    try {\n      const response = await apiJson.delete<RecordTableConfigResponse>(\n        `${this.baseUrl}/${tableName}?church_id=${churchId}`\n      );\n      \n      if (!response.success) {\n        throw new Error(response.error || 'Failed to delete table configuration');\n      }\n    } catch (error) {\n      console.error('Error deleting table configuration:', error);\n      throw error;\n    }\n  }\n\n  /**\n   * Get field definitions for a table\n   */\n  async getFieldDefinitions(\n    churchId: number,\n    tableName: string\n  ): Promise<FieldDefinition[]> {\n    try {\n      const response = await apiJson.get<{\n        success: boolean;\n        data: FieldDefinition[];\n        error?: string;\n      }>(`${this.baseUrl}/${tableName}/fields?church_id=${churchId}`);\n      \n      if (!response.success) {\n        throw new Error(response.error || 'Failed to fetch field definitions');\n      }\n      \n      return response.data;\n    } catch (error) {\n      console.error('Error fetching field definitions:', error);\n      throw error;\n    }\n  }\n\n  /**\n   * Get display settings for a table\n   */\n  async getDisplaySettings(\n    churchId: number,\n    tableName: string\n  ): Promise<DisplaySettings> {\n    try {\n      const response = await apiJson.get<{\n        success: boolean;\n        data: DisplaySettings;\n        error?: string;\n      }>(`${this.baseUrl}/${tableName}/display-settings?church_id=${churchId}`);\n      \n      if (!response.success) {\n        throw new Error(response.error || 'Failed to fetch display settings');\n      }\n      \n      return response.data;\n    } catch (error) {\n      console.error('Error fetching display settings:', error);\n      throw error;\n    }\n  }\n\n  /**\n   * Get search configuration for a table\n   */\n  async getSearchConfig(\n    churchId: number,\n    tableName: string\n  ): Promise<SearchConfig> {\n    try {\n      const response = await apiJson.get<{\n        success: boolean;\n        data: SearchConfig;\n        error?: string;\n      }>(`${this.baseUrl}/${tableName}/search-config?church_id=${churchId}`);\n      \n      if (!response.success) {\n        throw new Error(response.error || 'Failed to fetch search configuration');\n      }\n      \n      return response.data;\n    } catch (error) {\n      console.error('Error fetching search configuration:', error);\n      throw error;\n    }\n  }\n\n  /**\n   * Get validation rules for a table\n   */\n  async getValidationRules(\n    churchId: number,\n    tableName: string\n  ): Promise<ValidationRules> {\n    try {\n      const config = await this.getTableConfig(churchId, tableName);\n      return config?.validation_rules || { required_fields: [], field_validations: {} };\n    } catch (error) {\n      console.error('Error fetching validation rules:', error);\n      throw error;\n    }\n  }\n\n  /**\n   * Get import/export configuration for a table\n   */\n  async getImportExportConfig(\n    churchId: number,\n    tableName: string\n  ): Promise<ImportExportConfig> {\n    try {\n      const config = await this.getTableConfig(churchId, tableName);\n      return config?.import_export_config || {\n        supported_formats: [],\n        export_fields: [],\n        import_mapping: {},\n        bulk_import_limit: 1000\n      };\n    } catch (error) {\n      console.error('Error fetching import/export configuration:', error);\n      throw error;\n    }\n  }\n\n  /**\n   * Get certificate configuration for a table\n   */\n  async getCertificateConfig(\n    churchId: number,\n    tableName: string\n  ): Promise<CertificateConfig> {\n    try {\n      const config = await this.getTableConfig(churchId, tableName);\n      return config?.certificate_config || {\n        enabled: false,\n        template_path: '',\n        field_positions: {},\n        field_mapping: {},\n        output_format: 'png',\n        quality: 95\n      };\n    } catch (error) {\n      console.error('Error fetching certificate configuration:', error);\n      throw error;\n    }\n  }\n\n  /**\n   * Validate record data against table configuration\n   */\n  async validateRecordData(\n    churchId: number,\n    tableName: string,\n    recordData: Record<string, any>\n  ): Promise<{ isValid: boolean; errors: Array<{ field: string; message: string }> }> {\n    try {\n      const response = await apiJson.post<{\n        success: boolean;\n        data: { isValid: boolean; errors: Array<{ field: string; message: string }> };\n        error?: string;\n      }>(`${this.baseUrl}/${tableName}/validate?church_id=${churchId}`, recordData);\n      \n      if (!response.success) {\n        throw new Error(response.error || 'Failed to validate record data');\n      }\n      \n      return response.data;\n    } catch (error) {\n      console.error('Error validating record data:', error);\n      throw error;\n    }\n  }\n\n  /**\n   * Get table schema information\n   */\n  async getTableSchema(\n    churchId: number,\n    tableName: string\n  ): Promise<{\n    tableName: string;\n    displayName: string;\n    description?: string;\n    tableType: string;\n    primaryKey: string;\n    churchIdField: string;\n    dateField: string;\n    nameFields: string[];\n    sortDefault: string;\n    sortDirection: string;\n    fields: FieldDefinition[];\n    displaySettings: DisplaySettings;\n    searchConfig: SearchConfig;\n    validationRules: ValidationRules;\n    importExportConfig: ImportExportConfig;\n    certificateConfig: CertificateConfig;\n  } | null> {\n    try {\n      const config = await this.getTableConfig(churchId, tableName);\n      if (!config) return null;\n\n      return {\n        tableName: config.table_name,\n        displayName: config.display_name,\n        description: config.description,\n        tableType: config.table_type,\n        primaryKey: config.table_config.primary_key,\n        churchIdField: config.table_config.church_id_field,\n        dateField: config.table_config.date_field,\n        nameFields: config.table_config.name_fields,\n        sortDefault: config.table_config.sort_default,\n        sortDirection: config.table_config.sort_direction,\n        fields: config.field_definitions,\n        displaySettings: config.display_settings,\n        searchConfig: config.search_config,\n        validationRules: config.validation_rules,\n        importExportConfig: config.import_export_config,\n        certificateConfig: config.certificate_config\n      };\n    } catch (error) {\n      console.error('Error fetching table schema:', error);\n      throw error;\n    }\n  }\n}\n\n// Export singleton instance\nexport const recordTableConfigApiService = new RecordTableConfigApiService();\n\n// Export class for testing\nexport { RecordTableConfigApiService };\n","// AgGridConfigApiService for records-centralized features\n// Placeholder implementation\n\nexport interface AgGridConfig {\n  id: string;\n  name: string;\n  columnDefs: ColumnDefinition[];\n  gridOptions: GridOptions;\n  defaultColDef?: any;\n}\n\nexport interface ColumnDefinition {\n  field: string;\n  headerName: string;\n  type?: string;\n  width?: number;\n  sortable?: boolean;\n  filter?: boolean;\n  editable?: boolean;\n}\n\nexport interface GridOptions {\n  pagination: boolean;\n  paginationPageSize: number;\n  rowSelection: string;\n  suppressRowClickSelection?: boolean;\n  groupSelectsChildren?: boolean;\n  groupSelectsFiltered?: boolean;\n}\n\nclass AgGridConfigApiService {\n  private baseUrl: string;\n\n  constructor(baseUrl: string = '/api/ag-grid-config') {\n    this.baseUrl = baseUrl;\n  }\n\n  async getConfigs(): Promise<AgGridConfig[]> {\n    console.log('Getting AgGrid configs');\n    return [];\n  }\n\n  async getConfig(id: string): Promise<AgGridConfig | null> {\n    console.log('Getting AgGrid config:', id);\n    return null;\n  }\n\n  async createConfig(config: Omit<AgGridConfig, 'id'>): Promise<AgGridConfig> {\n    console.log('Creating AgGrid config:', config);\n    return {\n      id: Date.now().toString(),\n      ...config\n    };\n  }\n\n  async updateConfig(id: string, config: Partial<AgGridConfig>): Promise<AgGridConfig | null> {\n    console.log('Updating AgGrid config:', id, config);\n    return null;\n  }\n\n  async deleteConfig(id: string): Promise<boolean> {\n    console.log('Deleting AgGrid config:', id);\n    return true;\n  }\n}\n\nexport const agGridConfigApiService = new AgGridConfigApiService();\n","/**\n * Orthodox Metrics - Unified Records API Service\n * Combines record table configuration and AG Grid configuration for complete record management\n */\n\nimport { recordTableConfigApiService, RecordTableConfig, FieldDefinition, TableConfig } from './RecordTableConfigApiService';\nimport { agGridConfigApiService, AgGridConfig, ColumnDefinition, GridOptions } from './AgGridConfigApiService';\nimport { apiJson } from '@/sandbox/field-mapper/api/client';\n\nexport interface UnifiedRecordConfig {\n  tableConfig: RecordTableConfig;\n  agGridConfig: AgGridConfig;\n  schema: UnifiedTableSchema;\n}\n\nexport interface UnifiedTableSchema {\n  tableName: string;\n  displayName: string;\n  description?: string;\n  tableType: 'baptism' | 'marriage' | 'funeral' | 'custom';\n  primaryKey: string;\n  churchIdField: string;\n  dateField: string;\n  nameFields: string[];\n  sortDefault: string;\n  sortDirection: 'ASC' | 'DESC';\n  fields: FieldDefinition[];\n  displaySettings: any;\n  searchConfig: any;\n  validationRules: any;\n  importExportConfig: any;\n  certificateConfig: any;\n  gridOptions: GridOptions;\n  columnDefs: ColumnDefinition[];\n  defaultColDef: Record<string, any>;\n  themeSettings: any;\n  exportSettings: any;\n}\n\nexport interface RecordData {\n  [key: string]: any;\n}\n\nexport interface RecordFilters {\n  search?: string;\n  filters?: Record<string, any>;\n  sort?: {\n    field: string;\n    direction: 'asc' | 'desc';\n  };\n  pagination?: {\n    page: number;\n    limit: number;\n  };\n}\n\nexport interface PaginatedRecordsResponse {\n  records: RecordData[];\n  pagination: {\n    page: number;\n    limit: number;\n    total: number;\n    totalPages: number;\n  };\n  schema: UnifiedTableSchema;\n}\n\nexport interface RecordApiResponse {\n  success: boolean;\n  data: RecordData | RecordData[] | PaginatedRecordsResponse;\n  church?: {\n    id: number;\n    db: string;\n  };\n  error?: string;\n  details?: string;\n}\n\nclass UnifiedRecordsApiService {\n  private baseUrl = '/api/dynamic-records';\n\n  /**\n   * Get unified configuration for a table (combines table config + AG Grid config)\n   */\n  async getUnifiedConfig(\n    churchId: number,\n    tableName: string,\n    agGridConfigName: string = 'default'\n  ): Promise<UnifiedRecordConfig | null> {\n    try {\n      const [tableConfig, agGridConfig] = await Promise.all([\n        recordTableConfigApiService.getTableConfig(churchId, tableName),\n        agGridConfigApiService.getGridConfig(churchId, tableName, agGridConfigName)\n      ]);\n\n      if (!tableConfig || !agGridConfig) {\n        return null;\n      }\n\n      const schema = this.createUnifiedSchema(tableConfig, agGridConfig);\n\n      return {\n        tableConfig,\n        agGridConfig,\n        schema\n      };\n    } catch (error) {\n      console.error('Error fetching unified configuration:', error);\n      throw error;\n    }\n  }\n\n  /**\n   * Get records with unified configuration\n   */\n  async getRecords(\n    churchId: number,\n    tableName: string,\n    filters: RecordFilters = {}\n  ): Promise<PaginatedRecordsResponse> {\n    try {\n      const queryParams = new URLSearchParams({\n        church_id: churchId.toString(),\n        ...(filters.search && { search: filters.search }),\n        ...(filters.sort && { \n          sortField: filters.sort.field,\n          sortDirection: filters.sort.direction\n        }),\n        ...(filters.pagination && {\n          page: filters.pagination.page.toString(),\n          limit: filters.pagination.limit.toString()\n        }),\n        ...(filters.filters && { filters: JSON.stringify(filters.filters) })\n      });\n\n      const response = await apiJson.get<RecordApiResponse>(\n        `${this.baseUrl}/tables/${tableName}/records?${queryParams}`\n      );\n\n      if (!response.success) {\n        throw new Error(response.error || 'Failed to fetch records');\n      }\n\n      return response.data as PaginatedRecordsResponse;\n    } catch (error) {\n      console.error('Error fetching records:', error);\n      throw error;\n    }\n  }\n\n  /**\n   * Get single record by ID\n   */\n  async getRecord(\n    churchId: number,\n    tableName: string,\n    recordId: string | number\n  ): Promise<RecordData> {\n    try {\n      const response = await apiJson.get<RecordApiResponse>(\n        `${this.baseUrl}/tables/${tableName}/records/${recordId}?church_id=${churchId}`\n      );\n\n      if (!response.success) {\n        throw new Error(response.error || 'Failed to fetch record');\n      }\n\n      return (response.data as any).record;\n    } catch (error) {\n      console.error('Error fetching record:', error);\n      throw error;\n    }\n  }\n\n  /**\n   * Create new record\n   */\n  async createRecord(\n    churchId: number,\n    tableName: string,\n    recordData: RecordData\n  ): Promise<RecordData> {\n    try {\n      const response = await apiJson.post<RecordApiResponse>(\n        `${this.baseUrl}/tables/${tableName}/records?church_id=${churchId}`,\n        recordData\n      );\n\n      if (!response.success) {\n        throw new Error(response.error || 'Failed to create record');\n      }\n\n      return response.data as RecordData;\n    } catch (error) {\n      console.error('Error creating record:', error);\n      throw error;\n    }\n  }\n\n  /**\n   * Update existing record\n   */\n  async updateRecord(\n    churchId: number,\n    tableName: string,\n    recordId: string | number,\n    recordData: RecordData\n  ): Promise<RecordData> {\n    try {\n      const response = await apiJson.put<RecordApiResponse>(\n        `${this.baseUrl}/tables/${tableName}/records/${recordId}?church_id=${churchId}`,\n        recordData\n      );\n\n      if (!response.success) {\n        throw new Error(response.error || 'Failed to update record');\n      }\n\n      return response.data as RecordData;\n    } catch (error) {\n      console.error('Error updating record:', error);\n      throw error;\n    }\n  }\n\n  /**\n   * Delete record\n   */\n  async deleteRecord(\n    churchId: number,\n    tableName: string,\n    recordId: string | number\n  ): Promise<void> {\n    try {\n      const response = await apiJson.delete<RecordApiResponse>(\n        `${this.baseUrl}/tables/${tableName}/records/${recordId}?church_id=${churchId}`\n      );\n\n      if (!response.success) {\n        throw new Error(response.error || 'Failed to delete record');\n      }\n    } catch (error) {\n      console.error('Error deleting record:', error);\n      throw error;\n    }\n  }\n\n  /**\n   * Validate record data\n   */\n  async validateRecord(\n    churchId: number,\n    tableName: string,\n    recordData: RecordData\n  ): Promise<{ isValid: boolean; errors: Array<{ field: string; message: string }> }> {\n    try {\n      const response = await apiJson.post<{\n        success: boolean;\n        data: { isValid: boolean; errors: Array<{ field: string; message: string }> };\n        error?: string;\n      }>(`${this.baseUrl}/tables/${tableName}/validate?church_id=${churchId}`, recordData);\n\n      if (!response.success) {\n        throw new Error(response.error || 'Failed to validate record');\n      }\n\n      return response.data;\n    } catch (error) {\n      console.error('Error validating record:', error);\n      throw error;\n    }\n  }\n\n  /**\n   * Get available tables for a church\n   */\n  async getAvailableTables(churchId: number): Promise<Array<{\n    tableName: string;\n    displayName: string;\n    tableType: string;\n    fieldCount: number;\n    hasCertificate: boolean;\n  }>> {\n    try {\n      const response = await apiJson.get<{\n        success: boolean;\n        data: Array<{\n          tableName: string;\n          displayName: string;\n          tableType: string;\n          fieldCount: number;\n          hasCertificate: boolean;\n        }>;\n        error?: string;\n      }>(`${this.baseUrl}/tables?church_id=${churchId}`);\n\n      if (!response.success) {\n        throw new Error(response.error || 'Failed to fetch available tables');\n      }\n\n      return response.data;\n    } catch (error) {\n      console.error('Error fetching available tables:', error);\n      throw error;\n    }\n  }\n\n  /**\n   * Get table schema\n   */\n  async getTableSchema(\n    churchId: number,\n    tableName: string\n  ): Promise<UnifiedTableSchema | null> {\n    try {\n      const config = await this.getUnifiedConfig(churchId, tableName);\n      return config?.schema || null;\n    } catch (error) {\n      console.error('Error fetching table schema:', error);\n      throw error;\n    }\n  }\n\n  /**\n   * Save user's grid state\n   */\n  async saveGridState(\n    churchId: number,\n    tableName: string,\n    stateData: any,\n    configName: string = 'default'\n  ): Promise<void> {\n    try {\n      await agGridConfigApiService.saveGridState(churchId, tableName, stateData, configName);\n    } catch (error) {\n      console.error('Error saving grid state:', error);\n      throw error;\n    }\n  }\n\n  /**\n   * Load user's saved grid state\n   */\n  async loadGridState(\n    churchId: number,\n    tableName: string,\n    configName: string = 'default'\n  ): Promise<any> {\n    try {\n      return await agGridConfigApiService.loadGridState(churchId, tableName, configName);\n    } catch (error) {\n      console.error('Error loading grid state:', error);\n      throw error;\n    }\n  }\n\n  /**\n   * Get field definitions for a table\n   */\n  async getFieldDefinitions(\n    churchId: number,\n    tableName: string\n  ): Promise<FieldDefinition[]> {\n    try {\n      return await recordTableConfigApiService.getFieldDefinitions(churchId, tableName);\n    } catch (error) {\n      console.error('Error fetching field definitions:', error);\n      throw error;\n    }\n  }\n\n  /**\n   * Get column definitions for AG Grid\n   */\n  async getColumnDefinitions(\n    churchId: number,\n    tableName: string,\n    configName: string = 'default'\n  ): Promise<ColumnDefinition[]> {\n    try {\n      return await agGridConfigApiService.getColumnDefinitions(churchId, tableName, configName);\n    } catch (error) {\n      console.error('Error fetching column definitions:', error);\n      throw error;\n    }\n  }\n\n  /**\n   * Create unified schema from table and AG Grid configurations\n   */\n  private createUnifiedSchema(\n    tableConfig: RecordTableConfig,\n    agGridConfig: AgGridConfig\n  ): UnifiedTableSchema {\n    return {\n      tableName: tableConfig.table_name,\n      displayName: tableConfig.display_name,\n      description: tableConfig.description,\n      tableType: tableConfig.table_type,\n      primaryKey: tableConfig.table_config.primary_key,\n      churchIdField: tableConfig.table_config.church_id_field,\n      dateField: tableConfig.table_config.date_field,\n      nameFields: tableConfig.table_config.name_fields,\n      sortDefault: tableConfig.table_config.sort_default,\n      sortDirection: tableConfig.table_config.sort_direction,\n      fields: tableConfig.field_definitions,\n      displaySettings: tableConfig.display_settings,\n      searchConfig: tableConfig.search_config,\n      validationRules: tableConfig.validation_rules,\n      importExportConfig: tableConfig.import_export_config,\n      certificateConfig: tableConfig.certificate_config,\n      gridOptions: agGridConfig.grid_options,\n      columnDefs: agGridConfig.column_definitions,\n      defaultColDef: agGridConfig.default_column_state,\n      themeSettings: agGridConfig.theme_settings,\n      exportSettings: agGridConfig.export_settings\n    };\n  }\n\n  /**\n   * Get searchable fields for a table\n   */\n  async getSearchableFields(churchId: number, tableName: string): Promise<string[]> {\n    try {\n      const schema = await this.getTableSchema(churchId, tableName);\n      return schema?.searchConfig.searchable_fields || [];\n    } catch (error) {\n      console.error('Error fetching searchable fields:', error);\n      throw error;\n    }\n  }\n\n  /**\n   * Get sortable fields for a table\n   */\n  async getSortableFields(churchId: number, tableName: string): Promise<string[]> {\n    try {\n      const schema = await this.getTableSchema(churchId, tableName);\n      return schema?.searchConfig.sortable_fields || [];\n    } catch (error) {\n      console.error('Error fetching sortable fields:', error);\n      throw error;\n    }\n  }\n\n  /**\n   * Get required fields for a table\n   */\n  async getRequiredFields(churchId: number, tableName: string): Promise<string[]> {\n    try {\n      const schema = await this.getTableSchema(churchId, tableName);\n      return schema?.validationRules.required_fields || [];\n    } catch (error) {\n      console.error('Error fetching required fields:', error);\n      throw error;\n    }\n  }\n\n  /**\n   * Get dropdown options for a field\n   */\n  async getDropdownOptions(\n    churchId: number,\n    tableName: string,\n    fieldName: string\n  ): Promise<string[]> {\n    try {\n      // This would typically call a dropdown API\n      // For now, return empty array\n      return [];\n    } catch (error) {\n      console.error('Error fetching dropdown options:', error);\n      throw error;\n    }\n  }\n}\n\n// Export singleton instance\nexport const unifiedRecordsApiService = new UnifiedRecordsApiService();\n\n// Export class for testing\nexport { UnifiedRecordsApiService };\n","// useAgGridConfig hook for records-centralized features\n// Placeholder implementation\n\nimport { useMemo } from 'react';\n\nexport const useAgGridConfig = (options: any = {}) => {\n  return useMemo(() => ({\n    defaultColDef: {\n      flex: 1,\n      minWidth: 100,\n      resizable: true,\n      sortable: true,\n      filter: true,\n    },\n    columnDefs: [],\n    rowData: [],\n    pagination: true,\n    paginationPageSize: 20,\n    ...options\n  }), [options]);\n};\n","/**\n * Orthodox Metrics - useUnifiedRecords Hook\n * React hook that combines record table configuration and AG Grid configuration\n */\n\nimport { useState, useCallback, useMemo } from 'react';\nimport { useQuery, useMutation, useQueryClient } from '@tanstack/react-query';\nimport {\n  unifiedRecordsApiService,\n  UnifiedRecordConfig,\n  UnifiedTableSchema,\n  RecordData,\n  RecordFilters,\n  PaginatedRecordsResponse,\n  ValidationResult\n} from './UnifiedRecordsApiService';\nimport { useRecordTableConfig } from './useRecordTableConfig';\nimport { useAgGridConfig } from './useAgGridConfig';\n\nexport interface UseUnifiedRecordsOptions {\n  churchId: number;\n  tableName: string;\n  agGridConfigName?: string;\n  filters?: RecordFilters;\n  enabled?: boolean;\n  refetchInterval?: number;\n}\n\nexport interface UseUnifiedRecordsReturn {\n  // Data\n  records: RecordData[] | undefined;\n  pagination: {\n    page: number;\n    limit: number;\n    total: number;\n    totalPages: number;\n  } | undefined;\n  schema: UnifiedTableSchema | undefined;\n  config: UnifiedRecordConfig | undefined;\n  \n  // Loading states\n  loading: boolean;\n  recordsLoading: boolean;\n  configLoading: boolean;\n  error: string | null;\n  \n  // Actions\n  refetch: () => void;\n  refetchRecords: () => void;\n  refetchConfig: () => void;\n  setFilters: (filters: RecordFilters) => void;\n  setSort: (sort: { field: string; direction: 'asc' | 'desc' }) => void;\n  setPagination: (pagination: { page: number; limit: number }) => void;\n  \n  // Grid state management\n  saveGridState: (state: any) => Promise<void>;\n  loadGridState: () => Promise<any>;\n  isSavingState: boolean;\n  isLoadingState: boolean;\n}\n\nexport interface UseUnifiedRecordMutationsOptions {\n  churchId: number;\n  tableName: string;\n  onSuccess?: (data: RecordData) => void;\n  onError?: (error: Error) => void;\n}\n\nexport interface UseUnifiedRecordMutationsReturn {\n  createRecord: (data: RecordData) => Promise<RecordData>;\n  updateRecord: (id: string | number, data: RecordData) => Promise<RecordData>;\n  deleteRecord: (id: string | number) => Promise<void>;\n  validateRecord: (data: RecordData) => Promise<ValidationResult>;\n  isCreating: boolean;\n  isUpdating: boolean;\n  isDeleting: boolean;\n  isValidating: boolean;\n  error: string | null;\n}\n\nexport interface UseAvailableTablesOptions {\n  churchId: number;\n  enabled?: boolean;\n}\n\nexport interface UseAvailableTablesReturn {\n  tables: Array<{\n    tableName: string;\n    displayName: string;\n    tableType: string;\n    fieldCount: number;\n    hasCertificate: boolean;\n  }>;\n  loading: boolean;\n  error: string | null;\n  refetch: () => void;\n}\n\n/**\n * Main hook for unified records management\n */\nexport const useUnifiedRecords = ({\n  churchId,\n  tableName,\n  agGridConfigName = 'default',\n  filters = {},\n  enabled = true,\n  refetchInterval\n}: UseUnifiedRecordsOptions): UseUnifiedRecordsReturn => {\n  const [currentFilters, setCurrentFilters] = useState<RecordFilters>(filters);\n  const queryClient = useQueryClient();\n\n  // Get unified configuration\n  const {\n    data: config,\n    isLoading: configLoading,\n    error: configError,\n    refetch: refetchConfig\n  } = useQuery({\n    queryKey: ['unifiedConfig', churchId, tableName, agGridConfigName],\n    queryFn: () => unifiedRecordsApiService.getUnifiedConfig(churchId, tableName, agGridConfigName),\n    enabled: enabled && !!churchId && !!tableName,\n    staleTime: 5 * 60 * 1000, // 5 minutes\n    retry: 3\n  });\n\n  // Get records with current filters\n  const {\n    data: recordsResponse,\n    isLoading: recordsLoading,\n    error: recordsError,\n    refetch: refetchRecords\n  } = useQuery({\n    queryKey: ['unifiedRecords', churchId, tableName, currentFilters],\n    queryFn: () => unifiedRecordsApiService.getRecords(churchId, tableName, currentFilters),\n    enabled: enabled && !!churchId && !!tableName,\n    refetchInterval,\n    staleTime: 1 * 60 * 1000, // 1 minute\n    retry: 3\n  });\n\n  // Grid state management\n  const {\n    saveState: saveGridState,\n    loadState: loadGridState,\n    isSaving: isSavingState,\n    isLoading: isLoadingState\n  } = useAgGridConfig({\n    churchId,\n    tableName,\n    configName: agGridConfigName,\n    enabled: enabled && !!churchId && !!tableName\n  });\n\n  // Memoized values\n  const records = useMemo(() => recordsResponse?.records, [recordsResponse]);\n  const pagination = useMemo(() => recordsResponse?.pagination, [recordsResponse]);\n  const schema = useMemo(() => recordsResponse?.schema || config?.schema, [recordsResponse, config]);\n  \n  const loading = configLoading || recordsLoading;\n  const error = configError?.message || recordsError?.message || null;\n\n  // Action handlers\n  const setFilters = useCallback((newFilters: RecordFilters) => {\n    setCurrentFilters(prev => ({ ...prev, ...newFilters }));\n  }, []);\n\n  const setSort = useCallback((sort: { field: string; direction: 'asc' | 'desc' }) => {\n    setCurrentFilters(prev => ({ ...prev, sort }));\n  }, []);\n\n  const setPagination = useCallback((pagination: { page: number; limit: number }) => {\n    setCurrentFilters(prev => ({ ...prev, pagination }));\n  }, []);\n\n  const refetch = useCallback(() => {\n    refetchConfig();\n    refetchRecords();\n  }, [refetchConfig, refetchRecords]);\n\n  return {\n    // Data\n    records,\n    pagination,\n    schema,\n    config,\n    \n    // Loading states\n    loading,\n    recordsLoading,\n    configLoading,\n    error,\n    \n    // Actions\n    refetch,\n    refetchRecords,\n    refetchConfig,\n    setFilters,\n    setSort,\n    setPagination,\n    \n    // Grid state management\n    saveGridState,\n    loadGridState,\n    isSavingState,\n    isLoadingState\n  };\n};\n\n/**\n * Hook for record mutations (create, update, delete, validate)\n */\nexport const useUnifiedRecordMutations = ({\n  churchId,\n  tableName,\n  onSuccess,\n  onError\n}: UseUnifiedRecordMutationsOptions): UseUnifiedRecordMutationsReturn => {\n  const queryClient = useQueryClient();\n\n  const createMutation = useMutation({\n    mutationFn: (data: RecordData) =>\n      unifiedRecordsApiService.createRecord(churchId, tableName, data),\n    onSuccess: (data) => {\n      queryClient.invalidateQueries({ queryKey: ['unifiedRecords', churchId, tableName] });\n      onSuccess?.(data);\n    },\n    onError: (error) => {\n      onError?.(error);\n    }\n  });\n\n  const updateMutation = useMutation({\n    mutationFn: ({ id, data }: { id: string | number; data: RecordData }) =>\n      unifiedRecordsApiService.updateRecord(churchId, tableName, id, data),\n    onSuccess: (data) => {\n      queryClient.invalidateQueries({ queryKey: ['unifiedRecords', churchId, tableName] });\n      onSuccess?.(data);\n    },\n    onError: (error) => {\n      onError?.(error);\n    }\n  });\n\n  const deleteMutation = useMutation({\n    mutationFn: (id: string | number) =>\n      unifiedRecordsApiService.deleteRecord(churchId, tableName, id),\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: ['unifiedRecords', churchId, tableName] });\n    },\n    onError: (error) => {\n      onError?.(error);\n    }\n  });\n\n  const validateMutation = useMutation({\n    mutationFn: (data: RecordData) =>\n      unifiedRecordsApiService.validateRecord(churchId, tableName, data),\n    onError: (error) => {\n      onError?.(error);\n    }\n  });\n\n  return {\n    createRecord: createMutation.mutateAsync,\n    updateRecord: (id: string | number, data: RecordData) =>\n      updateMutation.mutateAsync({ id, data }),\n    deleteRecord: deleteMutation.mutateAsync,\n    validateRecord: validateMutation.mutateAsync,\n    isCreating: createMutation.isPending,\n    isUpdating: updateMutation.isPending,\n    isDeleting: deleteMutation.isPending,\n    isValidating: validateMutation.isPending,\n    error: createMutation.error?.message || updateMutation.error?.message || deleteMutation.error?.message || validateMutation.error?.message || null\n  };\n};\n\n/**\n * Hook to get available tables for a church\n */\nexport const useAvailableTables = ({\n  churchId,\n  enabled = true\n}: UseAvailableTablesOptions): UseAvailableTablesReturn => {\n  const {\n    data: tables = [],\n    isLoading: loading,\n    error,\n    refetch\n  } = useQuery({\n    queryKey: ['availableTables', churchId],\n    queryFn: () => unifiedRecordsApiService.getAvailableTables(churchId),\n    enabled: enabled && !!churchId,\n    staleTime: 5 * 60 * 1000, // 5 minutes\n    retry: 3\n  });\n\n  return {\n    tables,\n    loading,\n    error: error?.message || null,\n    refetch\n  };\n};\n\n/**\n * Hook to get table schema\n */\nexport const useTableSchema = (\n  churchId: number,\n  tableName: string,\n  enabled: boolean = true\n) => {\n  const {\n    data: schema,\n    isLoading: loading,\n    error,\n    refetch\n  } = useQuery({\n    queryKey: ['tableSchema', churchId, tableName],\n    queryFn: () => unifiedRecordsApiService.getTableSchema(churchId, tableName),\n    enabled: enabled && !!churchId && !!tableName,\n    staleTime: 10 * 60 * 1000, // 10 minutes\n    retry: 3\n  });\n\n  return {\n    schema,\n    loading,\n    error: error?.message || null,\n    refetch\n  };\n};\n\n/**\n * Hook to get field definitions for a table\n */\nexport const useFieldDefinitions = (\n  churchId: number,\n  tableName: string,\n  enabled: boolean = true\n) => {\n  const {\n    data: fields = [],\n    isLoading: loading,\n    error,\n    refetch\n  } = useQuery({\n    queryKey: ['fieldDefinitions', churchId, tableName],\n    queryFn: () => unifiedRecordsApiService.getFieldDefinitions(churchId, tableName),\n    enabled: enabled && !!churchId && !!tableName,\n    staleTime: 10 * 60 * 1000, // 10 minutes\n    retry: 3\n  });\n\n  return {\n    fields,\n    loading,\n    error: error?.message || null,\n    refetch\n  };\n};\n\n/**\n * Hook to get column definitions for AG Grid\n */\nexport const useColumnDefinitions = (\n  churchId: number,\n  tableName: string,\n  configName: string = 'default',\n  enabled: boolean = true\n) => {\n  const {\n    data: columns = [],\n    isLoading: loading,\n    error,\n    refetch\n  } = useQuery({\n    queryKey: ['columnDefinitions', churchId, tableName, configName],\n    queryFn: () => unifiedRecordsApiService.getColumnDefinitions(churchId, tableName, configName),\n    enabled: enabled && !!churchId && !!tableName,\n    staleTime: 10 * 60 * 1000, // 10 minutes\n    retry: 3\n  });\n\n  return {\n    columns,\n    loading,\n    error: error?.message || null,\n    refetch\n  };\n};\n\n/**\n * Hook to get searchable fields for a table\n */\nexport const useSearchableFields = (\n  churchId: number,\n  tableName: string,\n  enabled: boolean = true\n) => {\n  const {\n    data: fields = [],\n    isLoading: loading,\n    error,\n    refetch\n  } = useQuery({\n    queryKey: ['searchableFields', churchId, tableName],\n    queryFn: () => unifiedRecordsApiService.getSearchableFields(churchId, tableName),\n    enabled: enabled && !!churchId && !!tableName,\n    staleTime: 10 * 60 * 1000, // 10 minutes\n    retry: 3\n  });\n\n  return {\n    fields,\n    loading,\n    error: error?.message || null,\n    refetch\n  };\n};\n\n/**\n * Hook to get sortable fields for a table\n */\nexport const useSortableFields = (\n  churchId: number,\n  tableName: string,\n  enabled: boolean = true\n) => {\n  const {\n    data: fields = [],\n    isLoading: loading,\n    error,\n    refetch\n  } = useQuery({\n    queryKey: ['sortableFields', churchId, tableName],\n    queryFn: () => unifiedRecordsApiService.getSortableFields(churchId, tableName),\n    enabled: enabled && !!churchId && !!tableName,\n    staleTime: 10 * 60 * 1000, // 10 minutes\n    retry: 3\n  });\n\n  return {\n    fields,\n    loading,\n    error: error?.message || null,\n    refetch\n  };\n};\n\n/**\n * Hook to get required fields for a table\n */\nexport const useRequiredFields = (\n  churchId: number,\n  tableName: string,\n  enabled: boolean = true\n) => {\n  const {\n    data: fields = [],\n    isLoading: loading,\n    error,\n    refetch\n  } = useQuery({\n    queryKey: ['requiredFields', churchId, tableName],\n    queryFn: () => unifiedRecordsApiService.getRequiredFields(churchId, tableName),\n    enabled: enabled && !!churchId && !!tableName,\n    staleTime: 10 * 60 * 1000, // 10 minutes\n    retry: 3\n  });\n\n  return {\n    fields,\n    loading,\n    error: error?.message || null,\n    refetch\n  };\n};\n\n/**\n * Hook to get dropdown options for a field\n */\nexport const useDropdownOptions = (\n  churchId: number,\n  tableName: string,\n  fieldName: string,\n  enabled: boolean = true\n) => {\n  const {\n    data: options = [],\n    isLoading: loading,\n    error,\n    refetch\n  } = useQuery({\n    queryKey: ['dropdownOptions', churchId, tableName, fieldName],\n    queryFn: () => unifiedRecordsApiService.getDropdownOptions(churchId, tableName, fieldName),\n    enabled: enabled && !!churchId && !!tableName && !!fieldName,\n    staleTime: 10 * 60 * 1000, // 10 minutes\n    retry: 3\n  });\n\n  return {\n    options,\n    loading,\n    error: error?.message || null,\n    refetch\n  };\n};\n","/**\n * Orthodox Metrics - Modern Dynamic Records Manager\n * Updated to use the new unified configuration system and template-agnostic architecture\n */\n\nimport React, { useState, useMemo, useCallback } from 'react';\nimport {\n  Box,\n  Typography,\n  Button,\n  Chip,\n  IconButton,\n  Tooltip,\n  Alert,\n  Paper,\n  Select,\n  MenuItem,\n  FormControl,\n  InputLabel,\n  CircularProgress,\n  Snackbar,\n  Dialog,\n  DialogTitle,\n  DialogContent,\n  DialogActions,\n} from '@mui/material';\nimport {\n  Add as AddIcon,\n  Refresh as RefreshIcon,\n  Download as DownloadIcon,\n  Upload as UploadIcon,\n  Lock as LockIcon,\n  LockOpen as LockOpenIcon,\n  TableChart as TableIcon,\n  Settings as SettingsIcon,\n  Visibility as ViewIcon,\n  Edit as EditIcon,\n  Delete as DeleteIcon,\n} from '@mui/icons-material';\n\n// Import new unified hooks and components from local files\nimport {\n  useUnifiedRecords,\n  useUnifiedRecordMutations,\n  useAvailableTables,\n  useTableSchema,\n  useFieldDefinitions,\n  useSearchableFields,\n  useSortableFields,\n  useRequiredFields,\n} from './useUnifiedRecords';\nimport { useDynamicRecords, useRecordTables, useTableColumns } from './useDynamicRecords';\n\n// Template helpers (using defaults for now)\nconst getCurrentTemplate = () => 'default';\nconst switchTemplate = (_: string) => {};\nconst getRecordsTableComponent = () => null;\nimport { RecordsSearch } from './RecordsSearch';\nimport { RecordsModal } from './RecordsModal';\n\n// Import types\nimport { RecordData, RecordFilters, UnifiedTableSchema } from './RecordsTypes';\n\ninterface ModernDynamicRecordsManagerProps {\n  churchId: number;\n  initialTableName?: string;\n  readOnly?: boolean;\n  onTableChange?: (tableName: string) => void;\n  onRecordSelect?: (record: RecordData) => void;\n  className?: string;\n  style?: React.CSSProperties;\n}\n\nexport function ModernDynamicRecordsManager({\n  churchId,\n  initialTableName = '',\n  readOnly = false,\n  onTableChange,\n  onRecordSelect,\n  className,\n  style,\n}: ModernDynamicRecordsManagerProps) {\n  // State management\n  const [selectedTable, setSelectedTable] = useState<string>(initialTableName);\n  const [isLocked, setIsLocked] = useState(readOnly);\n  const [selectedRecord, setSelectedRecord] = useState<RecordData | null>(null);\n  const [showForm, setShowForm] = useState(false);\n  const [showImport, setShowImport] = useState(false);\n  const [showSettings, setShowSettings] = useState(false);\n  const [showDeleteConfirm, setShowDeleteConfirm] = useState(false);\n  const [recordToDelete, setRecordToDelete] = useState<RecordData | null>(null);\n  const [snackbar, setSnackbar] = useState<{ open: boolean; message: string; severity: 'success' | 'error' | 'info' }>({\n    open: false,\n    message: '',\n    severity: 'info',\n  });\n\n  // Get current template\n  const currentTemplate = getCurrentTemplate();\n\n  // Get available tables\n  const {\n    tables,\n    loading: tablesLoading,\n    error: tablesError,\n    refetch: refetchTables,\n  } = useAvailableTables(churchId);\n\n  // Get table schema\n  const {\n    schema,\n    loading: schemaLoading,\n    error: schemaError,\n  } = useTableSchema(churchId, selectedTable);\n\n  // Get field definitions\n  const {\n    fields,\n    loading: fieldsLoading,\n  } = useFieldDefinitions(churchId, selectedTable);\n\n  // Get searchable and sortable fields\n  const {\n    fields: searchableFields,\n  } = useSearchableFields(churchId, selectedTable);\n\n  const {\n    fields: sortableFields,\n  } = useSortableFields(churchId, selectedTable);\n\n  const {\n    fields: requiredFields,\n  } = useRequiredFields(churchId, selectedTable);\n\n  // Unified records management\n  const {\n    records,\n    pagination,\n    loading: recordsLoading,\n    error: recordsError,\n    refetch: refetchRecords,\n    setFilters,\n    setSort,\n    setPagination,\n  } = useUnifiedRecords({\n    churchId,\n    tableName: selectedTable,\n    enabled: !!selectedTable,\n  });\n\n  // Record mutations\n  const {\n    createRecord,\n    updateRecord,\n    deleteRecord,\n    isCreating,\n    isUpdating,\n    isDeleting,\n    error: mutationError,\n  } = useUnifiedRecordMutations({\n    churchId,\n    tableName: selectedTable,\n    onSuccess: (data) => {\n      setSnackbar({\n        open: true,\n        message: 'Record saved successfully',\n        severity: 'success',\n      });\n      refetchRecords();\n    },\n    onError: (error) => {\n      setSnackbar({\n        open: true,\n        message: `Error: ${error.message}`,\n        severity: 'error',\n      });\n    },\n  });\n\n  // Get the appropriate table component for current template\n  const RecordsTable = useMemo(() => getRecordsTableComponent(), [currentTemplate]);\n\n  // Memoized actions configuration\n  const actions = useMemo(() => [\n    {\n      key: 'view',\n      label: 'View',\n      icon: <ViewIcon />,\n      color: 'primary' as const,\n    },\n    {\n      key: 'edit',\n      label: 'Edit',\n      icon: <EditIcon />,\n      color: 'primary' as const,\n    },\n    {\n      key: 'delete',\n      label: 'Delete',\n      icon: <DeleteIcon />,\n      color: 'error' as const,\n    },\n  ], []);\n\n  // Event handlers\n  const handleTableChange = useCallback((tableName: string) => {\n    setSelectedTable(tableName);\n    onTableChange?.(tableName);\n    // Reset filters and pagination when switching tables\n    setFilters({});\n    setPagination({ page: 1, limit: 50 });\n  }, [onTableChange, setFilters, setPagination]);\n\n  const handleSearch = useCallback((filters: RecordFilters) => {\n    setFilters(filters);\n  }, [setFilters]);\n\n  const handleSort = useCallback((field: string, direction: 'asc' | 'desc') => {\n    setSort({ field, direction });\n  }, [setSort]);\n\n  const handlePaginationChange = useCallback((page: number, limit: number) => {\n    setPagination({ page, limit });\n  }, [setPagination]);\n\n  const handleRecordAction = useCallback((action: string, record: RecordData) => {\n    switch (action) {\n      case 'view':\n        setSelectedRecord(record);\n        setShowForm(true);\n        onRecordSelect?.(record);\n        break;\n      case 'edit':\n        setSelectedRecord(record);\n        setShowForm(true);\n        break;\n      case 'delete':\n        setRecordToDelete(record);\n        setShowDeleteConfirm(true);\n        break;\n    }\n  }, [onRecordSelect]);\n\n  const handleDeleteConfirm = useCallback(async () => {\n    if (!recordToDelete) return;\n\n    try {\n      await deleteRecord(recordToDelete.id);\n      setShowDeleteConfirm(false);\n      setRecordToDelete(null);\n      setSnackbar({\n        open: true,\n        message: 'Record deleted successfully',\n        severity: 'success',\n      });\n    } catch (error) {\n      setSnackbar({\n        open: true,\n        message: `Error deleting record: ${error instanceof Error ? error.message : 'Unknown error'}`,\n        severity: 'error',\n      });\n    }\n  }, [recordToDelete, deleteRecord]);\n\n  const handleFormSuccess = useCallback((record: RecordData) => {\n    setShowForm(false);\n    setSelectedRecord(null);\n    setSnackbar({\n      open: true,\n      message: 'Record saved successfully',\n      severity: 'success',\n    });\n  }, []);\n\n  const handleFormError = useCallback((error: string) => {\n    setSnackbar({\n      open: true,\n      message: `Form error: ${error}`,\n      severity: 'error',\n    });\n  }, []);\n\n  const handleLockToggle = useCallback(() => {\n    setIsLocked(!isLocked);\n  }, [isLocked]);\n\n  const handleTemplateSwitch = useCallback((template: string) => {\n    switchTemplate(template as any);\n    setSnackbar({\n      open: true,\n      message: `Switched to ${template} template`,\n      severity: 'info',\n    });\n  }, []);\n\n  // Loading state for tables\n  if (tablesLoading) {\n    return (\n      <Box sx={{ p: 3, textAlign: 'center' }}>\n        <CircularProgress />\n        <Typography sx={{ mt: 2 }}>Discovering record tables...</Typography>\n      </Box>\n    );\n  }\n\n  // Error state for tables\n  if (tablesError) {\n    return (\n      <Alert severity=\"error\" sx={{ m: 2 }}>\n        Error discovering tables: {tablesError}\n        <Button onClick={() => refetchTables()} sx={{ ml: 2 }}>\n          Retry\n        </Button>\n      </Alert>\n    );\n  }\n\n  // No tables found\n  if (tables.length === 0) {\n    return (\n      <Box sx={{ p: 3, textAlign: 'center' }}>\n        <Typography variant=\"h6\" color=\"text.secondary\">\n          No record tables found\n        </Typography>\n        <Typography variant=\"body2\" color=\"text.secondary\" sx={{ mt: 1 }}>\n          Tables should be named with pattern: om_church_##_*_records\n        </Typography>\n        <Button onClick={() => refetchTables()} sx={{ mt: 2 }}>\n          Refresh\n        </Button>\n      </Box>\n    );\n  }\n\n  return (\n    <Box className={className} style={style}>\n      {/* Header */}\n      <Paper elevation={2} sx={{ mb: 2 }}>\n        <Box sx={{ p: 3, borderBottom: '1px solid', borderColor: 'divider' }}>\n          <Box sx={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center', mb: 2 }}>\n            <Box sx={{ display: 'flex', alignItems: 'center', gap: 1 }}>\n              <TableIcon sx={{ color: 'primary.main', fontSize: 32 }} />\n              <Typography variant=\"h4\" component=\"h1\" sx={{ fontWeight: 600 }}>\n                Dynamic Records Manager\n              </Typography>\n              <Chip\n                label={currentTemplate.toUpperCase()}\n                color=\"primary\"\n                size=\"small\"\n                sx={{ ml: 1 }}\n              />\n            </Box>\n            \n            <Box sx={{ display: 'flex', gap: 1, alignItems: 'center' }}>\n              <Chip\n                label={isLocked ? 'Locked' : 'Unlocked'}\n                color={isLocked ? 'error' : 'success'}\n                icon={isLocked ? <LockIcon /> : <LockOpenIcon />}\n              />\n              \n              <Tooltip title=\"Toggle Lock\">\n                <IconButton onClick={handleLockToggle} disabled={readOnly}>\n                  {isLocked ? <LockIcon /> : <LockOpenIcon />}\n                </IconButton>\n              </Tooltip>\n\n              <Tooltip title=\"Settings\">\n                <IconButton onClick={() => setShowSettings(true)}>\n                  <SettingsIcon />\n                </IconButton>\n              </Tooltip>\n            </Box>\n          </Box>\n\n          {/* Table Selection */}\n          <Box sx={{ mb: 2 }}>\n            <FormControl fullWidth sx={{ maxWidth: 400 }}>\n              <InputLabel>Select Record Table</InputLabel>\n              <Select\n                value={selectedTable}\n                onChange={(e) => handleTableChange(e.target.value)}\n                label=\"Select Record Table\"\n              >\n                {tables.map((table) => (\n                  <MenuItem key={table.tableName} value={table.tableName}>\n                    <Box sx={{ display: 'flex', alignItems: 'center', gap: 1 }}>\n                      <TableIcon fontSize=\"small\" />\n                      <Box>\n                        <Typography variant=\"body1\">{table.displayName}</Typography>\n                        <Typography variant=\"caption\" color=\"text.secondary\">\n                          {table.tableName}  {table.fieldCount} fields\n                        </Typography>\n                      </Box>\n                    </Box>\n                  </MenuItem>\n                ))}\n              </Select>\n            </FormControl>\n          </Box>\n\n          {/* Action Buttons */}\n          {selectedTable && (\n            <Box sx={{ display: 'flex', gap: 1, flexWrap: 'wrap' }}>\n              <Button\n                variant=\"contained\"\n                startIcon={<AddIcon />}\n                onClick={() => setShowForm(true)}\n                disabled={isLocked}\n              >\n                Add Record\n              </Button>\n              \n              <Button\n                variant=\"outlined\"\n                startIcon={<UploadIcon />}\n                onClick={() => setShowImport(true)}\n                disabled={isLocked}\n              >\n                Import\n              </Button>\n              \n              <Button\n                variant=\"outlined\"\n                startIcon={<DownloadIcon />}\n                onClick={() => {/* Handle export */}}\n              >\n                Export\n              </Button>\n              \n              <Button\n                variant=\"outlined\"\n                startIcon={<RefreshIcon />}\n                onClick={() => refetchRecords()}\n              >\n                Refresh\n              </Button>\n            </Box>\n          )}\n        </Box>\n\n        {/* Content */}\n        {selectedTable ? (\n          <>\n            {/* Search and Filters */}\n            <Box sx={{ p: 3, pb: 0 }}>\n              <RecordsSearch\n                churchId={churchId}\n                tableName={selectedTable}\n                onSearch={handleSearch}\n                searchableFields={searchableFields}\n                loading={recordsLoading}\n              />\n            </Box>\n\n            {/* Records Table */}\n            <Box sx={{ p: 3, pt: 0 }}>\n              {schemaLoading ? (\n                <Box sx={{ display: 'flex', justifyContent: 'center', p: 3 }}>\n                  <CircularProgress />\n                </Box>\n              ) : schemaError ? (\n                <Alert severity=\"error\">\n                  Error loading table schema: {schemaError}\n                </Alert>\n              ) : (\n                <RecordsTable\n                  data={records || []}\n                  schema={schema!}\n                  churchId={churchId}\n                  tableName={selectedTable}\n                  loading={recordsLoading}\n                  error={recordsError}\n                  onRecordSelect={onRecordSelect}\n                  onRecordEdit={(record) => handleRecordAction('edit', record)}\n                  onRecordDelete={(record) => handleRecordAction('delete', record)}\n                  onRecordCreate={() => setShowForm(true)}\n                  onFiltersChange={handleSearch}\n                  onSortChange={handleSort}\n                  onPaginationChange={handlePaginationChange}\n                  pagination={pagination}\n                  enableSelection={!isLocked}\n                  enableSorting={true}\n                  enableFiltering={true}\n                  enablePagination={true}\n                  enableSearch={true}\n                  enableExport={true}\n                  enableBulkActions={!isLocked}\n                  enableRowActions={!isLocked}\n                />\n              )}\n            </Box>\n          </>\n        ) : (\n          <Box sx={{ p: 3, textAlign: 'center' }}>\n            <Typography variant=\"h6\" color=\"text.secondary\">\n              Select a table to view records\n            </Typography>\n            <Typography variant=\"body2\" color=\"text.secondary\" sx={{ mt: 1 }}>\n              Choose from the dropdown above to start managing records\n            </Typography>\n          </Box>\n        )}\n      </Paper>\n\n      {/* Form Modal */}\n      {selectedTable && (\n        <RecordsModal\n          open={showForm}\n          onClose={() => {\n            setShowForm(false);\n            setSelectedRecord(null);\n          }}\n          title={selectedRecord ? 'Edit Record' : 'Add New Record'}\n          maxWidth=\"md\"\n        >\n          {/* Form content would go here */}\n          <Box sx={{ p: 2 }}>\n            <Typography variant=\"body1\">\n              Form implementation for {selectedTable} records\n            </Typography>\n            <Typography variant=\"body2\" color=\"text.secondary\" sx={{ mt: 1 }}>\n              This would contain the dynamic form based on field definitions\n            </Typography>\n          </Box>\n        </RecordsModal>\n      )}\n\n      {/* Delete Confirmation Dialog */}\n      <Dialog\n        open={showDeleteConfirm}\n        onClose={() => setShowDeleteConfirm(false)}\n        maxWidth=\"sm\"\n        fullWidth\n      >\n        <DialogTitle>Confirm Delete</DialogTitle>\n        <DialogContent>\n          <Typography>\n            Are you sure you want to delete this record? This action cannot be undone.\n          </Typography>\n        </DialogContent>\n        <DialogActions>\n          <Button onClick={() => setShowDeleteConfirm(false)}>\n            Cancel\n          </Button>\n          <Button\n            onClick={handleDeleteConfirm}\n            color=\"error\"\n            variant=\"contained\"\n            disabled={isDeleting}\n          >\n            {isDeleting ? 'Deleting...' : 'Delete'}\n          </Button>\n        </DialogActions>\n      </Dialog>\n\n      {/* Settings Dialog */}\n      <Dialog\n        open={showSettings}\n        onClose={() => setShowSettings(false)}\n        maxWidth=\"sm\"\n        fullWidth\n      >\n        <DialogTitle>Settings</DialogTitle>\n        <DialogContent>\n          <Box sx={{ p: 2 }}>\n            <Typography variant=\"h6\" gutterBottom>\n              Template Settings\n            </Typography>\n            <Box sx={{ display: 'flex', gap: 1, flexWrap: 'wrap' }}>\n              {['mui', 'berry', 'antd', 'chakra'].map((template) => (\n                <Button\n                  key={template}\n                  variant={currentTemplate === template ? 'contained' : 'outlined'}\n                  onClick={() => handleTemplateSwitch(template)}\n                  size=\"small\"\n                >\n                  {template.toUpperCase()}\n                </Button>\n              ))}\n            </Box>\n          </Box>\n        </DialogContent>\n        <DialogActions>\n          <Button onClick={() => setShowSettings(false)}>\n            Close\n          </Button>\n        </DialogActions>\n      </Dialog>\n\n      {/* Snackbar for notifications */}\n      <Snackbar\n        open={snackbar.open}\n        autoHideDuration={6000}\n        onClose={() => setSnackbar(prev => ({ ...prev, open: false }))}\n        message={snackbar.message}\n      />\n    </Box>\n  );\n}\n\nexport default ModernDynamicRecordsManager;\n"],"names":["RecordTableConfigApiService","__publicField","churchId","__async","response","apiJson","error","tableName","_a","config","recordData","recordTableConfigApiService","AgGridConfigApiService","baseUrl","id","__spreadValues","agGridConfigApiService","UnifiedRecordsApiService","agGridConfigName","tableConfig","agGridConfig","schema","_0","_1","filters","queryParams","recordId","stateData","configName","fieldName","unifiedRecordsApiService","useAgGridConfig","options","useMemo","useUnifiedRecords","enabled","refetchInterval","currentFilters","setCurrentFilters","useState","useQueryClient","configLoading","configError","refetchConfig","useQuery","recordsResponse","recordsLoading","recordsError","refetchRecords","saveGridState","loadGridState","isSavingState","isLoadingState","records","pagination","loading","setFilters","useCallback","newFilters","prev","setSort","sort","__spreadProps","setPagination","refetch","useUnifiedRecordMutations","onSuccess","onError","queryClient","createMutation","useMutation","data","updateMutation","deleteMutation","validateMutation","_b","_c","_d","useAvailableTables","tables","useTableSchema","useFieldDefinitions","fields","useSearchableFields","useSortableFields","useRequiredFields","getCurrentTemplate","getRecordsTableComponent","ModernDynamicRecordsManager","initialTableName","readOnly","onTableChange","onRecordSelect","className","style","selectedTable","setSelectedTable","isLocked","setIsLocked","selectedRecord","setSelectedRecord","showForm","setShowForm","showImport","setShowImport","showSettings","setShowSettings","showDeleteConfirm","setShowDeleteConfirm","recordToDelete","setRecordToDelete","snackbar","setSnackbar","currentTemplate","tablesLoading","tablesError","refetchTables","schemaLoading","schemaError","searchableFields","deleteRecord","isDeleting","RecordsTable","ViewIcon","EditIcon","DeleteIcon","handleTableChange","handleSearch","handleSort","field","direction","handlePaginationChange","page","limit","handleRecordAction","action","record","handleDeleteConfirm","handleLockToggle","handleTemplateSwitch","template","jsxs","Box","jsx","CircularProgress","Typography","Alert","Button","Paper","TableIcon","Chip","LockIcon","LockOpenIcon","Tooltip","IconButton","SettingsIcon","FormControl","InputLabel","Select","e","table","MenuItem","AddIcon","UploadIcon","DownloadIcon","RefreshIcon","Fragment","RecordsSearch","RecordsModal","Dialog","DialogTitle","DialogContent","DialogActions","Snackbar"],"mappings":"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"}