var J=Object.defineProperty,K=Object.defineProperties;var Q=Object.getOwnPropertyDescriptors;var I=Object.getOwnPropertySymbols;var _=Object.prototype.hasOwnProperty,N=Object.prototype.propertyIsEnumerable;var M=(t,s,i)=>s in t?J(t,s,{enumerable:!0,configurable:!0,writable:!0,value:i}):t[s]=i,c=(t,s)=>{for(var i in s||(s={}))_.call(s,i)&&M(t,i,s[i]);if(I)for(var i of I(s))N.call(s,i)&&M(t,i,s[i]);return t},d=(t,s)=>K(t,Q(s));var R=(t,s)=>{var i={};for(var a in t)_.call(t,a)&&s.indexOf(a)<0&&(i[a]=t[a]);if(t!=null&&I)for(var a of I(t))s.indexOf(a)<0&&N.call(t,a)&&(i[a]=t[a]);return i};var F=(t,s,i)=>new Promise((a,v)=>{var h=o=>{try{C(i.next(o))}catch(p){v(p)}},f=o=>{try{C(i.throw(o))}catch(p){v(p)}},C=o=>o.done?a(o.value):Promise.resolve(o.value).then(h,f);C((i=i.apply(t,s)).next())});import{k as V,j as e,B as T,S as P,d as m,t as S,f as x,U as $,h as X,s as A,a1 as w,e as O,D as Z,P as ee,a0 as L}from"./index-Dgvcv9SG.js";import{r as g}from"./vendor-Dkfty7_r.js";import{a as Y}from"./axiosInstance-ybWCckox.js";import{I as q}from"./IconFileDescription-SehuB43a.js";import{T as te,a as k}from"./Tabs-DvDGzSBw.js";import{I as se}from"./IconCode-MaeTwYWg.js";import{I as ie}from"./IconUser-5i6r9hmN.js";import"./api.config-C9UNSeTF.js";import"./KeyboardArrowRight-iVZ9lhbl.js";function z(t){const h=t,{children:s,value:i,index:a}=h,v=R(h,["children","value","index"]);return e.jsx("div",d(c({role:"tabpanel",hidden:i!==a,id:`ocr-settings-tabpanel-${a}`,"aria-labelledby":`ocr-settings-tab-${a}`},v),{children:i===a&&e.jsx(T,{sx:{py:3},children:s})}))}const he=()=>{const{user:t}=V(),[s,i]=g.useState(0),[a,v]=g.useState(!1),[h,f]=g.useState(!1),[C,o]=g.useState(!1),[p,j]=g.useState(null),[r,b]=g.useState({documentProcessing:{spellingCorrection:"fix",extractAllText:"yes",improveFormatting:"yes"},documentDeletion:{deleteAfter:7,deleteUnit:"days"}});g.useEffect(()=>{H()},[]);const H=g.useCallback(()=>F(void 0,null,function*(){var l,n,u,W,B,E;if(t!=null&&t.church_id){v(!0);try{const D=yield Y.get(`/api/church/${t.church_id}/ocr/settings`),y=((l=D.data)==null?void 0:l.settings)||D.data;y&&b({documentProcessing:{spellingCorrection:((n=y.documentProcessing)==null?void 0:n.spellingCorrection)||"fix",extractAllText:((u=y.documentProcessing)==null?void 0:u.extractAllText)||"yes",improveFormatting:((W=y.documentProcessing)==null?void 0:W.improveFormatting)||"yes"},documentDeletion:{deleteAfter:((B=y.documentDeletion)==null?void 0:B.deleteAfter)||7,deleteUnit:((E=y.documentDeletion)==null?void 0:E.deleteUnit)||"days"}})}catch(D){console.error("[OCRSettingsPage] Failed to load settings:",D)}finally{v(!1)}}}),[t==null?void 0:t.church_id]),U=g.useCallback(()=>F(void 0,null,function*(){var l,n;if(!(t!=null&&t.church_id)){j("Church ID not available");return}f(!0),j(null),o(!1);try{const u=r.documentDeletion.deleteUnit==="minutes"?r.documentDeletion.deleteAfter:r.documentDeletion.deleteUnit==="hours"?r.documentDeletion.deleteAfter*60:r.documentDeletion.deleteAfter*24*60;if(u<10){j("Minimum deletion time is 10 minutes"),f(!1);return}if(u>14*24*60){j("Maximum deletion time is 14 days"),f(!1);return}yield Y.put(`/api/church/${t.church_id}/ocr/settings`,{documentProcessing:r.documentProcessing,documentDeletion:r.documentDeletion}),o(!0),setTimeout(()=>o(!1),3e3)}catch(u){console.error("[OCRSettingsPage] Failed to save settings:",u),j(((n=(l=u.response)==null?void 0:l.data)==null?void 0:n.message)||"Failed to save settings")}finally{f(!1)}}),[r,t==null?void 0:t.church_id]),G=(l,n)=>{i(n)};return e.jsxs(T,{sx:{p:3,maxWidth:1200,mx:"auto"},children:[e.jsxs(P,{direction:"row",justifyContent:"space-between",alignItems:"center",sx:{mb:3},children:[e.jsxs(P,{direction:"row",spacing:1,alignItems:"center",children:[e.jsx(q,{size:24}),e.jsx(m,{variant:"h5",fontWeight:600,children:"Settings"})]}),e.jsx(S,{value:"account",size:"small",sx:{minWidth:120},children:e.jsx(x,{value:"account",children:"Account"})})]}),e.jsx($,{sx:{mb:3},children:e.jsxs(te,{value:s,onChange:G,sx:{borderBottom:"1px solid",borderColor:"divider","& .MuiTab-root":{textTransform:"none",minHeight:64}},children:[e.jsx(k,{icon:e.jsx(q,{size:20}),iconPosition:"start",label:"Documents",id:"ocr-settings-tab-0","aria-controls":"ocr-settings-tabpanel-0"}),e.jsx(k,{icon:e.jsx(se,{size:20}),iconPosition:"start",label:"API",id:"ocr-settings-tab-1","aria-controls":"ocr-settings-tabpanel-1"}),e.jsx(k,{icon:e.jsx(ie,{size:20}),iconPosition:"start",label:"Profile",id:"ocr-settings-tab-2","aria-controls":"ocr-settings-tabpanel-2"})]})}),e.jsxs($,{sx:{p:3},children:[e.jsxs(z,{value:s,index:0,children:[e.jsxs(T,{sx:{mb:4},children:[e.jsx(m,{variant:"h6",fontWeight:600,gutterBottom:!0,children:"Document processing"}),e.jsxs(P,{direction:"row",spacing:1,alignItems:"center",sx:{mb:3},children:[e.jsx(m,{variant:"body2",color:"text.secondary",children:"Customize AI"}),e.jsx(X,{label:"Experimental",size:"small",color:"default",sx:{height:20,fontSize:"0.7rem"}})]}),e.jsxs(P,{spacing:3,children:[e.jsxs(A,{fullWidth:!0,children:[e.jsx(w,{id:"spelling-correction-label",children:"Fix spelling mistakes"}),e.jsxs(S,{labelId:"spelling-correction-label",id:"spelling-correction",value:r.documentProcessing.spellingCorrection,label:"Fix spelling mistakes",onChange:l=>b(n=>d(c({},n),{documentProcessing:d(c({},n.documentProcessing),{spellingCorrection:l.target.value})})),children:[e.jsx(x,{value:"exact",children:"Transcribe exactly as written"}),e.jsx(x,{value:"fix",children:"Fix spelling mistakes"})]})]}),e.jsxs(A,{fullWidth:!0,children:[e.jsx(w,{id:"extract-all-text-label",children:"Extract all text"}),e.jsxs(S,{labelId:"extract-all-text-label",id:"extract-all-text",value:r.documentProcessing.extractAllText,label:"Extract all text",onChange:l=>b(n=>d(c({},n),{documentProcessing:d(c({},n.documentProcessing),{extractAllText:l.target.value})})),children:[e.jsx(x,{value:"yes",children:"Yes"}),e.jsx(x,{value:"no",children:"No"})]})]}),e.jsxs(A,{fullWidth:!0,children:[e.jsx(w,{id:"improve-formatting-label",children:"Improving formatting for better readability"}),e.jsxs(S,{labelId:"improve-formatting-label",id:"improve-formatting",value:r.documentProcessing.improveFormatting,label:"Improving formatting for better readability",onChange:l=>b(n=>d(c({},n),{documentProcessing:d(c({},n.documentProcessing),{improveFormatting:l.target.value})})),children:[e.jsx(x,{value:"yes",children:"Yes"}),e.jsx(x,{value:"no",children:"No"})]})]})]}),e.jsx(O,{variant:"outlined",onClick:U,disabled:h||a,sx:{mt:3},children:h?"Saving...":"Save changes"})]}),e.jsx(Z,{sx:{my:4}}),e.jsxs(T,{children:[e.jsx(m,{variant:"h6",fontWeight:600,gutterBottom:!0,children:"Document deletion"}),e.jsx(m,{variant:"body2",color:"text.secondary",paragraph:!0,children:"Control how quickly your documents are automatically deleted from our server."}),e.jsxs(P,{direction:"row",spacing:2,alignItems:"center",sx:{mt:2,mb:2},children:[e.jsx(m,{variant:"body2",children:"Delete files after"}),e.jsx(ee,{type:"number",value:r.documentDeletion.deleteAfter,onChange:l=>{const n=parseInt(l.target.value,10);!isNaN(n)&&n>0&&b(u=>d(c({},u),{documentDeletion:d(c({},u.documentDeletion),{deleteAfter:n})}))},inputProps:{min:1},sx:{width:100},size:"small"}),e.jsx(A,{size:"small",sx:{minWidth:100},children:e.jsxs(S,{value:r.documentDeletion.deleteUnit,onChange:l=>b(n=>d(c({},n),{documentDeletion:d(c({},n.documentDeletion),{deleteUnit:l.target.value})})),children:[e.jsx(x,{value:"minutes",children:"minutes"}),e.jsx(x,{value:"hours",children:"hours"}),e.jsx(x,{value:"days",children:"day"})]})})]}),e.jsx(m,{variant:"caption",color:"text.secondary",sx:{display:"block",mt:1},children:"Minimum 10 minutes. Maximum 14 days. Files will be deleted automatically after the selected period. Changes will not apply to existing documents."}),e.jsx(O,{variant:"outlined",onClick:U,disabled:h||a,sx:{mt:2},children:h?"Saving...":"Save changes"})]})]}),e.jsxs(z,{value:s,index:1,children:[e.jsx(m,{variant:"h6",gutterBottom:!0,children:"API Settings"}),e.jsx(m,{variant:"body2",color:"text.secondary",children:"API configuration and access tokens will be available here."})]}),e.jsxs(z,{value:s,index:2,children:[e.jsx(m,{variant:"h6",gutterBottom:!0,children:"Profile Settings"}),e.jsx(m,{variant:"body2",color:"text.secondary",children:"User profile settings will be available here."})]})]}),C&&e.jsx(L,{severity:"success",sx:{mt:2},onClose:()=>o(!1),children:"Settings saved successfully!"}),p&&e.jsx(L,{severity:"error",sx:{mt:2},onClose:()=>j(null),children:p})]})};export{he as default};
//# sourceMappingURL=OCRSettingsPage-BEKZYz2Q.js.map
