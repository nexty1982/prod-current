var Ss=Object.defineProperty,Rs=Object.defineProperties;var ks=Object.getOwnPropertyDescriptors;var at=Object.getOwnPropertySymbols;var jt=Object.prototype.hasOwnProperty,Tt=Object.prototype.propertyIsEnumerable;var gt=(e,s,n)=>s in e?Ss(e,s,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[s]=n,Q=(e,s)=>{for(var n in s||(s={}))jt.call(s,n)&&gt(e,n,s[n]);if(at)for(var n of at(s))Tt.call(s,n)&&gt(e,n,s[n]);return e},ae=(e,s)=>Rs(e,ks(s));var At=(e,s)=>{var n={};for(var o in e)jt.call(e,o)&&s.indexOf(o)<0&&(n[o]=e[o]);if(e!=null&&at)for(var o of at(e))s.indexOf(o)<0&&Tt.call(e,o)&&(n[o]=e[o]);return n};var Ct=(e,s,n)=>gt(e,typeof s!="symbol"?s+"":s,n);var Ne=(e,s,n)=>new Promise((o,l)=>{var c=i=>{try{r(n.next(i))}catch(x){l(x)}},p=i=>{try{r(n.throw(i))}catch(x){l(x)}},r=i=>i.done?o(i.value):Promise.resolve(i.value).then(c,p);r((n=n.apply(e,s)).next())});import{a as qe,j as a,cF as Es,cG as Is,cH as Fs,cI as lt,cJ as Ps,cK as Ms,cL as js,cM as It,cN as Ts,cO as Qt,cP as As,cQ as Ae,cR as Os,cS as Bs,cT as Ns,cU as dt,cV as Gs,cW as _s,cX as Ws,cY as Us,cZ as Ds,c_ as Ls,c$ as yt,d0 as Hs,d1 as Vs,d2 as $s,d3 as Js,d4 as zs,d5 as Ks,d6 as qs,d7 as Ye,d8 as Ys,d9 as Qs,da as Zs,db as Xs,P as Ue,I as Ke,B as Re,T as Ze,b3 as vt,e as te,d as Ge,q as er,U as tr,a$ as sr,s as Ot,a1 as Bt,t as Nt,f as De,D as Xe,aG as rr,K as Le,Z as He,O as Ve,F as Gt,aI as _t,a2 as $e,a4 as nr,a0 as or}from"./index-Dgvcv9SG.js";import{r as t,b as y,c as ar,a as Zt}from"./vendor-Dkfty7_r.js";import{E as lr}from"./Edit-CACFOr_F.js";import{a as We}from"./admin.api-KTUJsu5j.js";import{C as cr}from"./Container-BLaKfmEJ.js";import{E as ir}from"./ExpandLess-Q0bpIKM4.js";import{E as ur}from"./ExpandMore-BrqjMfMM.js";import{H as dr}from"./HelpOutline-Cjd0qgNk.js";import{D as pr}from"./Delete-SFEnB1j-.js";import"./api.config-C9UNSeTF.js";const wt=qe(a.jsx("path",{d:"M19 9h-4V3H9v6H5l7 7zM5 18v2h14v-2z"})),et=qe(a.jsx("path",{d:"M9 16h6v-6h4l-7-7-7 7h4zm-4 2h14v2H5z"})),mr=qe(a.jsx("path",{d:"M18.4 10.6C16.55 8.99 14.15 8 11.5 8c-4.65 0-8.58 3.03-9.96 7.22L3.9 16c1.05-3.19 4.05-5.5 7.6-5.5 1.95 0 3.73.72 5.12 1.88L13 16h9V7z"})),Wt=qe(a.jsx("path",{d:"M19 13H5v-2h14z"})),hr=qe(a.jsx("path",{d:"M6.99 11 3 15l3.99 4v-3H14v-2H6.99zM21 9l-3.99-4v3H10v2h7.01v3z"})),fr=qe(a.jsx("path",{d:"M12.5 8c-2.65 0-5.05.99-6.9 2.6L2 7v9h9l-3.62-3.62c1.39-1.16 3.16-1.88 5.12-1.88 3.54 0 6.55 2.31 7.6 5.5l2.37-.78C21.08 11.03 17.15 8 12.5 8"}));var ve=y.createContext({}),Xt=y.createContext("default"),rt=(e,s,n,o)=>{if(!e||e.componentFromFramework||s.isDestroyed())return;const c=e.newAgStackInstance();let p,r,i=!1;return c.then(x=>{if(i){s.destroyBean(x);return}p=x,r=p.getGui(),n.appendChild(r),Ut(o,p)}),()=>{i=!0,p&&(r==null||r.remove(),s.destroyBean(p),o&&Ut(o,void 0))}},Ut=(e,s)=>{if(e)if(e instanceof Function)e(s);else{const n=e;n.current=s}},je=(...e)=>e.filter(n=>n!=null&&n!=="").join(" "),Te=class es{constructor(...s){this.classesMap={};for(const n of s)this.classesMap[n]=!0}setClass(s,n){if(!!this.classesMap[s]==n)return this;const l=new es;return l.classesMap=Q({},this.classesMap),l.classesMap[s]=n,l}toString(){return Object.keys(this.classesMap).filter(n=>this.classesMap[n]).join(" ")}},Qe=e=>{const s=()=>typeof Symbol=="function"&&Symbol.for,n=()=>s()?Symbol.for("react.memo"):60115;return typeof e=="function"&&!(e.prototype&&e.prototype.isReactComponent)||typeof e=="object"&&e.$$typeof===n()},Yt,St=(Yt=y.version)==null?void 0:Yt.split(".")[0],ts=St==="16"||St==="17";function gr(){return St==="19"}var ct=!1;function Cr(e){return ct||setTimeout(()=>ct=!1,0),ct=!0,e()}var st=(e,s)=>{!ts&&e&&!ct?ar.flushSync(s):s()},yr=e=>{ts?e():y.startTransition(e)};function wr(e,s,n){return y.useSyncExternalStore?y.useSyncExternalStore(e,s):n}function it(e,s,n){if(s==null||e==null)return s;if(e===s||s.length===0&&e.length===0)return e;if(n||e.length===0&&s.length>0||e.length>0&&s.length===0)return s;const o=[],l=[],c=new Map,p=new Map;for(let r=0;r<s.length;r++){const i=s[r];p.set(i.instanceId,i)}for(let r=0;r<e.length;r++){const i=e[r];c.set(i.instanceId,i),p.has(i.instanceId)&&o.push(i)}for(let r=0;r<s.length;r++){const i=s[r],x=i.instanceId;c.has(x)||l.push(i)}return o.length===e.length&&l.length===0?e:o.length===0&&l.length===s.length?s:o.length===0?l:l.length===0?o:[...o,...l]}var ss=t.forwardRef((e,s)=>{var L;const{registry:n,context:o}=t.useContext(ve),l=t.useRef(null),c=t.useRef(null),p=t.useRef(null),r=t.useRef(null),i=t.useRef(null),x=t.useRef(),[m,j]=t.useState(),[h,R]=t.useState(),[f,O]=t.useState(),[P,E]=t.useState(()=>new Te),[N,$]=t.useState(()=>new Te("ag-hidden")),[B,v]=t.useState(()=>new Te("ag-hidden")),[Z,_]=t.useState(()=>new Te("ag-invisible"));t.useImperativeHandle(s,()=>({refresh(){return!1}})),t.useLayoutEffect(()=>rt(m,o,c.current),[m]);const k=t.useCallback(H=>{if(l.current=H,!H||o.isDestroyed()){x.current=o.destroyBean(x.current);return}const D={setInnerRenderer:(z,G)=>{j(z),O(G)},setChildCount:z=>R(z),toggleCss:(z,G)=>E(K=>K.setClass(z,G)),setContractedDisplayed:z=>v(G=>G.setClass("ag-hidden",!z)),setExpandedDisplayed:z=>$(G=>G.setClass("ag-hidden",!z)),setCheckboxVisible:z=>_(G=>G.setClass("ag-invisible",!z)),setCheckboxSpacing:z=>_(G=>G.setClass("ag-group-checkbox-spacing",z))},V=n.createDynamicBean("groupCellRendererCtrl",!0);V&&(x.current=o.createBean(V),x.current.init(D,H,p.current,r.current,i.current,ss,e))},[]),I=t.useMemo(()=>`ag-cell-wrapper ${P.toString()}`,[P]),M=t.useMemo(()=>`ag-group-expanded ${N.toString()}`,[N]),C=t.useMemo(()=>`ag-group-contracted ${B.toString()}`,[B]),w=t.useMemo(()=>`ag-group-checkbox ${Z.toString()}`,[Z]),T=m==null?void 0:m.componentFromFramework,A=T?m.componentClass:void 0,F=m==null&&f!=null,J=As(f);return y.createElement("span",Q({className:I,ref:k},e.colDef?{}:{role:(L=x.current)==null?void 0:L.getCellAriaRole()}),y.createElement("span",{className:M,ref:r}),y.createElement("span",{className:C,ref:i}),y.createElement("span",{className:w,ref:p}),y.createElement("span",{className:"ag-group-value",ref:c},F?J:T?y.createElement(A,Q({},m.params)):null),y.createElement("span",{className:"ag-group-child-count"},h))}),Dt=ss,Ft=t.createContext({setMethods:()=>{}}),xr=e=>{const{initialProps:s,addUpdateCallback:n,CustomComponentClass:o,setMethods:l}=e,[i,...x]=t.useState(s),m=i,{key:c}=m,p=At(m,["key"]),[r]=x;return t.useEffect(()=>{n(j=>r(j))},[]),y.createElement(Ft.Provider,{value:{setMethods:l}},y.createElement(o,Q({key:c},p)))},br=t.memo(xr),vr=0;function Lt(){return`agPortalKey_${++vr}`}var rs=class{constructor(e,s,n,o){this.portal=null,this.oldPortal=null,this.reactComponent=e,this.portalManager=s,this.componentType=n,this.suppressFallbackMethods=!!o,this.statelessComponent=this.isStateless(this.reactComponent),this.key=Lt(),this.portalKey=Lt(),this.instanceCreated=this.isStatelessComponent()?Ae.resolve(!1):new Ae(l=>{this.resolveInstanceCreated=l})}getGui(){return this.eParentElement}getRootElement(){return this.eParentElement.firstChild}destroy(){this.componentInstance&&typeof this.componentInstance.destroy=="function"&&this.componentInstance.destroy();const e=this.portal;e&&this.portalManager.destroyPortal(e)}createParentElement(e){const s=this.portalManager.getComponentWrappingElement(),n=document.createElement(s||"div");return n.classList.add("ag-react-container"),e.reactContainer=n,n}statelessComponentRendered(){return this.eParentElement.childElementCount>0||this.eParentElement.childNodes.length>0}getFrameworkComponentInstance(){return this.componentInstance}isStatelessComponent(){return this.statelessComponent}getReactComponentName(){return this.reactComponent.name}getMemoType(){return this.hasSymbol()?Symbol.for("react.memo"):60115}hasSymbol(){return typeof Symbol=="function"&&Symbol.for}isStateless(e){return typeof e=="function"&&!(e.prototype&&e.prototype.isReactComponent)||typeof e=="object"&&e.$$typeof===this.getMemoType()}hasMethod(e){const s=this.getFrameworkComponentInstance();return!!s&&s[e]!=null||this.fallbackMethodAvailable(e)}callMethod(e,s){const n=this.getFrameworkComponentInstance();if(this.isStatelessComponent())return this.fallbackMethod(e,s&&s[0]?s[0]:{});if(!n){setTimeout(()=>this.callMethod(e,s));return}const o=n[e];if(o)return o.apply(n,s);if(this.fallbackMethodAvailable(e))return this.fallbackMethod(e,s&&s[0]?s[0]:{})}addMethod(e,s){this[e]=s}init(e){return this.eParentElement=this.createParentElement(e),this.createOrUpdatePortal(e),new Ae(s=>this.createReactComponent(s))}createOrUpdatePortal(e){this.isStatelessComponent()||(this.ref=s=>{var n;this.componentInstance=s,(n=this.resolveInstanceCreated)==null||n.call(this,!0),this.resolveInstanceCreated=void 0},e.ref=this.ref),this.reactElement=this.createElement(this.reactComponent,ae(Q({},e),{key:this.key})),this.portal=Zt.createPortal(this.reactElement,this.eParentElement,this.portalKey)}createElement(e,s){return t.createElement(e,s)}createReactComponent(e){this.portalManager.mountReactPortal(this.portal,this,e)}rendered(){return this.isStatelessComponent()&&this.statelessComponentRendered()||!!(!this.isStatelessComponent()&&this.getFrameworkComponentInstance())}refreshComponent(e){this.oldPortal=this.portal,this.createOrUpdatePortal(e),this.portalManager.updateReactPortal(this.oldPortal,this.portal)}fallbackMethod(e,s){const n=this[`${e}Component`];if(!this.suppressFallbackMethods&&n)return n.bind(this)(s)}fallbackMethodAvailable(e){return this.suppressFallbackMethods?!1:!!this[`${e}Component`]}};function pt(e,s,n){for(const o of e){const l=s[o];l&&(n[o]=l)}}var Ie=class extends rs{constructor(){super(...arguments),this.awaitUpdateCallback=new Ae(e=>{this.resolveUpdateCallback=e}),this.wrapperComponent=br}init(e){return this.sourceParams=e,super.init(this.getProps())}addMethod(){}getInstance(){return this.instanceCreated.then(()=>this.componentInstance)}getFrameworkComponentInstance(){return this}createElement(e,s){return super.createElement(this.wrapperComponent,{initialProps:s,CustomComponentClass:e,setMethods:n=>this.setMethods(n),addUpdateCallback:n=>{this.updateCallback=()=>(n(this.getProps()),new Ae(o=>{setTimeout(()=>{o()})})),this.resolveUpdateCallback()}})}setMethods(e){this.providedMethods=e,pt(this.getOptionalMethods(),this.providedMethods,this)}getOptionalMethods(){return[]}getProps(){return ae(Q({},this.sourceParams),{key:this.key,ref:this.ref})}refreshProps(){return this.updateCallback?this.updateCallback():new Ae(e=>this.awaitUpdateCallback.then(()=>{this.updateCallback().then(()=>e())}))}},Sr=class extends Ie{refresh(e){return this.sourceParams=e,this.refreshProps(),!0}},Rr=class extends Ie{constructor(){super(...arguments),this.date=null,this.onDateChange=e=>this.updateDate(e)}getDate(){return this.date}setDate(e){this.date=e,this.refreshProps()}refresh(e){this.sourceParams=e,this.refreshProps()}getOptionalMethods(){return["afterGuiAttached","setInputPlaceholder","setInputAriaLabel","setDisabled"]}updateDate(e){this.setDate(e),this.sourceParams.onDateChanged()}getProps(){const e=super.getProps();return e.date=this.date,e.onDateChange=this.onDateChange,delete e.onDateChanged,e}},kr=class extends Ie{constructor(){super(...arguments),this.label="",this.icon=null,this.shake=!1}setIcon(e,s){this.icon=e,this.shake=s,this.refreshProps()}setLabel(e){this.label=e,this.refreshProps()}getProps(){const e=super.getProps(),{label:s,icon:n,shake:o}=this;return e.label=s,e.icon=n,e.shake=o,e}},Er=class extends Ie{constructor(){super(...arguments),this.model=null,this.onModelChange=e=>this.updateModel(e),this.onUiChange=()=>this.sourceParams.filterModifiedCallback(),this.expectingNewMethods=!0,this.hasBeenActive=!1,this.awaitSetMethodsCallback=new Ae(e=>{this.resolveSetMethodsCallback=e})}isFilterActive(){return this.model!=null}doesFilterPass(e){return this.providedMethods.doesFilterPass(e)}getModel(){return this.model}setModel(e){return this.expectingNewMethods=!0,this.model=e,this.hasBeenActive||(this.hasBeenActive=this.isFilterActive()),this.refreshProps()}refresh(e){return this.sourceParams=e,this.refreshProps(),!0}afterGuiAttached(e){var n;const s=this.providedMethods;s?(n=s.afterGuiAttached)==null||n.call(s,e):this.awaitSetMethodsCallback.then(()=>{var o,l;return(l=(o=this.providedMethods)==null?void 0:o.afterGuiAttached)==null?void 0:l.call(o,e)})}getOptionalMethods(){return["afterGuiDetached","onNewRowsLoaded","getModelAsString","onAnyFilterChanged"]}setMethods(e){var s,n;this.expectingNewMethods===!1&&this.hasBeenActive&&((s=this.providedMethods)==null?void 0:s.doesFilterPass)!==(e==null?void 0:e.doesFilterPass)&&setTimeout(()=>{this.sourceParams.filterChangedCallback()}),this.expectingNewMethods=!1,super.setMethods(e),this.resolveSetMethodsCallback(),(n=this.resolveFilterPassCallback)==null||n.call(this),this.resolveFilterPassCallback=void 0}updateModel(e){var n;(n=this.resolveFilterPassCallback)==null||n.call(this);const s=new Ae(o=>{this.resolveFilterPassCallback=o});this.setModel(e).then(()=>{s.then(()=>{this.sourceParams.filterChangedCallback()})})}getProps(){const e=super.getProps();return e.model=this.model,e.onModelChange=this.onModelChange,e.onUiChange=this.onUiChange,delete e.filterChangedCallback,e}},Ir=class extends Ie{constructor(){super(...arguments),this.awaitSetMethodsCallback=new Ae(e=>{this.resolveSetMethodsCallback=e})}refresh(e){return this.sourceParams=e,this.refreshProps(),!0}afterGuiAttached(e){var n;const s=this.providedMethods;s?(n=s.afterGuiAttached)==null||n.call(s,e):this.awaitSetMethodsCallback.then(()=>{var o,l;return(l=(o=this.providedMethods)==null?void 0:o.afterGuiAttached)==null?void 0:l.call(o,e)})}getOptionalMethods(){return["afterGuiDetached","onNewRowsLoaded","onAnyFilterChanged"]}setMethods(e){super.setMethods(e),this.resolveSetMethodsCallback()}};function ns(e,s){e.parentFilterInstance(n=>{(n.setModel(s)||Ae.resolve()).then(()=>{e.filterParams.filterChangedCallback()})})}var Fr=class{constructor(e,s){this.floatingFilterParams=e,this.refreshProps=s,this.model=null,this.onModelChange=n=>this.updateModel(n)}getProps(){return ae(Q({},this.floatingFilterParams),{model:this.model,onModelChange:this.onModelChange})}onParentModelChanged(e){this.model=e,this.refreshProps()}refresh(e){this.floatingFilterParams=e,this.refreshProps()}setMethods(e){pt(this.getOptionalMethods(),e,this)}getOptionalMethods(){return["afterGuiAttached"]}updateModel(e){this.model=e,this.refreshProps(),ns(this.floatingFilterParams,e)}},Pr=class extends Ie{constructor(){super(...arguments),this.model=null,this.onModelChange=e=>this.updateModel(e)}onParentModelChanged(e){this.model=e,this.refreshProps()}refresh(e){this.sourceParams=e,this.refreshProps()}getOptionalMethods(){return["afterGuiAttached"]}updateModel(e){this.model=e,this.refreshProps(),ns(this.sourceParams,e)}getProps(){const e=super.getProps();return e.model=this.model,e.onModelChange=this.onModelChange,e}},Mr=class extends Ie{refresh(e){this.sourceParams=e,this.refreshProps()}getOptionalMethods(){return["afterGuiAttached"]}},jr=class extends Ie{refresh(e){return this.sourceParams=e,this.refreshProps(),!0}},Tr=class extends Ie{refresh(e){this.sourceParams=e,this.refreshProps()}},Ar=class extends Ie{constructor(){super(...arguments),this.active=!1,this.expanded=!1,this.onActiveChange=e=>this.updateActive(e)}setActive(e){this.awaitSetActive(e)}setExpanded(e){this.expanded=e,this.refreshProps()}getOptionalMethods(){return["select","configureDefaults"]}awaitSetActive(e){return this.active=e,this.refreshProps()}updateActive(e){const s=this.awaitSetActive(e);e&&s.then(()=>this.sourceParams.onItemActivated())}getProps(){const e=super.getProps();return e.active=this.active,e.expanded=this.expanded,e.onActiveChange=this.onActiveChange,delete e.onItemActivated,e}},Or=class extends Ie{refresh(e){this.sourceParams=e,this.refreshProps()}},Br=class extends Ie{refresh(e){return this.sourceParams=e,this.refreshProps(),!0}},Nr=class extends Ie{constructor(){super(...arguments),this.onStateChange=e=>this.updateState(e)}refresh(e){return this.sourceParams=e,this.refreshProps(),!0}getState(){return this.state}updateState(e){this.state=e,this.refreshProps(),this.sourceParams.onStateUpdated()}getProps(){const e=super.getProps();return e.state=this.state,e.onStateChange=this.onStateChange,e}};function Pt(){It(231)}var Gr=1e3,_r=class{constructor(e,s,n){this.destroyed=!1,this.portals=[],this.hasPendingPortalUpdate=!1,this.wrappingElement=s||"div",this.refresher=e,this.maxComponentCreationTimeMs=n||Gr}getPortals(){return this.portals}destroy(){this.destroyed=!0}destroyPortal(e){this.portals=this.portals.filter(s=>s!==e),this.batchUpdate()}getComponentWrappingElement(){return this.wrappingElement}mountReactPortal(e,s,n){this.portals=[...this.portals,e],this.waitForInstance(s,n),this.batchUpdate()}updateReactPortal(e,s){this.portals[this.portals.indexOf(e)]=s,this.batchUpdate()}batchUpdate(){this.hasPendingPortalUpdate||(setTimeout(()=>{this.destroyed||(this.refresher(),this.hasPendingPortalUpdate=!1)}),this.hasPendingPortalUpdate=!0)}waitForInstance(e,s,n=Date.now()){if(this.destroyed){s(null);return}if(e.rendered())s(e);else{if(Date.now()-n>=this.maxComponentCreationTimeMs&&!this.hasPendingPortalUpdate){st(!0,()=>this.refresher()),e.rendered()&&s(e);return}window.setTimeout(()=>{this.waitForInstance(e,s,n)})}}},Wr=({ctrl:e})=>{const s=e.isAlive(),{context:n}=t.useContext(ve),[o,l]=t.useState(),[c,p]=t.useState(),r=t.useRef(),i=t.useRef(null),x=t.useRef(null),m=t.useRef(null),j=t.useRef(),h=t.useRef();s&&!h.current&&(h.current=new dt(()=>i.current));const R=t.useCallback(E=>{if(i.current=E,!E||!e.isAlive()||n.isDestroyed()){r.current=n.destroyBean(r.current);return}r.current=n.createBean(new Ye);const N=()=>{var v;const B=e.getSelectAllGui();B&&((v=x.current)==null||v.insertAdjacentElement("afterend",B),r.current.addDestroyFunc(()=>B.remove()))},$={setWidth:B=>{i.current&&(i.current.style.width=B)},toggleCss:(B,v)=>h.current.toggleCss(B,v),setUserStyles:B=>p(B),setAriaSort:B=>{i.current&&(B?Ys(i.current,B):Qs(i.current))},setUserCompDetails:B=>l(B),getUserCompInstance:()=>j.current||void 0,refreshSelectAllGui:N,removeSelectAllGui:()=>{var B;return(B=e.getSelectAllGui())==null?void 0:B.remove()}};e.setComp($,E,x.current,m.current,r.current),N()},[]);t.useLayoutEffect(()=>rt(o,n,m.current,j),[o]),t.useEffect(()=>{e.setDragSource(i.current)},[o]);const f=t.useMemo(()=>!!((o==null?void 0:o.componentFromFramework)&&Qe(o.componentClass)),[o]),O=o==null?void 0:o.componentFromFramework,P=o==null?void 0:o.componentClass;return y.createElement("div",{ref:R,style:c,className:"ag-header-cell",role:"columnheader"},y.createElement("div",{ref:x,className:"ag-header-cell-resize",role:"presentation"}),y.createElement("div",{ref:m,className:"ag-header-cell-comp-wrapper",role:"presentation"},O?f?y.createElement(P,Q({},o.params)):y.createElement(P,ae(Q({},o.params),{ref:j})):null))},Ur=t.memo(Wr),Dr=class{constructor(e,s){this.floatingFilterParams=e,this.refreshProps=s}getProps(){return this.floatingFilterParams}refresh(e){this.floatingFilterParams=e,this.refreshProps()}setMethods(e){pt(this.getOptionalMethods(),e,this)}getOptionalMethods(){return["afterGuiAttached"]}},Lr=({ctrl:e})=>{const{context:s,gos:n}=t.useContext(ve),[o,l]=t.useState(),[c,p]=t.useState(()=>new Te("ag-header-cell","ag-floating-filter")),[r,i]=t.useState(()=>new Te),[x,m]=t.useState(()=>new Te("ag-floating-filter-button","ag-hidden")),[j,h]=t.useState("false"),[R,f]=t.useState(),[,O]=t.useState(1),P=t.useRef(),E=t.useRef(null),N=t.useRef(null),$=t.useRef(null),B=t.useRef(null),v=t.useRef(),Z=t.useRef(),_=V=>{V!=null&&v.current&&v.current(V)},k=t.useCallback(V=>{if(E.current=V,!V||!e.isAlive()||s.isDestroyed()){P.current=s.destroyBean(P.current);return}P.current=s.createBean(new Ye),Z.current=new Ae(G=>{v.current=G});const z={toggleCss:(G,K)=>p(le=>le.setClass(G,K)),setUserStyles:G=>l(G),addOrRemoveBodyCssClass:(G,K)=>i(le=>le.setClass(G,K)),setButtonWrapperDisplayed:G=>{m(K=>K.setClass("ag-hidden",!G)),h(G?"false":"true")},setWidth:G=>{E.current&&(E.current.style.width=G)},setCompDetails:G=>f(G),getFloatingFilterComp:()=>Z.current?Z.current:null,setMenuIcon:G=>{var K;return(K=B.current)==null?void 0:K.appendChild(G)}};e.setComp(z,V,B.current,N.current,P.current)},[]);t.useLayoutEffect(()=>rt(R,s,N.current,_),[R]);const I=t.useMemo(()=>c.toString(),[c]),M=t.useMemo(()=>r.toString(),[r]),C=t.useMemo(()=>x.toString(),[x]),w=t.useMemo(()=>!!(R&&R.componentFromFramework&&Qe(R.componentClass)),[R]),T=t.useMemo(()=>n.get("reactiveCustomComponents"),[]),A=t.useMemo(()=>n.get("enableFilterHandlers"),[]),[F,J]=t.useState();t.useEffect(()=>{if(R!=null&&R.componentFromFramework)if(T){const V=A?Dr:Fr,z=new V(R.params,()=>O(G=>G+1));_(z),J(z)}else Pt()},[R]);const L=F==null?void 0:F.getProps(),H=R==null?void 0:R.componentFromFramework,D=R==null?void 0:R.componentClass;return y.createElement("div",{ref:k,style:o,className:I,role:"gridcell"},y.createElement("div",{ref:N,className:M,role:"presentation"},H?T?L&&y.createElement(Ft.Provider,{value:{setMethods:V=>F.setMethods(V)}},y.createElement(D,Q({},L))):y.createElement(D,ae(Q({},R.params),{ref:w?()=>{}:_})):null),y.createElement("div",{ref:$,"aria-hidden":j,className:C,role:"presentation"},y.createElement("button",{ref:B,type:"button",className:"ag-button ag-floating-filter-button-button",tabIndex:-1})))},Hr=t.memo(Lr),Vr=({ctrl:e})=>{const{context:s}=t.useContext(ve),[n,o]=t.useState(),[l,c]=t.useState(()=>new Te),[p,r]=t.useState(()=>new Te),[i,x]=t.useState("false"),[m,j]=t.useState(),[h,R]=t.useState(),f=t.useRef(),O=t.useRef(null),P=t.useRef(null),E=t.useRef(null),N=t.useRef(),$=t.useCallback(I=>{if(O.current=I,!I||!e.isAlive()||s.isDestroyed()){f.current=s.destroyBean(f.current);return}f.current=s.createBean(new Ye);const M={setWidth:C=>{O.current&&(O.current.style.width=C)},toggleCss:(C,w)=>c(T=>T.setClass(C,w)),setUserStyles:C=>o(C),setHeaderWrapperHidden:C=>{const w=E.current;w&&(C?w.style.setProperty("display","none"):w.style.removeProperty("display"))},setHeaderWrapperMaxHeight:C=>{const w=E.current;w&&(C!=null?w.style.setProperty("max-height",`${C}px`):w.style.removeProperty("max-height"),w.classList.toggle("ag-header-cell-comp-wrapper-limited-height",C!=null))},setUserCompDetails:C=>R(C),setResizableDisplayed:C=>{r(w=>w.setClass("ag-hidden",!C)),x(C?"false":"true")},setAriaExpanded:C=>j(C),getUserCompInstance:()=>N.current||void 0};e.setComp(M,I,P.current,E.current,f.current)},[]);t.useLayoutEffect(()=>rt(h,s,E.current),[h]),t.useEffect(()=>{O.current&&e.setDragSource(O.current)},[h]);const B=t.useMemo(()=>!!((h==null?void 0:h.componentFromFramework)&&Qe(h.componentClass)),[h]),v=t.useMemo(()=>"ag-header-group-cell "+l.toString(),[l]),Z=t.useMemo(()=>"ag-header-cell-resize "+p.toString(),[p]),_=h==null?void 0:h.componentFromFramework,k=h==null?void 0:h.componentClass;return y.createElement("div",{ref:$,style:n,className:v,role:"columnheader","aria-expanded":m},y.createElement("div",{ref:E,className:"ag-header-cell-comp-wrapper",role:"presentation"},_?B?y.createElement(k,Q({},h.params)):y.createElement(k,ae(Q({},h.params),{ref:N})):null),y.createElement("div",{ref:P,"aria-hidden":i,className:Z}))},$r=t.memo(Vr),Jr=({ctrl:e})=>{const{gos:s,context:n}=t.useContext(ve),{topOffset:o,rowHeight:l}=t.useMemo(()=>e.getTopAndHeight(),[]),c=t.useMemo(()=>s.get("tabIndex"),[]),[p,r]=t.useState(()=>e.getAriaRowIndex()),i=e.headerRowClass,[x,m]=t.useState(()=>l+"px"),[j,h]=t.useState(()=>o+"px"),R=t.useRef(null),[f,O]=t.useState(()=>e.getUpdatedHeaderCtrls()),P=t.useRef(),E=t.useRef(null),N=t.useCallback(v=>{if(E.current=v,!v||!e.isAlive()||n.isDestroyed()){P.current=n.destroyBean(P.current);return}P.current=n.createBean(new Ye);const Z={setHeight:_=>m(_),setTop:_=>h(_),setHeaderCtrls:(_,k,I)=>{const M=R.current,C=it(M,_,k);C!==M&&(R.current=C,st(I,()=>O(C)))},setWidth:_=>{E.current&&(E.current.style.width=_)},setRowIndex:_=>{r(_)}};e.setComp(Z,P.current,!1)},[]),$=t.useMemo(()=>({height:x,top:j}),[x,j]),B=t.useCallback(v=>{switch(e.type){case"group":return y.createElement($r,{ctrl:v,key:v.instanceId});case"filter":return y.createElement(Hr,{ctrl:v,key:v.instanceId});default:return y.createElement(Ur,{ctrl:v,key:v.instanceId})}},[]);return y.createElement("div",{ref:N,className:i,role:"row",style:$,tabIndex:c,"aria-rowindex":p},f.map(B))},zr=t.memo(Jr),Kr=({pinned:e})=>{const[s,n]=t.useState(!0),[o,l]=t.useState([]),{context:c}=t.useContext(ve),p=t.useRef(null),r=t.useRef(null),i=t.useRef(),x=e==="left",m=e==="right",j=!x&&!m,h=t.useCallback(O=>{if(p.current=O,!O||c.isDestroyed()){i.current=c.destroyBean(i.current);return}i.current=c.createBean(new Vs(e));const P={setDisplayed:n,setCtrls:E=>l(E),setCenterWidth:E=>{r.current&&(r.current.style.width=E)},setViewportScrollLeft:E=>{p.current&&(p.current.scrollLeft=E)},setPinnedContainerWidth:E=>{p.current&&(p.current.style.width=E,p.current.style.minWidth=E,p.current.style.maxWidth=E)}};i.current.setComp(P,p.current)},[]),R=s?"":"ag-hidden",f=()=>o.map(O=>y.createElement(zr,{ctrl:O,key:O.instanceId}));return x?y.createElement("div",{ref:h,className:"ag-pinned-left-header "+R,"aria-hidden":!s,role:"rowgroup"},f()):m?y.createElement("div",{ref:h,className:"ag-pinned-right-header "+R,"aria-hidden":!s,role:"rowgroup"},f()):j?y.createElement("div",{ref:h,className:"ag-header-viewport "+R,role:"rowgroup",tabIndex:-1},y.createElement("div",{ref:r,className:"ag-header-container",role:"presentation"},f())):null},xt=t.memo(Kr),qr=()=>{const[e,s]=t.useState(()=>new Te),[n,o]=t.useState(),{context:l}=t.useContext(ve),c=t.useRef(null),p=t.useRef(),r=t.useCallback(m=>{if(c.current=m,!m||l.isDestroyed()){p.current=l.destroyBean(p.current);return}p.current=l.createBean(new Hs);const j={toggleCss:(h,R)=>s(f=>f.setClass(h,R)),setHeightAndMinHeight:h=>o(h)};p.current.setComp(j,m,m)},[]),i=t.useMemo(()=>"ag-header "+e.toString(),[e]),x=t.useMemo(()=>({height:n,minHeight:n}),[n]);return y.createElement("div",{ref:r,className:i,style:x,role:"presentation"},y.createElement(xt,{pinned:"left"}),y.createElement(xt,{pinned:null}),y.createElement(xt,{pinned:"right"}))},Yr=t.memo(qr),Qr=(e,s)=>{t.useEffect(()=>{const n=s.current;if(n){const o=n.parentElement;if(o){const l=document.createComment(e);return o.insertBefore(l,n),()=>{l.remove()}}}},[e])},Je=Qr,Zr=class{constructor(e,s){this.cellEditorParams=e,this.refreshProps=s,this.instanceCreated=new Ae(n=>{this.resolveInstanceCreated=n}),this.onValueChange=n=>this.updateValue(n),this.value=e.value}getProps(){return ae(Q({},this.cellEditorParams),{initialValue:this.cellEditorParams.value,value:this.value,onValueChange:this.onValueChange})}getValue(){return this.value}refresh(e){this.cellEditorParams=e,this.refreshProps()}setMethods(e){pt(this.getOptionalMethods(),e,this)}getInstance(){return this.instanceCreated.then(()=>this.componentInstance)}setRef(e){var s;this.componentInstance=e,(s=this.resolveInstanceCreated)==null||s.call(this),this.resolveInstanceCreated=void 0}getOptionalMethods(){return["isCancelBeforeStart","isCancelAfterEnd","focusIn","focusOut","afterGuiAttached","getValidationErrors","getValidationElement"]}updateValue(e){this.value=e,this.refreshProps()}},Xr=e=>{const s=t.useRef(e),n=t.useRef(),o=t.useRef(!1),l=t.useRef(!1),[,c]=t.useState(0);o.current&&(l.current=!0),t.useEffect(()=>(o.current||(n.current=s.current(),o.current=!0),c(p=>p+1),()=>{var p;l.current&&((p=n.current)==null||p.call(n))}),[])},en=e=>{const[s,n]=t.useState(),o=t.useContext(ve),{context:l,popupSvc:c,gos:p,editSvc:r}=o,{editDetails:i,cellCtrl:x,eParentCell:m}=e;return Xr(()=>{var O,P;const{compDetails:j}=i,h=p.get("stopEditingWhenCellsLoseFocus");let R,f;if(!l.isDestroyed()){f=l.createBean(r.createPopupEditorWrapper(j.params));const E=f.getGui();if(e.jsChildComp){const _=e.jsChildComp.getGui();_&&E.appendChild(_)}const{column:N,rowNode:$}=x,B={column:N,rowNode:$,type:"popupCellEditor",eventSource:m,ePopup:E,position:i.popupPosition,keepWithinBounds:!0},v=c==null?void 0:c.positionPopupByComponent.bind(c,B),Z=c==null?void 0:c.addPopup({modal:h,eChild:E,closeOnEsc:!0,closedCallback:()=>{x.onPopupEditorClosed()},anchorToElement:m,positionCallback:v,ariaOwns:m});R=Z?Z.hideFunc:void 0,n(f),(P=(O=e.jsChildComp)==null?void 0:O.afterGuiAttached)==null||P.call(O)}return()=>{R==null||R(),l.destroyBean(f)}}),t.useLayoutEffect(()=>()=>{x.isCellFocused()&&(s!=null&&s.getGui().contains(Xs(o)))&&m.focus({preventScroll:!0})},[s]),s&&e.wrappedContent?Zt.createPortal(e.wrappedContent,s.getGui()):null},Ht=t.memo(en),tn=(e,s,n)=>{const{compProxy:o}=e;n(o);const l=o.getProps(),c=Qe(s);return y.createElement(Ft.Provider,{value:{setMethods:p=>o.setMethods(p)}},c?y.createElement(s,Q({},l)):y.createElement(s,ae(Q({},l),{ref:p=>o.setRef(p)})))},Vt=(e,s,n)=>e.compProxy?tn(e,s,n):y.createElement(s,ae(Q({},e.compDetails.params),{ref:n})),sn=(e,s,n,o,l)=>{const c=e.compDetails,p=c.componentClass,r=c.componentFromFramework&&!e.popup,i=c.componentFromFramework&&e.popup,x=!c.componentFromFramework&&e.popup;return r?Vt(e,p,s):i?y.createElement(Ht,{editDetails:e,cellCtrl:o,eParentCell:n,wrappedContent:Vt(e,p,s)}):x&&l?y.createElement(Ht,{editDetails:e,cellCtrl:o,eParentCell:n,jsChildComp:l}):null},rn=(e,s,n,o,l,c)=>{const{context:p}=t.useContext(ve),r=t.useCallback(()=>{const i=l.current;if(!i)return;const x=i.getGui();x&&x.parentElement&&x.remove(),p.destroyBean(i),l.current=void 0},[]);t.useEffect(()=>{const i=e!=null,x=(e==null?void 0:e.compDetails)&&!e.compDetails.componentFromFramework,m=s&&n==null;if(!(i&&x&&!m)){r();return}const h=e.compDetails;if(l.current){const f=l.current,P=f.refresh!=null&&e.force==!1?f.refresh(h.params):!1;if(P===!0||P===void 0)return;r()}h.newAgStackInstance().then(f=>{if(!f)return;const O=f.getGui();if(!O)return;(s?n:c.current).appendChild(O),l.current=f})},[e,s,o]),t.useEffect(()=>r,[])},os=rn,nn=({cellCtrl:e,parent:s})=>{var l;const n=t.useRef(),o=t.useMemo(()=>{const{loadingComp:c}=e.getDeferLoadingCellRenderer();return c?{value:void 0,compDetails:c,force:!1}:void 0},[e]);if(os(o,!1,void 0,1,n,s),(l=o==null?void 0:o.compDetails)!=null&&l.componentFromFramework){const c=o.compDetails.componentClass;return y.createElement(c,Q({},o.compDetails.params))}return y.createElement(y.Fragment,null)},on=({cellCtrl:e,printLayout:s,editingCell:n})=>{const o=t.useContext(ve),{context:l}=o,{column:{colIdSanitised:c},instanceId:p}=e,r=t.useRef(),[i,x]=t.useState(()=>e.isCellRenderer()?void 0:{compDetails:void 0,value:e.getValueToDisplay(),force:!1}),[m,j]=t.useState(),[h,R]=t.useState(1),[f,O]=t.useState(),[P,E]=t.useState(!1),[N,$]=t.useState(!1),[B,v]=t.useState(!1),[Z,_]=t.useState(),k=t.useMemo(()=>e.isForceWrapper(),[e]),I=t.useMemo(()=>e.getCellAriaRole(),[e]),M=t.useRef(null),C=t.useRef(null),w=t.useRef(null),T=t.useRef(),A=t.useRef(),F=t.useRef(),J=t.useRef([]),L=t.useRef(),H=t.useRef(),[D,V]=t.useState(0),z=t.useCallback(q=>{H.current=q,V(u=>u+1)},[]),G=i!=null&&(P||B||N)&&(m==null||!!m.popup),K=k||G,le=t.useMemo(()=>e.getCellValueClass(),[e]),Ce=t.useCallback(q=>{if(A.current=q,q){const u=q.isCancelBeforeStart&&q.isCancelBeforeStart();setTimeout(()=>{u?(e.stopEditing(!0),e.focusCell(!0)):(e.cellEditorAttached(),e.enableEditorTooltipFeature(q))})}},[e]),ie=t.useRef();ie.current||(ie.current=new dt(()=>M.current)),os(i,K,H.current,D,T,M);const Ee=t.useRef();t.useLayoutEffect(()=>{var W,oe;const q=Ee.current,u=i;if(Ee.current=i,q==null||q.compDetails==null||u==null||u.compDetails==null)return;(W=L.current)==null||W.refreshVisibility();const X=q.compDetails,de=u.compDetails;if(X.componentClass!=de.componentClass||((oe=w.current)==null?void 0:oe.refresh)==null)return;w.current.refresh(de.params)!=!0&&R(pe=>pe+1)},[i]),t.useLayoutEffect(()=>{if(!(m&&!m.compDetails.componentFromFramework)||l.isDestroyed())return;const u=m.compDetails,X=m.popup===!0,de=u.newAgStackInstance();return de.then(re=>{var oe;if(!re)return;const W=re.getGui();if(Ce(re),!X){const pe=(k?F:M).current;pe==null||pe.appendChild(W),(oe=re.afterGuiAttached)==null||oe.call(re)}_(re)}),()=>{de.then(re=>{const W=re.getGui();e.disableEditorTooltipFeature(),l.destroyBean(re),Ce(void 0),_(void 0),W==null||W.remove()})}},[m]);const be=t.useCallback(q=>{if(F.current=q,!q||l.isDestroyed()||!e.isAlive()){const de=J.current;J.current=[];for(const re of de)re();return}let u;const X=de=>{de&&(q.insertAdjacentElement("afterbegin",de.getGui()),J.current.push(()=>{Zs(de.getGui()),l.destroyBean(de),L.current===u&&(L.current=void 0)}))};P&&X(e.createSelectionCheckbox()),B&&X(e.createDndSource()),N&&(u=e.createRowDragComp(),L.current=u,u&&(X(u),u.refreshVisibility()))},[e,l,B,N,P]),Fe=t.useCallback(()=>{var re;const q=!e.isCellSpanning()||C.current,u=M.current;if(!u||!q||!e||!e.isAlive()||l.isDestroyed()){r.current=l.destroyBean(r.current);return}r.current=l.createBean(new Ye);const X={toggleCss:(W,oe)=>ie.current.toggleCss(W,oe),setUserStyles:W=>O(W),getFocusableElement:()=>M.current,setIncludeSelection:W=>E(W),setIncludeRowDrag:W=>$(W),setIncludeDndSource:W=>v(W),getCellEditor:()=>{var W;return(W=A.current)!=null?W:null},getCellRenderer:()=>{var W;return(W=w.current)!=null?W:T.current},getParentOfValue:()=>{var W,oe;return(oe=(W=H.current)!=null?W:F.current)!=null?oe:M.current},setRenderDetails:(W,oe,pe)=>{var Be;const Pe=()=>{x(fe=>(fe==null?void 0:fe.compDetails)!==W||(fe==null?void 0:fe.value)!==oe||(fe==null?void 0:fe.force)!==pe?{value:oe,compDetails:W,force:pe}:fe)};if((Be=W==null?void 0:W.params)!=null&&Be.deferRender&&!e.rowNode.group){const{loadingComp:fe,onReady:ze}=e.getDeferLoadingCellRenderer();if(fe){x({value:void 0,compDetails:fe,force:!1}),ze.then(()=>yr(Pe));return}}Pe()},setEditDetails:(W,oe,pe,Pe)=>{if(W){let Be;W.componentFromFramework&&(Pe?Be=new Zr(W.params,()=>R(fe=>fe+1)):Pt()),j({compDetails:W,popup:oe,popupPosition:pe,compProxy:Be}),oe||x(void 0)}else e.hasBrowserFocus()&&X.getFocusableElement().focus({preventScroll:!0}),A.current=void 0,j(void 0)},refreshEditStyles:(W,oe)=>{if(!M.current)return;const{current:pe}=ie;pe.toggleCss("ag-cell-value",!K),pe.toggleCss("ag-cell-inline-editing",!!W&&!oe),pe.toggleCss("ag-cell-popup-editing",!!W&&!!oe),pe.toggleCss("ag-cell-not-inline-editing",!W||!!oe)}},de=F.current||void 0;e.setComp(X,u,(re=C.current)!=null?re:void 0,de,s,n,r.current)},[]),se=t.useCallback(q=>{M.current=q,Fe()},[]),we=t.useCallback(q=>{C.current=q,Fe()},[]),ue=t.useMemo(()=>{var u;return!!(((u=i==null?void 0:i.compDetails)==null?void 0:u.componentFromFramework)&&Qe(i.compDetails.componentClass))},[i]);t.useLayoutEffect(()=>{if(!M.current)return;const{current:q}=ie;q.toggleCss("ag-cell-value",!K),q.toggleCss("ag-cell-inline-editing",!!m&&!m.popup),q.toggleCss("ag-cell-popup-editing",!!m&&!!m.popup),q.toggleCss("ag-cell-not-inline-editing",!m||!!m.popup)});const ye=()=>{var X,de;const{compDetails:q,value:u}=i;if(!q)return(de=(X=u==null?void 0:u.toString)==null?void 0:X.call(u))!=null?de:u;if(q.componentFromFramework){const re=q.componentClass;return y.createElement(t.Suspense,{fallback:y.createElement(nn,{cellCtrl:e,parent:M})},ue?y.createElement(re,ae(Q({},q.params),{key:h})):y.createElement(re,ae(Q({},q.params),{key:h,ref:w})))}},ke=()=>{const q=()=>i==null?null:K?y.createElement("span",{role:"presentation",id:`cell-${p}`,className:le,ref:z},ye()):ye(),u=X=>sn(X,Ce,M.current,e,Z);return m!=null?m.popup?y.createElement(y.Fragment,null,q(),u(m)):u(m):q()},Oe=()=>y.createElement("div",{ref:se,style:f,role:I,"col-id":c},K?y.createElement("div",{className:"ag-cell-wrapper",role:"presentation",ref:be},ke()):ke());return e.isCellSpanning()?y.createElement("div",{ref:we,className:"ag-spanned-cell-wrapper",role:"presentation"},Oe()):Oe()},an=t.memo(on),ln=({rowCtrl:e,containerType:s})=>{const{context:n,gos:o,editSvc:l}=t.useContext(ve),c=t.useContext(Xt)==="default",p=t.useRef(),r=t.useRef(e.getDomOrder()),i=e.isFullWidth(),x=e.rowNode.displayed,[m,j]=t.useState(()=>x?e.rowNode.getRowIndexString():null),[h,R]=t.useState(()=>e.rowId),[f,O]=t.useState(()=>e.businessKey),[P,E]=t.useState(()=>e.rowStyles),N=t.useRef(null),[$,B]=t.useState(()=>null),[v,Z]=t.useState(),[_,k]=t.useState(()=>x?e.getInitialRowTop(s):void 0),[I,M]=t.useState(()=>x?e.getInitialTransform(s):void 0),C=t.useRef(null),w=t.useRef(),T=t.useRef(),A=t.useRef(!1),[F,J]=t.useState(0);t.useEffect(()=>{var we;if(A.current||!v||F>10)return;const se=(we=C.current)==null?void 0:we.firstChild;se?(e.setupDetailRowAutoHeight(se),A.current=!0):J(ue=>ue+1)},[v,F]);const L=t.useRef();L.current||(L.current=new dt(()=>C.current));const H=t.useRef(()=>{}),D=t.useCallback(se=>(H.current=se,()=>{H.current=()=>{}}),[]),V=wr(D,()=>N.current,[]),z=c?V:$,G=t.useCallback(se=>{if(C.current=se,p.current=se?n.createBean(new Ye):n.destroyBean(p.current),!se){e.unsetComp(s);return}if(!e.isAlive()||n.isDestroyed())return;const we={setTop:k,setTransform:M,toggleCss:(ue,ye)=>L.current.toggleCss(ue,ye),setDomOrder:ue=>r.current=ue,setRowIndex:j,setRowId:R,setRowBusinessKey:O,setUserStyles:E,setCellCtrls:(ue,ye)=>{const ke=N.current,Oe=it(ke,ue,r.current);Oe!==ke&&(N.current=Oe,c?H.current():st(ye,()=>B(Oe)))},showFullWidth:ue=>{T.current=ue.params,Z(ue)},getFullWidthCellRenderer:()=>w.current,getFullWidthCellRendererParams:()=>T.current,refreshFullWidth:ue=>{const ye=ue();return T.current=ye,Ee.current?(Z(ke=>ae(Q({},ke),{params:ye})),!0):!w.current||!w.current.refresh?!1:w.current.refresh(ye)}};e.setComp(we,se,s,p.current)},[]);t.useLayoutEffect(()=>rt(v,n,C.current,w),[v]);const K=t.useMemo(()=>{const se={top:_,transform:I};return Object.assign(se,P),se},[_,I,P]),le=i&&(v==null?void 0:v.componentFromFramework),Ce=!i&&z!=null,ie=t.useMemo(()=>!!((v==null?void 0:v.componentFromFramework)&&Qe(v.componentClass)),[v]),Ee=t.useRef(!1);t.useEffect(()=>{Ee.current=ie&&!!v&&!!o.get("reactiveCustomComponents")},[ie,v]);const be=()=>z==null?void 0:z.map(se=>{var we;return y.createElement(an,{cellCtrl:se,editingCell:(we=l==null?void 0:l.isEditing(se,{withOpenEditor:!0}))!=null?we:!1,printLayout:e.printLayout,key:se.instanceId})}),Fe=()=>{const se=v.componentClass;return ie?y.createElement(se,Q({},v.params)):y.createElement(se,ae(Q({},v.params),{ref:w}))};return y.createElement("div",{ref:G,role:"row",style:K,"row-index":m,"row-id":h,"row-business-key":f},Ce?be():le?Fe():null)},$t=t.memo(ln),cn=({name:e})=>{const{context:s,gos:n}=t.useContext(ve),o=t.useMemo(()=>$s(e),[e]),l=t.useRef(null),c=t.useRef(null),p=t.useRef(null),r=t.useRef([]),i=t.useRef([]),[x,m]=t.useState(()=>[]),j=!!n.get("enableCellSpan")&&!!o.getSpannedRowCtrls,h=t.useRef([]),R=t.useRef([]),[f,O]=t.useState(()=>[]),P=t.useRef(!1),E=t.useRef(),N=t.useMemo(()=>je("ag-viewport",Js(e)),[e]),$=t.useMemo(()=>je(zs(e)),[e]),B=t.useMemo(()=>je("ag-spanning-container",Ks(e)),[e]),v=o.type==="center"||j,Z=v?l:c;Je(" AG Row Container "+e+" ",Z);const _=t.useCallback(()=>{const F=!v||l.current!=null,J=c.current!=null,L=!j||p.current!=null;return F&&J&&L},[]),k=t.useCallback(()=>l.current==null&&c.current==null&&p.current==null,[]),I=t.useCallback(()=>{var F;if(k()&&(E.current=s.destroyBean(E.current)),!s.isDestroyed()&&_()){const J=D=>{const V=it(i.current,r.current,P.current);V!==i.current&&(i.current=V,st(D,()=>m(V)))},L=D=>{const V=it(R.current,h.current,P.current);V!==R.current&&(R.current=V,st(D,()=>O(V)))},H={setHorizontalScroll:D=>{l.current&&(l.current.scrollLeft=D)},setViewportHeight:D=>{l.current&&(l.current.style.height=D)},setRowCtrls:({rowCtrls:D,useFlushSync:V})=>{const z=!!V&&r.current.length>0&&D.length>0;r.current=D,J(z)},setSpannedRowCtrls:(D,V)=>{const z=!!V&&h.current.length>0&&D.length>0;h.current=D,L(z)},setDomOrder:D=>{P.current!=D&&(P.current=D,J(!1))},setContainerWidth:D=>{c.current&&(c.current.style.width=D)},setOffsetTop:D=>{c.current&&(c.current.style.transform=`translateY(${D})`)}};E.current=s.createBean(new qs(e)),E.current.setComp(H,c.current,(F=p.current)!=null?F:void 0,l.current)}},[_,k]),M=t.useCallback(F=>{c.current=F,I()},[I]),C=t.useCallback(F=>{p.current=F,I()},[I]),w=t.useCallback(F=>{l.current=F,I()},[I]),T=()=>y.createElement("div",{className:$,ref:M,role:v?"presentation":"rowgroup"},x.map(F=>y.createElement($t,{rowCtrl:F,containerType:o.type,key:F.instanceId})));if(!v)return T();const A=()=>y.createElement("div",{className:B,ref:C,role:"presentation"},f.map(F=>y.createElement($t,{rowCtrl:F,containerType:o.type,key:F.instanceId})));return y.createElement("div",{className:N,ref:w,role:"rowgroup"},T(),j?A():null)},un=t.memo(cn),dn=()=>{const e=t.useContext(ve),{context:s,overlays:n}=e,[o,l]=t.useState(""),[c,p]=t.useState(0),[r,i]=t.useState(0),[x,m]=t.useState("0px"),[j,h]=t.useState("0px"),[R,f]=t.useState("100%"),[O,P]=t.useState("0px"),[E,N]=t.useState("0px"),[$,B]=t.useState("100%"),[v,Z]=t.useState(!0),[_,k]=t.useState(!0),[I,M]=t.useState(null),[C,w]=t.useState(""),[T,A]=t.useState(null),[F,J]=t.useState("ag-layout-normal"),L=t.useRef();L.current||(L.current=new dt(()=>H.current));const H=t.useRef(null),D=t.useRef(null),V=t.useRef(null),z=t.useRef(null),G=t.useRef(null),K=t.useRef(null),le=t.useRef(null),Ce=t.useRef([]),ie=t.useRef([]);Je(" AG Grid Body ",H),Je(" AG Pinned Top ",D),Je(" AG Sticky Top ",V),Je(" AG Middle ",K),Je(" AG Pinned Bottom ",le);const Ee=t.useCallback(W=>{if(H.current=W,!W||s.isDestroyed()){Ce.current=s.destroyBeans(Ce.current);for(const ce of ie.current)ce();ie.current=[];return}const oe=(ce,Se)=>{ce.appendChild(Se),ie.current.push(()=>Se.remove())},pe=ce=>{const Se=s.createBean(new ce);return Ce.current.push(Se),Se},Pe=(ce,Se,mt)=>{oe(ce,document.createComment(mt)),oe(ce,pe(Se).getGui())};Pe(W,Ds," AG Fake Horizontal Scroll ");const Be=n==null?void 0:n.getOverlayWrapperCompClass();Be&&Pe(W,Be," AG Overlay Wrapper "),G.current&&Pe(G.current,Ls," AG Fake Vertical Scroll ");const fe={setRowAnimationCssOnBodyViewport:l,setColumnCount:ce=>{H.current&&Us(H.current,ce)},setRowCount:ce=>{H.current&&Ws(H.current,ce)},setTopHeight:p,setBottomHeight:i,setStickyTopHeight:m,setStickyTopTop:h,setStickyTopWidth:f,setTopInvisible:Z,setBottomInvisible:k,setColumnMovingCss:(ce,Se)=>L.current.toggleCss(ce,Se),updateLayoutClasses:J,setAlwaysVerticalScrollClass:M,setPinnedTopBottomOverflowY:w,setCellSelectableCss:(ce,Se)=>A(Se?ce:null),setBodyViewportWidth:ce=>{K.current&&(K.current.style.width=ce)},registerBodyViewportResizeListener:ce=>{if(K.current){const Se=Qt(e,K.current,ce);ie.current.push(()=>Se())}},setStickyBottomHeight:P,setStickyBottomBottom:N,setStickyBottomWidth:B,setGridRootRole:ce=>W.setAttribute("role",ce)},ze=s.createBean(new Gs);Ce.current.push(ze),ze.setComp(fe,W,K.current,D.current,le.current,V.current,z.current)},[]),be=t.useMemo(()=>je("ag-root","ag-unselectable",F),[F]),Fe=t.useMemo(()=>je("ag-body-viewport",o,F,I,T),[o,F,I,T]),se=t.useMemo(()=>je("ag-body",F),[F]),we=t.useMemo(()=>je("ag-floating-top",v?"ag-invisible":null,T),[T,v]),ue=t.useMemo(()=>je("ag-sticky-top",T),[T]),ye=t.useMemo(()=>je("ag-sticky-bottom",O==="0px"?"ag-invisible":null,T),[T,O]),ke=t.useMemo(()=>je("ag-floating-bottom",_?"ag-invisible":null,T),[T,_]),Oe=t.useMemo(()=>({height:c,minHeight:c,overflowY:C}),[c,C]),q=t.useMemo(()=>({height:x,top:j,width:R}),[x,j,R]),u=t.useMemo(()=>({height:O,bottom:E,width:$}),[O,E,$]),X=t.useMemo(()=>({height:r,minHeight:r,overflowY:C}),[r,C]),de=W=>y.createElement(un,{name:W,key:`${W}-container`}),re=({section:W,children:oe,className:pe,style:Pe})=>y.createElement("div",{ref:W,className:pe,role:"presentation",style:Pe},oe.map(de));return y.createElement("div",{ref:Ee,className:be},y.createElement(Yr,null),re({section:D,className:we,style:Oe,children:["topLeft","topCenter","topRight","topFullWidth"]}),y.createElement("div",{className:se,ref:G,role:"presentation"},re({section:K,className:Fe,children:["left","center","right","fullWidth"]})),re({section:V,className:ue,style:q,children:["stickyTopLeft","stickyTopCenter","stickyTopRight","stickyTopFullWidth"]}),re({section:z,className:ye,style:u,children:["stickyBottomLeft","stickyBottomCenter","stickyBottomRight","stickyBottomFullWidth"]}),re({section:le,className:ke,style:X,children:["bottomLeft","bottomCenter","bottomRight","bottomFullWidth"]}))},pn=t.memo(dn),mn=(e,s)=>{const{children:n,eFocusableElement:o,onTabKeyDown:l,gridCtrl:c,forceFocusOutWhenTabGuardsAreEmpty:p,isEmpty:r}=e,{context:i}=t.useContext(ve),x=t.useRef(null),m=t.useRef(null),j=t.useRef(),h=E=>{var $,B;const N=E==null?void 0:parseInt(E,10).toString();for(const v of[x,m])N===void 0?($=v.current)==null||$.removeAttribute("tabindex"):(B=v.current)==null||B.setAttribute("tabindex",N)};t.useImperativeHandle(s,()=>({forceFocusOutOfContainer(E){var N;(N=j.current)==null||N.forceFocusOutOfContainer(E)}}));const R=t.useCallback(()=>{const E=x.current,N=m.current;if(!E&&!N||i.isDestroyed()){j.current=i.destroyBean(j.current);return}if(E&&N){const $={setTabIndex:h};j.current=i.createBean(new _s({comp:$,eTopGuard:E,eBottomGuard:N,eFocusableElement:o,onTabKeyDown:l,forceFocusOutWhenTabGuardsAreEmpty:p,focusInnerElement:B=>c.focusInnerElement(B),isEmpty:r}))}},[]),f=t.useCallback(E=>{x.current=E,R()},[R]),O=t.useCallback(E=>{m.current=E,R()},[R]),P=E=>{const N=E==="top"?yt.TAB_GUARD_TOP:yt.TAB_GUARD_BOTTOM;return y.createElement("div",{className:`${yt.TAB_GUARD} ${N}`,role:"presentation",ref:E==="top"?f:O})};return y.createElement(y.Fragment,null,P("top"),n,P("bottom"))},hn=t.forwardRef(mn),fn=t.memo(hn),gn=({context:e})=>{const[s,n]=t.useState(""),[o,l]=t.useState(""),[c,p]=t.useState(null),[r,i]=t.useState(null),[x,m]=t.useState(!1),[j,h]=t.useState(),R=t.useRef(),f=t.useRef(null),O=t.useRef(),[P,E]=t.useState(null),N=t.useRef(()=>{}),$=t.useRef(),B=t.useRef([]),v=t.useCallback(()=>{},[]);Je(" AG Grid ",f);const Z=t.useCallback(w=>{if(f.current=w,R.current=w?e.createBean(new Os):e.destroyBean(R.current),!w||e.isDestroyed())return;const T=R.current;N.current=T.focusInnerElement.bind(T);const A={destroyGridUi:()=>{},setRtlClass:n,forceFocusOutOfContainer:F=>{var J,L;if(!F&&((J=$.current)!=null&&J.isDisplayed())){$.current.forceFocusOutOfContainer(F);return}(L=O.current)==null||L.forceFocusOutOfContainer(F)},updateLayoutClasses:l,getFocusableContainers:()=>{var L;const F=[],J=(L=f.current)==null?void 0:L.querySelector(".ag-root");J&&F.push({getGui:()=>J});for(const H of B.current)H.isDisplayed()&&F.push(H);return F},setCursor:p,setUserSelect:i};T.setComp(A,w,w),m(!0)},[]);t.useEffect(()=>{const w=R.current,T=f.current;if(!j||!w||!P||!T||e.isDestroyed())return;const A=[],{watermarkSelector:F,paginationSelector:J,sideBarSelector:L,statusBarSelector:H,gridHeaderDropZonesSelector:D}=w.getOptionalSelectors(),V=[];if(D){const G=e.createBean(new D.component),K=G.getGui();T.insertAdjacentElement("afterbegin",K),V.push(K),A.push(G)}if(L){const G=e.createBean(new L.component),K=G.getGui(),le=P.querySelector(".ag-tab-guard-bottom");le&&(le.insertAdjacentElement("beforebegin",K),V.push(K)),A.push(G),B.current.push(G)}const z=G=>{const K=e.createBean(new G),le=K.getGui();return T.insertAdjacentElement("beforeend",le),V.push(le),A.push(K),K};if(H&&z(H.component),J){const G=z(J.component);$.current=G,B.current.push(G)}return F&&z(F.component),()=>{e.destroyBeans(A);for(const G of V)G.remove()}},[j,P,e]);const _=t.useMemo(()=>je("ag-root-wrapper",s,o),[s,o]),k=t.useMemo(()=>je("ag-root-wrapper-body","ag-focus-managed",o),[o]),I=t.useMemo(()=>({userSelect:r!=null?r:"",WebkitUserSelect:r!=null?r:"",cursor:c!=null?c:""}),[r,c]),M=t.useCallback(w=>{O.current=w,h(w!==null)},[]),C=t.useCallback(()=>{var w;return!((w=R.current)!=null&&w.isFocusable())},[]);return y.createElement("div",{ref:Z,className:_,style:I,role:"presentation"},y.createElement("div",{className:k,ref:E,role:"presentation"},x&&P&&!e.isDestroyed()&&y.createElement(ve.Provider,{value:e.getBeans()},y.createElement(fn,{ref:M,eFocusableElement:P,onTabKeyDown:v,gridCtrl:R.current,forceFocusOutWhenTabGuardsAreEmpty:!0,isEmpty:C},y.createElement(pn,null)))))},Cn=t.memo(gn),yn=class extends js{postConstruct(){if(this.beans.colAutosize){const e=this.queueResizeOperationsForTick.bind(this);this.addManagedEventListeners({rowExpansionStateChanged:e,expandOrCollapseAll:e,cellValueChanged:e,rowNodeDataChanged:e,rowDataUpdated:e})}}queueResizeOperationsForTick(){const e=this.beans.colAutosize;e.shouldQueueResizeOperations=!0,setTimeout(()=>{e.processResizeOperations()},0)}areHeaderCellsRendered(){return this.beans.ctrlsSvc.getHeaderRowContainerCtrls().every(e=>e.getAllCtrls().every(s=>s.areCellsRendered()))}areCellsRendered(){return this.beans.rowRenderer.getAllRowCtrls().every(e=>e.isRowRendered()&&e.getAllCellCtrls().every(s=>!!s.eGui))}},as={setGridApi:void 0,maxComponentCreationTimeMs:void 0,children:void 0},wn=Q({gridOptions:void 0,modules:void 0,containerStyle:void 0,className:void 0,passGridApi:void 0,componentWrappingElement:void 0},as),ls=new Set(Object.keys(wn)),xn=new Set(Object.keys(as)),cs=e=>{var E,N;const s=t.useRef(),n=t.useRef(null),o=t.useRef(null),l=t.useRef([]),c=t.useRef([]),p=t.useRef(e),r=t.useRef(),i=t.useRef(),x=t.useRef(!1),[m,j]=t.useState(void 0),[,h]=t.useState(0),R=t.useCallback($=>{var T;if(n.current=$,!$){for(const A of l.current)A();l.current.length=0;return}const B=e.modules||[];o.current||(o.current=new _r(()=>h(A=>A+1),e.componentWrappingElement,e.maxComponentCreationTimeMs),l.current.push(()=>{var A;(A=o.current)==null||A.destroy(),o.current=null}));const v=Es(e.gridOptions,e,Object.keys(e).filter(A=>!ls.has(A))),Z=()=>{if(x.current){const A=()=>{var J;return(J=r.current)!=null&&J.shouldQueueUpdates()?void 0:c.current.shift()};let F=A();for(;F;)F(),F=A()}},_=new Rn(Z);r.current=_;const k=new yn,I={providedBeanInstances:{frameworkCompWrapper:new vn(o.current,v),renderStatus:k},modules:B,frameworkOverrides:_,setThemeOnGridDiv:!0},M=A=>{j(A),A.createBean(k),l.current.push(()=>{A.destroy()}),A.getBean("ctrlsSvc").whenReady({addDestroyFunc:F=>{l.current.push(F)}},()=>{var J;if(A.isDestroyed())return;const F=s.current;F&&((J=e.passGridApi)==null||J.call(e,F))})},C=A=>{A.getBean("ctrlsSvc").whenReady({addDestroyFunc:F=>{l.current.push(F)}},()=>{for(const F of c.current)F();c.current.length=0,x.current=!0})},w=new Is;(T=v.gridId)!=null||(v.gridId=i.current),s.current=w.create($,v,M,C,I),l.current.push(()=>{s.current=void 0}),s.current&&(i.current=s.current.getGridId())},[]),f=t.useMemo(()=>Q({height:"100%"},e.containerStyle||{}),[e.containerStyle]),O=t.useCallback($=>{var B;x.current&&!((B=r.current)!=null&&B.shouldQueueUpdates())?$():c.current.push($)},[]);t.useEffect(()=>{const $=bn(p.current,e);p.current=e,O(()=>{s.current&&Fs($,s.current)})},[e]);const P=!y.useSyncExternalStore||lt(e,"renderingMode")==="legacy"?"legacy":"default";return y.createElement("div",{style:f,className:e.className,ref:R},y.createElement(Xt.Provider,{value:P},m&&!m.isDestroyed()?y.createElement(Cn,{key:m.instanceId,context:m}):null,(N=(E=o.current)==null?void 0:E.getPortals())!=null?N:null))};function bn(e,s){const n={};for(const o of Object.keys(s)){if(ls.has(o)){xn.has(o)&&It(274,{prop:o});continue}const l=s[o];e[o]!==l&&(n[o]=l)}return n}var vn=class extends Ms{constructor(e,s){super(),this.parent=e,this.gridOptions=s}createWrapper(e,s){const n=this.gridOptions;if(lt(n,"reactiveCustomComponents")){const p=(r=>{switch(r){case"filter":return lt(n,"enableFilterHandlers")?Ir:Er;case"floatingFilterComponent":return lt(n,"enableFilterHandlers")?Mr:Pr;case"dateComponent":return Rr;case"dragAndDropImageComponent":return kr;case"loadingOverlayComponent":return Tr;case"noRowsOverlayComponent":return Or;case"statusPanel":return Br;case"toolPanel":return Nr;case"menuItem":return Ar;case"cellRenderer":return Sr;case"innerHeaderComponent":return jr}})(s.name);if(p)return new p(e,this.parent,s)}else switch(s.name){case"filter":case"floatingFilterComponent":case"dateComponent":case"dragAndDropImageComponent":case"loadingOverlayComponent":case"noRowsOverlayComponent":case"statusPanel":case"toolPanel":case"menuItem":case"cellRenderer":Pt();break}const l=!s.cellRenderer&&s.name!=="toolPanel";return new rs(e,this.parent,s,l)}},Sn=t.forwardRef((e,s)=>{const n=t.useContext(ve),{registry:o,context:l,gos:c,rowModel:p}=n,[r,i]=t.useState(()=>new Te),[x,m]=t.useState(()=>new Te),[j,h]=t.useState(),[R,f]=t.useState(),O=t.useRef(),P=t.useRef(null),E=t.useRef(),N=t.useMemo(()=>{var _;return Ts(e.api.getGridId(),(_=j==null?void 0:j.rowModelType)!=null?_:"clientSide")},[e]),$=t.useMemo(()=>r.toString()+" ag-details-row",[r]),B=t.useMemo(()=>x.toString()+" ag-details-grid",[x]);s&&t.useImperativeHandle(s,()=>({refresh(){var _,k;return(k=(_=O.current)==null?void 0:_.refresh())!=null?k:!1}})),e.template&&It(230);const v=t.useCallback(_=>{var M;if(P.current=_,!_||l.isDestroyed()){O.current=l.destroyBean(O.current),(M=E.current)==null||M.call(E);return}const k={toggleCss:(C,w)=>i(T=>T.setClass(C,w)),toggleDetailGridCss:(C,w)=>m(T=>T.setClass(C,w)),setDetailGrid:C=>h(C),setRowData:C=>f(C),getGui:()=>P.current},I=o.createDynamicBean("detailCellRendererCtrl",!0);if(I&&(l.createBean(I),I.init(k,e),O.current=I,c.get("detailRowAutoHeight"))){const C=()=>{if(P.current==null)return;const w=P.current.clientHeight;w!=null&&w>0&&setTimeout(()=>{e.node.setRowHeight(w),(Bs(c)||Ns(c))&&p.onRowHeightChanged()},0)};E.current=Qt(n,_,C),C()}},[]),Z=t.useCallback(_=>{var k;(k=O.current)==null||k.registerDetailWithMaster(_)},[]);return y.createElement("div",{className:$,ref:v},j&&y.createElement(cs,ae(Q({className:B},j),{modules:N,rowData:R,passGridApi:Z})))}),Rn=class extends Ps{constructor(e){super("react"),this.processQueuedUpdates=e,this.queueUpdates=!1,this.renderingEngine="react",this.frameworkComponents={agGroupCellRenderer:Dt,agGroupRowRenderer:Dt,agDetailCellRenderer:Sn},this.wrapIncoming=(s,n)=>n==="ensureVisible"?Cr(s):s()}frameworkComponent(e){return this.frameworkComponents[e]}isFrameworkComponent(e){if(!e)return!1;const s=e.prototype;return!(s&&"getGui"in s)}getLockOnRefresh(){this.queueUpdates=!0}releaseLockOnRefresh(){this.queueUpdates=!1,this.processQueuedUpdates()}shouldQueueUpdates(){return this.queueUpdates}runWhenReadyAsync(){return gr()}},kn=class extends t.Component{constructor(){super(...arguments),this.apiListeners=[],this.setGridApi=e=>{this.api=e;for(const s of this.apiListeners)s(e)}}registerApiListener(e){this.apiListeners.push(e)}componentWillUnmount(){this.apiListeners.length=0}render(){return y.createElement(cs,ae(Q({},this.props),{passGridApi:this.setGridApi}))}};function is(e){if(!e||!e.trim())return{rows:[],rowCount:0,colCount:0};const n=e.replace(/\r\n/g,`
`).replace(/\r/g,`
`).split(`
`).filter(j=>j.trim());if(n.length===0)return{rows:[],rowCount:0,colCount:0};const o=n.slice(0,Math.min(5,n.length)).join(`
`),l=(o.match(/\t/g)||[]).length,c=(o.match(/,/g)||[]).length,p=(o.match(/;/g)||[]).length;let r="	";l>c&&l>p?r="	":c>p?r=",":p>0&&(r=";");const i=[];let x=0;for(const j of n){if(!j.trim())continue;const h=[];let R="",f=!1;for(let O=0;O<j.length;O++){const P=j[O],E=j[O+1];if(P==='"')f&&E==='"'?(R+='"',O++):f=!f;else if((P===r||P===`
`)&&!f){if(h.push(R.trim()),R="",P===`
`)break}else R+=P}(R||h.length>0)&&h.push(R.trim()),h.length>0&&(i.push(h),x=Math.max(x,h.length))}const m=i.map(j=>{const h=[...j];for(;h.length<x;)h.push("");return h});return{rows:m,rowCount:m.length,colCount:x}}const En=e=>{const s=e.displayName||"",n=e.onHeaderValueChange,[o,l]=t.useState(!1),[c,p]=t.useState(s),r=t.useRef(null);t.useEffect(()=>{p(s)},[s]),t.useEffect(()=>{o&&r.current&&(r.current.focus(),r.current.select())},[o]);const i=h=>{h.stopPropagation(),l(!0),p(s)},x=()=>{const h=c.trim();h&&h!==s&&n?n(h):h||p(s),l(!1)},m=()=>{p(s),l(!1)},j=h=>{h.key==="Enter"?(h.preventDefault(),x()):h.key==="Escape"&&(h.preventDefault(),m())};return o?a.jsx("div",{style:{display:"flex",alignItems:"center",width:"100%",gap:4,padding:"0 8px"},children:a.jsx(Ue,{inputRef:r,value:c,onChange:h=>p(h.target.value),onBlur:x,onKeyDown:j,size:"small",variant:"standard",sx:{flex:1,"& .MuiInputBase-input":{padding:"4px 8px",fontSize:"14px"}}})}):a.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",width:"100%",cursor:"pointer",padding:"0 8px"},onDoubleClick:i,children:[a.jsx("span",{style:{flex:1,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:s}),a.jsx(Ke,{size:"small",onClick:i,sx:{padding:"4px",marginLeft:"4px"},title:"Edit column name",children:a.jsx(lr,{fontSize:"small"})})]})},Rt=1,us=500,kt=1,ds=100;function ut(e,s,n){return Math.max(s,Math.min(n,Math.floor(e)||s))}function In(e){return`col_${e}`}function Fn(e){return`row_${e}`}function Jt(e){return`Column ${String.fromCharCode(65+e%26)}`}function ne(e,s,n){const o=ut(s,Rt,us),l=ut(n,kt,ds),c=[],p=(e==null?void 0:e.columns)||[];for(let m=0;m<l;m++){const j=In(m),h=p.find(R=>(R==null?void 0:R.id)===j)||(m<p.length?p[m]:null);h?c.push({id:j,label:h.label||Jt(m)}):c.push({id:j,label:Jt(m)})}const r=[],i=(e==null?void 0:e.rows)||[],x={};p.forEach((m,j)=>{j<c.length&&(x[m.id]=c[j].id)});for(let m=0;m<o;m++){const j=Fn(m),h=i.find(f=>(f==null?void 0:f.id)===j)||(m<i.length?i[m]:null),R={};c.forEach((f,O)=>{let P="";if(h!=null&&h.cells){if(f.id in h.cells)P=String(h.cells[f.id]||"");else if(O<p.length){const E=p[O].id;E&&E in h.cells&&(P=String(h.cells[E]||""))}}R[f.id]=P}),r.push({id:j,cells:R})}return{columns:c,rows:r}}function bt(e,s){const n=ut(Number(e)||Rt,Rt,us),o=ut(Number(s)||kt,kt,ds);return{rows:n,cols:o}}const Pn=({data:e,onDataChange:s,onToast:n})=>{var Z,_;const o=t.useRef(null),l=t.useRef(null),[c,p]=t.useState(null),r=t.useMemo(()=>{if(!(e!=null&&e.columns)||!Array.isArray(e.columns)||e.columns.length===0||!(e!=null&&e.rows)||!Array.isArray(e.rows)||e.rows.length===0)return ne(null,1,1);const k=Math.max(1,e.columns.length),I=Math.max(1,e.rows.length);return ne(e,I,k)},[e]),{rowData:i,columnDefs:x}=t.useMemo(()=>{var M,C,w,T;if(!(r!=null&&r.columns)||!(r!=null&&r.rows)){const A=ne(null,1,1);return{rowData:[{id:((M=A.rows[0])==null?void 0:M.id)||"row_0",[((C=A.columns[0])==null?void 0:C.id)||"col_0"]:""}],columnDefs:[{field:((w=A.columns[0])==null?void 0:w.id)||"col_0",headerName:((T=A.columns[0])==null?void 0:T.label)||"Column A",editable:!0,sortable:!1,filter:!1,resizable:!0,minWidth:120,flex:1}]}}const k=r.columns.map(A=>({field:A.id,headerName:A.label||"",editable:!0,sortable:!1,filter:!1,resizable:!0,minWidth:120,flex:1,cellEditor:"agTextCellEditor",cellEditorParams:{useFormatter:!1},headerComponent:En,headerComponentParams:{onHeaderValueChange:F=>{if(F&&F.trim()&&(A!=null&&A.id)){const J=r.columns.map(L=>L.id===A.id?ae(Q({},L),{label:F.trim()}):L);s(ae(Q({},r),{columns:J}))}}}}));return{rowData:r.rows.map(A=>{const F={id:A.id};return r.columns.forEach(J=>{var L;F[J.id]=String(((L=A.cells)==null?void 0:L[J.id])||"")}),F}),columnDefs:k}},[r,s]),m=t.useCallback(k=>{p(k.api)},[]),j=t.useCallback(k=>{var T,A;if(!(k!=null&&k.data)||!((T=k==null?void 0:k.colDef)!=null&&T.field))return;const I=k.data.id,M=k.colDef.field,C=(A=k.newValue)!=null?A:"";if(!(r!=null&&r.rows)||!Array.isArray(r.rows))return;const w=r.rows.map(F=>(F==null?void 0:F.id)===I?ae(Q({},F),{cells:ae(Q({},F.cells||{}),{[M]:String(C)})}):F);s(ae(Q({},r),{rows:w}))},[r,s]),h=t.useCallback(()=>{if(!(r!=null&&r.columns)||!(r!=null&&r.rows))return;const k=r.rows.length,M={id:`row_${k}`,cells:{}};r.columns.forEach(T=>{M.cells[T.id]=""});const C=ae(Q({},r),{rows:[...r.rows,M]}),w=ne(C,C.rows.length,C.columns.length);s(w),setTimeout(()=>{c&&r.columns.length>0&&(c.setFocusedCell(k,r.columns[0].id),c.startEditingCell({rowIndex:k,colKey:r.columns[0].id}))},100)},[r,s,c]),R=t.useCallback(()=>{if(!(r!=null&&r.rows)||!Array.isArray(r.rows)||r.rows.length<=1){n("Cannot remove the last row","warning");return}const k=r.rows.slice(0,-1),I=ne(ae(Q({},r),{rows:k}),k.length,r.columns.length);s(I)},[r,s,n]),f=t.useCallback(()=>{if(!(r!=null&&r.columns)||!(r!=null&&r.rows))return;const k=r.columns.length+1,I=ne(r,r.rows.length,k);s(I)},[r,s]),O=t.useCallback(()=>{if(!(r!=null&&r.columns)||!(r!=null&&r.rows)||r.columns.length<=1){n("Cannot remove the last column","warning");return}const k=r.columns.length-1,I=ne(r,r.rows.length,k);s(I)},[r,s,n]),P=t.useCallback(k=>{var I,M,C;if(!c||!(r!=null&&r.columns)||!(r!=null&&r.rows))return!1;try{const w=is(k);if(w.rows.length===0)return!1;const T=c.getFocusedCell();if(!T)return!1;const A=(I=T.rowIndex)!=null?I:0,F=((M=T.column)==null?void 0:M.getColId())||((C=r.columns[0])==null?void 0:C.id)||"",J=r.columns.findIndex(z=>(z==null?void 0:z.id)===F);if(J===-1)return!1;const L=Math.max(r.rows.length,A+w.rows.length),H=Math.max(r.columns.length,J+w.colCount);let D=ne(r,L,H);w.rows.forEach((z,G)=>{const K=A+G;if(K>=D.rows.length)return;const le=D.rows[K];z.forEach((Ce,ie)=>{const Ee=J+ie;if(Ee<D.columns.length){const be=D.columns[Ee].id;le.cells[be]=String(Ce||"")}})});const V=ne(D,D.rows.length,D.columns.length);return s(V),n(`Pasted ${w.rows.length} rows, ${w.colCount} columns`,"success"),!0}catch(w){return console.error("Paste error:",w),!1}},[r,s,c,n]);t.useEffect(()=>{if(!l.current)return;const k=M=>{var w;const C=((w=M.clipboardData)==null?void 0:w.getData("text/plain"))||"";C.trim()&&P(C)&&(M.preventDefault(),M.stopPropagation())},I=l.current;return I.addEventListener("paste",k),()=>{I.removeEventListener("paste",k)}},[P]);const E=t.useCallback(k=>{},[]),N=t.useCallback(k=>{c&&(r!=null&&r.columns)&&(r!=null&&r.rows)&&setTimeout(()=>{const I=[];if(c.forEachNode(M=>{var C;if((C=M==null?void 0:M.data)!=null&&C.id){const w={};r.columns.forEach(T=>{w[T.id]=String(M.data[T.id]||"")}),I.push({id:M.data.id,cells:w})}}),I.length>0){const M=ae(Q({},r),{rows:I}),C=ne(M,I.length,r.columns.length);s(C)}},0)},[r,s,c]),$=t.useCallback(k=>{if(c&&(r!=null&&r.columns)){const I=[];if(c.forEachNode(M=>{var C;if((C=M==null?void 0:M.data)!=null&&C.id){const w={};r.columns.forEach(T=>{w[T.id]=String(M.data[T.id]||"")}),I.push({id:M.data.id,cells:w})}}),I.length>0){const M=ae(Q({},r),{rows:I}),C=ne(M,I.length,r.columns.length);s(C)}}},[r,s,c]),B=t.useCallback(()=>{var J;if(!(r!=null&&r.rows)||!(r!=null&&r.columns)||r.rows.length===0||r.columns.length===0){n("Cannot transpose empty table","warning");return}const k=r.rows.map(L=>r.columns.map(H=>{var D;return String(((D=L.cells)==null?void 0:D[H.id])||"")})),I=[];for(let L=0;L<r.columns.length;L++){I[L]=[];for(let H=0;H<r.rows.length;H++)I[L][H]=((J=k[H])==null?void 0:J[L])||""}const M=r.columns.length,C=r.rows.length,w={columns:r.rows.map((L,H)=>{var D;return{id:`col_${H}`,label:((D=r.columns[H])==null?void 0:D.label)||`Column ${String.fromCharCode(65+H%26)}`}}),rows:r.columns.map((L,H)=>{const D={};return r.rows.forEach((V,z)=>{var G;D[`col_${z}`]=((G=I[H])==null?void 0:G[z])||""}),{id:`row_${H}`,cells:D}})},T=ne(w,M,C);s(T);const A=T.rows.length,F=T.columns.length;n(`Table transposed: ${A} rows  ${F} columns`,"success")},[r,s,n]),v=t.useCallback((k,I)=>{const{rows:M,cols:C}=bt(k,I),w=ne(r,M,C);s(w)},[r,s]);return a.jsxs(Re,{sx:{display:"flex",flexDirection:"column",height:"100%",gap:2},children:[a.jsxs(Re,{sx:{display:"flex",gap:1,flexWrap:"wrap",alignItems:"center",p:2,borderBottom:1,borderColor:"divider"},children:[a.jsx(Ue,{label:"Rows",type:"number",size:"small",value:((Z=r==null?void 0:r.rows)==null?void 0:Z.length)||0,onChange:k=>{var M;const I=k.target.value;v(I,((M=r==null?void 0:r.columns)==null?void 0:M.length)||0)},onBlur:k=>{var M,C;const{rows:I}=bt(k.target.value,((M=r==null?void 0:r.columns)==null?void 0:M.length)||0);v(I,((C=r==null?void 0:r.columns)==null?void 0:C.length)||0)},sx:{width:100},inputProps:{min:1,max:500}}),a.jsx(Ue,{label:"Columns",type:"number",size:"small",value:((_=r==null?void 0:r.columns)==null?void 0:_.length)||0,onChange:k=>{var M;const I=k.target.value;v(((M=r==null?void 0:r.rows)==null?void 0:M.length)||0,I)},onBlur:k=>{var M,C;const{cols:I}=bt(((M=r==null?void 0:r.rows)==null?void 0:M.length)||0,k.target.value);v(((C=r==null?void 0:r.rows)==null?void 0:C.length)||0,I)},sx:{width:100},inputProps:{min:1,max:100}}),a.jsx(Re,{sx:{flex:1}}),a.jsx(Ze,{title:"Add Row",children:a.jsx(Ke,{onClick:h,size:"small",children:a.jsx(vt,{})})}),a.jsx(Ze,{title:"Remove Last Row",children:a.jsx(Ke,{onClick:R,size:"small",children:a.jsx(Wt,{})})}),a.jsx(Ze,{title:"Add Column",children:a.jsx(Ke,{onClick:f,size:"small",children:a.jsx(vt,{})})}),a.jsx(Ze,{title:"Remove Last Column",children:a.jsx(Ke,{onClick:O,size:"small",children:a.jsx(Wt,{})})}),a.jsx(Re,{sx:{width:1,borderTop:1,borderColor:"divider",my:1}}),a.jsx(Ze,{title:"Transpose Table (Swap Rows & Columns)",children:a.jsx(te,{variant:"outlined",startIcon:a.jsx(hr,{}),onClick:B,size:"small",children:"Transpose"})})]}),a.jsx(Re,{sx:{flex:1,minHeight:400,display:"flex",flexDirection:"column",overflow:"hidden"},children:a.jsx("div",{className:"ag-theme-alpine",ref:l,style:{height:"100%",width:"100%",minHeight:400,flex:1},children:a.jsx(kn,{ref:o,columnDefs:x,rowData:i,onGridReady:m,onCellValueChanged:j,onPasteStart:E,onPasteEnd:N,onRowDataUpdated:$,defaultColDef:{editable:!0,sortable:!1,filter:!1,resizable:!0},theme:"legacy",suppressClipboardPaste:!1,animateRows:!1,getRowId:k=>k.data.id,rowSelection:{mode:"multiRow",enableClickSelection:!0}})})})]})};function zt(e){if(e==null)return"";const s=String(e);return s.includes(",")||s.includes('"')||s.includes(`
`)||s.includes("\r")?`"${s.replace(/"/g,'""')}"`:s}function Mn(e){if(!(e!=null&&e.columns)||!(e!=null&&e.rows))return"";const s=[],n=e.columns.map(o=>zt((o==null?void 0:o.label)||"")).join(",");return s.push(n),e.rows.forEach(o=>{const l=e.columns.map(c=>{var r;const p=((r=o==null?void 0:o.cells)==null?void 0:r[(c==null?void 0:c.id)||""])||"";return zt(String(p))});s.push(l.join(","))}),s.join(`\r
`)}function jn(){const e=new Date,s=e.getFullYear(),n=String(e.getMonth()+1).padStart(2,"0"),o=String(e.getDate()).padStart(2,"0"),l=String(e.getHours()).padStart(2,"0"),c=String(e.getMinutes()).padStart(2,"0");return`live-table-builder_${s}-${n}-${o}_${l}${c}.csv`}function Tn(e,s=!0){if(!e.rows||e.rows.length===0)return{columns:[],rows:[]};let n=[],o=[];if(s&&e.rows.length>0)n=e.rows[0],o=e.rows.slice(1);else{const r=Math.max(...e.rows.map(i=>i.length));n=Array.from({length:r},(i,x)=>`Column ${String.fromCharCode(65+x%26)}`),o=e.rows}const l=Math.max(n.length,...o.map(r=>r.length));for(;n.length<l;){const r=n.length,i=String.fromCharCode(65+r%26);n.push(`Column ${i}`)}const c=n.map((r,i)=>({id:`col_${i}`,label:r||`Column ${String.fromCharCode(65+i%26)}`})),p=o.map((r,i)=>{const x=`row_${i}`,m={};return c.forEach((j,h)=>{m[j.id]=String(r[h]||"")}),{id:x,cells:m}});return{columns:c,rows:p}}function Kt(e,s=!0){const n=is(e);return Tn(n,s)}const An=50;class On{constructor(){Ct(this,"history",[]);Ct(this,"currentIndex",-1)}push(s){this.currentIndex<this.history.length-1&&(this.history=this.history.slice(0,this.currentIndex+1)),this.history.push(JSON.parse(JSON.stringify(s))),this.currentIndex++,this.history.length>An&&(this.history.shift(),this.currentIndex--)}undo(){return this.currentIndex>0?(this.currentIndex--,JSON.parse(JSON.stringify(this.history[this.currentIndex]))):null}redo(){return this.currentIndex<this.history.length-1?(this.currentIndex++,JSON.parse(JSON.stringify(this.history[this.currentIndex]))):null}canUndo(){return this.currentIndex>0}canRedo(){return this.currentIndex<this.history.length-1}clear(){this.history=[],this.currentIndex=-1}initialize(s){this.history=[JSON.parse(JSON.stringify(s))],this.currentIndex=0}}const qt="om_live_table_builder_state_v1",Et=10,Bn=6,tt=()=>ne(null,Et,Bn),zn=()=>{const[e,s]=t.useState(tt()),[n,o]=t.useState(!1),[l,c]=t.useState(!1),[p,r]=t.useState(""),[i,x]=t.useState(""),[m,j]=t.useState(!0),[h,R]=t.useState(!1),f=y.useRef(new On),[O,P]=t.useState(!1),[E,N]=t.useState(!1),[$,B]=t.useState({open:!1,message:"",severity:"info"}),[v,Z]=t.useState(""),[_,k]=t.useState(""),[I,M]=t.useState([]),[C,w]=t.useState(!1),[T,A]=t.useState(!1),[F,J]=t.useState(!1),[L,H]=t.useState(""),[D,V]=t.useState(!1),[z,G]=t.useState(""),[K,le]=t.useState(!1),[Ce,ie]=t.useState(""),[Ee,be]=t.useState(""),[Fe,se]=t.useState("custom"),[we,ue]=t.useState(""),[ye,ke]=t.useState(!1),[Oe,q]=t.useState(!1),u=t.useCallback((d,g="info")=>{B({open:!0,message:d,severity:g})},[]),X=t.useCallback(()=>Ne(void 0,null,function*(){q(!0);try{const d=yield We.templates.getAll();d.success&&M(d.templates.map(g=>({slug:g.slug,name:g.name,record_type:g.record_type,is_global:g.is_global})))}catch(d){console.error("Failed to load templates from database:",d),u("Failed to load templates","error")}finally{q(!1)}}),[u]);t.useEffect(()=>{var d,g;try{const S=localStorage.getItem(qt);if(S){const b=JSON.parse(S);if((d=b==null?void 0:b.data)!=null&&d.columns&&Array.isArray(b.data.columns)&&((g=b==null?void 0:b.data)!=null&&g.rows)&&Array.isArray(b.data.rows)){const U=ne(b.data,b.data.rows.length,b.data.columns.length);s(U),f.current.initialize(U),be(JSON.stringify(U))}else{u("Invalid saved data format, using defaults","warning");const U=tt();s(U),f.current.initialize(U),be(JSON.stringify(U))}}else{const b=tt();s(b),f.current.initialize(b),be(JSON.stringify(b))}}catch(S){console.error("Failed to load table data:",S),u("Failed to load saved data, using defaults","warning");const b=tt();s(b),f.current.initialize(b),be(JSON.stringify(b))}X()},[X]),t.useEffect(()=>{P(f.current.canUndo()),N(f.current.canRedo())},[e]),t.useEffect(()=>{try{if(e!=null&&e.columns&&Array.isArray(e.columns)&&(e!=null&&e.rows)&&Array.isArray(e.rows)){const d=ne(e,e.rows.length,e.columns.length),g={data:d,version:"1"};localStorage.setItem(qt,JSON.stringify(g)),be(JSON.stringify(d))}}catch(d){console.error("Failed to save table data:",d),u("Failed to save data to localStorage","error")}},[e]),t.useEffect(()=>{X()},[C,F,K,X]);const de=t.useCallback(d=>{var U,Y;const g=ne(d,((U=d==null?void 0:d.rows)==null?void 0:U.length)||0,((Y=d==null?void 0:d.columns)==null?void 0:Y.length)||0),S=JSON.stringify(e),b=JSON.stringify(g);S!==b&&(s(g),f.current.push(g),P(f.current.canUndo()),N(f.current.canRedo()))},[e]),re=t.useCallback(()=>{const d=f.current.undo();d&&(s(d),P(f.current.canUndo()),N(f.current.canRedo()),u("Undone","info"))},[u]),W=t.useCallback(()=>{const d=f.current.redo();d&&(s(d),P(f.current.canUndo()),N(f.current.canRedo()),u("Redone","info"))},[u]);t.useEffect(()=>{const d=g=>{(g.ctrlKey||g.metaKey)&&g.key==="z"&&!g.shiftKey&&(g.preventDefault(),re()),(g.ctrlKey||g.metaKey)&&(g.key==="y"||g.key==="z"&&g.shiftKey)&&(g.preventDefault(),W())};return window.addEventListener("keydown",d),()=>{window.removeEventListener("keydown",d)}},[re,W]);const oe=t.useCallback(()=>{try{if(!(e!=null&&e.columns)||!(e!=null&&e.rows)){u("No data to export","warning");return}const g={data:ne(e,e.rows.length,e.columns.length),version:"1"},S=JSON.stringify(g,null,2);navigator.clipboard&&navigator.clipboard.writeText&&navigator.clipboard.writeText(S).then(()=>{u("JSON copied to clipboard","success")}).catch(()=>{});const b=new Blob([S],{type:"application/json"}),U=URL.createObjectURL(b),Y=document.createElement("a");Y.href=U,Y.download=`live-table-builder-${new Date().toISOString().split("T")[0]}.json`,document.body.appendChild(Y),Y.click(),document.body.removeChild(Y),URL.revokeObjectURL(U),u("JSON exported and copied to clipboard","success")}catch(d){u("Failed to export data","error"),console.error(d)}},[e,u]),pe=t.useCallback(()=>{o(!0),x("")},[]),Pe=t.useCallback(()=>{o(!0),r("")},[]),Be=t.useCallback(()=>{var d;try{if(!i||!i.trim()){u("Please paste CSV data","warning");return}const g=Kt(i,m);if(!g.columns||g.columns.length===0){u("Invalid CSV format: no columns found","error");return}const S=ne(g,((d=g.rows)==null?void 0:d.length)||0,g.columns.length);s(S),f.current.push(S),P(f.current.canUndo()),N(f.current.canRedo()),o(!1),x("");const b=S.rows.length,U=S.columns.length;u(`Imported ${b} rows, ${U} columns`,"success")}catch(g){const S=g instanceof Error?g.message:"Unknown error";u("Failed to parse CSV: "+S,"error"),console.error(g)}},[i,m,u]),fe=t.useCallback(()=>{var d,g;try{if(!p||!p.trim()){u("Please paste JSON data","warning");return}const S=JSON.parse(p);if((d=S==null?void 0:S.data)!=null&&d.columns&&Array.isArray(S.data.columns)&&((g=S==null?void 0:S.data)!=null&&g.rows)&&Array.isArray(S.data.rows)){const b=ne(S.data,S.data.rows.length,S.data.columns.length);s(b),f.current.push(b),P(f.current.canUndo()),N(f.current.canRedo()),o(!1),r("");const U=b.rows.length,Y=b.columns.length;u(`JSON imported: ${U} rows, ${Y} columns`,"success")}else u("Invalid JSON format: missing columns or rows","error")}catch(S){u("Failed to parse JSON: "+(S instanceof Error?S.message:"Unknown error"),"error"),console.error(S)}},[p,u]),ze=t.useCallback(d=>{var b;const g=(b=d.target.files)==null?void 0:b[0];if(!g)return;const S=new FileReader;S.onload=U=>{var Y,ge,he,ee;try{const me=(Y=U.target)==null?void 0:Y.result;if(!me||!me.trim()){u("File is empty","error");return}const Me=g.name.toLowerCase();if(Me.endsWith(".csv")||Me.endsWith(".tsv")){const xe=Kt(me,m);if(!xe.columns||xe.columns.length===0){u("Invalid CSV format: no columns found","error");return}const _e=ne(xe,((ge=xe.rows)==null?void 0:ge.length)||0,xe.columns.length);s(_e),f.current.push(_e),P(f.current.canUndo()),N(f.current.canRedo());const ht=_e.rows.length,ft=_e.columns.length;u(`Imported ${ht} rows, ${ft} columns from CSV`,"success")}else{const xe=JSON.parse(me);if((he=xe==null?void 0:xe.data)!=null&&he.columns&&Array.isArray(xe.data.columns)&&((ee=xe==null?void 0:xe.data)!=null&&ee.rows)&&Array.isArray(xe.data.rows)){const _e=ne(xe.data,xe.data.rows.length,xe.data.columns.length);s(_e),f.current.push(_e),P(f.current.canUndo()),N(f.current.canRedo());const ht=_e.rows.length,ft=_e.columns.length;u(`Imported ${ht} rows, ${ft} columns from JSON`,"success")}else u("Invalid JSON format: missing columns or rows","error")}}catch(me){const Me=me instanceof Error?me.message:"Unknown error";u("Failed to parse file: "+Me,"error"),console.error(me)}},S.onerror=()=>{u("Failed to read file","error")},S.readAsText(g)},[u,m]),ce=t.useCallback(()=>{try{if(!(e!=null&&e.columns)||!(e!=null&&e.rows)){u("No data to export","warning");return}const d=ne(e,e.rows.length,e.columns.length),g=Mn(d);if(!g){u("Failed to generate CSV","error");return}const S=new Blob([g],{type:"text/csv;charset=utf-8;"}),b=URL.createObjectURL(S),U=document.createElement("a");U.href=b,U.download=jn(),document.body.appendChild(U),U.click(),document.body.removeChild(U),URL.revokeObjectURL(b),u("CSV exported successfully","success")}catch(d){u("Failed to export CSV","error"),console.error(d)}},[e,u]),Se=t.useCallback(()=>{c(!0)},[]),mt=t.useCallback(()=>{try{const d=tt();s(d),f.current.clear(),f.current.initialize(d),P(!1),N(!1),c(!1),be(JSON.stringify(d)),u("Grid reset to defaults","success")}catch(d){u("Failed to reset table","error"),console.error(d)}},[u]),Mt=t.useCallback(()=>{if(!e)return!1;const d=ne(e,e.rows.length,e.columns.length);return JSON.stringify(d)!==Ee},[e,Ee]),nt=t.useCallback(d=>d.columns.map((S,b)=>{let U="string";const Y=S.label.toLowerCase();return Y.includes("date")||Y.includes("time")?U="date":Y.includes("id")||Y.includes("number")||Y.includes("count")?U="number":Y.includes("email")?U="email":Y.includes("phone")&&(U="tel"),{column:S.id,label:S.label||`Column ${b+1}`,type:U,required:!1}}),[]),ps=t.useCallback(()=>Ne(void 0,null,function*(){var g,S;if(!v.trim()){u("Template name is required","warning");return}if(I.find(b=>b.name===v.trim()||b.slug===v.trim().toLowerCase().replace(/[^\w\s-]/g,"").replace(/[\s_-]+/g,"-"))){A(!0);return}try{const b=ne(e,e.rows.length,e.columns.length),U=nt(b),Y=v.trim().toLowerCase().replace(/[^\w\s-]/g,"").replace(/[\s_-]+/g,"-").replace(/^-+|-+$/g,""),ge={name:v.trim(),slug:Y,record_type:Fe,description:we.trim()||null,fields:U,grid_type:"aggrid",theme:"liturgicalBlueGold",layout_type:"table",is_editable:!0,church_id:null,is_global:ye};if((yield We.templates.create(ge)).success){const ee=v.trim();yield X(),Z(""),ue(""),se("custom"),ke(!1),w(!1),u(`Saved template: ${ee}`,"success")}else u("Failed to save template","error")}catch(b){console.error("Error saving template:",b);const U=((S=(g=b==null?void 0:b.response)==null?void 0:g.data)==null?void 0:S.error)||(b==null?void 0:b.message)||"Unknown error";u(`Failed to save template: ${U}`,"error")}}),[v,Fe,we,ye,e,I,nt,X,u]),ms=t.useCallback(()=>Ne(void 0,null,function*(){var d,g;try{const S=I.find(he=>he.name===v.trim()||he.slug===v.trim().toLowerCase().replace(/[^\w\s-]/g,"").replace(/[\s_-]+/g,"-"));if(!S){u("Template not found","error");return}const b=ne(e,e.rows.length,e.columns.length),U=nt(b),Y={record_type:Fe,description:we.trim()||null,fields:U,is_global:ye};if((yield We.templates.update(S.slug,Y)).success){const he=v.trim();yield X(),Z(""),ue(""),se("custom"),ke(!1),w(!1),A(!1),u(`Updated template: ${he}`,"success")}else u("Failed to update template","error")}catch(S){console.error("Error updating template:",S);const b=((g=(d=S==null?void 0:S.response)==null?void 0:d.data)==null?void 0:g.error)||(S==null?void 0:S.message)||"Unknown error";u(`Failed to update template: ${b}`,"error")}}),[v,Fe,we,ye,e,I,nt,X,u]),hs=t.useCallback(d=>Ne(void 0,null,function*(){if(Mt()){G(d),V(!0);return}try{const g=yield We.templates.getBySlug(d);if(!g.success||!g.template){u("Template not found","error");return}const S=g.template;let b=[];if(Array.isArray(S.fields))b=S.fields;else if(S.fields&&typeof S.fields=="object")if(S.fields.columns&&Array.isArray(S.fields.columns))b=S.fields.columns.map(ee=>({column:ee.name||ee.column||`col_${b.length}`,label:ee.label||ee.name||ee.column,type:ee.type||"string",required:ee.required||!1}));else throw new Error("Template fields format not recognized");else throw new Error("Template fields is missing or invalid");const U=b.map((ee,me)=>({id:ee.column||`col_${me}`,label:ee.label||ee.column||`Column ${me+1}`})),Y=Array.from({length:Et},(ee,me)=>({id:`row_${me}`,cells:U.reduce((Me,ot)=>(Me[ot.id]="",Me),{})})),he=ne({columns:U,rows:Y},Y.length,U.length);s(he),f.current.clear(),f.current.initialize(he),P(!1),N(!1),be(JSON.stringify(he)),k(d),u(`Loaded template: ${S.name}`,"success")}catch(g){console.error("Error loading template:",g),u(`Failed to load template: ${(g==null?void 0:g.message)||"Unknown error"}`,"error")}}),[Mt,u]),fs=t.useCallback(()=>Ne(void 0,null,function*(){const d=z;try{const g=yield We.templates.getBySlug(d);if(!g.success||!g.template){u("Template not found","error"),V(!1);return}const S=g.template;let b=[];if(Array.isArray(S.fields))b=S.fields;else if(S.fields&&typeof S.fields=="object")if(S.fields.columns&&Array.isArray(S.fields.columns))b=S.fields.columns.map(ee=>({column:ee.name||ee.column||`col_${b.length}`,label:ee.label||ee.name||ee.column,type:ee.type||"string",required:ee.required||!1}));else throw new Error("Template fields format not recognized");else throw new Error("Template fields is missing or invalid");const U=b.map((ee,me)=>({id:ee.column||`col_${me}`,label:ee.label||ee.column||`Column ${me+1}`})),Y=Array.from({length:Et},(ee,me)=>({id:`row_${me}`,cells:U.reduce((Me,ot)=>(Me[ot.id]="",Me),{})})),he=ne({columns:U,rows:Y},Y.length,U.length);s(he),f.current.clear(),f.current.initialize(he),P(!1),N(!1),be(JSON.stringify(he)),k(d),V(!1),G(""),u(`Loaded template: ${S.name}`,"success")}catch(g){console.error("Error loading template:",g),u(`Failed to load template: ${(g==null?void 0:g.message)||"Unknown error"}`,"error"),V(!1)}}),[z,u]),gs=t.useCallback(d=>{H(d),J(!0)},[]),Cs=t.useCallback(()=>Ne(void 0,null,function*(){const d=L;try{(yield We.templates.delete(d)).success?(yield X(),J(!1),H(""),_===d&&k(""),u("Template deleted successfully","success")):u("Failed to delete template","error")}catch(g){console.error("Error deleting template:",g),u(`Failed to delete template: ${(g==null?void 0:g.message)||"Unknown error"}`,"error")}}),[L,_,X,u]),ys=t.useCallback(()=>Ne(void 0,null,function*(){try{const d=yield We.templates.getAll();if(d.success){const g=JSON.stringify(d.templates,null,2),S=new Blob([g],{type:"application/json"}),b=URL.createObjectURL(S),U=document.createElement("a");U.href=b;const Y=new Date,ge=Y.toISOString().split("T")[0],he=Y.toTimeString().split(" ")[0].replace(/:/g,"");U.download=`live-table-templates_${ge}_${he}.json`,document.body.appendChild(U),U.click(),document.body.removeChild(U),URL.revokeObjectURL(b),u("Templates exported successfully","success")}else u("Failed to export templates","error")}catch(d){u("Failed to export templates","error"),console.error(d)}}),[u]),ws=t.useCallback(()=>{le(!0),ie("")},[]),xs=t.useCallback(d=>{var b;const g=(b=d.target.files)==null?void 0:b[0];if(!g)return;const S=new FileReader;S.onload=U=>{var Y;try{const ge=(Y=U.target)==null?void 0:Y.result;if(!ge){u("Failed to read file","error");return}JSON.parse(ge),ie(ge),le(!0)}catch(ge){u("Invalid JSON file","error"),console.error(ge)}},S.onerror=()=>{u("Failed to read file","error")},S.readAsText(g),d.target.value=""},[u]),bs=t.useCallback(()=>Ne(void 0,null,function*(){try{if(!Ce.trim()){u("Please paste template JSON data","warning");return}const d=JSON.parse(Ce);if(!Array.isArray(d)){u("Invalid template format: expected array","error");return}let g=0,S=0;for(const b of d)try{yield We.templates.create({name:b.name,slug:b.slug,record_type:b.record_type||"custom",description:b.description||null,fields:b.fields||[],grid_type:b.grid_type||"aggrid",theme:b.theme||"liturgicalBlueGold",layout_type:b.layout_type||"table",is_editable:b.is_editable!==!1,church_id:b.church_id||null,is_global:b.is_global||!1}),g++}catch(U){console.error("Failed to import template:",b.name,U),S++}yield X(),le(!1),ie(""),S>0?u(`Imported ${g} templates. ${S} failed.`,"warning"):u(`Imported ${g} templates successfully`,"success")}catch(d){u("Failed to import templates","error"),console.error(d)}}),[Ce,X,u]),vs=t.useCallback(()=>Ne(void 0,null,function*(){try{const d=["id","church_id","entry_no","date","first_name","last_name","father_name","mother_name","godfather_name","godmother_name","notes"],g=["baptism","marriage","funeral"],S=["en","gr"];let b=0;for(const U of S)for(const Y of g){const ge=`${U}_${Y}_records`,he=ge.toLowerCase().replace(/[^\w\s-]/g,"").replace(/[\s_-]+/g,"-"),ee=d.map((me,Me)=>({column:`col_${Me}`,label:me,type:"string",required:!1}));try{yield We.templates.create({name:ge,slug:he,record_type:Y,description:`Standard ${Y} template for ${U}`,fields:ee,grid_type:"aggrid",theme:"liturgicalBlueGold",layout_type:"table",is_editable:!0,church_id:null,is_global:!0}),b++}catch(me){console.log(`Template ${ge} may already exist, skipping`)}}yield X(),u(`Created ${b} standard templates`,"success")}catch(d){u("Failed to create standard templates","error"),console.error(d)}}),[X,u]);return a.jsxs(cr,{maxWidth:"xl",sx:{py:4,height:"calc(100vh - 120px)",display:"flex",flexDirection:"column"},children:[a.jsxs(Re,{sx:{mb:3},children:[a.jsxs(Re,{sx:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",mb:2},children:[a.jsxs(Re,{children:[a.jsx(Ge,{variant:"h4",gutterBottom:!0,children:"Live Table Builder"}),a.jsx(Ge,{variant:"body2",color:"text.secondary",children:"Create, edit, and manage tables with clipboard paste support. Data is automatically saved."})]}),a.jsxs(Ke,{onClick:()=>R(!h),title:"Show/hide quick tips",sx:{ml:2},children:[h?a.jsx(ir,{}):a.jsx(ur,{}),a.jsx(dr,{sx:{ml:.5}})]})]}),a.jsx(er,{in:h,children:a.jsxs(tr,{sx:{p:2,mb:2,bgcolor:"background.default"},children:[a.jsx(Ge,{variant:"subtitle2",gutterBottom:!0,sx:{fontWeight:"bold"},children:"Quick Tips:"}),a.jsxs(Re,{component:"ul",sx:{m:0,pl:2.5,"& li":{mb:.5}},children:[a.jsx("li",{children:"Double-click column headers to edit them inline"}),a.jsx("li",{children:"Paste data from Excel/Google Sheets directly into cells"}),a.jsxs("li",{children:["Use ",a.jsx("strong",{children:"Ctrl+Z"})," to undo and ",a.jsx("strong",{children:"Ctrl+Y"})," to redo"]}),a.jsx("li",{children:"Export to CSV for Excel compatibility or JSON for data backup"}),a.jsx("li",{children:"Import CSV/TSV files with automatic delimiter detection"}),a.jsx("li",{children:"All changes are automatically saved to your browser"})]})]})}),a.jsxs(Re,{sx:{mb:2,p:2,border:1,borderColor:"divider",borderRadius:1,bgcolor:"background.paper"},children:[a.jsx(Ge,{variant:"subtitle2",gutterBottom:!0,sx:{fontWeight:"bold",mb:1.5},children:"Template Management"}),a.jsxs(Re,{sx:{display:"flex",gap:1,flexWrap:"wrap",alignItems:"center"},children:[a.jsx(Ue,{label:"Template Name",size:"small",value:v,onChange:d=>Z(d.target.value),placeholder:"e.g., en_baptism_records",sx:{width:200}}),a.jsx(te,{variant:"contained",startIcon:a.jsx(sr,{}),onClick:()=>w(!0),disabled:!v.trim(),size:"small",children:"Save Template"}),a.jsxs(Ot,{size:"small",sx:{minWidth:200},children:[a.jsx(Bt,{children:"Load Template"}),a.jsx(Nt,{value:_,label:"Load Template",disabled:Oe,onChange:d=>{const g=d.target.value;k(g),g&&hs(g)},children:Oe?a.jsx(De,{disabled:!0,children:"Loading templates..."}):I.length===0?a.jsx(De,{disabled:!0,children:"No templates available"}):I.map(d=>a.jsxs(De,{value:d.slug,children:[d.name," ",d.is_global?"(Global)":""]},d.slug))})]}),a.jsx(te,{variant:"outlined",startIcon:a.jsx(pr,{}),onClick:()=>{_&&gs(_)},disabled:!_,color:"error",size:"small",children:"Delete"}),a.jsx(Xe,{orientation:"vertical",flexItem:!0,sx:{mx:1}}),a.jsx(te,{variant:"outlined",startIcon:a.jsx(wt,{}),onClick:ys,size:"small",children:"Export Templates"}),a.jsx(te,{variant:"outlined",startIcon:a.jsx(et,{}),onClick:ws,size:"small",children:"Import Templates"}),a.jsx("input",{accept:".json",style:{display:"none"},id:"import-templates-file-input",type:"file",onChange:xs}),a.jsx("label",{htmlFor:"import-templates-file-input",children:a.jsx(te,{variant:"outlined",component:"span",startIcon:a.jsx(et,{}),size:"small",children:"Upload Templates"})}),a.jsx(te,{variant:"outlined",startIcon:a.jsx(vt,{}),onClick:vs,size:"small",color:"secondary",children:"Create Standard Templates"}),a.jsx(Xe,{orientation:"vertical",flexItem:!0,sx:{mx:1}})]})]}),a.jsxs(Re,{sx:{display:"flex",gap:1,flexWrap:"wrap",alignItems:"center"},children:[a.jsx(te,{variant:"outlined",startIcon:a.jsx(fr,{}),onClick:re,disabled:!O,title:"Undo (Ctrl+Z)",size:"small",children:"Undo"}),a.jsx(te,{variant:"outlined",startIcon:a.jsx(mr,{}),onClick:W,disabled:!E,title:"Redo (Ctrl+Y or Ctrl+Shift+Z)",size:"small",children:"Redo"}),a.jsx(Xe,{orientation:"vertical",flexItem:!0,sx:{mx:1}}),a.jsx(te,{variant:"outlined",startIcon:a.jsx(rr,{}),onClick:Se,color:"warning",size:"small",children:"Reset"}),a.jsx(Xe,{orientation:"vertical",flexItem:!0,sx:{mx:1}}),a.jsx(te,{variant:"outlined",startIcon:a.jsx(et,{}),onClick:pe,size:"small",children:"Import JSON"}),a.jsx(te,{variant:"outlined",startIcon:a.jsx(et,{}),onClick:Pe,size:"small",children:"Import CSV"}),a.jsx("input",{accept:".json,.csv,.tsv",style:{display:"none"},id:"import-file-input",type:"file",onChange:ze}),a.jsx("label",{htmlFor:"import-file-input",children:a.jsx(te,{variant:"outlined",component:"span",startIcon:a.jsx(et,{}),size:"small",children:"Upload File"})}),a.jsx(Xe,{orientation:"vertical",flexItem:!0,sx:{mx:1}}),a.jsx(te,{variant:"outlined",startIcon:a.jsx(wt,{}),onClick:oe,size:"small",children:"Export JSON"}),a.jsx(te,{variant:"contained",startIcon:a.jsx(wt,{}),onClick:ce,size:"small",children:"Export CSV"})]})]}),a.jsx(Re,{sx:{mb:2,p:1.5,bgcolor:"action.hover",borderRadius:1},children:a.jsxs(Ge,{variant:"body2",color:"text.secondary",children:[a.jsx("strong",{children:"Tip:"})," Paste data from Excel/Google Sheets (Ctrl/Cmd+V) or start typing in any cell. All changes are automatically saved."]})}),a.jsx(Re,{sx:{flex:1,minHeight:500,display:"flex",flexDirection:"column",overflow:"hidden"},children:a.jsx(Pn,{data:e,onDataChange:de,onToast:u})}),a.jsxs(Le,{open:n,onClose:()=>o(!1),maxWidth:"md",fullWidth:!0,children:[a.jsx(He,{children:i?"Import CSV/TSV":"Import JSON"}),a.jsx(Ve,{children:i?a.jsxs(a.Fragment,{children:[a.jsx(Gt,{control:a.jsx(_t,{checked:m,onChange:d=>j(d.target.checked)}),label:"First row is headers",sx:{mt:2,mb:1}}),a.jsx(Ue,{fullWidth:!0,multiline:!0,rows:12,value:i,onChange:d=>x(d.target.value),placeholder:"Paste CSV/TSV data here...",sx:{mt:1}})]}):a.jsx(Ue,{fullWidth:!0,multiline:!0,rows:12,value:p,onChange:d=>r(d.target.value),placeholder:"Paste JSON data here...",sx:{mt:2}})}),a.jsxs($e,{children:[a.jsx(te,{onClick:()=>{o(!1),r(""),x("")},children:"Cancel"}),i?a.jsx(te,{onClick:Be,variant:"contained",children:"Import CSV"}):a.jsx(te,{onClick:fe,variant:"contained",children:"Import JSON"})]})]}),a.jsxs(Le,{open:l,onClose:()=>c(!1),children:[a.jsx(He,{children:"Reset Table"}),a.jsx(Ve,{children:a.jsx(Ge,{children:"Reset to default 10x6 grid? This will lose all current data."})}),a.jsxs($e,{children:[a.jsx(te,{onClick:()=>c(!1),children:"Cancel"}),a.jsx(te,{onClick:mt,variant:"contained",color:"warning",children:"Reset"})]})]}),a.jsxs(Le,{open:C,onClose:()=>w(!1),maxWidth:"sm",fullWidth:!0,children:[a.jsx(He,{children:"Save Template to Database"}),a.jsx(Ve,{children:a.jsxs(Re,{sx:{display:"flex",flexDirection:"column",gap:2,pt:1},children:[a.jsx(Ue,{fullWidth:!0,label:"Template Name",value:v,onChange:d=>Z(d.target.value),placeholder:"e.g., Standard Baptism Records",required:!0,autoFocus:!0}),a.jsxs(Ot,{fullWidth:!0,children:[a.jsx(Bt,{children:"Record Type"}),a.jsxs(Nt,{value:Fe,label:"Record Type",onChange:d=>se(d.target.value),children:[a.jsx(De,{value:"baptism",children:"Baptism"}),a.jsx(De,{value:"marriage",children:"Marriage"}),a.jsx(De,{value:"funeral",children:"Funeral"}),a.jsx(De,{value:"custom",children:"Custom"})]})]}),a.jsx(Ue,{fullWidth:!0,label:"Description (optional)",value:we,onChange:d=>ue(d.target.value),placeholder:"Template description...",multiline:!0,rows:2}),a.jsx(Gt,{control:a.jsx(_t,{checked:ye,onChange:d=>ke(d.target.checked)}),label:"Make this template global (available to all churches)"})]})}),a.jsxs($e,{children:[a.jsx(te,{onClick:()=>{w(!1),Z(""),ue(""),se("custom"),ke(!1)},children:"Cancel"}),a.jsx(te,{onClick:ps,variant:"contained",disabled:!v.trim(),children:"Save"})]})]}),a.jsxs(Le,{open:T,onClose:()=>A(!1),children:[a.jsx(He,{children:"Update Template?"}),a.jsx(Ve,{children:a.jsxs(Ge,{children:['Template "',v,'" already exists in the database. Update it?']})}),a.jsxs($e,{children:[a.jsx(te,{onClick:()=>{A(!1),Z(""),w(!1)},children:"Cancel"}),a.jsx(te,{onClick:ms,variant:"contained",color:"warning",children:"Update"})]})]}),a.jsxs(Le,{open:F,onClose:()=>J(!1),children:[a.jsx(He,{children:"Delete Template?"}),a.jsx(Ve,{children:a.jsx(Ge,{children:"Are you sure you want to delete this template? This action cannot be undone."})}),a.jsxs($e,{children:[a.jsx(te,{onClick:()=>{J(!1),H("")},children:"Cancel"}),a.jsx(te,{onClick:Cs,variant:"contained",color:"error",children:"Delete"})]})]}),a.jsxs(Le,{open:D,onClose:()=>V(!1),children:[a.jsx(He,{children:"Load Template?"}),a.jsx(Ve,{children:a.jsx(Ge,{children:"You have unsaved changes. Loading this template will replace your current table. Continue?"})}),a.jsxs($e,{children:[a.jsx(te,{onClick:()=>{V(!1),G("")},children:"Cancel"}),a.jsx(te,{onClick:fs,variant:"contained",color:"warning",children:"Load Template"})]})]}),a.jsxs(Le,{open:K,onClose:()=>le(!1),maxWidth:"md",fullWidth:!0,children:[a.jsx(He,{children:"Import Templates"}),a.jsxs(Ve,{children:[a.jsx(Ge,{variant:"body2",color:"text.secondary",sx:{mb:2},children:"Paste JSON template data. Existing templates with the same name will be overwritten."}),a.jsx(Ue,{fullWidth:!0,multiline:!0,rows:12,value:Ce,onChange:d=>ie(d.target.value),placeholder:"Paste template JSON here...",sx:{mt:1}})]}),a.jsxs($e,{children:[a.jsx(te,{onClick:()=>{le(!1),ie("")},children:"Cancel"}),a.jsx(te,{onClick:bs,variant:"contained",disabled:!Ce.trim(),children:"Import Templates"})]})]}),a.jsx(nr,{open:$.open,autoHideDuration:12e3,onClose:()=>B(ae(Q({},$),{open:!1})),anchorOrigin:{vertical:"center",horizontal:"center"},sx:{position:"fixed",top:"50% !important",left:"50% !important",transform:"translate(-50%, -50%) !important",zIndex:1e4,"& .MuiSnackbar-root":{position:"fixed",top:"50% !important",left:"50% !important",transform:"translate(-50%, -50%) !important"}},children:a.jsx(or,{onClose:()=>B(ae(Q({},$),{open:!1})),severity:$.severity,sx:{minWidth:"400px",maxWidth:"600px",fontSize:"1.1rem",padding:"16px 20px","& .MuiAlert-message":{fontSize:"1.1rem",fontWeight:500},"& .MuiAlert-icon":{fontSize:"28px"}},children:$.message})})]})};export{zn as LiveTableBuilderPage,zn as default};
//# sourceMappingURL=LiveTableBuilderPage-BXqie1by.js.map
