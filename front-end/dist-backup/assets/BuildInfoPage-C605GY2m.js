var v=(s,n,t)=>new Promise((d,a)=>{var g=i=>{try{c(t.next(i))}catch(f){a(f)}},u=i=>{try{c(t.throw(i))}catch(f){a(f)}},c=i=>i.done?d(i.value):Promise.resolve(i.value).then(g,u);c((t=t.apply(s,n)).next())});import{c as I,j as e,B as o,S as l,d as r,T as k,I as F,C as b,aH as C,U as h,Y as z,G as x,D as j,h as y,V as B,R as T}from"./index-Dgvcv9SG.js";import{r as m}from"./vendor-Dkfty7_r.js";import{I as R}from"./IconCheck-WLZZX55y.js";import{I as w}from"./IconGitBranch-C4AloSyd.js";import{I as S}from"./IconCalendar-CsRfdV1H.js";import{I as D}from"./IconServer-B22FO22R.js";import{I as E}from"./IconInfoCircle-CInPNjNe.js";/**
 * @license @tabler/icons-react v3.36.1 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */const M=[["path",{d:"M4 8h16",key:"svg-0"}],["path",{d:"M4 6a2 2 0 0 1 2 -2h12a2 2 0 0 1 2 2v12a2 2 0 0 1 -2 2h-12a2 2 0 0 1 -2 -2l0 -12",key:"svg-1"}],["path",{d:"M8 4v4",key:"svg-2"}]],V=I("outline","browser","Browser",M);function G(){const s="5.0.0",n="unknown",t=new Date().toISOString();return{version:s,gitSha:n.length>7?n.substring(0,7):n,buildTime:t,environment:"production",nodeVersion:void 0}}const N=()=>{const[s,n]=m.useState(null),[t,d]=m.useState(!1),[a,g]=m.useState(null),u=m.useCallback(()=>v(void 0,null,function*(){d(!0),g(null);try{const c=yield fetch("/api/system/version",{method:"GET",headers:{"Content-Type":"application/json"}});if(!c.ok)throw new Error(`Failed to fetch server version: ${c.status}`);const i=yield c.json();if(i.success&&i.server)n({version:i.server.version||"unknown",gitSha:i.server.gitSha||"unknown",gitShaFull:i.server.gitShaFull||"unknown",buildTime:i.server.buildTime||new Date().toISOString(),nodeVersion:i.server.nodeVersion||"unknown",environment:i.server.environment||"unknown",uptime:i.server.uptime||0});else throw new Error("Invalid server version response")}catch(c){const i=c instanceof Error?c.message:"Failed to fetch server version";g(i),n({version:"unknown",gitSha:"unknown",gitShaFull:"unknown",buildTime:new Date().toISOString(),nodeVersion:"unknown",environment:"unknown",uptime:0})}finally{d(!1)}}),[]);return m.useEffect(()=>{u()},[u]),{serverVersion:s,isLoading:t,error:a,refetch:u}},p=(s,n="N/A")=>!s||s==="unknown"||s==="undefined"?n:s,U=()=>{const s=G(),{serverVersion:n,isLoading:t,refetch:d}=N(),a=n&&s.gitSha===n.gitSha;return e.jsxs(o,{sx:{p:3},children:[e.jsxs(l,{direction:"row",alignItems:"center",justifyContent:"space-between",sx:{mb:3},children:[e.jsx(r,{variant:"h4",children:"Build Information"}),e.jsx(k,{title:"Refresh server version",children:e.jsx(F,{onClick:d,disabled:t,children:t?e.jsx(b,{size:20}):e.jsx(C,{size:20})})})]}),e.jsx(h,{sx:{p:2,mb:3,background:a?"linear-gradient(135deg, #1b5e20 0%, #2e7d32 100%)":"linear-gradient(135deg, #e65100 0%, #f57c00 100%)",borderRadius:2},children:e.jsxs(l,{direction:"row",alignItems:"center",spacing:2,children:[a?e.jsx(R,{size:24}):e.jsx(z,{size:24}),e.jsxs(o,{children:[e.jsx(r,{variant:"subtitle1",fontWeight:"bold",children:a?"Versions Synchronized":"Version Mismatch Detected"}),e.jsx(r,{variant:"body2",sx:{opacity:.9},children:a?"Frontend and Server are running the same build.":"Frontend and Server builds may be out of sync."})]})]})}),e.jsxs(x,{container:!0,spacing:3,sx:{mb:3},children:[e.jsx(x,{item:!0,xs:12,md:6,children:e.jsx(h,{sx:{p:3,background:"linear-gradient(135deg, #1a237e 0%, #3949ab 100%)",borderRadius:2,height:"100%"},children:e.jsxs(l,{spacing:2,children:[e.jsxs(l,{direction:"row",alignItems:"center",spacing:1,children:[e.jsx(V,{size:24}),e.jsx(r,{variant:"h6",fontWeight:"bold",children:"Frontend"})]}),e.jsx(j,{sx:{borderColor:"rgba(255,255,255,0.2)"}}),e.jsxs(o,{children:[e.jsx(r,{variant:"caption",sx:{opacity:.7},children:"Version"}),e.jsx(r,{variant:"h5",fontFamily:"monospace",fontWeight:"bold",children:p(s.version,"unknown")})]}),e.jsxs(o,{children:[e.jsx(r,{variant:"caption",sx:{opacity:.7},children:"Git SHA"}),e.jsxs(l,{direction:"row",alignItems:"center",spacing:1,children:[e.jsx(w,{size:16}),e.jsx(y,{label:p(s.gitSha,"unknown"),size:"small",sx:{fontFamily:"monospace",bgcolor:"rgba(255,255,255,0.2)",color:"inherit"}})]})]}),e.jsxs(o,{children:[e.jsx(r,{variant:"caption",sx:{opacity:.7},children:"Build Time"}),e.jsxs(l,{direction:"row",alignItems:"center",spacing:1,children:[e.jsx(S,{size:16}),e.jsx(r,{variant:"body2",fontFamily:"monospace",children:new Date(s.buildTime).toLocaleString()})]})]}),e.jsxs(o,{children:[e.jsx(r,{variant:"caption",sx:{opacity:.7},children:"Environment"}),e.jsx(r,{variant:"body2",fontFamily:"monospace",children:s.environment||"development"})]})]})})}),e.jsx(x,{item:!0,xs:12,md:6,children:t?e.jsx(h,{sx:{p:3,background:"linear-gradient(135deg, #4a148c 0%, #7b1fa2 100%)",borderRadius:2,height:"100%",display:"flex",alignItems:"center",justifyContent:"center"},children:e.jsx(b,{color:"inherit"})}):e.jsx(h,{sx:{p:3,background:"linear-gradient(135deg, #4a148c 0%, #7b1fa2 100%)",borderRadius:2,height:"100%"},children:e.jsxs(l,{spacing:2,children:[e.jsxs(l,{direction:"row",alignItems:"center",spacing:1,children:[e.jsx(D,{size:24}),e.jsx(r,{variant:"h6",fontWeight:"bold",children:"Server"})]}),e.jsx(j,{sx:{borderColor:"rgba(255,255,255,0.2)"}}),e.jsxs(o,{children:[e.jsx(r,{variant:"caption",sx:{opacity:.7},children:"Version"}),e.jsx(r,{variant:"h5",fontFamily:"monospace",fontWeight:"bold",children:p(n==null?void 0:n.version,"unknown")})]}),e.jsxs(o,{children:[e.jsx(r,{variant:"caption",sx:{opacity:.7},children:"Git SHA"}),e.jsxs(l,{direction:"row",alignItems:"center",spacing:1,children:[e.jsx(w,{size:16}),e.jsx(y,{label:p(n==null?void 0:n.gitSha,"unknown"),size:"small",sx:{fontFamily:"monospace",bgcolor:"rgba(255,255,255,0.2)",color:"inherit"}})]})]}),e.jsxs(o,{children:[e.jsx(r,{variant:"caption",sx:{opacity:.7},children:"Build Time"}),e.jsxs(l,{direction:"row",alignItems:"center",spacing:1,children:[e.jsx(S,{size:16}),e.jsx(r,{variant:"body2",fontFamily:"monospace",children:n!=null&&n.buildTime?new Date(n.buildTime).toLocaleString():"unknown"})]})]}),e.jsxs(o,{children:[e.jsx(r,{variant:"caption",sx:{opacity:.7},children:"Node.js"}),e.jsx(r,{variant:"body2",fontFamily:"monospace",children:(n==null?void 0:n.nodeVersion)||"unknown"})]}),e.jsxs(o,{children:[e.jsx(r,{variant:"caption",sx:{opacity:.7},children:"Uptime"}),e.jsx(r,{variant:"body2",fontFamily:"monospace",children:n!=null&&n.uptime?`${Math.floor(n.uptime/3600)}h ${Math.floor(n.uptime%3600/60)}m`:"unknown"})]})]})})})]}),e.jsx(B,{children:e.jsxs(T,{children:[e.jsxs(r,{variant:"h6",gutterBottom:!0,sx:{display:"flex",alignItems:"center",gap:1},children:[e.jsx(E,{size:20}),"Raw Build Data"]}),e.jsx(j,{sx:{my:2}}),e.jsxs(x,{container:!0,spacing:2,children:[e.jsxs(x,{item:!0,xs:12,md:6,children:[e.jsx(r,{variant:"subtitle2",color:"text.secondary",gutterBottom:!0,children:"Frontend"}),e.jsx(h,{variant:"outlined",sx:{p:2,bgcolor:"background.default",fontFamily:"monospace",fontSize:"0.75rem"},children:e.jsx("pre",{style:{margin:0,overflow:"auto"},children:JSON.stringify(s,null,2)})})]}),e.jsxs(x,{item:!0,xs:12,md:6,children:[e.jsx(r,{variant:"subtitle2",color:"text.secondary",gutterBottom:!0,children:"Server"}),e.jsx(h,{variant:"outlined",sx:{p:2,bgcolor:"background.default",fontFamily:"monospace",fontSize:"0.75rem"},children:e.jsx("pre",{style:{margin:0,overflow:"auto"},children:JSON.stringify(n,null,2)})})]})]}),e.jsx(j,{sx:{my:2}}),e.jsxs(r,{variant:"body2",color:"text.secondary",children:[e.jsx("strong",{children:"Note:"})," If you see old build information after a deployment, clear your browser cache or perform a hard refresh (Ctrl+Shift+R / Cmd+Shift+R)."]})]})})]})};export{U as default};
//# sourceMappingURL=BuildInfoPage-C605GY2m.js.map
