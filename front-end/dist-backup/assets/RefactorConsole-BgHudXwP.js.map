{"version":3,"file":"RefactorConsole-BgHudXwP.js","sources":["../../node_modules/lucide-react/dist/esm/icons/archive.js","../../node_modules/lucide-react/dist/esm/icons/arrow-down-wide-narrow.js","../../node_modules/lucide-react/dist/esm/icons/arrow-up-narrow-wide.js","../../node_modules/lucide-react/dist/esm/icons/calendar.js","../../node_modules/lucide-react/dist/esm/icons/check.js","../../node_modules/lucide-react/dist/esm/icons/clock.js","../../node_modules/lucide-react/dist/esm/icons/code.js","../../node_modules/lucide-react/dist/esm/icons/copy.js","../../node_modules/lucide-react/dist/esm/icons/download.js","../../node_modules/lucide-react/dist/esm/icons/external-link.js","../../node_modules/lucide-react/dist/esm/icons/eye.js","../../node_modules/lucide-react/dist/esm/icons/file-check.js","../../node_modules/lucide-react/dist/esm/icons/file-code.js","../../node_modules/lucide-react/dist/esm/icons/file-search.js","../../node_modules/lucide-react/dist/esm/icons/file-text.js","../../node_modules/lucide-react/dist/esm/icons/file-x.js","../../node_modules/lucide-react/dist/esm/icons/folder-open.js","../../node_modules/lucide-react/dist/esm/icons/folder.js","../../node_modules/lucide-react/dist/esm/icons/funnel.js","../../node_modules/lucide-react/dist/esm/icons/git-branch.js","../../node_modules/lucide-react/dist/esm/icons/git-compare.js","../../node_modules/lucide-react/dist/esm/icons/hard-drive.js","../../node_modules/lucide-react/dist/esm/icons/history.js","../../node_modules/lucide-react/dist/esm/icons/loader-circle.js","../../node_modules/lucide-react/dist/esm/icons/package.js","../../node_modules/lucide-react/dist/esm/icons/rotate-ccw.js","../../node_modules/lucide-react/dist/esm/icons/search.js","../../node_modules/lucide-react/dist/esm/icons/triangle-alert.js","../../node_modules/lucide-react/dist/esm/icons/user.js","../../node_modules/lucide-react/dist/esm/icons/users.js","../../node_modules/lucide-react/dist/esm/icons/zap.js","../../src/features/devel-tools/refactor-console/components/Tree.tsx","../../src/features/devel-tools/refactor-console/components/Legend.tsx","../../src/features/devel-tools/refactor-console/components/Toolbar.tsx","../../src/features/devel-tools/refactor-console/components/RequirementPreviewModal.tsx","../../src/features/devel-tools/refactor-console/components/RestorationStatusBadge.tsx","../../src/features/devel-tools/refactor-console/api/refactorConsoleClient.ts","../../src/features/devel-tools/refactor-console/components/RestoreBundleButton.tsx","../../src/features/devel-tools/refactor-console/components/DiffViewModal.tsx","../../src/features/devel-tools/refactor-console/components/RestoreHistoryViewer.tsx","../../src/features/devel-tools/refactor-console/utils/bundleResolver.ts","../../src/features/devel-tools/refactor-console/hooks/useRefactorScan.ts","../../src/components/admin/SessionPulse.tsx","../../src/features/devel-tools/refactor-console/RefactorConsole.tsx"],"sourcesContent":["/**\n * @license lucide-react v0.534.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst __iconNode = [\n  [\"rect\", { width: \"20\", height: \"5\", x: \"2\", y: \"3\", rx: \"1\", key: \"1wp1u1\" }],\n  [\"path\", { d: \"M4 8v11a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8\", key: \"1s80jp\" }],\n  [\"path\", { d: \"M10 12h4\", key: \"a56b0p\" }]\n];\nconst Archive = createLucideIcon(\"archive\", __iconNode);\n\nexport { __iconNode, Archive as default };\n//# sourceMappingURL=archive.js.map\n","/**\n * @license lucide-react v0.534.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst __iconNode = [\n  [\"path\", { d: \"m3 16 4 4 4-4\", key: \"1co6wj\" }],\n  [\"path\", { d: \"M7 20V4\", key: \"1yoxec\" }],\n  [\"path\", { d: \"M11 4h10\", key: \"1w87gc\" }],\n  [\"path\", { d: \"M11 8h7\", key: \"djye34\" }],\n  [\"path\", { d: \"M11 12h4\", key: \"q8tih4\" }]\n];\nconst ArrowDownWideNarrow = createLucideIcon(\"arrow-down-wide-narrow\", __iconNode);\n\nexport { __iconNode, ArrowDownWideNarrow as default };\n//# sourceMappingURL=arrow-down-wide-narrow.js.map\n","/**\n * @license lucide-react v0.534.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst __iconNode = [\n  [\"path\", { d: \"m3 8 4-4 4 4\", key: \"11wl7u\" }],\n  [\"path\", { d: \"M7 4v16\", key: \"1glfcx\" }],\n  [\"path\", { d: \"M11 12h4\", key: \"q8tih4\" }],\n  [\"path\", { d: \"M11 16h7\", key: \"uosisv\" }],\n  [\"path\", { d: \"M11 20h10\", key: \"jvxblo\" }]\n];\nconst ArrowUpNarrowWide = createLucideIcon(\"arrow-up-narrow-wide\", __iconNode);\n\nexport { __iconNode, ArrowUpNarrowWide as default };\n//# sourceMappingURL=arrow-up-narrow-wide.js.map\n","/**\n * @license lucide-react v0.534.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst __iconNode = [\n  [\"path\", { d: \"M8 2v4\", key: \"1cmpym\" }],\n  [\"path\", { d: \"M16 2v4\", key: \"4m81vk\" }],\n  [\"rect\", { width: \"18\", height: \"18\", x: \"3\", y: \"4\", rx: \"2\", key: \"1hopcy\" }],\n  [\"path\", { d: \"M3 10h18\", key: \"8toen8\" }]\n];\nconst Calendar = createLucideIcon(\"calendar\", __iconNode);\n\nexport { __iconNode, Calendar as default };\n//# sourceMappingURL=calendar.js.map\n","/**\n * @license lucide-react v0.534.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst __iconNode = [[\"path\", { d: \"M20 6 9 17l-5-5\", key: \"1gmf2c\" }]];\nconst Check = createLucideIcon(\"check\", __iconNode);\n\nexport { __iconNode, Check as default };\n//# sourceMappingURL=check.js.map\n","/**\n * @license lucide-react v0.534.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst __iconNode = [\n  [\"path\", { d: \"M12 6v6l4 2\", key: \"mmk7yg\" }],\n  [\"circle\", { cx: \"12\", cy: \"12\", r: \"10\", key: \"1mglay\" }]\n];\nconst Clock = createLucideIcon(\"clock\", __iconNode);\n\nexport { __iconNode, Clock as default };\n//# sourceMappingURL=clock.js.map\n","/**\n * @license lucide-react v0.534.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst __iconNode = [\n  [\"path\", { d: \"m16 18 6-6-6-6\", key: \"eg8j8\" }],\n  [\"path\", { d: \"m8 6-6 6 6 6\", key: \"ppft3o\" }]\n];\nconst Code = createLucideIcon(\"code\", __iconNode);\n\nexport { __iconNode, Code as default };\n//# sourceMappingURL=code.js.map\n","/**\n * @license lucide-react v0.534.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst __iconNode = [\n  [\"rect\", { width: \"14\", height: \"14\", x: \"8\", y: \"8\", rx: \"2\", ry: \"2\", key: \"17jyea\" }],\n  [\"path\", { d: \"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2\", key: \"zix9uf\" }]\n];\nconst Copy = createLucideIcon(\"copy\", __iconNode);\n\nexport { __iconNode, Copy as default };\n//# sourceMappingURL=copy.js.map\n","/**\n * @license lucide-react v0.534.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst __iconNode = [\n  [\"path\", { d: \"M12 15V3\", key: \"m9g1x1\" }],\n  [\"path\", { d: \"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4\", key: \"ih7n3h\" }],\n  [\"path\", { d: \"m7 10 5 5 5-5\", key: \"brsn70\" }]\n];\nconst Download = createLucideIcon(\"download\", __iconNode);\n\nexport { __iconNode, Download as default };\n//# sourceMappingURL=download.js.map\n","/**\n * @license lucide-react v0.534.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst __iconNode = [\n  [\"path\", { d: \"M15 3h6v6\", key: \"1q9fwt\" }],\n  [\"path\", { d: \"M10 14 21 3\", key: \"gplh6r\" }],\n  [\"path\", { d: \"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6\", key: \"a6xqqp\" }]\n];\nconst ExternalLink = createLucideIcon(\"external-link\", __iconNode);\n\nexport { __iconNode, ExternalLink as default };\n//# sourceMappingURL=external-link.js.map\n","/**\n * @license lucide-react v0.534.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst __iconNode = [\n  [\n    \"path\",\n    {\n      d: \"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0\",\n      key: \"1nclc0\"\n    }\n  ],\n  [\"circle\", { cx: \"12\", cy: \"12\", r: \"3\", key: \"1v7zrd\" }]\n];\nconst Eye = createLucideIcon(\"eye\", __iconNode);\n\nexport { __iconNode, Eye as default };\n//# sourceMappingURL=eye.js.map\n","/**\n * @license lucide-react v0.534.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst __iconNode = [\n  [\"path\", { d: \"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z\", key: \"1rqfz7\" }],\n  [\"path\", { d: \"M14 2v4a2 2 0 0 0 2 2h4\", key: \"tnqrlb\" }],\n  [\"path\", { d: \"m9 15 2 2 4-4\", key: \"1grp1n\" }]\n];\nconst FileCheck = createLucideIcon(\"file-check\", __iconNode);\n\nexport { __iconNode, FileCheck as default };\n//# sourceMappingURL=file-check.js.map\n","/**\n * @license lucide-react v0.534.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst __iconNode = [\n  [\"path\", { d: \"M10 12.5 8 15l2 2.5\", key: \"1tg20x\" }],\n  [\"path\", { d: \"m14 12.5 2 2.5-2 2.5\", key: \"yinavb\" }],\n  [\"path\", { d: \"M14 2v4a2 2 0 0 0 2 2h4\", key: \"tnqrlb\" }],\n  [\"path\", { d: \"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7z\", key: \"1mlx9k\" }]\n];\nconst FileCode = createLucideIcon(\"file-code\", __iconNode);\n\nexport { __iconNode, FileCode as default };\n//# sourceMappingURL=file-code.js.map\n","/**\n * @license lucide-react v0.534.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst __iconNode = [\n  [\"path\", { d: \"M14 2v4a2 2 0 0 0 2 2h4\", key: \"tnqrlb\" }],\n  [\n    \"path\",\n    { d: \"M4.268 21a2 2 0 0 0 1.727 1H18a2 2 0 0 0 2-2V7l-5-5H6a2 2 0 0 0-2 2v3\", key: \"ms7g94\" }\n  ],\n  [\"path\", { d: \"m9 18-1.5-1.5\", key: \"1j6qii\" }],\n  [\"circle\", { cx: \"5\", cy: \"14\", r: \"3\", key: \"ufru5t\" }]\n];\nconst FileSearch = createLucideIcon(\"file-search\", __iconNode);\n\nexport { __iconNode, FileSearch as default };\n//# sourceMappingURL=file-search.js.map\n","/**\n * @license lucide-react v0.534.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst __iconNode = [\n  [\"path\", { d: \"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z\", key: \"1rqfz7\" }],\n  [\"path\", { d: \"M14 2v4a2 2 0 0 0 2 2h4\", key: \"tnqrlb\" }],\n  [\"path\", { d: \"M10 9H8\", key: \"b1mrlr\" }],\n  [\"path\", { d: \"M16 13H8\", key: \"t4e002\" }],\n  [\"path\", { d: \"M16 17H8\", key: \"z1uh3a\" }]\n];\nconst FileText = createLucideIcon(\"file-text\", __iconNode);\n\nexport { __iconNode, FileText as default };\n//# sourceMappingURL=file-text.js.map\n","/**\n * @license lucide-react v0.534.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst __iconNode = [\n  [\"path\", { d: \"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z\", key: \"1rqfz7\" }],\n  [\"path\", { d: \"M14 2v4a2 2 0 0 0 2 2h4\", key: \"tnqrlb\" }],\n  [\"path\", { d: \"m14.5 12.5-5 5\", key: \"b62r18\" }],\n  [\"path\", { d: \"m9.5 12.5 5 5\", key: \"1rk7el\" }]\n];\nconst FileX = createLucideIcon(\"file-x\", __iconNode);\n\nexport { __iconNode, FileX as default };\n//# sourceMappingURL=file-x.js.map\n","/**\n * @license lucide-react v0.534.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst __iconNode = [\n  [\n    \"path\",\n    {\n      d: \"m6 14 1.5-2.9A2 2 0 0 1 9.24 10H20a2 2 0 0 1 1.94 2.5l-1.54 6a2 2 0 0 1-1.95 1.5H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h3.9a2 2 0 0 1 1.69.9l.81 1.2a2 2 0 0 0 1.67.9H18a2 2 0 0 1 2 2v2\",\n      key: \"usdka0\"\n    }\n  ]\n];\nconst FolderOpen = createLucideIcon(\"folder-open\", __iconNode);\n\nexport { __iconNode, FolderOpen as default };\n//# sourceMappingURL=folder-open.js.map\n","/**\n * @license lucide-react v0.534.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst __iconNode = [\n  [\n    \"path\",\n    {\n      d: \"M20 20a2 2 0 0 0 2-2V8a2 2 0 0 0-2-2h-7.9a2 2 0 0 1-1.69-.9L9.6 3.9A2 2 0 0 0 7.93 3H4a2 2 0 0 0-2 2v13a2 2 0 0 0 2 2Z\",\n      key: \"1kt360\"\n    }\n  ]\n];\nconst Folder = createLucideIcon(\"folder\", __iconNode);\n\nexport { __iconNode, Folder as default };\n//# sourceMappingURL=folder.js.map\n","/**\n * @license lucide-react v0.534.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst __iconNode = [\n  [\n    \"path\",\n    {\n      d: \"M10 20a1 1 0 0 0 .553.895l2 1A1 1 0 0 0 14 21v-7a2 2 0 0 1 .517-1.341L21.74 4.67A1 1 0 0 0 21 3H3a1 1 0 0 0-.742 1.67l7.225 7.989A2 2 0 0 1 10 14z\",\n      key: \"sc7q7i\"\n    }\n  ]\n];\nconst Funnel = createLucideIcon(\"funnel\", __iconNode);\n\nexport { __iconNode, Funnel as default };\n//# sourceMappingURL=funnel.js.map\n","/**\n * @license lucide-react v0.534.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst __iconNode = [\n  [\"line\", { x1: \"6\", x2: \"6\", y1: \"3\", y2: \"15\", key: \"17qcm7\" }],\n  [\"circle\", { cx: \"18\", cy: \"6\", r: \"3\", key: \"1h7g24\" }],\n  [\"circle\", { cx: \"6\", cy: \"18\", r: \"3\", key: \"fqmcym\" }],\n  [\"path\", { d: \"M18 9a9 9 0 0 1-9 9\", key: \"n2h4wq\" }]\n];\nconst GitBranch = createLucideIcon(\"git-branch\", __iconNode);\n\nexport { __iconNode, GitBranch as default };\n//# sourceMappingURL=git-branch.js.map\n","/**\n * @license lucide-react v0.534.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst __iconNode = [\n  [\"circle\", { cx: \"18\", cy: \"18\", r: \"3\", key: \"1xkwt0\" }],\n  [\"circle\", { cx: \"6\", cy: \"6\", r: \"3\", key: \"1lh9wr\" }],\n  [\"path\", { d: \"M13 6h3a2 2 0 0 1 2 2v7\", key: \"1yeb86\" }],\n  [\"path\", { d: \"M11 18H8a2 2 0 0 1-2-2V9\", key: \"19pyzm\" }]\n];\nconst GitCompare = createLucideIcon(\"git-compare\", __iconNode);\n\nexport { __iconNode, GitCompare as default };\n//# sourceMappingURL=git-compare.js.map\n","/**\n * @license lucide-react v0.534.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst __iconNode = [\n  [\"line\", { x1: \"22\", x2: \"2\", y1: \"12\", y2: \"12\", key: \"1y58io\" }],\n  [\n    \"path\",\n    {\n      d: \"M5.45 5.11 2 12v6a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2v-6l-3.45-6.89A2 2 0 0 0 16.76 4H7.24a2 2 0 0 0-1.79 1.11z\",\n      key: \"oot6mr\"\n    }\n  ],\n  [\"line\", { x1: \"6\", x2: \"6.01\", y1: \"16\", y2: \"16\", key: \"sgf278\" }],\n  [\"line\", { x1: \"10\", x2: \"10.01\", y1: \"16\", y2: \"16\", key: \"1l4acy\" }]\n];\nconst HardDrive = createLucideIcon(\"hard-drive\", __iconNode);\n\nexport { __iconNode, HardDrive as default };\n//# sourceMappingURL=hard-drive.js.map\n","/**\n * @license lucide-react v0.534.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst __iconNode = [\n  [\"path\", { d: \"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8\", key: \"1357e3\" }],\n  [\"path\", { d: \"M3 3v5h5\", key: \"1xhq8a\" }],\n  [\"path\", { d: \"M12 7v5l4 2\", key: \"1fdv2h\" }]\n];\nconst History = createLucideIcon(\"history\", __iconNode);\n\nexport { __iconNode, History as default };\n//# sourceMappingURL=history.js.map\n","/**\n * @license lucide-react v0.534.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst __iconNode = [[\"path\", { d: \"M21 12a9 9 0 1 1-6.219-8.56\", key: \"13zald\" }]];\nconst LoaderCircle = createLucideIcon(\"loader-circle\", __iconNode);\n\nexport { __iconNode, LoaderCircle as default };\n//# sourceMappingURL=loader-circle.js.map\n","/**\n * @license lucide-react v0.534.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst __iconNode = [\n  [\n    \"path\",\n    {\n      d: \"M11 21.73a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73z\",\n      key: \"1a0edw\"\n    }\n  ],\n  [\"path\", { d: \"M12 22V12\", key: \"d0xqtd\" }],\n  [\"polyline\", { points: \"3.29 7 12 12 20.71 7\", key: \"ousv84\" }],\n  [\"path\", { d: \"m7.5 4.27 9 5.15\", key: \"1c824w\" }]\n];\nconst Package = createLucideIcon(\"package\", __iconNode);\n\nexport { __iconNode, Package as default };\n//# sourceMappingURL=package.js.map\n","/**\n * @license lucide-react v0.534.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst __iconNode = [\n  [\"path\", { d: \"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8\", key: \"1357e3\" }],\n  [\"path\", { d: \"M3 3v5h5\", key: \"1xhq8a\" }]\n];\nconst RotateCcw = createLucideIcon(\"rotate-ccw\", __iconNode);\n\nexport { __iconNode, RotateCcw as default };\n//# sourceMappingURL=rotate-ccw.js.map\n","/**\n * @license lucide-react v0.534.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst __iconNode = [\n  [\"path\", { d: \"m21 21-4.34-4.34\", key: \"14j7rj\" }],\n  [\"circle\", { cx: \"11\", cy: \"11\", r: \"8\", key: \"4ej97u\" }]\n];\nconst Search = createLucideIcon(\"search\", __iconNode);\n\nexport { __iconNode, Search as default };\n//# sourceMappingURL=search.js.map\n","/**\n * @license lucide-react v0.534.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst __iconNode = [\n  [\n    \"path\",\n    {\n      d: \"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3\",\n      key: \"wmoenq\"\n    }\n  ],\n  [\"path\", { d: \"M12 9v4\", key: \"juzpu7\" }],\n  [\"path\", { d: \"M12 17h.01\", key: \"p32p05\" }]\n];\nconst TriangleAlert = createLucideIcon(\"triangle-alert\", __iconNode);\n\nexport { __iconNode, TriangleAlert as default };\n//# sourceMappingURL=triangle-alert.js.map\n","/**\n * @license lucide-react v0.534.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst __iconNode = [\n  [\"path\", { d: \"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2\", key: \"975kel\" }],\n  [\"circle\", { cx: \"12\", cy: \"7\", r: \"4\", key: \"17ys0d\" }]\n];\nconst User = createLucideIcon(\"user\", __iconNode);\n\nexport { __iconNode, User as default };\n//# sourceMappingURL=user.js.map\n","/**\n * @license lucide-react v0.534.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst __iconNode = [\n  [\"path\", { d: \"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2\", key: \"1yyitq\" }],\n  [\"path\", { d: \"M16 3.128a4 4 0 0 1 0 7.744\", key: \"16gr8j\" }],\n  [\"path\", { d: \"M22 21v-2a4 4 0 0 0-3-3.87\", key: \"kshegd\" }],\n  [\"circle\", { cx: \"9\", cy: \"7\", r: \"4\", key: \"nufk8\" }]\n];\nconst Users = createLucideIcon(\"users\", __iconNode);\n\nexport { __iconNode, Users as default };\n//# sourceMappingURL=users.js.map\n","/**\n * @license lucide-react v0.534.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst __iconNode = [\n  [\n    \"path\",\n    {\n      d: \"M4 14a1 1 0 0 1-.78-1.63l9.9-10.2a.5.5 0 0 1 .86.46l-1.92 6.02A1 1 0 0 0 13 10h7a1 1 0 0 1 .78 1.63l-9.9 10.2a.5.5 0 0 1-.86-.46l1.92-6.02A1 1 0 0 0 11 14z\",\n      key: \"1xq2db\"\n    }\n  ]\n];\nconst Zap = createLucideIcon(\"zap\", __iconNode);\n\nexport { __iconNode, Zap as default };\n//# sourceMappingURL=zap.js.map\n","import React, { useState, useEffect, memo } from 'react';\r\nimport { \r\n  ChevronRight, \r\n  ChevronDown, \r\n  Folder, \r\n  FileCode, \r\n  GitBranch,\r\n  AlertTriangle,\r\n  CheckCircle,\r\n  Clock,\r\n  XCircle,\r\n  Copy,\r\n  ExternalLink,\r\n  Eye,\r\n  MoreHorizontal,\r\n  Archive,\r\n  RotateCcw,\r\n  FileX,\r\n  FileCheck\r\n} from 'lucide-react';\r\nimport { TreeItem, RecoveryStatus } from '@/types/refactorConsole';\r\nimport { useTheme } from '@mui/material/styles';\r\n\r\n// Browser-compatible path utilities\r\nconst pathBasename = (filePath: string): string => {\r\n  const parts = filePath.split('/');\r\n  return parts[parts.length - 1] || '/';\r\n};\r\n\r\nconst pathExtname = (filePath: string): string => {\r\n  const basename = pathBasename(filePath);\r\n  const lastDot = basename.lastIndexOf('.');\r\n  return lastDot >= 0 ? basename.slice(lastDot) : '';\r\n};\r\n\r\nconst pathDirname = (filePath: string): string => {\r\n  const parts = filePath.split('/');\r\n  return parts.slice(0, -1).join('/') || '/';\r\n};\r\n\r\ninterface TreeProps {\r\n  treeItems: TreeItem[];\r\n  expandedPaths: Set<string>;\r\n  onToggleExpanded: (path: string) => void;\r\n  onNodeAction: (action: string, node: TreeItem) => void;\r\n  className?: string;\r\n  isDark?: boolean;\r\n}\r\n\r\n\r\nconst getRecoveryStatusIcon = (recoveryStatus?: RecoveryStatus) => {\r\n  if (!recoveryStatus) return null;\r\n  \r\n  switch (recoveryStatus) {\r\n    case 'missing_in_prod':\r\n      return <FileX className=\"w-4 h-4 text-purple-500\" title=\"Missing in production\" />;\r\n    case 'modified_since_backup':\r\n      return <AlertTriangle className=\"w-4 h-4 text-orange-500\" title=\"Modified since backup\" />;\r\n    case 'new_file':\r\n      return <FileCheck className=\"w-4 h-4 text-green-500\" title=\"New file (not in backup)\" />;\r\n    case 'unchanged':\r\n      return <CheckCircle className=\"w-4 h-4 text-gray-400\" title=\"Unchanged since backup\" />;\r\n    default:\r\n      return null;\r\n  }\r\n};\r\n\r\nconst getRecoveryStatusColor = (recoveryStatus?: RecoveryStatus): string => {\r\n  if (!recoveryStatus) return '';\r\n  \r\n  switch (recoveryStatus) {\r\n    case 'missing_in_prod':\r\n      return 'border-l-4 border-purple-500 dark:border-purple-400 bg-purple-50 dark:bg-purple-900/20';\r\n    case 'modified_since_backup':\r\n      return 'border-l-4 border-orange-500 dark:border-orange-400 bg-orange-50 dark:bg-orange-900/20';\r\n    case 'new_file':\r\n      return 'border-l-4 border-green-500 dark:border-green-400 bg-green-50 dark:bg-green-900/20';\r\n    case 'unchanged':\r\n      return '';\r\n    default:\r\n      return '';\r\n  }\r\n};\r\n\r\nconst getClassificationIcon = (classification: string) => {\r\n  switch (classification) {\r\n    case 'green':\r\n      return <CheckCircle className=\"w-4 h-4 text-green-500\" />;\r\n    case 'orange':\r\n      return <AlertTriangle className=\"w-4 h-4 text-orange-500\" />;\r\n    case 'yellow':\r\n      return <Clock className=\"w-4 h-4 text-yellow-500\" />;\r\n      case 'red':\r\n        return <XCircle className=\"w-4 h-4 text-red-500\" />;\r\n    default:\r\n      return <FileCode className=\"w-4 h-4 text-gray-400\" />;\r\n  }\r\n};\r\n\r\n// Text colors are now handled inline in TreeNode using isDark prop\r\n\r\nconst getFileIcon = (filePath: string) => {\r\n  const extension = pathExtname(filePath).toLowerCase();\r\n  \r\n  switch (extension) {\r\n    case 'tsx':\r\n    case 'ts':\r\n      return <FileCode className=\"w-4 h-4 text-blue-500\" />;\r\n    case 'jsx':\r\n    case 'js':\r\n      return <FileCode className=\"w-4 h-4 text-yellow-500\" />;\r\n    case 'css':\r\n    case 'scss':\r\n      return <FileCode className=\"w-4 h-4 text-purple-500\" />;\r\n    case 'json':\r\n      return <FileCode className=\"w-4 h-4 text-green-500\" />;\r\n    default:\r\n      return <FileCode className=\"w-4 h-4 text-gray-400\" />;\r\n  }\r\n};\r\n\r\ninterface TreeNodeProps {\r\n  item: TreeItem;\r\n  level: number;\r\n  onToggleExpanded: (path: string) => void;\r\n  onNodeAction: (action: string, node: TreeItem) => void;\r\n  showBadges?: boolean;\r\n  isDark?: boolean;\r\n}\r\n\r\nconst TreeNode = memo<TreeNodeProps>(({ \r\n  item, \r\n  level, \r\n  onToggleExpanded, \r\n  onNodeAction,\r\n  showBadges = true,\r\n  isDark = false\r\n}) => {\r\n  const [showActions, setShowActions] = useState(false);\r\n  const isExpanded = item.expanded;\r\n  const hasChildren = item.children && item.children.length > 0;\r\n  const isDirectory = item.type === 'dir';\r\n  \r\n  const indentStyle = { marginLeft: `${level * 16}px` };\r\n  \r\n  // Get text color based on classification and dark mode\r\n  const getTextColor = () => {\r\n    switch (item.classification) {\r\n      case 'green': return isDark ? '#4ade80' : '#15803d';\r\n      case 'orange': return isDark ? '#fb923c' : '#c2410c';\r\n      case 'yellow': return isDark ? '#facc15' : '#a16207';\r\n      case 'red': return isDark ? '#f87171' : '#b91c1c';\r\n      default: return isDark ? '#d1d5db' : '#374151';\r\n    }\r\n  };\r\n  \r\n  const textColor = getTextColor();\r\n  \r\n  const handleAction = (e: React.MouseEvent, action: string) => {\r\n    e.stopPropagation();\r\n    onNodeAction(action, item);\r\n    setShowActions(false);\r\n  };\r\n  \r\n  const renderBadges = () => {\r\n    if (!showBadges) return null;\r\n    \r\n    const badges = [];\r\n    \r\n    // Badge style helper\r\n    const getBadgeStyle = (type: string) => {\r\n      const styles: Record<string, { bg: string; text: string; border?: string }> = {\r\n        purple: {\r\n          bg: isDark ? 'rgba(147, 51, 234, 0.25)' : '#f3e8ff',\r\n          text: isDark ? '#d8b4fe' : '#7e22ce',\r\n          border: isDark ? '#7c3aed' : '#c4b5fd'\r\n        },\r\n        orange: {\r\n          bg: isDark ? 'rgba(234, 88, 12, 0.25)' : '#ffedd5',\r\n          text: isDark ? '#fdba74' : '#c2410c',\r\n          border: isDark ? '#ea580c' : '#fdba74'\r\n        },\r\n        green: {\r\n          bg: isDark ? 'rgba(34, 197, 94, 0.25)' : '#dcfce7',\r\n          text: isDark ? '#86efac' : '#15803d',\r\n          border: isDark ? '#22c55e' : '#86efac'\r\n        },\r\n        yellow: {\r\n          bg: isDark ? 'rgba(234, 179, 8, 0.25)' : '#fef9c3',\r\n          text: isDark ? '#fde047' : '#a16207',\r\n          border: isDark ? '#eab308' : '#fde047'\r\n        },\r\n        red: {\r\n          bg: isDark ? 'rgba(239, 68, 68, 0.25)' : '#fee2e2',\r\n          text: isDark ? '#fca5a5' : '#b91c1c',\r\n          border: isDark ? '#ef4444' : '#fca5a5'\r\n        },\r\n        blue: {\r\n          bg: isDark ? 'rgba(59, 130, 246, 0.25)' : '#dbeafe',\r\n          text: isDark ? '#93c5fd' : '#1e40af'\r\n        },\r\n        gray: {\r\n          bg: isDark ? '#374151' : '#f3f4f6',\r\n          text: isDark ? '#9ca3af' : '#4b5563',\r\n          border: isDark ? '#4b5563' : '#d1d5db'\r\n        }\r\n      };\r\n      return styles[type] || styles.gray;\r\n    };\r\n    \r\n    // Recovery status badge (highest priority)\r\n    if (item.recoveryStatus) {\r\n      const statusLabels = {\r\n        'missing_in_prod': 'MISSING',\r\n        'modified_since_backup': 'MODIFIED',\r\n        'new_file': 'NEW',\r\n        'unchanged': 'UNCHANGED'\r\n      };\r\n      const statusTypes = {\r\n        'missing_in_prod': 'purple',\r\n        'modified_since_backup': 'orange',\r\n        'new_file': 'green',\r\n        'unchanged': 'gray'\r\n      };\r\n      const style = getBadgeStyle(statusTypes[item.recoveryStatus]);\r\n      badges.push(\r\n        <span \r\n          key=\"recovery\"\r\n          className=\"text-xs px-2 py-1 rounded-full font-medium\"\r\n          style={{\r\n            backgroundColor: style.bg,\r\n            color: style.text,\r\n            border: style.border ? `1px solid ${style.border}` : 'none'\r\n          }}\r\n        >\r\n          {statusLabels[item.recoveryStatus]}\r\n        </span>\r\n      );\r\n    }\r\n    \r\n    // Classification badge\r\n    const classStyle = getBadgeStyle(item.classification === 'green' ? 'green' : \r\n                                     item.classification === 'orange' ? 'orange' :\r\n                                     item.classification === 'yellow' ? 'yellow' : 'red');\r\n    badges.push(\r\n      <span \r\n        key=\"classification\"\r\n        className=\"text-xs px-2 py-1 rounded-full font-medium\"\r\n        style={{\r\n          backgroundColor: classStyle.bg,\r\n          color: classStyle.text\r\n        }}\r\n      >\r\n        {item.classification.toUpperCase()}\r\n      </span>\r\n    );\r\n    \r\n    // Usage score badge\r\n    if (item.type === 'file') {\r\n      const blueStyle = getBadgeStyle('blue');\r\n      badges.push(\r\n        <span \r\n          key=\"score\" \r\n          className=\"text-xs px-2 py-1 rounded-full font-medium\"\r\n          style={{\r\n            backgroundColor: blueStyle.bg,\r\n            color: blueStyle.text\r\n          }}\r\n        >\r\n          Score: {item.usage.score}\r\n        </span>\r\n      );\r\n    }\r\n    \r\n    // Duplicate badge\r\n    if (item.similarity?.duplicates.length || item.similarity?.nearMatches.length) {\r\n      const redStyle = getBadgeStyle('red');\r\n      badges.push(\r\n        <span \r\n          key=\"duplicates\" \r\n          className=\"text-xs px-2 py-1 rounded-full font-medium flex items-center gap-1\"\r\n          style={{\r\n            backgroundColor: redStyle.bg,\r\n            color: redStyle.text\r\n          }}\r\n        >\r\n          <GitBranch className=\"w-3 h-3\" />\r\n          Dupes\r\n        </span>\r\n      );\r\n    }\r\n    \r\n    // Feature path badge\r\n    if (item.featurePathMatch) {\r\n      const greenStyle = getBadgeStyle('green');\r\n      badges.push(\r\n        <span \r\n          key=\"feature\" \r\n          className=\"text-xs px-2 py-1 rounded-full font-medium\"\r\n          style={{\r\n            backgroundColor: greenStyle.bg,\r\n            color: greenStyle.text\r\n          }}\r\n        >\r\n          Feature\r\n        </span>\r\n      );\r\n    }\r\n    \r\n    return (\r\n      <div className=\"flex gap-1 flex-wrap\">\r\n        {badges}\r\n      </div>\r\n    );\r\n  };\r\n  \r\n  return (\r\n    <div \r\n      className=\"flex items-center gap-2 py-2 px-3 cursor-pointer group\"\r\n      style={{\r\n        ...indentStyle,\r\n        color: textColor,\r\n        backgroundColor: 'transparent',\r\n        transition: 'background-color 0.15s'\r\n      }}\r\n      onMouseEnter={(e) => {\r\n        setShowActions(true);\r\n        e.currentTarget.style.backgroundColor = isDark ? 'rgba(55, 65, 81, 0.5)' : '#f9fafb';\r\n      }}\r\n      onMouseLeave={(e) => {\r\n        setShowActions(false);\r\n        e.currentTarget.style.backgroundColor = 'transparent';\r\n      }}\r\n    >\r\n      {/* Expand/Collapse Button */}\r\n      {hasChildren && (\r\n        <button\r\n          onClick={(e) => {\r\n            e.stopPropagation();\r\n            onToggleExpanded(item.path);\r\n          }}\r\n          className=\"flex items-center justify-center w-4 h-4 rounded transition-colors\"\r\n          style={{ color: isDark ? '#9ca3af' : '#6b7280' }}\r\n          onMouseEnter={(e) => {\r\n            e.currentTarget.style.backgroundColor = isDark ? '#4b5563' : '#e5e7eb';\r\n          }}\r\n          onMouseLeave={(e) => {\r\n            e.currentTarget.style.backgroundColor = 'transparent';\r\n          }}\r\n        >\r\n          {isExpanded ? (\r\n            <ChevronDown className=\"w-3 h-3\" />\r\n          ) : (\r\n            <ChevronRight className=\"w-3 h-3\" />\r\n          )}\r\n        </button>\r\n      )}\r\n      \r\n      {!hasChildren && <div className=\"w-4 h-4\" />}\r\n      \r\n      {/* File/Directory Icon */}\r\n      <div className=\"flex items-center\">\r\n        {isDirectory ? (\r\n          <Folder className=\"w-4 h-4 text-blue-500\" />\r\n        ) : (\r\n          getFileIcon(item.path)\r\n        )}\r\n      </div>\r\n      \r\n      {/* Recovery Status Icon (if in recovery mode) */}\r\n      {item.recoveryStatus && (\r\n        <div className=\"flex items-center\">\r\n          {getRecoveryStatusIcon(item.recoveryStatus)}\r\n        </div>\r\n      )}\r\n      \r\n      {/* Classification Icon */}\r\n      <div className=\"flex items-center\">\r\n        {getClassificationIcon(item.classification)}\r\n      </div>\r\n      \r\n      {/* File/Directory Name */}\r\n      <div className=\"flex-1 min-w-0\">\r\n        <div \r\n          className=\"text-sm font-medium truncate\"\r\n          style={{ color: textColor }}\r\n        >\r\n          {item.type === 'dir' ? pathBasename(item.path) : pathBasename(item.relPath)}\r\n        </div>\r\n        {item.type === 'file' && (\r\n          <div \r\n            className=\"text-xs truncate\"\r\n            style={{ color: isDark ? '#9ca3af' : '#6b7280' }}\r\n          >\r\n            {item.relPath}\r\n          </div>\r\n        )}\r\n      </div>\r\n      \r\n      {/* Action Buttons */}\r\n      {showActions && (\r\n        <div className=\"flex items-center gap-1\">\r\n          <button\r\n            onClick={(e) => handleAction(e, 'copy')}\r\n            className=\"p-1 rounded\"\r\n            style={{ color: isDark ? '#d1d5db' : '#4b5563' }}\r\n            onMouseEnter={(e) => e.currentTarget.style.backgroundColor = isDark ? '#4b5563' : '#e5e7eb'}\r\n            onMouseLeave={(e) => e.currentTarget.style.backgroundColor = 'transparent'}\r\n            title=\"Copy relative path\"\r\n          >\r\n            <Copy className=\"w-4 h-4\" />\r\n          </button>\r\n          \r\n          {item.type === 'file' && (\r\n            <button\r\n              onClick={(e) => handleAction(e, 'open')}\r\n              className=\"p-1 rounded\"\r\n              style={{ color: isDark ? '#d1d5db' : '#4b5563' }}\r\n              onMouseEnter={(e) => e.currentTarget.style.backgroundColor = isDark ? '#4b5563' : '#e5e7eb'}\r\n              onMouseLeave={(e) => e.currentTarget.style.backgroundColor = 'transparent'}\r\n              title=\"Open in editor\"\r\n            >\r\n              <ExternalLink className=\"w-4 h-4\" />\r\n            </button>\r\n          )}\r\n          \r\n          {/* Restore button (only for missing files) */}\r\n          {item.recoveryStatus === 'missing_in_prod' && item.type === 'file' && (\r\n            <button\r\n              onClick={(e) => handleAction(e, 'restore')}\r\n              className=\"p-1 rounded\"\r\n              style={{ color: isDark ? '#c084fc' : '#9333ea' }}\r\n              onMouseEnter={(e) => e.currentTarget.style.backgroundColor = isDark ? 'rgba(147, 51, 234, 0.3)' : '#e9d5ff'}\r\n              onMouseLeave={(e) => e.currentTarget.style.backgroundColor = 'transparent'}\r\n              title=\"Restore from backup\"\r\n            >\r\n              <RotateCcw className=\"w-4 h-4\" />\r\n            </button>\r\n          )}\r\n          \r\n          <button\r\n            onClick={(e) => handleAction(e, 'reasons')}\r\n            className=\"p-1 rounded\"\r\n            style={{ color: isDark ? '#d1d5db' : '#4b5563' }}\r\n            onMouseEnter={(e) => e.currentTarget.style.backgroundColor = isDark ? '#4b5563' : '#e5e7eb'}\r\n            onMouseLeave={(e) => e.currentTarget.style.backgroundColor = 'transparent'}\r\n            title=\"View classification reasons\"\r\n          >\r\n            <Eye className=\"w-4 h-4\" />\r\n          </button>\r\n        </div>\r\n      )}\r\n      \r\n      {/* Badges */}\r\n      <div className=\"flex-shrink-0 mr-2\">\r\n        {renderBadges()}\r\n      </div>\r\n    </div>\r\n  );\r\n});\r\n\r\nconst Tree = memo<TreeProps>(({ \r\n  treeItems, \r\n  expandedPaths, \r\n  onToggleExpanded, \r\n  onNodeAction,\r\n  className = '',\r\n  isDark: isDarkProp\r\n}) => {\r\n  const theme = useTheme();\r\n  const isDark = isDarkProp !== undefined ? isDarkProp : theme.palette.mode === 'dark';\r\n  const [flattenedList, setFlattenedList] = useState<TreeItem[]>([]);\r\n  \r\n  // Flatten tree for virtualization\r\n  const flattenTree = (items: TreeItem[], level: number = 0): TreeItem[] => {\r\n    const result: TreeItem[] = [];\r\n    \r\n    items.forEach(item => {\r\n      const flattenedItem = { ...item, level };\r\n      result.push(flattenedItem);\r\n      \r\n      if (item.children && item.children.length > 0 && item.expanded) {\r\n        result.push(...flattenTree(item.children, level + 1));\r\n      }\r\n    });\r\n    \r\n    return result;\r\n  };\r\n  \r\n  useEffect(() => {\r\n    const flattened = flattenTree(treeItems);\r\n    setFlattenedList(flattened);\r\n  }, [treeItems, expandedPaths]);\r\n  \r\n  if (treeItems.length === 0) {\r\n    return (\r\n      <div \r\n        className=\"flex items-center justify-center h-64 rounded-lg\"\r\n        style={{\r\n          backgroundColor: isDark ? '#1f2937' : '#ffffff',\r\n          border: `1px solid ${isDark ? '#374151' : '#e5e7eb'}`,\r\n          color: isDark ? '#9ca3af' : '#6b7280'\r\n        }}\r\n      >\r\n        <div className=\"text-center\">\r\n          <FileCode \r\n            className=\"w-8 h-8 mx-auto mb-2\" \r\n            style={{ color: isDark ? '#6b7280' : '#9ca3af' }}\r\n          />\r\n          <p>No files found matching current filters</p>\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n  \r\n  return (\r\n    <div \r\n      className={`rounded-lg ${className}`}\r\n      style={{\r\n        backgroundColor: isDark ? '#1f2937' : '#ffffff',\r\n        border: `1px solid ${isDark ? '#374151' : '#e5e7eb'}`\r\n      }}\r\n    >\r\n      <div \r\n        className=\"p-4\"\r\n        style={{\r\n          backgroundColor: isDark ? 'rgba(55, 65, 81, 0.5)' : '#f9fafb',\r\n          borderBottom: `1px solid ${isDark ? '#374151' : '#e5e7eb'}`\r\n        }}\r\n      >\r\n        <div className=\"flex items-center justify-between\">\r\n          <h3 \r\n            className=\"font-medium\"\r\n            style={{ color: isDark ? '#f3f4f6' : '#111827' }}\r\n          >\r\n            File Tree ({flattenedList.length} items)\r\n          </h3>\r\n          <div \r\n            className=\"text-sm\"\r\n            style={{ color: isDark ? '#9ca3af' : '#6b7280' }}\r\n          >\r\n            {treeItems.length} root items\r\n          </div>\r\n        </div>\r\n      </div>\r\n      \r\n      <div \r\n        className=\"overflow-auto\" \r\n        style={{ \r\n          maxHeight: '600px',\r\n          backgroundColor: isDark ? '#1f2937' : '#ffffff'\r\n        }}\r\n      >\r\n        {flattenedList.map((item, index) => (\r\n          <TreeNode\r\n            key={`${item.path}-${index}`}\r\n            item={item}\r\n            level={(item as any).level || 0}\r\n            onToggleExpanded={onToggleExpanded}\r\n            onNodeAction={onNodeAction}\r\n            isDark={isDark}\r\n          />\r\n        ))}\r\n      </div>\r\n    </div>\r\n  );\r\n});\r\n\r\nTree.displayName = 'Tree';\r\nTreeNode.displayName = 'TreeNode';\r\n\r\nexport default Tree;\r\n","import React from 'react';\r\nimport { \r\n  CheckCircle, \r\n  AlertTriangle, \r\n  Clock, \r\n  XCircle,\r\n  GitBranch,\r\n  Zap,\r\n  Calendar,\r\n  FileText\r\n} from 'lucide-react';\r\nimport { useTheme, alpha } from '@mui/material/styles';\r\nimport { Paper, Box, Button, ButtonGroup, Typography } from '@mui/material';\r\nimport { Classification, RefactorScan, FilterState } from '@/types/refactorConsole';\r\n\r\ninterface LegendProps {\r\n  scanData: RefactorScan | null;\r\n  filterState: FilterState;\r\n  onFilterChange: (updates: Partial<FilterState>) => void;\r\n  className?: string;\r\n}\r\n\r\nconst Legend: React.FC<LegendProps> = ({ \r\n  scanData, \r\n  filterState, \r\n  onFilterChange,\r\n  className = ''\r\n}) => {\r\n  const theme = useTheme();\r\n  const isDark = theme.palette.mode === 'dark';\r\n  \r\n  if (!scanData) return null;\r\n\r\n  const classificationConfigs = [\r\n    {\r\n      key: 'green' as Classification,\r\n      label: 'Production Ready',\r\n      icon: CheckCircle,\r\n      description: 'Likely in production and actively used',\r\n      color: 'green',\r\n      count: scanData.summary.likelyInProd\r\n    },\r\n    {\r\n      key: 'orange' as Classification,\r\n      label: 'High Risk',\r\n      icon: AlertTriangle,\r\n      description: 'May be used by multiple feature areas',\r\n      color: 'orange',\r\n      count: scanData.summary.highRisk\r\n    },\r\n    {\r\n      key: 'yellow' as Classification,\r\n      label: 'In Development',\r\n      icon: Clock,\r\n      description: 'Development files or low usage, recent edits',\r\n      color: 'yellow',\r\n      count: scanData.summary.inDevelopment\r\n    },\r\n    {\r\n      key: 'red' as Classification,\r\n      label: 'Legacy/Duplicate',\r\n      icon: XCircle,\r\n      description: 'Duplicates, legacy patterns, or old files',\r\n      color: 'red',\r\n      count: scanData.summary.legacyOrDupes\r\n    }\r\n  ];\r\n\r\n  const handleClassificationToggle = (classification: Classification) => {\r\n    const newClassifications = filterState.classifications.includes(classification)\r\n      ? filterState.classifications.filter(c => c !== classification)\r\n      : [...filterState.classifications, classification];\r\n    \r\n    onFilterChange({ classifications: newClassifications });\r\n  };\r\n\r\n  const handleSelectAllClassifications = () => {\r\n    onFilterChange({ classifications: ['green', 'orange', 'yellow', 'red'] });\r\n  };\r\n\r\n  const handleDeselectAllClassifications = () => {\r\n    onFilterChange({ classifications: [] });\r\n  };\r\n\r\n  // Get theme-aware styles for each classification\r\n  const getColorStyles = (color: string) => {\r\n    const colorMap: Record<string, { main: string; light: string; dark: string }> = {\r\n      green: { main: theme.palette.success.main, light: theme.palette.success.light, dark: theme.palette.success.dark },\r\n      orange: { main: theme.palette.warning.main, light: theme.palette.warning.light, dark: theme.palette.warning.dark },\r\n      yellow: { main: theme.palette.warning.main, light: theme.palette.warning.light, dark: theme.palette.warning.dark },\r\n      red: { main: theme.palette.error.main, light: theme.palette.error.light, dark: theme.palette.error.dark },\r\n    };\r\n    const colors = colorMap[color] || { main: theme.palette.grey[500], light: theme.palette.grey[100], dark: theme.palette.grey[700] };\r\n    return {\r\n      bgcolor: alpha(colors.main, isDark ? 0.15 : 0.12),\r\n      color: isDark ? colors.light : colors.dark,\r\n      borderColor: alpha(colors.main, isDark ? 0.5 : 0.4),\r\n      iconColor: isDark ? colors.light : colors.main,\r\n    };\r\n  };\r\n\r\n  return (\r\n    <Paper \r\n      elevation={0}\r\n      sx={{ \r\n        bgcolor: 'background.paper',\r\n        border: 1,\r\n        borderColor: 'divider',\r\n        borderRadius: 1\r\n      }}\r\n      className={className}\r\n    >\r\n      {/* Header */}\r\n      <Box \r\n        sx={{ \r\n          p: 2,\r\n          borderBottom: 1,\r\n          borderColor: 'divider'\r\n        }}\r\n      >\r\n        <Box sx={{ display: 'flex', alignItems: 'center', justifyContent: 'space-between' }}>\r\n          <Typography variant=\"subtitle1\" fontWeight={600}>\r\n            Classification Legend\r\n          </Typography>\r\n          <ButtonGroup size=\"small\" variant=\"outlined\">\r\n            <Button onClick={handleSelectAllClassifications} color=\"info\" sx={{ textTransform: 'none', fontSize: '0.75rem' }}>\r\n              All\r\n            </Button>\r\n            <Button onClick={handleDeselectAllClassifications} color=\"inherit\" sx={{ textTransform: 'none', fontSize: '0.75rem' }}>\r\n              None\r\n            </Button>\r\n          </ButtonGroup>\r\n        </Box>\r\n      </Box>\r\n\r\n      {/* Classification Items */}\r\n      <Box sx={{ p: 2, display: 'flex', flexDirection: 'column', gap: 1.5 }}>\r\n        {classificationConfigs.map((config) => {\r\n          const styles = getColorStyles(config.color);\r\n          const Icon = config.icon;\r\n          const isSelected = filterState.classifications.includes(config.key);\r\n\r\n          return (\r\n            <Box\r\n              key={config.key}\r\n              onClick={() => handleClassificationToggle(config.key)}\r\n              sx={{\r\n                p: 1.5,\r\n                borderRadius: 1,\r\n                border: 2,\r\n                cursor: 'pointer',\r\n                transition: 'all 0.2s',\r\n                bgcolor: isSelected ? styles.bgcolor : 'action.hover',\r\n                borderColor: isSelected ? styles.borderColor : 'divider',\r\n                '&:hover': {\r\n                  bgcolor: isSelected ? styles.bgcolor : 'action.selected',\r\n                }\r\n              }}\r\n            >\r\n              <Box sx={{ display: 'flex', alignItems: 'center', gap: 1.5 }}>\r\n                <Box\r\n                  sx={{\r\n                    display: 'flex',\r\n                    alignItems: 'center',\r\n                    justifyContent: 'center',\r\n                    width: 24,\r\n                    height: 24,\r\n                    borderRadius: 0.5,\r\n                    bgcolor: isSelected ? styles.bgcolor : 'action.selected'\r\n                  }}\r\n                >\r\n                  <Icon \r\n                    className=\"w-4 h-4\" \r\n                    style={{ color: isSelected ? styles.iconColor : theme.palette.text.disabled }} \r\n                  />\r\n                </Box>\r\n                \r\n                <Box sx={{ flex: 1 }}>\r\n                  <Typography \r\n                    variant=\"body2\" \r\n                    fontWeight={500}\r\n                    color={isSelected ? styles.color : 'text.primary'}\r\n                  >\r\n                    {config.label}\r\n                  </Typography>\r\n                  <Typography \r\n                    variant=\"caption\" \r\n                    color={isSelected ? styles.color : 'text.secondary'}\r\n                  >\r\n                    {config.description}\r\n                  </Typography>\r\n                </Box>\r\n                \r\n                <Typography \r\n                  variant=\"body2\" \r\n                  fontWeight={500}\r\n                  color={isSelected ? styles.color : 'text.secondary'}\r\n                >\r\n                  {config.count}\r\n                </Typography>\r\n              </Box>\r\n            </Box>\r\n          );\r\n        })}\r\n      </Box>\r\n\r\n      {/* Summary Statistics */}\r\n      <Box \r\n        sx={{ \r\n          p: 2,\r\n          borderTop: 1,\r\n          borderColor: 'divider',\r\n          bgcolor: 'action.hover'\r\n        }}\r\n      >\r\n        <Box sx={{ display: 'grid', gridTemplateColumns: '1fr 1fr', gap: 2, textAlign: 'center' }}>\r\n          <Box>\r\n            <Typography variant=\"h5\" fontWeight={700}>\r\n              {scanData.summary.totalFiles}\r\n            </Typography>\r\n            <Typography variant=\"body2\" color=\"text.secondary\">Total Files</Typography>\r\n          </Box>\r\n          <Box>\r\n            <Typography variant=\"h5\" fontWeight={700}>\r\n              {scanData.summary.totalDirs}\r\n            </Typography>\r\n            <Typography variant=\"body2\" color=\"text.secondary\">Directories</Typography>\r\n          </Box>\r\n          <Box sx={{ gridColumn: 'span 2', mt: 1 }}>\r\n            <Box sx={{ display: 'flex', alignItems: 'center', gap: 2, justifyContent: 'center' }}>\r\n              <Box sx={{ display: 'flex', alignItems: 'center', gap: 0.5 }}>\r\n                <GitBranch className=\"w-4 h-4\" />\r\n                <Typography variant=\"body2\" color=\"text.secondary\">\r\n                  {scanData.summary.duplicates} duplicates\r\n                </Typography>\r\n              </Box>\r\n              <Box sx={{ display: 'flex', alignItems: 'center', gap: 0.5 }}>\r\n                <Calendar className=\"w-4 h-4\" />\r\n                <Typography variant=\"body2\" color=\"text.secondary\">\r\n                  Last scan: {new Date(scanData.generatedAt).toLocaleTimeString()}\r\n                </Typography>\r\n              </Box>\r\n            </Box>\r\n          </Box>\r\n        </Box>\r\n      </Box>\r\n    </Paper>\r\n  );\r\n};\r\n\r\nexport default Legend;\r\n","import React, { useState } from 'react';\r\nimport {\r\n  Search,\r\n  RefreshCw,\r\n  Filter,\r\n  SortAsc,\r\n  SortDesc,\r\n  ChevronDown,\r\n  Zap,\r\n  FileSearch,\r\n  Calendar,\r\n  AlertCircle,\r\n  Save,\r\n  Settings,\r\n  Archive,\r\n  RotateCcw\r\n} from 'lucide-react';\r\nimport { useTheme, alpha } from '@mui/material/styles';\r\nimport { Paper, Box, TextField, Select, MenuItem, FormControl, InputLabel, Chip, Button } from '@mui/material';\r\nimport { FilterState, SortOption } from '@/types/refactorConsole';\r\n\r\ninterface ToolbarProps {\r\n  searchQuery: string;\r\n  onSearchChange: (query: string) => void;\r\n  \r\n  sortOptions: SortOption[];\r\n  currentSort: SortOption;\r\n  onSortChange: (sort: SortOption) => void;\r\n  \r\n  filterState: FilterState;\r\n  onFilterChange: (updates: Partial<FilterState>) => void;\r\n  \r\n  isLoading: boolean;\r\n  onRefresh: () => void;\r\n  onAnalyze: () => void;\r\n  \r\n  filteredCount: number;\r\n  totalCount: number;\r\n  \r\n  // Gap Analysis / Recovery Mode\r\n  compareWithBackup?: boolean;\r\n  onToggleRecoveryMode?: () => void;\r\n  \r\n  className?: string;\r\n}\r\n\r\nconst Toolbar: React.FC<ToolbarProps> = ({\r\n  searchQuery,\r\n  onSearchChange,\r\n  sortOptions,\r\n  currentSort,\r\n  onSortChange,\r\n  filterState,\r\n  onFilterChange,\r\n  isLoading,\r\n  onRefresh,\r\n  onAnalyze,\r\n  filteredCount,\r\n  totalCount,\r\n  compareWithBackup = false,\r\n  onToggleRecoveryMode,\r\n  className = ''\r\n}) => {\r\n  const theme = useTheme();\r\n  const [showFilters, setShowFilters] = useState(false);\r\n  const [showFileTypePicker, setShowFileTypePicker] = useState(false);\r\n  const [showSortPicker, setShowSortPicker] = useState(false);\r\n\r\n  const fileTypes = [\r\n    { label: 'All Files', value: '' },\r\n    { label: 'TypeScript', value: '.ts' },\r\n    { label: 'TSX Components', value: '.tsx' },\r\n    { label: 'JavaScript', value: '.js' },\r\n    { label: 'JSX Components', value: '.jsx' },\r\n    { label: 'CSS/SCSS', value: '.css' },\r\n    { label: 'JSON', value: '.json' },\r\n    { label: 'Configuration', value: ['.json', '.yaml', '.yml', '.toml'] },\r\n  ];\r\n\r\n  const modifiedTimeOptions = [\r\n    { label: 'All Time', value: 0 },\r\n    { label: 'Last 24 Hours', value: 1 },\r\n    { label: 'Last 7 Days', value: 7 },\r\n    { label: 'Last 30 Days', value: 30 },\r\n    { label: 'Last 90 Days', value: 90 },\r\n  ];\r\n\r\n  const handleFileTypeSelect = (value: string | string[]) => {\r\n    onFilterChange({ \r\n      fileType: Array.isArray(value) ? value[0] : value \r\n    });\r\n    setShowFileTypePicker(false);\r\n  };\r\n\r\n  const handleSortSelect = (sort: SortOption) => {\r\n    onSortChange(sort);\r\n    setShowSortPicker(false);\r\n  };\r\n\r\n  const handleModifiedTimeSelect = (days: number) => {\r\n    onFilterChange({ modifiedDays: days });\r\n  };\r\n\r\n  const clearFilters = () => {\r\n    onFilterChange({\r\n      classifications: ['green', 'orange', 'yellow', 'red'],\r\n      searchQuery: '',\r\n      fileType: '',\r\n      modifiedDays: 0,\r\n      showDuplicates: false,\r\n    });\r\n  };\r\n\r\n  const hasActiveFilters = \r\n    filterState.searchQuery.trim() !== '' ||\r\n    filterState.fileType !== '' ||\r\n    filterState.modifiedDays > 0 ||\r\n    filterState.showDuplicates ||\r\n    filterState.classifications.length < 4;\r\n\r\n  return (\r\n    <Paper \r\n      elevation={0}\r\n      sx={{ \r\n        bgcolor: 'background.paper',\r\n        border: 1,\r\n        borderColor: 'divider',\r\n        borderRadius: 1\r\n      }}\r\n      className={className}\r\n    >\r\n      {/* Main Toolbar */}\r\n      <Box sx={{ p: 2 }}>\r\n        <Box sx={{ display: 'flex', alignItems: 'center', gap: 2 }}>\r\n          {/* Search */}\r\n          <Box sx={{ flex: 1, position: 'relative' }}>\r\n            <Search style={{ position: 'absolute', left: 12, top: '50%', transform: 'translateY(-50%)', color: theme.palette.text.disabled, width: 16, height: 16, zIndex: 1 }} />\r\n            <TextField\r\n              fullWidth\r\n              placeholder=\"Search files by name or path...\"\r\n              value={searchQuery}\r\n              onChange={(e) => onSearchChange(e.target.value)}\r\n              size=\"small\"\r\n              sx={{\r\n                '& .MuiOutlinedInput-root': {\r\n                  pl: 5\r\n                }\r\n              }}\r\n            />\r\n          </Box>\r\n\r\n          {/* Quick Actions */}\r\n          <Box sx={{ display: 'flex', alignItems: 'center', gap: 1 }}>\r\n            {/* Sort Dropdown */}\r\n            <Box sx={{ position: 'relative' }}>\r\n              <Button\r\n                variant=\"outlined\"\r\n                color=\"inherit\"\r\n                onClick={() => setShowSortPicker(!showSortPicker)}\r\n                endIcon={<ChevronDown className=\"w-4 h-4\" />}\r\n                startIcon={\r\n                  currentSort.key === 'score' ? (\r\n                    <Zap className=\"w-4 h-4\" />\r\n                  ) : currentSort.key === 'name' ? (\r\n                    <FileSearch className=\"w-4 h-4\" />\r\n                  ) : currentSort.key === 'mtime' ? (\r\n                    <Calendar className=\"w-4 h-4\" />\r\n                  ) : (\r\n                    <AlertCircle className=\"w-4 h-4\" />\r\n                  )\r\n                }\r\n                sx={{ textTransform: 'none' }}\r\n              >\r\n                {currentSort.label}\r\n              </Button>\r\n\r\n              {showSortPicker && (\r\n                <Paper\r\n                  elevation={8}\r\n                  sx={{\r\n                    position: 'absolute',\r\n                    right: 0,\r\n                    top: '100%',\r\n                    mt: 0.5,\r\n                    width: 256,\r\n                    bgcolor: 'background.paper',\r\n                    border: 1,\r\n                    borderColor: 'divider',\r\n                    borderRadius: 1,\r\n                    zIndex: 1300,\r\n                    p: 1\r\n                  }}\r\n                >\r\n                  {sortOptions.map((option) => (\r\n                    <Button\r\n                      key={`${option.key}-${option.direction}`}\r\n                      onClick={() => handleSortSelect(option)}\r\n                      fullWidth\r\n                      startIcon={\r\n                        option.key === 'score' ? (\r\n                          <Zap className=\"w-4 h-4\" />\r\n                        ) : option.key === 'name' ? (\r\n                          <FileSearch className=\"w-4 h-4\" />\r\n                        ) : option.key === 'mtime' ? (\r\n                          <Calendar className=\"w-4 h-4\" />\r\n                        ) : (\r\n                          <AlertCircle className=\"w-4 h-4\" />\r\n                        )\r\n                      }\r\n                      endIcon={option.direction === 'asc' ? <SortAsc className=\"w-4 h-4\" /> : <SortDesc className=\"w-4 h-4\" />}\r\n                      sx={{\r\n                        textTransform: 'none',\r\n                        justifyContent: 'flex-start',\r\n                        px: 1.5,\r\n                        py: 1,\r\n                        color: currentSort.key === option.key && currentSort.direction === option.direction\r\n                          ? 'primary.main'\r\n                          : 'text.primary',\r\n                        bgcolor: currentSort.key === option.key && currentSort.direction === option.direction\r\n                          ? alpha(theme.palette.primary.main, 0.1)\r\n                          : 'transparent',\r\n                        '&:hover': {\r\n                          bgcolor: 'action.hover'\r\n                        }\r\n                      }}\r\n                    >\r\n                      {option.label}\r\n                    </Button>\r\n                  ))}\r\n                </Paper>\r\n              )}\r\n            </Box>\r\n\r\n            {/* File Type Filter */}\r\n            <Box sx={{ position: 'relative' }}>\r\n              <Button\r\n                variant=\"outlined\"\r\n                color=\"inherit\"\r\n                onClick={() => setShowFileTypePicker(!showFileTypePicker)}\r\n                endIcon={<ChevronDown className=\"w-4 h-4\" />}\r\n                startIcon={<FileSearch className=\"w-4 h-4\" />}\r\n                sx={{ textTransform: 'none' }}\r\n              >\r\n                {filterState.fileType || 'All Types'}\r\n              </Button>\r\n\r\n              {showFileTypePicker && (\r\n                <Paper\r\n                  elevation={8}\r\n                  sx={{\r\n                    position: 'absolute',\r\n                    right: 0,\r\n                    top: '100%',\r\n                    mt: 0.5,\r\n                    width: 192,\r\n                    bgcolor: 'background.paper',\r\n                    border: 1,\r\n                    borderColor: 'divider',\r\n                    borderRadius: 1,\r\n                    zIndex: 1300,\r\n                    p: 1\r\n                  }}\r\n                >\r\n                  {fileTypes.map((type) => (\r\n                    <Button\r\n                      key={type.label}\r\n                      onClick={() => handleFileTypeSelect(type.value)}\r\n                      fullWidth\r\n                      sx={{\r\n                        textTransform: 'none',\r\n                        justifyContent: 'flex-start',\r\n                        px: 1.5,\r\n                        py: 1,\r\n                        color: (Array.isArray(type.value) ? type.value.includes(filterState.fileType) : filterState.fileType === type.value)\r\n                          ? 'primary.main'\r\n                          : 'text.primary',\r\n                        bgcolor: (Array.isArray(type.value) ? type.value.includes(filterState.fileType) : filterState.fileType === type.value)\r\n                          ? alpha(theme.palette.primary.main, 0.1)\r\n                          : 'transparent',\r\n                        '&:hover': {\r\n                          bgcolor: 'action.hover'\r\n                        }\r\n                      }}\r\n                    >\r\n                      {type.label}\r\n                    </Button>\r\n                  ))}\r\n                </Paper>\r\n              )}\r\n            </Box>\r\n\r\n            {/* Additional Filters */}\r\n            <Button\r\n              variant={hasActiveFilters ? \"contained\" : \"outlined\"}\r\n              color={hasActiveFilters ? \"primary\" : \"inherit\"}\r\n              onClick={() => setShowFilters(!showFilters)}\r\n              startIcon={<Filter className=\"w-4 h-4\" />}\r\n              sx={{ textTransform: 'none' }}\r\n            >\r\n              Filters\r\n            </Button>\r\n\r\n            {/* Clear Filters */}\r\n            {hasActiveFilters && (\r\n              <Button\r\n                variant=\"text\"\r\n                onClick={clearFilters}\r\n                sx={{\r\n                  textTransform: 'none',\r\n                  color: 'text.secondary',\r\n                  '&:hover': {\r\n                    color: 'text.primary'\r\n                  }\r\n                }}\r\n              >\r\n                Clear\r\n              </Button>\r\n            )}\r\n\r\n            {/* Refresh */}\r\n            <Button\r\n              variant=\"outlined\"\r\n              color=\"inherit\"\r\n              onClick={onRefresh}\r\n              disabled={isLoading}\r\n              startIcon={<RefreshCw className={`w-4 h-4 ${isLoading ? 'animate-spin' : ''}`} />}\r\n              sx={{ textTransform: 'none' }}\r\n            >\r\n              Refresh\r\n            </Button>\r\n\r\n            {/* Recovery Mode Toggle */}\r\n            {onToggleRecoveryMode && (\r\n              <Button\r\n                variant={compareWithBackup ? \"contained\" : \"outlined\"}\r\n                color={compareWithBackup ? \"secondary\" : \"inherit\"}\r\n                onClick={onToggleRecoveryMode}\r\n                disabled={isLoading}\r\n                startIcon={<Archive className=\"w-4 h-4\" />}\r\n                sx={{ textTransform: 'none' }}\r\n                title=\"Compare with September 2025 backup (Gap Analysis)\"\r\n              >\r\n                Recovery Mode\r\n              </Button>\r\n            )}\r\n\r\n            {/* Analyze Button */}\r\n            <Button\r\n              variant=\"contained\"\r\n              color=\"primary\"\r\n              onClick={onAnalyze}\r\n              disabled={isLoading}\r\n              startIcon={<Zap className=\"w-4 h-4\" />}\r\n              sx={{ textTransform: 'none' }}\r\n            >\r\n              Analyze\r\n            </Button>\r\n          </Box>\r\n        </Box>\r\n\r\n        {/* Results Count */}\r\n        <Box sx={{ mt: 2, display: 'flex', alignItems: 'center', justifyContent: 'space-between', fontSize: '0.875rem', color: 'text.secondary' }}>\r\n          <Box>\r\n            Showing {filteredCount.toLocaleString()} of {totalCount.toLocaleString()} files\r\n            {hasActiveFilters && ' (filtered)'}\r\n          </Box>\r\n          \r\n          {isLoading && (\r\n            <Box sx={{ display: 'flex', alignItems: 'center', gap: 1 }}>\r\n              <RefreshCw className=\"w-4 h-4 animate-spin\" />\r\n              <span>Analyzing codebase...</span>\r\n            </Box>\r\n          )}\r\n        </Box>\r\n      </Box>\r\n\r\n      {/* Extended Filters Panel */}\r\n      {showFilters && (\r\n        <Box sx={{ borderTop: 1, borderColor: 'divider', p: 2, bgcolor: 'action.hover' }}>\r\n          <Box sx={{ display: 'grid', gridTemplateColumns: { xs: '1fr', md: 'repeat(3, 1fr)' }, gap: 2 }}>\r\n            {/* Modified Time Filter */}\r\n            <FormControl fullWidth>\r\n              <InputLabel>Modified Within</InputLabel>\r\n              <Select\r\n                value={filterState.modifiedDays}\r\n                onChange={(e) => handleModifiedTimeSelect(Number(e.target.value))}\r\n                label=\"Modified Within\"\r\n              >\r\n                {modifiedTimeOptions.map((option) => (\r\n                  <MenuItem key={option.value} value={option.value}>\r\n                    {option.label}\r\n                  </MenuItem>\r\n                ))}\r\n              </Select>\r\n            </FormControl>\r\n\r\n            {/* Duplicates Only */}\r\n            <Box sx={{ display: 'flex', alignItems: 'center', gap: 1 }}>\r\n              <input\r\n                type=\"checkbox\"\r\n                id=\"showDuplicates\"\r\n                checked={filterState.showDuplicates}\r\n                onChange={(e) => onFilterChange({ showDuplicates: e.target.checked })}\r\n                style={{\r\n                  width: 16,\r\n                  height: 16,\r\n                  accentColor: theme.palette.primary.main,\r\n                  cursor: 'pointer'\r\n                }}\r\n              />\r\n              <label htmlFor=\"showDuplicates\" style={{ fontSize: '0.875rem', fontWeight: 500, color: theme.palette.text.primary, cursor: 'pointer' }}>\r\n                Show duplicates only\r\n              </label>\r\n            </Box>\r\n\r\n            {/* Recovery Status Filters (only show if Recovery Mode is enabled) */}\r\n            {compareWithBackup && (\r\n              <>\r\n                <Box sx={{ display: 'flex', alignItems: 'center', gap: 1 }}>\r\n                  <input\r\n                    type=\"checkbox\"\r\n                    id=\"showMissingOnly\"\r\n                    checked={filterState.showMissingOnly || false}\r\n                    onChange={(e) => onFilterChange({ showMissingOnly: e.target.checked })}\r\n                    style={{\r\n                      width: 16,\r\n                      height: 16,\r\n                      accentColor: theme.palette.secondary.main,\r\n                      cursor: 'pointer'\r\n                    }}\r\n                  />\r\n                  <label htmlFor=\"showMissingOnly\" style={{ fontSize: '0.875rem', fontWeight: 500, color: theme.palette.text.primary, cursor: 'pointer' }}>\r\n                    Show missing files only\r\n                  </label>\r\n                </Box>\r\n              </>\r\n            )}\r\n\r\n            {/* Quick Filter Badges */}\r\n            <Box>\r\n              <Box sx={{ fontSize: '0.875rem', fontWeight: 500, color: 'text.primary', mb: 0.5 }}>Quick Filters</Box>\r\n              <Box sx={{ display: 'flex', flexWrap: 'wrap', gap: 1 }}>\r\n                <Chip\r\n                  label=\"Duplicates\"\r\n                  onClick={() => filterState.showDuplicates ? null : onFilterChange({ showDuplicates: true })}\r\n                  color={filterState.showDuplicates ? \"error\" : \"default\"}\r\n                  size=\"small\"\r\n                  sx={{\r\n                    bgcolor: filterState.showDuplicates \r\n                      ? alpha(theme.palette.error.main, 0.1)\r\n                      : undefined,\r\n                    color: filterState.showDuplicates \r\n                      ? 'error.main'\r\n                      : undefined\r\n                  }}\r\n                />\r\n                <Chip\r\n                  label=\"Recent (7d)\"\r\n                  onClick={() => onFilterChange({ modifiedDays: filterState.modifiedDays === 7 ? 0 : 7 })}\r\n                  color={filterState.modifiedDays === 7 ? \"primary\" : \"default\"}\r\n                  size=\"small\"\r\n                  sx={{\r\n                    bgcolor: filterState.modifiedDays === 7\r\n                      ? alpha(theme.palette.primary.main, 0.1)\r\n                      : undefined,\r\n                    color: filterState.modifiedDays === 7\r\n                      ? 'primary.main'\r\n                      : undefined\r\n                  }}\r\n                />\r\n                <Chip\r\n                  label=\"Legacy Only\"\r\n                  onClick={() => onFilterChange({ classifications: ['red'] })}\r\n                  color=\"error\"\r\n                  size=\"small\"\r\n                  sx={{\r\n                    bgcolor: alpha(theme.palette.error.main, 0.1),\r\n                    color: 'error.main'\r\n                  }}\r\n                />\r\n                {compareWithBackup && (\r\n                  <>\r\n                    <Chip\r\n                      label=\"Missing\"\r\n                      onClick={() => onFilterChange({ recoveryStatus: ['missing_in_prod'], showMissingOnly: true })}\r\n                      color={filterState.showMissingOnly ? \"secondary\" : \"default\"}\r\n                      size=\"small\"\r\n                      sx={{\r\n                        bgcolor: filterState.showMissingOnly\r\n                          ? alpha(theme.palette.secondary.main, 0.1)\r\n                          : undefined,\r\n                        color: filterState.showMissingOnly\r\n                          ? 'secondary.main'\r\n                          : undefined\r\n                      }}\r\n                    />\r\n                    <Chip\r\n                      label=\"Modified\"\r\n                      onClick={() => onFilterChange({ recoveryStatus: ['modified_since_backup'] })}\r\n                      color={filterState.recoveryStatus?.includes('modified_since_backup') ? \"warning\" : \"default\"}\r\n                      size=\"small\"\r\n                      sx={{\r\n                        bgcolor: filterState.recoveryStatus?.includes('modified_since_backup')\r\n                          ? alpha(theme.palette.warning.main, 0.1)\r\n                          : undefined,\r\n                        color: filterState.recoveryStatus?.includes('modified_since_backup')\r\n                          ? 'warning.main'\r\n                          : undefined\r\n                      }}\r\n                    />\r\n                    <Chip\r\n                      label=\"New Files\"\r\n                      onClick={() => onFilterChange({ recoveryStatus: ['new_file'] })}\r\n                      color={filterState.recoveryStatus?.includes('new_file') ? \"success\" : \"default\"}\r\n                      size=\"small\"\r\n                      sx={{\r\n                        bgcolor: filterState.recoveryStatus?.includes('new_file')\r\n                          ? alpha(theme.palette.success.main, 0.1)\r\n                          : undefined,\r\n                        color: filterState.recoveryStatus?.includes('new_file')\r\n                          ? 'success.main'\r\n                          : undefined\r\n                      }}\r\n                    />\r\n                  </>\r\n                )}\r\n              </Box>\r\n            </Box>\r\n          </Box>\r\n        </Box>\r\n      )}\r\n    </Paper>\r\n  );\r\n};\r\n\r\nexport default Toolbar;\r\n","import React from 'react';\r\nimport { X, CheckCircle, XCircle, AlertCircle, Code, FileCode, ExternalLink } from 'lucide-react';\r\nimport { FileAnalysis, EndpointReference, ASTIntegrationPoint } from '@/types/refactorConsole';\r\n\r\n// Browser-compatible path utilities\r\nconst pathBasename = (filePath: string): string => {\r\n  const parts = filePath.split('/');\r\n  return parts[parts.length - 1] || '/';\r\n};\r\n\r\nconst pathExtname = (filePath: string): string => {\r\n  const basename = pathBasename(filePath);\r\n  const lastDot = basename.lastIndexOf('.');\r\n  return lastDot >= 0 ? basename.slice(lastDot) : '';\r\n};\r\n\r\ninterface RequirementPreviewModalProps {\r\n  fileAnalysis: FileAnalysis | null;\r\n  integrationPoints: {\r\n    menuItems: ASTIntegrationPoint | null;\r\n    router: ASTIntegrationPoint | null;\r\n  };\r\n  onClose: () => void;\r\n}\r\n\r\nconst RequirementPreviewModal: React.FC<RequirementPreviewModalProps> = ({\r\n  fileAnalysis,\r\n  integrationPoints,\r\n  onClose\r\n}) => {\r\n  if (!fileAnalysis) return null;\r\n\r\n  const { file, imports, endpoints } = fileAnalysis;\r\n  const allImportsResolved = imports.every(imp => imp.resolved);\r\n  const allEndpointsVerified = endpoints.every(ep => ep.existsInServer);\r\n\r\n  return (\r\n    <div className=\"fixed inset-0 bg-black bg-opacity-50 dark:bg-opacity-70 flex items-center justify-center z-50\">\r\n      <div className=\"bg-white dark:bg-gray-800 rounded-lg max-w-4xl w-full mx-4 max-h-[90vh] overflow-y-auto\">\r\n        <div className=\"sticky top-0 bg-white dark:bg-gray-800 border-b border-gray-200 dark:border-gray-700 p-6 flex items-center justify-between\">\r\n          <div>\r\n            <h2 className=\"text-2xl font-bold text-gray-900 dark:text-gray-100\">Requirement Preview</h2>\r\n            <p className=\"text-sm text-gray-600 dark:text-gray-400 mt-1\">{file.relPath}</p>\r\n          </div>\r\n          <button\r\n            onClick={onClose}\r\n            className=\"text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-gray-300 p-2 hover:bg-gray-100 dark:hover:bg-gray-700 rounded\"\r\n          >\r\n            <X className=\"w-5 h-5\" />\r\n          </button>\r\n        </div>\r\n\r\n        <div className=\"p-6 space-y-6\">\r\n          {/* File Information */}\r\n          <div className=\"bg-gray-50 dark:bg-gray-700/50 p-4 rounded-lg\">\r\n            <h3 className=\"font-semibold text-gray-900 dark:text-gray-100 mb-2\">File Information</h3>\r\n            <div className=\"grid grid-cols-2 gap-4 text-sm\">\r\n              <div>\r\n                <span className=\"text-gray-600 dark:text-gray-400\">Status:</span>\r\n                <span className={`ml-2 font-medium ${\r\n                  file.status === 'missing_in_target' ? 'text-purple-600' : 'text-orange-600'\r\n                }`}>\r\n                  {file.status === 'missing_in_target' ? 'Missing in Target' : 'Modified in Target'}\r\n                </span>\r\n              </div>\r\n              <div>\r\n                <span className=\"text-gray-600 dark:text-gray-400\">Size:</span>\r\n                <span className=\"ml-2 font-medium text-gray-900 dark:text-gray-100\">{(file.size / 1024).toFixed(2)} KB</span>\r\n              </div>\r\n              <div>\r\n                <span className=\"text-gray-600 dark:text-gray-400\">Source Path:</span>\r\n                <span className=\"ml-2 font-mono text-xs text-gray-900 dark:text-gray-100\">{file.sourcePath}</span>\r\n              </div>\r\n              <div>\r\n                <span className=\"text-gray-600 dark:text-gray-400\">Target Path:</span>\r\n                <span className=\"ml-2 font-mono text-xs text-gray-900 dark:text-gray-100\">{file.targetPath || 'N/A'}</span>\r\n              </div>\r\n            </div>\r\n          </div>\r\n\r\n          {/* Dependency Status */}\r\n          <div>\r\n            <div className=\"flex items-center justify-between mb-3\">\r\n              <h3 className=\"text-lg font-semibold text-gray-900 dark:text-gray-100 flex items-center gap-2\">\r\n                <Code className=\"w-5 h-5\" />\r\n                Import Dependencies\r\n              </h3>\r\n              {allImportsResolved ? (\r\n                <span className=\"flex items-center gap-1 text-green-600 dark:text-green-400\">\r\n                  <CheckCircle className=\"w-4 h-4\" />\r\n                  All Resolved\r\n                </span>\r\n              ) : (\r\n                <span className=\"flex items-center gap-1 text-orange-600 dark:text-orange-400\">\r\n                  <AlertCircle className=\"w-4 h-4\" />\r\n                  Some Unresolved\r\n                </span>\r\n              )}\r\n            </div>\r\n            \r\n            {imports.length === 0 ? (\r\n              <p className=\"text-gray-500 dark:text-gray-400 text-sm\">No imports found</p>\r\n            ) : (\r\n              <div className=\"space-y-2\">\r\n                {imports.map((imp, index) => (\r\n                  <div\r\n                    key={index}\r\n                    className={`p-3 rounded-lg border ${\r\n                      imp.resolved\r\n                        ? 'bg-green-50 dark:bg-green-900/20 border-green-200 dark:border-green-800'\r\n                        : 'bg-orange-50 dark:bg-orange-900/20 border-orange-200 dark:border-orange-800'\r\n                    }`}\r\n                  >\r\n                    <div className=\"flex items-start justify-between\">\r\n                      <div className=\"flex-1\">\r\n                        <div className=\"flex items-center gap-2\">\r\n                          {imp.resolved ? (\r\n                            <CheckCircle className=\"w-4 h-4 text-green-600 dark:text-green-400\" />\r\n                          ) : (\r\n                            <XCircle className=\"w-4 h-4 text-orange-600 dark:text-orange-400\" />\r\n                          )}\r\n                          <code className=\"text-sm font-mono text-gray-900 dark:text-gray-100\">{imp.importPath}</code>\r\n                        </div>\r\n                        {imp.resolved && imp.resolvedPath && (\r\n                          <p className=\"text-xs text-gray-600 dark:text-gray-400 mt-1 ml-6\">\r\n                             {imp.resolvedPath}\r\n                          </p>\r\n                        )}\r\n                        {!imp.resolved && imp.error && (\r\n                          <p className=\"text-xs text-red-600 dark:text-red-400 mt-1 ml-6\">\r\n                            Error: {imp.error}\r\n                          </p>\r\n                        )}\r\n                      </div>\r\n                    </div>\r\n                  </div>\r\n                ))}\r\n              </div>\r\n            )}\r\n          </div>\r\n\r\n          {/* Endpoint Status */}\r\n          <div>\r\n            <div className=\"flex items-center justify-between mb-3\">\r\n              <h3 className=\"text-lg font-semibold text-gray-900 dark:text-gray-100 flex items-center gap-2\">\r\n                <ExternalLink className=\"w-5 h-5\" />\r\n                API Endpoints\r\n              </h3>\r\n              {endpoints.length > 0 && (\r\n                <span className={`flex items-center gap-1 ${\r\n                  allEndpointsVerified ? 'text-green-600 dark:text-green-400' : 'text-orange-600 dark:text-orange-400'\r\n                }`}>\r\n                  {allEndpointsVerified ? (\r\n                    <>\r\n                      <CheckCircle className=\"w-4 h-4\" />\r\n                      All Verified\r\n                    </>\r\n                  ) : (\r\n                    <>\r\n                      <AlertCircle className=\"w-4 h-4\" />\r\n                      Some Missing\r\n                    </>\r\n                  )}\r\n                </span>\r\n              )}\r\n            </div>\r\n            \r\n            {endpoints.length === 0 ? (\r\n              <p className=\"text-gray-500 dark:text-gray-400 text-sm\">No endpoints referenced in documentation</p>\r\n            ) : (\r\n              <div className=\"space-y-2\">\r\n                {endpoints.map((endpoint, index) => (\r\n                  <div\r\n                    key={index}\r\n                    className={`p-3 rounded-lg border ${\r\n                      endpoint.existsInServer\r\n                        ? 'bg-green-50 dark:bg-green-900/20 border-green-200 dark:border-green-800'\r\n                        : 'bg-orange-50 dark:bg-orange-900/20 border-orange-200 dark:border-orange-800'\r\n                    }`}\r\n                  >\r\n                    <div className=\"flex items-start justify-between\">\r\n                      <div className=\"flex-1\">\r\n                        <div className=\"flex items-center gap-2\">\r\n                          {endpoint.existsInServer ? (\r\n                            <CheckCircle className=\"w-4 h-4 text-green-600 dark:text-green-400\" />\r\n                          ) : (\r\n                            <XCircle className=\"w-4 h-4 text-orange-600 dark:text-orange-400\" />\r\n                          )}\r\n                          <span className=\"font-mono text-sm font-semibold text-gray-900 dark:text-gray-100\">\r\n                            {endpoint.method} {endpoint.path}\r\n                          </span>\r\n                        </div>\r\n                        {endpoint.existsInServer && endpoint.routeFile && (\r\n                          <p className=\"text-xs text-gray-600 dark:text-gray-400 mt-1 ml-6\">\r\n                            Found in: {endpoint.routeFile}\r\n                          </p>\r\n                        )}\r\n                        {!endpoint.existsInServer && (\r\n                          <p className=\"text-xs text-orange-600 dark:text-orange-400 mt-1 ml-6\">\r\n                            Not found in server routes\r\n                          </p>\r\n                        )}\r\n                        {endpoint.foundInDocs.length > 0 && (\r\n                          <p className=\"text-xs text-gray-500 dark:text-gray-400 mt-1 ml-6\">\r\n                            Referenced in: {endpoint.foundInDocs.join(', ')}\r\n                          </p>\r\n                        )}\r\n                      </div>\r\n                    </div>\r\n                  </div>\r\n                ))}\r\n              </div>\r\n            )}\r\n          </div>\r\n\r\n          {/* Integration Points */}\r\n          {(integrationPoints.menuItems || integrationPoints.router) && (\r\n            <div>\r\n              <h3 className=\"text-lg font-semibold text-gray-900 dark:text-gray-100 mb-3 flex items-center gap-2\">\r\n                <FileCode className=\"w-5 h-5\" />\r\n                Integration Points\r\n              </h3>\r\n              \r\n              <div className=\"space-y-4\">\r\n                {integrationPoints.menuItems && (\r\n                  <div className=\"bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-800 rounded-lg p-4\">\r\n                    <div className=\"flex items-center justify-between mb-2\">\r\n                      <h4 className=\"font-semibold text-blue-900 dark:text-blue-300\">MenuItems.ts</h4>\r\n                      <span className=\"text-xs text-blue-600 dark:text-blue-400\">\r\n                        Line {integrationPoints.menuItems.lineNumber}\r\n                      </span>\r\n                    </div>\r\n                    <pre className=\"text-xs bg-white dark:bg-gray-900 p-3 rounded border border-blue-100 dark:border-blue-800 overflow-x-auto text-gray-900 dark:text-gray-100\">\r\n                      <code>{integrationPoints.menuItems.codeBlock}</code>\r\n                    </pre>\r\n                  </div>\r\n                )}\r\n\r\n                {integrationPoints.router && (\r\n                  <div className=\"bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-800 rounded-lg p-4\">\r\n                    <div className=\"flex items-center justify-between mb-2\">\r\n                      <h4 className=\"font-semibold text-blue-900 dark:text-blue-300\">Router.tsx</h4>\r\n                      <span className=\"text-xs text-blue-600 dark:text-blue-400\">\r\n                        Line {integrationPoints.router.lineNumber}\r\n                      </span>\r\n                    </div>\r\n                    <pre className=\"text-xs bg-white dark:bg-gray-900 p-3 rounded border border-blue-100 dark:border-blue-800 overflow-x-auto text-gray-900 dark:text-gray-100\">\r\n                      <code>{integrationPoints.router.codeBlock}</code>\r\n                    </pre>\r\n                  </div>\r\n                )}\r\n              </div>\r\n            </div>\r\n          )}\r\n\r\n          {/* Projected Code Blocks */}\r\n          <div>\r\n            <h3 className=\"text-lg font-semibold text-gray-900 dark:text-gray-100 mb-3\">Projected Integration Code</h3>\r\n            \r\n            <div className=\"space-y-4\">\r\n              {integrationPoints.router && (\r\n                <div>\r\n                  <h4 className=\"font-medium text-gray-700 dark:text-gray-300 mb-2\">Router.tsx Addition</h4>\r\n                  <pre className=\"text-xs bg-gray-900 dark:bg-gray-950 text-green-400 dark:text-green-300 p-4 rounded overflow-x-auto\">\r\n                    <code>{`// Add to Router.tsx (around line ${integrationPoints.router.lineNumber})\r\n{\r\n  path: '/apps/${file.relPath.replace(/\\.(tsx?|jsx?)$/, '').replace(/\\\\//g, '/')}',\r\n  element: <${getComponentName(file.relPath)} />,\r\n}`}</code>\r\n                  </pre>\r\n                </div>\r\n              )}\r\n\r\n              {integrationPoints.menuItems && (\r\n                <div>\r\n                  <h4 className=\"font-medium text-gray-700 dark:text-gray-300 mb-2\">MenuItems.ts Addition</h4>\r\n                  <pre className=\"text-xs bg-gray-900 dark:bg-gray-950 text-green-400 dark:text-green-300 p-4 rounded overflow-x-auto\">\r\n                    <code>{`// Add to MenuItems array (around line ${integrationPoints.menuItems.lineNumber})\r\n{\r\n  label: '${getMenuLabel(file.relPath)}',\r\n  path: '/apps/${file.relPath.replace(/\\.(tsx?|jsx?)$/, '').replace(/\\\\//g, '/')}',\r\n  icon: 'FileCode', // Update with appropriate icon\r\n}`}</code>\r\n                  </pre>\r\n                </div>\r\n              )}\r\n            </div>\r\n          </div>\r\n        </div>\r\n\r\n        <div className=\"sticky bottom-0 bg-gray-50 dark:bg-gray-700/50 border-t border-gray-200 dark:border-gray-700 px-6 py-4 flex justify-end\">\r\n          <button\r\n            onClick={onClose}\r\n            className=\"px-4 py-2 bg-gray-200 dark:bg-gray-600 text-gray-800 dark:text-gray-200 rounded hover:bg-gray-300 dark:hover:bg-gray-500 transition-colors\"\r\n          >\r\n            Close\r\n          </button>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\n// Helper functions\r\nfunction getComponentName(relPath: string): string {\r\n  const basename = pathBasename(relPath);\r\n  return basename.replace(/\\.(tsx?|jsx?)$/, '');\r\n}\r\n\r\nfunction getMenuLabel(relPath: string): string {\r\n  const basename = pathBasename(relPath);\r\n  const name = basename.replace(/\\.(tsx?|jsx?)$/, '');\r\n  return name.replace(/([A-Z])/g, ' $1').trim();\r\n}\r\n\r\nexport default RequirementPreviewModal;\r\n","import React from 'react';\r\nimport { CheckCircle, AlertTriangle, XCircle, Package } from 'lucide-react';\r\nimport { FileAnalysis } from '@/types/refactorConsole';\r\n\r\nexport type RestorationStatus = 'ready' | 'missing_deps' | 'server_blocker' | 'unknown';\r\n\r\ninterface RestorationStatusBadgeProps {\r\n  fileAnalysis: FileAnalysis;\r\n  bundleSize?: number;\r\n  className?: string;\r\n}\r\n\r\n/**\r\n * Determines the restoration status based on file analysis\r\n */\r\nexport function calculateRestorationStatus(fileAnalysis: FileAnalysis): RestorationStatus {\r\n  const { imports, endpoints } = fileAnalysis;\r\n  \r\n  // Check if all imports are resolved\r\n  const allImportsResolved = imports.every(imp => imp.resolved);\r\n  \r\n  // Check if any imports are missing but might exist in backup\r\n  const missingImportsInBackup = imports.filter(imp => \r\n    !imp.resolved && !imp.error?.includes('node_modules')\r\n  );\r\n  \r\n  // Check if any endpoints are missing from server\r\n  const missingEndpoints = endpoints.filter(ep => !ep.existsInServer);\r\n  \r\n  // Server Blocker: Required endpoints don't exist\r\n  if (missingEndpoints.length > 0) {\r\n    return 'server_blocker';\r\n  }\r\n  \r\n  // Missing Deps: Imports not resolved but might be in backup\r\n  if (!allImportsResolved && missingImportsInBackup.length > 0) {\r\n    return 'missing_deps';\r\n  }\r\n  \r\n  // Ready: All imports resolved and all endpoints exist\r\n  if (allImportsResolved && endpoints.every(ep => ep.existsInServer || endpoints.length === 0)) {\r\n    return 'ready';\r\n  }\r\n  \r\n  return 'unknown';\r\n}\r\n\r\nexport const RestorationStatusBadge: React.FC<RestorationStatusBadgeProps> = ({\r\n  fileAnalysis,\r\n  bundleSize,\r\n  className = ''\r\n}) => {\r\n  const status = calculateRestorationStatus(fileAnalysis);\r\n  \r\n  const statusConfig = {\r\n    ready: {\r\n      icon: CheckCircle,\r\n      label: 'Ready',\r\n      color: 'text-green-600',\r\n      bgColor: 'bg-green-50',\r\n      borderColor: 'border-green-200',\r\n      description: 'All dependencies resolved and endpoints verified'\r\n    },\r\n    missing_deps: {\r\n      icon: AlertTriangle,\r\n      label: 'Missing Deps',\r\n      color: 'text-yellow-600',\r\n      bgColor: 'bg-yellow-50',\r\n      borderColor: 'border-yellow-200',\r\n      description: 'Some imports missing (may exist in backup bundle)'\r\n    },\r\n    server_blocker: {\r\n      icon: XCircle,\r\n      label: 'Server Blocker',\r\n      color: 'text-red-600',\r\n      bgColor: 'bg-red-50',\r\n      borderColor: 'border-red-200',\r\n      description: 'Required API endpoints not found in server'\r\n    },\r\n    unknown: {\r\n      icon: AlertTriangle,\r\n      label: 'Unknown',\r\n      color: 'text-gray-600 dark:text-gray-400',\r\n      bgColor: 'bg-gray-50 dark:bg-gray-700/50',\r\n      borderColor: 'border-gray-200 dark:border-gray-700',\r\n      description: 'Status cannot be determined'\r\n    }\r\n  };\r\n  \r\n  const config = statusConfig[status];\r\n  const Icon = config.icon;\r\n  \r\n  return (\r\n    <div\r\n      className={`inline-flex items-center gap-2 px-3 py-1.5 rounded-lg border ${config.bgColor} ${config.borderColor} ${className}`}\r\n      title={config.description}\r\n    >\r\n      <Icon className={`w-4 h-4 ${config.color}`} />\r\n      <span className={`text-sm font-medium ${config.color}`}>\r\n        {config.label}\r\n      </span>\r\n      {bundleSize && bundleSize > 1 && (\r\n        <div className=\"flex items-center gap-1 ml-1\">\r\n          <Package className=\"w-3 h-3 text-gray-500 dark:text-gray-400\" />\r\n          <span className=\"text-xs text-gray-600 dark:text-gray-400\">{bundleSize}</span>\r\n        </div>\r\n      )}\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default RestorationStatusBadge;\r\n","import { \r\n  RefactorScan, \r\n  Snapshot, \r\n  SourceType,\r\n  PreviewRestoreResponse,\r\n  RestoreHistoryResponse,\r\n  RestoreHistoryEntry,\r\n  RestoreHistoryStats\r\n} from '@/types/refactorConsole';\r\n\r\n// ============================================================================\r\n// Path Configuration Interface\r\n// ============================================================================\r\nexport interface PathConfig {\r\n  sourcePath: string;\r\n  destinationPath: string;\r\n  backupPath?: string;\r\n  sourceType?: SourceType;\r\n  snapshotId?: string;\r\n}\r\n\r\n// Default paths\r\nexport const DEFAULT_PATH_CONFIG: PathConfig = {\r\n  sourcePath: '/var/www/orthodoxmetrics/prod/refactor-src/',\r\n  destinationPath: '/var/www/orthodoxmetrics/prod/front-end/src/',\r\n  backupPath: '/var/www/orthodoxmetrics/backup'\r\n};\r\n\r\n// LocalStorage key for path configuration\r\nconst PATHS_STORAGE_KEY = 'refactor-console-paths';\r\n\r\nclass RefactorConsoleClient {\r\n  private baseUrl = '/api/refactor-console';\r\n\r\n  // ============================================================================\r\n  // Path Configuration Management\r\n  // ============================================================================\r\n  \r\n  /**\r\n   * Get saved path configuration from localStorage\r\n   */\r\n  getSavedPaths(): PathConfig {\r\n    try {\r\n      const saved = localStorage.getItem(PATHS_STORAGE_KEY);\r\n      if (saved) {\r\n        const parsed = JSON.parse(saved);\r\n        return {\r\n          sourcePath: parsed.sourcePath || DEFAULT_PATH_CONFIG.sourcePath,\r\n          destinationPath: parsed.destinationPath || DEFAULT_PATH_CONFIG.destinationPath,\r\n          backupPath: parsed.backupPath || DEFAULT_PATH_CONFIG.backupPath\r\n        };\r\n      }\r\n    } catch (e) {\r\n      console.warn('Failed to parse saved path config:', e);\r\n    }\r\n    return { ...DEFAULT_PATH_CONFIG };\r\n  }\r\n\r\n  /**\r\n   * Save path configuration to localStorage\r\n   */\r\n  savePaths(config: Partial<PathConfig>): void {\r\n    try {\r\n      const current = this.getSavedPaths();\r\n      const updated = {\r\n        ...current,\r\n        ...config\r\n      };\r\n      localStorage.setItem(PATHS_STORAGE_KEY, JSON.stringify(updated));\r\n      console.log('[RefactorConsole] Paths saved:', updated);\r\n    } catch (e) {\r\n      console.error('Failed to save path config:', e);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Clear saved path configuration (reset to defaults)\r\n   */\r\n  clearSavedPaths(): void {\r\n    localStorage.removeItem(PATHS_STORAGE_KEY);\r\n    console.log('[RefactorConsole] Paths reset to defaults');\r\n  }\r\n\r\n  /**\r\n   * Get default path configuration from server\r\n   */\r\n  async getDefaultPaths(): Promise<{\r\n    ok: boolean;\r\n    defaults: PathConfig & { projectRoot: string };\r\n    allowedBasePath: string;\r\n  }> {\r\n    try {\r\n      const response = await fetch(`${this.baseUrl}/config/paths`, {\r\n        method: 'GET',\r\n        headers: { 'Content-Type': 'application/json' },\r\n        credentials: 'include',\r\n      });\r\n      if (!response.ok) {\r\n        throw new Error(`HTTP error! status: ${response.status}`);\r\n      }\r\n      return await response.json();\r\n    } catch (error) {\r\n      console.error('Failed to get default paths:', error);\r\n      throw error;\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Validate paths on the server\r\n   */\r\n  async validatePaths(config: Partial<PathConfig>): Promise<{\r\n    ok: boolean;\r\n    validations: Record<string, {\r\n      input: string;\r\n      isValid: boolean;\r\n      sanitized: string;\r\n      error?: string;\r\n      exists: boolean;\r\n    }>;\r\n  }> {\r\n    try {\r\n      const response = await fetch(`${this.baseUrl}/config/validate-paths`, {\r\n        method: 'POST',\r\n        headers: { 'Content-Type': 'application/json' },\r\n        credentials: 'include',\r\n        body: JSON.stringify(config),\r\n      });\r\n      if (!response.ok) {\r\n        throw new Error(`HTTP error! status: ${response.status}`);\r\n      }\r\n      return await response.json();\r\n    } catch (error) {\r\n      console.error('Failed to validate paths:', error);\r\n      throw error;\r\n    }\r\n  }\r\n\r\n  // ============================================================================\r\n  // Snapshot Discovery\r\n  // ============================================================================\r\n  \r\n  /**\r\n   * Fetch available snapshots from the source directory\r\n   * @param sourceType - Type of source ('local' or 'remote')\r\n   * @param sourcePath - Optional custom source path\r\n   * @returns Promise containing list of available snapshots\r\n   */\r\n  async fetchSnapshots(\r\n    sourceType: SourceType = 'local',\r\n    sourcePath?: string\r\n  ): Promise<{\r\n    ok: boolean;\r\n    sourceType: SourceType;\r\n    basePath: string;\r\n    snapshots: Snapshot[];\r\n    defaultSnapshot: Snapshot | null;\r\n    stats: {\r\n      total: number;\r\n      valid: number;\r\n      invalid: number;\r\n      oldest: Snapshot | null;\r\n      newest: Snapshot | null;\r\n      yearCounts: Record<number, number>;\r\n    };\r\n  }> {\r\n    try {\r\n      const params = new URLSearchParams();\r\n      params.append('sourceType', sourceType);\r\n      if (sourcePath) {\r\n        params.append('sourcePath', sourcePath);\r\n      }\r\n\r\n      const response = await fetch(`${this.baseUrl}/snapshots?${params}`, {\r\n        method: 'GET',\r\n        headers: {\r\n          'Content-Type': 'application/json',\r\n        },\r\n        credentials: 'include',\r\n      });\r\n\r\n      if (!response.ok) {\r\n        const errorData = await this.safeParseResponse(response);\r\n        throw new Error(errorData.message || `HTTP error! status: ${response.status}`);\r\n      }\r\n\r\n      const data = await this.safeParseResponse(response);\r\n      return data;\r\n    } catch (error) {\r\n      console.error('Failed to fetch snapshots:', error);\r\n      throw new Error(error instanceof Error ? error.message : 'Failed to fetch snapshots');\r\n    }\r\n  }\r\n\r\n  // ============================================================================\r\n  // Scan Endpoint (with dynamic path support)\r\n  // ============================================================================\r\n  \r\n  /**\r\n   * Scan the codebase for refactoring analysis\r\n   * @param rebuild - Whether to force a rebuild of the scan (ignore cache)\r\n   * @param compareWithBackup - Whether to perform gap analysis with backup\r\n   * @param pathConfig - Optional custom path configuration\r\n   * @param sourceType - Source type ('local' or 'remote')\r\n   * @param snapshotId - Optional snapshot ID (e.g., '09-2025')\r\n   * @returns Promise containing the scan results\r\n   */\r\n  async scan(\r\n    rebuild: boolean = false, \r\n    compareWithBackup: boolean = false,\r\n    pathConfig?: Partial<PathConfig>,\r\n    sourceType?: SourceType,\r\n    snapshotId?: string\r\n  ): Promise<RefactorScan> {\r\n    try {\r\n      const params = new URLSearchParams();\r\n      if (rebuild) {\r\n        params.append('rebuild', '1');\r\n      }\r\n      if (compareWithBackup) {\r\n        params.append('compareWithBackup', '1');\r\n      }\r\n      \r\n      // Use saved paths if no custom config provided\r\n      const paths = pathConfig || this.getSavedPaths();\r\n      \r\n      // Add sourceType and snapshotId\r\n      const actualSourceType = sourceType || paths.sourceType || 'local';\r\n      const actualSnapshotId = snapshotId || paths.snapshotId;\r\n      \r\n      params.append('sourceType', actualSourceType);\r\n      if (actualSnapshotId) {\r\n        params.append('snapshotId', actualSnapshotId);\r\n      }\r\n      \r\n      if (paths.sourcePath) {\r\n        params.append('sourcePath', paths.sourcePath);\r\n      }\r\n      if (paths.destinationPath) {\r\n        params.append('destinationPath', paths.destinationPath);\r\n      }\r\n      if (paths.backupPath) {\r\n        params.append('backupPath', paths.backupPath);\r\n      }\r\n\r\n      const response = await fetch(`${this.baseUrl}/scan?${params}`, {\r\n        method: 'GET',\r\n        headers: {\r\n          'Content-Type': 'application/json',\r\n        },\r\n        credentials: 'include',\r\n      });\r\n\r\n      if (!response.ok) {\r\n        const errorData = await this.safeParseResponse(response);\r\n        throw new Error(errorData.message || `HTTP error! status: ${response.status}`);\r\n      }\r\n\r\n      const data = await this.safeParseResponse(response);\r\n      return data;\r\n    } catch (error) {\r\n      console.error('Failed to fetch refactor scan:', error);\r\n      throw new Error(error instanceof Error ? error.message : 'Failed to fetch scan data');\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Preview restore (dry run) - get diff and dependency check before restoring\r\n   * @param relPath - Relative path of the file to preview\r\n   * @param pathConfig - Optional custom path configuration\r\n   * @param sourceType - Source type ('local' or 'remote')\r\n   * @param snapshotId - Optional snapshot ID (e.g., '09-2025')\r\n   * @returns Promise containing preview with diff and dependencies\r\n   */\r\n  async previewRestore(\r\n    relPath: string,\r\n    pathConfig?: Partial<PathConfig>,\r\n    sourceType?: SourceType,\r\n    snapshotId?: string\r\n  ): Promise<PreviewRestoreResponse> {\r\n    try {\r\n      // Use saved paths if no custom config provided\r\n      const paths = pathConfig || this.getSavedPaths();\r\n      \r\n      // Use provided sourceType/snapshotId or fall back to saved values\r\n      const actualSourceType = sourceType || paths.sourceType || 'local';\r\n      const actualSnapshotId = snapshotId || paths.snapshotId;\r\n      \r\n      const response = await fetch(`${this.baseUrl}/preview-restore`, {\r\n        method: 'POST',\r\n        headers: {\r\n          'Content-Type': 'application/json',\r\n        },\r\n        credentials: 'include',\r\n        body: JSON.stringify({ \r\n          relPath,\r\n          sourcePath: paths.sourcePath || paths.backupPath,\r\n          destinationPath: paths.destinationPath,\r\n          sourceType: actualSourceType,\r\n          snapshotId: actualSnapshotId\r\n        }),\r\n      });\r\n\r\n      if (!response.ok) {\r\n        const errorData = await this.safeParseResponse(response);\r\n        throw new Error(errorData.message || `HTTP error! status: ${response.status}`);\r\n      }\r\n\r\n      const data = await this.safeParseResponse(response);\r\n      return data;\r\n    } catch (error) {\r\n      console.error('Failed to preview restore:', error);\r\n      throw new Error(error instanceof Error ? error.message : 'Failed to preview restore');\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Restore a file from the source to destination\r\n   * @param relPath - Relative path of the file to restore\r\n   * @param pathConfig - Optional custom path configuration\r\n   * @param sourceType - Source type ('local' or 'remote')\r\n   * @param snapshotId - Optional snapshot ID (e.g., '09-2025')\r\n   * @returns Promise containing restore result\r\n   */\r\n  async restore(\r\n    relPath: string,\r\n    pathConfig?: Partial<PathConfig>,\r\n    sourceType?: SourceType,\r\n    snapshotId?: string\r\n  ): Promise<{ \r\n    success: boolean; \r\n    message: string; \r\n    sourcePath: string; \r\n    restoredPath: string;\r\n    sourceType?: SourceType;\r\n    snapshotId?: string | null;\r\n  }> {\r\n    try {\r\n      // Use saved paths if no custom config provided\r\n      const paths = pathConfig || this.getSavedPaths();\r\n      \r\n      // Use provided sourceType/snapshotId or fall back to saved values\r\n      const actualSourceType = sourceType || paths.sourceType || 'local';\r\n      const actualSnapshotId = snapshotId || paths.snapshotId;\r\n      \r\n      const response = await fetch(`${this.baseUrl}/restore`, {\r\n        method: 'POST',\r\n        headers: {\r\n          'Content-Type': 'application/json',\r\n        },\r\n        credentials: 'include',\r\n        body: JSON.stringify({ \r\n          relPath,\r\n          sourcePath: paths.sourcePath || paths.backupPath,\r\n          destinationPath: paths.destinationPath,\r\n          sourceType: actualSourceType,\r\n          snapshotId: actualSnapshotId\r\n        }),\r\n      });\r\n\r\n      if (!response.ok) {\r\n        const errorData = await this.safeParseResponse(response);\r\n        throw new Error(errorData.message || `HTTP error! status: ${response.status}`);\r\n      }\r\n\r\n      const data = await this.safeParseResponse(response);\r\n      return data;\r\n    } catch (error) {\r\n      console.error('Failed to restore file:', error);\r\n      throw new Error(error instanceof Error ? error.message : 'Failed to restore file');\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Helper to safely parse JSON or text response\r\n   */\r\n  private async safeParseResponse(response: Response): Promise<any> {\r\n    const contentType = response.headers.get('content-type') || '';\r\n    \r\n    if (contentType.includes('application/json')) {\r\n      try {\r\n        return await response.json();\r\n      } catch (e) {\r\n        // Fallback to text if JSON parsing fails\r\n        const text = await response.text();\r\n        throw new Error(`Invalid JSON response: ${text.substring(0, 200)}`);\r\n      }\r\n    } else {\r\n      // Non-JSON response (likely HTML error page)\r\n      const text = await response.text();\r\n      throw new Error(`Non-JSON response (${contentType}): ${text.substring(0, 500)}`);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Start Phase 1: Discovery & Gap Analysis (background job)\r\n   * @returns Promise containing jobId\r\n   */\r\n  async startPhase1Analysis(): Promise<{ ok: boolean; jobId: string; status: string; message: string }> {\r\n    try {\r\n      const response = await fetch(`${this.baseUrl}/phase1/start`, {\r\n        method: 'POST',\r\n        headers: {\r\n          'Content-Type': 'application/json',\r\n        },\r\n        credentials: 'include',\r\n      });\r\n\r\n      if (!response.ok) {\r\n        const errorData = await this.safeParseResponse(response);\r\n        throw new Error(errorData.message || `HTTP error! status: ${response.status}`);\r\n      }\r\n\r\n      const data = await this.safeParseResponse(response);\r\n      return data;\r\n    } catch (error) {\r\n      console.error('Failed to start Phase 1 analysis:', error);\r\n      throw new Error(error instanceof Error ? error.message : 'Failed to start Phase 1 analysis');\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Get Phase 1 job status\r\n   * @param jobId - Job ID to check\r\n   * @returns Promise containing job status\r\n   */\r\n  async getPhase1JobStatus(jobId: string): Promise<{\r\n    ok: boolean;\r\n    jobId: string;\r\n    status: 'queued' | 'running' | 'done' | 'error';\r\n    progress: number;\r\n    currentStep: string;\r\n    error: string | null;\r\n    startedAt: number | null;\r\n    finishedAt: number | null;\r\n  }> {\r\n    try {\r\n      const response = await fetch(`${this.baseUrl}/jobs/${jobId}`, {\r\n        method: 'GET',\r\n        headers: {\r\n          'Content-Type': 'application/json',\r\n        },\r\n        credentials: 'include',\r\n      });\r\n\r\n      if (!response.ok) {\r\n        const errorData = await this.safeParseResponse(response);\r\n        throw new Error(errorData.message || `HTTP error! status: ${response.status}`);\r\n      }\r\n\r\n      const data = await this.safeParseResponse(response);\r\n      return data;\r\n    } catch (error) {\r\n      console.error(`Failed to get Phase 1 job ${jobId} status:`, error);\r\n      throw new Error(error instanceof Error ? error.message : 'Failed to get Phase 1 job status');\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Get Phase 1 job result\r\n   * @param jobId - Job ID to fetch result for\r\n   * @returns Promise containing Phase 1 report\r\n   */\r\n  async getPhase1JobResult(jobId: string): Promise<any> {\r\n    try {\r\n      const response = await fetch(`${this.baseUrl}/jobs/${jobId}/result`, {\r\n        method: 'GET',\r\n        headers: {\r\n          'Content-Type': 'application/json',\r\n        },\r\n        credentials: 'include',\r\n      });\r\n\r\n      if (response.status === 409) {\r\n        // Job not ready yet\r\n        const data = await this.safeParseResponse(response);\r\n        throw new Error(`Job not ready: ${data.status} (${data.progress}%)`);\r\n      }\r\n\r\n      if (!response.ok) {\r\n        const errorData = await this.safeParseResponse(response);\r\n        throw new Error(errorData.message || `HTTP error! status: ${response.status}`);\r\n      }\r\n\r\n      const data = await this.safeParseResponse(response);\r\n      return data;\r\n    } catch (error) {\r\n      console.error(`Failed to get Phase 1 job ${jobId} result:`, error);\r\n      throw new Error(error instanceof Error ? error.message : 'Failed to get Phase 1 job result');\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Restore a bundle of files from backup\r\n   * @param bundleRequest - Bundle restoration request\r\n   * @returns Promise containing restore result\r\n   */\r\n  async restoreBundle(bundleRequest: {\r\n    bundleFiles: string[];\r\n    routePath?: string;\r\n    menuLabel?: string;\r\n    menuIcon?: string;\r\n  }): Promise<{ success: boolean; message: string; restoredFiles: string[] }> {\r\n    try {\r\n      const response = await fetch(`${this.baseUrl}/restore-bundle`, {\r\n        method: 'POST',\r\n        headers: {\r\n          'Content-Type': 'application/json',\r\n        },\r\n        credentials: 'include',\r\n        body: JSON.stringify(bundleRequest),\r\n      });\r\n\r\n      if (!response.ok) {\r\n        const errorData = await response.json();\r\n        throw new Error(errorData.message || `HTTP error! status: ${response.status}`);\r\n      }\r\n\r\n      const data = await response.json();\r\n      return data;\r\n    } catch (error) {\r\n      console.error('Failed to restore bundle:', error);\r\n      throw new Error(error instanceof Error ? error.message : 'Failed to restore bundle');\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Health check endpoint - verify API is reachable\r\n   * @returns Promise containing health status\r\n   */\r\n  async healthCheck(): Promise<{ ok: boolean; service: string; ts: string; uptimeSec?: number; status?: string }> {\r\n    try {\r\n      const response = await fetch(`${this.baseUrl}/health`, {\r\n        method: 'GET',\r\n        headers: {\r\n          'Content-Type': 'application/json',\r\n        },\r\n        credentials: 'include',\r\n      });\r\n\r\n      if (!response.ok) {\r\n        throw new Error(`Health check failed: ${response.status} ${response.statusText}`);\r\n      }\r\n\r\n      const data = await response.json();\r\n      // Normalize response - server returns {ok: true, service: string, ts: string}\r\n      return {\r\n        ...data,\r\n        status: data.ok ? 'ok' : 'error'\r\n      };\r\n    } catch (error) {\r\n      console.error('Health check error:', error);\r\n      throw new Error(error instanceof Error ? error.message : 'Health check failed');\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Check if cached scan data exists and is recent\r\n   */\r\n  async checkCacheStatus(): Promise<{ exists: boolean; age: number }> {\r\n    try {\r\n      const response = await fetch(`${this.baseUrl}/scan`, {\r\n        method: 'HEAD',\r\n        credentials: 'include',\r\n      });\r\n\r\n      const age = response.status === 200 ? 0 : -1;\r\n      return {\r\n        exists: response.status === 200,\r\n        age\r\n      };\r\n    } catch (error) {\r\n      return { exists: false, age: -1 };\r\n    }\r\n  }\r\n\r\n  // ============================================================================\r\n  // Restore History Endpoints\r\n  // ============================================================================\r\n  \r\n  /**\r\n   * Get restore history with pagination\r\n   * @param limit - Number of entries to return\r\n   * @param offset - Offset for pagination\r\n   * @returns Promise containing restore history\r\n   */\r\n  async getRestoreHistory(\r\n    limit: number = 50,\r\n    offset: number = 0\r\n  ): Promise<RestoreHistoryResponse> {\r\n    try {\r\n      const params = new URLSearchParams();\r\n      params.append('limit', limit.toString());\r\n      params.append('offset', offset.toString());\r\n\r\n      const response = await fetch(`${this.baseUrl}/restore-history?${params}`, {\r\n        method: 'GET',\r\n        headers: {\r\n          'Content-Type': 'application/json',\r\n        },\r\n        credentials: 'include',\r\n      });\r\n\r\n      if (!response.ok) {\r\n        const errorData = await this.safeParseResponse(response);\r\n        throw new Error(errorData.message || `HTTP error! status: ${response.status}`);\r\n      }\r\n\r\n      const data = await this.safeParseResponse(response);\r\n      return data;\r\n    } catch (error) {\r\n      console.error('Failed to get restore history:', error);\r\n      throw new Error(error instanceof Error ? error.message : 'Failed to get restore history');\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Get restore history for a specific file\r\n   * @param relPath - Relative path of the file\r\n   * @returns Promise containing file restore history\r\n   */\r\n  async getFileRestoreHistory(relPath: string): Promise<{\r\n    ok: boolean;\r\n    relPath: string;\r\n    count: number;\r\n    entries: RestoreHistoryEntry[];\r\n  }> {\r\n    try {\r\n      const response = await fetch(`${this.baseUrl}/restore-history/file/${relPath}`, {\r\n        method: 'GET',\r\n        headers: {\r\n          'Content-Type': 'application/json',\r\n        },\r\n        credentials: 'include',\r\n      });\r\n\r\n      if (!response.ok) {\r\n        const errorData = await this.safeParseResponse(response);\r\n        throw new Error(errorData.message || `HTTP error! status: ${response.status}`);\r\n      }\r\n\r\n      const data = await this.safeParseResponse(response);\r\n      return data;\r\n    } catch (error) {\r\n      console.error('Failed to get file restore history:', error);\r\n      throw new Error(error instanceof Error ? error.message : 'Failed to get file restore history');\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Get restore statistics\r\n   * @returns Promise containing restore statistics\r\n   */\r\n  async getRestoreHistoryStats(): Promise<{\r\n    ok: boolean;\r\n    stats: RestoreHistoryStats;\r\n  }> {\r\n    try {\r\n      const response = await fetch(`${this.baseUrl}/restore-history/stats`, {\r\n        method: 'GET',\r\n        headers: {\r\n          'Content-Type': 'application/json',\r\n        },\r\n        credentials: 'include',\r\n      });\r\n\r\n      if (!response.ok) {\r\n        const errorData = await this.safeParseResponse(response);\r\n        throw new Error(errorData.message || `HTTP error! status: ${response.status}`);\r\n      }\r\n\r\n      const data = await this.safeParseResponse(response);\r\n      return data;\r\n    } catch (error) {\r\n      console.error('Failed to get restore history stats:', error);\r\n      throw new Error(error instanceof Error ? error.message : 'Failed to get restore history stats');\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Export restore history to CSV\r\n   * @param limit - Number of entries to export\r\n   * @returns Promise that triggers CSV download\r\n   */\r\n  async exportRestoreHistory(limit: number = 1000): Promise<void> {\r\n    try {\r\n      const params = new URLSearchParams();\r\n      params.append('limit', limit.toString());\r\n\r\n      const url = `${this.baseUrl}/restore-history/export?${params}`;\r\n      \r\n      // Trigger download by opening in new window/tab\r\n      window.open(url, '_blank');\r\n    } catch (error) {\r\n      console.error('Failed to export restore history:', error);\r\n      throw new Error(error instanceof Error ? error.message : 'Failed to export restore history');\r\n    }\r\n  }\r\n}\r\n\r\n// Export singleton instance\r\nexport const refactorConsoleClient = new RefactorConsoleClient();\r\nexport default refactorConsoleClient;\r\n","import React, { useState } from 'react';\r\nimport { Package, Loader2, CheckCircle, AlertCircle } from 'lucide-react';\r\nimport { FeatureBundle } from '@/types/refactorConsole';\r\nimport { RestorationStatusBadge, calculateRestorationStatus } from './RestorationStatusBadge';\r\nimport refactorConsoleClient from '../api/refactorConsoleClient';\r\nimport { toast } from 'react-toastify';\r\n\r\ninterface RestoreBundleButtonProps {\r\n  bundle: FeatureBundle;\r\n  onRestoreComplete?: () => void;\r\n}\r\n\r\nconst RestoreBundleButton: React.FC<RestoreBundleButtonProps> = ({\r\n  bundle,\r\n  onRestoreComplete\r\n}) => {\r\n  const [isRestoring, setIsRestoring] = useState(false);\r\n  const [showConfirm, setShowConfirm] = useState(false);\r\n  \r\n  const status = calculateRestorationStatus({\r\n    file: bundle.rootFile,\r\n    imports: bundle.missingImports,\r\n    endpoints: bundle.requiredEndpoints,\r\n    integrationPoints: []\r\n  });\r\n  \r\n  const canRestore = status === 'ready' || status === 'missing_deps';\r\n  \r\n  const handleRestore = async () => {\r\n    if (!canRestore) {\r\n      toast.error('Cannot restore bundle: dependencies or endpoints missing');\r\n      return;\r\n    }\r\n    \r\n    setIsRestoring(true);\r\n    \r\n    try {\r\n      // Generate route path from root file\r\n      const rootFileName = bundle.rootFile.relPath\r\n        .replace(/\\.(tsx?|jsx?)$/, '')\r\n        .replace(/^src\\//, '')\r\n        .replace(/\\//g, '/');\r\n      \r\n      const routePath = `/apps/${rootFileName}`;\r\n      \r\n      // Generate menu label from file name\r\n      const menuLabel = bundle.rootFile.relPath\r\n        .split('/')\r\n        .pop()!\r\n        .replace(/\\.(tsx?|jsx?)$/, '')\r\n        .replace(/([A-Z])/g, ' $1')\r\n        .trim();\r\n      \r\n      const result = await refactorConsoleClient.restoreBundle({\r\n        bundleFiles: bundle.files.map(f => f.relPath),\r\n        routePath,\r\n        menuLabel,\r\n        menuIcon: 'FileCode'\r\n      });\r\n      \r\n      if (result.success) {\r\n        toast.success(`Successfully restored ${result.restoredFiles.length} files`);\r\n        if (onRestoreComplete) {\r\n          onRestoreComplete();\r\n        }\r\n      } else {\r\n        toast.error(result.message || 'Restoration failed');\r\n      }\r\n    } catch (error) {\r\n      toast.error(`Failed to restore bundle: ${error instanceof Error ? error.message : 'Unknown error'}`);\r\n    } finally {\r\n      setIsRestoring(false);\r\n      setShowConfirm(false);\r\n    }\r\n  };\r\n  \r\n  if (!canRestore) {\r\n    return (\r\n      <div className=\"flex items-center gap-2\">\r\n        <RestorationStatusBadge \r\n          fileAnalysis={{\r\n            file: bundle.rootFile,\r\n            imports: bundle.missingImports,\r\n            endpoints: bundle.requiredEndpoints,\r\n            integrationPoints: []\r\n          }}\r\n          bundleSize={bundle.files.length}\r\n        />\r\n        <span className=\"text-sm text-gray-500 dark:text-gray-400\">\r\n          {status === 'server_blocker' \r\n            ? 'Required endpoints missing in server'\r\n            : 'Cannot restore'}\r\n        </span>\r\n      </div>\r\n    );\r\n  }\r\n  \r\n  if (showConfirm) {\r\n    return (\r\n      <div className=\"flex items-center gap-2 p-3 bg-yellow-50 border border-yellow-200 rounded-lg\">\r\n        <AlertCircle className=\"w-5 h-5 text-yellow-600\" />\r\n        <div className=\"flex-1\">\r\n          <p className=\"text-sm font-medium text-yellow-900\">\r\n            Restore {bundle.files.length} files?\r\n          </p>\r\n          <p className=\"text-xs text-yellow-700 mt-1\">\r\n            This will copy files from backup and update Router.tsx and MenuItems.ts\r\n          </p>\r\n        </div>\r\n        <div className=\"flex gap-2\">\r\n          <button\r\n            onClick={() => setShowConfirm(false)}\r\n            className=\"px-3 py-1 text-sm bg-gray-200 dark:bg-gray-600 text-gray-800 dark:text-gray-200 rounded hover:bg-gray-300 dark:hover:bg-gray-500\"\r\n          >\r\n            Cancel\r\n          </button>\r\n          <button\r\n            onClick={handleRestore}\r\n            disabled={isRestoring}\r\n            className=\"px-3 py-1 text-sm bg-green-600 text-white rounded hover:bg-green-700 disabled:opacity-50 flex items-center gap-2\"\r\n          >\r\n            {isRestoring ? (\r\n              <>\r\n                <Loader2 className=\"w-4 h-4 animate-spin\" />\r\n                Restoring...\r\n              </>\r\n            ) : (\r\n              <>\r\n                <CheckCircle className=\"w-4 h-4\" />\r\n                Confirm\r\n              </>\r\n            )}\r\n          </button>\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n  \r\n  return (\r\n    <div className=\"flex items-center gap-2\">\r\n      <RestorationStatusBadge \r\n        fileAnalysis={{\r\n          file: bundle.rootFile,\r\n          imports: bundle.missingImports,\r\n          endpoints: bundle.requiredEndpoints,\r\n          integrationPoints: []\r\n        }}\r\n        bundleSize={bundle.files.length}\r\n      />\r\n      <button\r\n        onClick={() => setShowConfirm(true)}\r\n        disabled={isRestoring || !canRestore}\r\n        className=\"px-4 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700 disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-2\"\r\n      >\r\n        <Package className=\"w-4 h-4\" />\r\n        <span>Restore Bundle</span>\r\n      </button>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default RestoreBundleButton;\r\n","/**\r\n * Diff View Modal Component\r\n * \r\n * Shows side-by-side comparison of source and target files before restore.\r\n * Includes dependency warnings and restore confirmation.\r\n */\r\n\r\nimport React, { useState, useMemo } from 'react';\r\nimport {\r\n  Dialog,\r\n  DialogTitle,\r\n  DialogContent,\r\n  DialogActions,\r\n  Button,\r\n  Box,\r\n  Alert,\r\n  AlertTitle,\r\n  Chip,\r\n  Typography,\r\n  Tab,\r\n  Tabs,\r\n  List,\r\n  ListItem,\r\n  ListItemText,\r\n  Divider,\r\n  CircularProgress\r\n} from '@mui/material';\r\nimport { useTheme, alpha } from '@mui/material/styles';\r\nimport { \r\n  AlertTriangle, \r\n  CheckCircle, \r\n  XCircle, \r\n  FileText,\r\n  GitCompare,\r\n  Package\r\n} from 'lucide-react';\r\nimport { FilePreview, DependencyCheckResult } from '@/types/refactorConsole';\r\n\r\ninterface DiffViewModalProps {\r\n  open: boolean;\r\n  onClose: () => void;\r\n  onConfirmRestore: () => void | Promise<void>;\r\n  preview: FilePreview | null;\r\n  dependencies: DependencyCheckResult | null;\r\n  isRestoring?: boolean;\r\n}\r\n\r\ninterface TabPanelProps {\r\n  children?: React.ReactNode;\r\n  index: number;\r\n  value: number;\r\n}\r\n\r\nfunction TabPanel(props: TabPanelProps) {\r\n  const { children, value, index, ...other } = props;\r\n  return (\r\n    <div\r\n      role=\"tabpanel\"\r\n      hidden={value !== index}\r\n      id={`diff-tabpanel-${index}`}\r\n      aria-labelledby={`diff-tab-${index}`}\r\n      {...other}\r\n    >\r\n      {value === index && <Box sx={{ pt: 2 }}>{children}</Box>}\r\n    </div>\r\n  );\r\n}\r\n\r\nconst DiffViewModal: React.FC<DiffViewModalProps> = ({\r\n  open,\r\n  onClose,\r\n  onConfirmRestore,\r\n  preview,\r\n  dependencies,\r\n  isRestoring = false\r\n}) => {\r\n  const theme = useTheme();\r\n  const [activeTab, setActiveTab] = useState(0);\r\n\r\n  // Calculate diff lines\r\n  const diffLines = useMemo(() => {\r\n    if (!preview) return { source: [], target: [], unified: [] };\r\n\r\n    const sourceLines = preview.sourceContent.split('\\n');\r\n    const targetLines = preview.targetContent ? preview.targetContent.split('\\n') : [];\r\n\r\n    // Simple line-by-line comparison\r\n    const maxLines = Math.max(sourceLines.length, targetLines.length);\r\n    const unified: Array<{\r\n      type: 'add' | 'remove' | 'unchanged' | 'empty';\r\n      sourceNum: number | null;\r\n      targetNum: number | null;\r\n      sourceLine: string;\r\n      targetLine: string;\r\n    }> = [];\r\n\r\n    for (let i = 0; i < maxLines; i++) {\r\n      const sourceLine = sourceLines[i] || '';\r\n      const targetLine = targetLines[i] || '';\r\n      \r\n      let type: 'add' | 'remove' | 'unchanged' | 'empty' = 'unchanged';\r\n      if (i >= targetLines.length && i < sourceLines.length) {\r\n        type = 'add';\r\n      } else if (i >= sourceLines.length && i < targetLines.length) {\r\n        type = 'remove';\r\n      } else if (sourceLine !== targetLine) {\r\n        type = 'add'; // Changed line\r\n      }\r\n\r\n      unified.push({\r\n        type,\r\n        sourceNum: i < sourceLines.length ? i + 1 : null,\r\n        targetNum: i < targetLines.length ? i + 1 : null,\r\n        sourceLine,\r\n        targetLine\r\n      });\r\n    }\r\n\r\n    return { source: sourceLines, target: targetLines, unified };\r\n  }, [preview]);\r\n\r\n  const handleTabChange = (_event: React.SyntheticEvent, newValue: number) => {\r\n    setActiveTab(newValue);\r\n  };\r\n\r\n  if (!preview || !dependencies) {\r\n    return null;\r\n  }\r\n\r\n  const hasMissingDeps = dependencies.missingCount > 0;\r\n  const isNewFile = !preview.targetExists;\r\n\r\n  return (\r\n    <Dialog\r\n      open={open}\r\n      onClose={onClose}\r\n      maxWidth=\"xl\"\r\n      fullWidth\r\n      PaperProps={{\r\n        sx: {\r\n          height: '90vh',\r\n          bgcolor: 'background.paper'\r\n        }\r\n      }}\r\n    >\r\n      <DialogTitle>\r\n        <Box sx={{ display: 'flex', alignItems: 'center', justifyContent: 'space-between' }}>\r\n          <Box sx={{ display: 'flex', alignItems: 'center', gap: 1 }}>\r\n            <GitCompare className=\"w-5 h-5\" />\r\n            <Typography variant=\"h6\">Preview Restore</Typography>\r\n          </Box>\r\n          <Box sx={{ display: 'flex', gap: 1 }}>\r\n            {isNewFile && (\r\n              <Chip label=\"New File\" color=\"success\" size=\"small\" />\r\n            )}\r\n            {preview.diffStats.identical && !isNewFile && (\r\n              <Chip label=\"Identical\" color=\"info\" size=\"small\" />\r\n            )}\r\n            {hasMissingDeps && (\r\n              <Chip \r\n                label={`${dependencies.missingCount} Missing Dep${dependencies.missingCount > 1 ? 's' : ''}`} \r\n                color=\"warning\" \r\n                size=\"small\"\r\n                icon={<AlertTriangle className=\"w-3 h-3\" />}\r\n              />\r\n            )}\r\n          </Box>\r\n        </Box>\r\n        <Typography variant=\"body2\" sx={{ color: 'text.secondary', mt: 0.5, fontFamily: 'monospace' }}>\r\n          {preview.relPath}\r\n        </Typography>\r\n      </DialogTitle>\r\n\r\n      <DialogContent dividers>\r\n        {/* Warnings Section */}\r\n        {hasMissingDeps && (\r\n          <Alert severity=\"warning\" sx={{ mb: 2 }}>\r\n            <AlertTitle>Missing Dependencies Detected</AlertTitle>\r\n            This file imports {dependencies.missingCount} component(s) that don't exist in the target directory.\r\n            Restoring this file may cause runtime errors.\r\n          </Alert>\r\n        )}\r\n\r\n        {/* Tabs */}\r\n        <Box sx={{ borderBottom: 1, borderColor: 'divider' }}>\r\n          <Tabs value={activeTab} onChange={handleTabChange}>\r\n            <Tab label=\"Side-by-Side Diff\" icon={<GitCompare className=\"w-4 h-4\" />} iconPosition=\"start\" />\r\n            <Tab label=\"Dependencies\" icon={<Package className=\"w-4 h-4\" />} iconPosition=\"start\" />\r\n            <Tab label=\"File Info\" icon={<FileText className=\"w-4 h-4\" />} iconPosition=\"start\" />\r\n          </Tabs>\r\n        </Box>\r\n\r\n        {/* Tab: Diff View */}\r\n        <TabPanel value={activeTab} index={0}>\r\n          <Box sx={{ \r\n            display: 'grid', \r\n            gridTemplateColumns: '1fr 1fr', \r\n            gap: 2,\r\n            height: '60vh',\r\n            overflow: 'auto'\r\n          }}>\r\n            {/* Source Column */}\r\n            <Box sx={{ border: 1, borderColor: 'divider', borderRadius: 1, overflow: 'hidden' }}>\r\n              <Box sx={{ \r\n                bgcolor: alpha(theme.palette.success.main, 0.1), \r\n                p: 1,\r\n                borderBottom: 1,\r\n                borderColor: 'divider'\r\n              }}>\r\n                <Typography variant=\"subtitle2\" sx={{ fontWeight: 600 }}>\r\n                  Source (Snapshot)\r\n                </Typography>\r\n                <Typography variant=\"caption\" sx={{ color: 'text.secondary' }}>\r\n                  {preview.sourceSize} bytes  {diffLines.source.length} lines\r\n                </Typography>\r\n              </Box>\r\n              <Box sx={{ \r\n                fontFamily: 'monospace', \r\n                fontSize: '0.8rem',\r\n                p: 1,\r\n                bgcolor: 'background.default',\r\n                maxHeight: '100%',\r\n                overflow: 'auto'\r\n              }}>\r\n                {diffLines.source.map((line, i) => {\r\n                  const diffLine = diffLines.unified[i];\r\n                  const isChanged = diffLine?.type === 'add';\r\n                  return (\r\n                    <Box\r\n                      key={i}\r\n                      sx={{\r\n                        display: 'flex',\r\n                        bgcolor: isChanged ? alpha(theme.palette.success.main, 0.1) : 'transparent',\r\n                        '&:hover': { bgcolor: alpha(theme.palette.primary.main, 0.05) }\r\n                      }}\r\n                    >\r\n                      <Box sx={{ \r\n                        width: 40, \r\n                        color: 'text.secondary', \r\n                        textAlign: 'right',\r\n                        pr: 1,\r\n                        flexShrink: 0,\r\n                        userSelect: 'none',\r\n                        borderRight: 1,\r\n                        borderColor: 'divider'\r\n                      }}>\r\n                        {i + 1}\r\n                      </Box>\r\n                      <Box sx={{ flex: 1, pl: 1, whiteSpace: 'pre', overflowX: 'auto' }}>\r\n                        {line || ' '}\r\n                      </Box>\r\n                    </Box>\r\n                  );\r\n                })}\r\n              </Box>\r\n            </Box>\r\n\r\n            {/* Target Column */}\r\n            <Box sx={{ border: 1, borderColor: 'divider', borderRadius: 1, overflow: 'hidden' }}>\r\n              <Box sx={{ \r\n                bgcolor: isNewFile ? alpha(theme.palette.info.main, 0.1) : alpha(theme.palette.error.main, 0.1), \r\n                p: 1,\r\n                borderBottom: 1,\r\n                borderColor: 'divider'\r\n              }}>\r\n                <Typography variant=\"subtitle2\" sx={{ fontWeight: 600 }}>\r\n                  Target (Current)\r\n                </Typography>\r\n                <Typography variant=\"caption\" sx={{ color: 'text.secondary' }}>\r\n                  {isNewFile ? 'File does not exist' : `${preview.targetSize} bytes  ${diffLines.target.length} lines`}\r\n                </Typography>\r\n              </Box>\r\n              <Box sx={{ \r\n                fontFamily: 'monospace', \r\n                fontSize: '0.8rem',\r\n                p: 1,\r\n                bgcolor: 'background.default',\r\n                maxHeight: '100%',\r\n                overflow: 'auto'\r\n              }}>\r\n                {isNewFile ? (\r\n                  <Box sx={{ p: 2, textAlign: 'center', color: 'text.secondary' }}>\r\n                    <Typography variant=\"body2\">File will be created</Typography>\r\n                  </Box>\r\n                ) : (\r\n                  diffLines.target.map((line, i) => {\r\n                    const diffLine = diffLines.unified[i];\r\n                    const isChanged = diffLine?.type === 'add';\r\n                    return (\r\n                      <Box\r\n                        key={i}\r\n                        sx={{\r\n                          display: 'flex',\r\n                          bgcolor: isChanged ? alpha(theme.palette.error.main, 0.1) : 'transparent',\r\n                          '&:hover': { bgcolor: alpha(theme.palette.primary.main, 0.05) }\r\n                        }}\r\n                      >\r\n                        <Box sx={{ \r\n                          width: 40, \r\n                          color: 'text.secondary', \r\n                          textAlign: 'right',\r\n                          pr: 1,\r\n                          flexShrink: 0,\r\n                          userSelect: 'none',\r\n                          borderRight: 1,\r\n                          borderColor: 'divider'\r\n                        }}>\r\n                          {i + 1}\r\n                        </Box>\r\n                        <Box sx={{ flex: 1, pl: 1, whiteSpace: 'pre', overflowX: 'auto' }}>\r\n                          {line || ' '}\r\n                        </Box>\r\n                      </Box>\r\n                    );\r\n                  })\r\n                )}\r\n              </Box>\r\n            </Box>\r\n          </Box>\r\n        </TabPanel>\r\n\r\n        {/* Tab: Dependencies */}\r\n        <TabPanel value={activeTab} index={1}>\r\n          <Box sx={{ maxHeight: '60vh', overflow: 'auto' }}>\r\n            {!dependencies.hasImports ? (\r\n              <Alert severity=\"info\">\r\n                <AlertTitle>No Dependencies</AlertTitle>\r\n                This file does not import any other files.\r\n              </Alert>\r\n            ) : (\r\n              <Box>\r\n                <Typography variant=\"subtitle1\" sx={{ mb: 2 }}>\r\n                  Found {dependencies.totalImports} import{dependencies.totalImports !== 1 ? 's' : ''}\r\n                </Typography>\r\n\r\n                {dependencies.missingCount > 0 && (\r\n                  <Alert severity=\"warning\" sx={{ mb: 2 }}>\r\n                    <AlertTitle> {dependencies.missingCount} Missing Dependencies</AlertTitle>\r\n                    The following imports could not be resolved in the target directory:\r\n                  </Alert>\r\n                )}\r\n\r\n                <List>\r\n                  {dependencies.imports.map((imp, idx) => (\r\n                    <React.Fragment key={idx}>\r\n                      <ListItem>\r\n                        <Box sx={{ display: 'flex', alignItems: 'center', width: '100%', gap: 2 }}>\r\n                          {imp.exists ? (\r\n                            <CheckCircle className=\"w-5 h-5\" style={{ color: theme.palette.success.main }} />\r\n                          ) : (\r\n                            <XCircle className=\"w-5 h-5\" style={{ color: theme.palette.error.main }} />\r\n                          )}\r\n                          <Box sx={{ flex: 1 }}>\r\n                            <Typography \r\n                              variant=\"body2\" \r\n                              sx={{ \r\n                                fontFamily: 'monospace',\r\n                                color: imp.exists ? 'text.primary' : 'error.main'\r\n                              }}\r\n                            >\r\n                              {imp.importPath}\r\n                            </Typography>\r\n                            {imp.resolvedPath && (\r\n                              <Typography variant=\"caption\" sx={{ color: 'text.secondary' }}>\r\n                                Line {imp.lineNumber}  {imp.resolvedPath}\r\n                              </Typography>\r\n                            )}\r\n                            {!imp.exists && !imp.resolvedPath && imp.importType !== 'package' && (\r\n                              <Typography variant=\"caption\" sx={{ color: 'error.main' }}>\r\n                                Line {imp.lineNumber}  Not found in target\r\n                              </Typography>\r\n                            )}\r\n                          </Box>\r\n                          <Chip \r\n                            label={imp.importType} \r\n                            size=\"small\" \r\n                            variant=\"outlined\"\r\n                            color={imp.importType === 'package' ? 'default' : 'primary'}\r\n                          />\r\n                        </Box>\r\n                      </ListItem>\r\n                      {idx < dependencies.imports.length - 1 && <Divider />}\r\n                    </React.Fragment>\r\n                  ))}\r\n                </List>\r\n              </Box>\r\n            )}\r\n          </Box>\r\n        </TabPanel>\r\n\r\n        {/* Tab: File Info */}\r\n        <TabPanel value={activeTab} index={2}>\r\n          <Box sx={{ display: 'flex', flexDirection: 'column', gap: 2 }}>\r\n            <Box>\r\n              <Typography variant=\"subtitle2\" sx={{ fontWeight: 600, mb: 1 }}>\r\n                Source File (Snapshot)\r\n              </Typography>\r\n              <Box sx={{ display: 'grid', gridTemplateColumns: 'auto 1fr', gap: 1, fontSize: '0.875rem' }}>\r\n                <Typography variant=\"body2\" sx={{ color: 'text.secondary' }}>Path:</Typography>\r\n                <Typography variant=\"body2\" sx={{ fontFamily: 'monospace' }}>{preview.sourcePath}</Typography>\r\n                <Typography variant=\"body2\" sx={{ color: 'text.secondary' }}>Size:</Typography>\r\n                <Typography variant=\"body2\">{preview.sourceSize} bytes</Typography>\r\n                <Typography variant=\"body2\" sx={{ color: 'text.secondary' }}>Lines:</Typography>\r\n                <Typography variant=\"body2\">{diffLines.source.length}</Typography>\r\n                <Typography variant=\"body2\" sx={{ color: 'text.secondary' }}>Modified:</Typography>\r\n                <Typography variant=\"body2\">{new Date(preview.sourceModified).toLocaleString()}</Typography>\r\n              </Box>\r\n            </Box>\r\n\r\n            <Divider />\r\n\r\n            <Box>\r\n              <Typography variant=\"subtitle2\" sx={{ fontWeight: 600, mb: 1 }}>\r\n                Target File (Current)\r\n              </Typography>\r\n              {isNewFile ? (\r\n                <Alert severity=\"info\">File does not exist in target directory - it will be created</Alert>\r\n              ) : (\r\n                <Box sx={{ display: 'grid', gridTemplateColumns: 'auto 1fr', gap: 1, fontSize: '0.875rem' }}>\r\n                  <Typography variant=\"body2\" sx={{ color: 'text.secondary' }}>Path:</Typography>\r\n                  <Typography variant=\"body2\" sx={{ fontFamily: 'monospace' }}>{preview.targetPath}</Typography>\r\n                  <Typography variant=\"body2\" sx={{ color: 'text.secondary' }}>Size:</Typography>\r\n                  <Typography variant=\"body2\">{preview.targetSize} bytes</Typography>\r\n                  <Typography variant=\"body2\" sx={{ color: 'text.secondary' }}>Lines:</Typography>\r\n                  <Typography variant=\"body2\">{diffLines.target.length}</Typography>\r\n                  <Typography variant=\"body2\" sx={{ color: 'text.secondary' }}>Modified:</Typography>\r\n                  <Typography variant=\"body2\">\r\n                    {preview.targetModified ? new Date(preview.targetModified).toLocaleString() : 'N/A'}\r\n                  </Typography>\r\n                </Box>\r\n              )}\r\n            </Box>\r\n\r\n            <Divider />\r\n\r\n            <Box>\r\n              <Typography variant=\"subtitle2\" sx={{ fontWeight: 600, mb: 1 }}>\r\n                Restore Impact\r\n              </Typography>\r\n              <Box sx={{ display: 'flex', flexDirection: 'column', gap: 1 }}>\r\n                <Alert severity={isNewFile ? 'info' : preview.diffStats.identical ? 'success' : 'warning'}>\r\n                  {isNewFile && 'New file will be created'}\r\n                  {!isNewFile && preview.diffStats.identical && 'Files are identical - no changes needed'}\r\n                  {!isNewFile && !preview.diffStats.identical && (\r\n                    <>\r\n                      {preview.diffStats.linesAdded > 0 ? `${preview.diffStats.linesAdded} lines will be added` : ''}\r\n                      {preview.diffStats.linesAdded < 0 ? `${Math.abs(preview.diffStats.linesAdded)} lines will be removed` : ''}\r\n                      {preview.diffStats.linesAdded === 0 ? 'Same number of lines, but content differs' : ''}\r\n                    </>\r\n                  )}\r\n                </Alert>\r\n              </Box>\r\n            </Box>\r\n          </Box>\r\n        </TabPanel>\r\n      </DialogContent>\r\n\r\n      <DialogActions sx={{ p: 2, gap: 1 }}>\r\n        <Button onClick={onClose} disabled={isRestoring}>\r\n          Cancel\r\n        </Button>\r\n        <Button\r\n          variant=\"contained\"\r\n          color={hasMissingDeps ? 'warning' : 'primary'}\r\n          onClick={onConfirmRestore}\r\n          disabled={isRestoring}\r\n          startIcon={isRestoring ? <CircularProgress size={16} /> : null}\r\n        >\r\n          {isRestoring ? 'Restoring...' : hasMissingDeps ? 'Restore Anyway' : 'Confirm Restore'}\r\n        </Button>\r\n      </DialogActions>\r\n    </Dialog>\r\n  );\r\n};\r\n\r\nexport default DiffViewModal;\r\n","/**\r\n * Restore History Viewer Component\r\n * \r\n * Displays audit log of all file restore operations.\r\n * Shows who restored what, when, and from which source.\r\n */\r\n\r\nimport React, { useState, useEffect } from 'react';\r\nimport {\r\n  Dialog,\r\n  DialogTitle,\r\n  DialogContent,\r\n  DialogActions,\r\n  Button,\r\n  Box,\r\n  Typography,\r\n  Table,\r\n  TableBody,\r\n  TableCell,\r\n  TableContainer,\r\n  TableHead,\r\n  TableRow,\r\n  Paper,\r\n  Chip,\r\n  IconButton,\r\n  Tooltip,\r\n  Alert,\r\n  CircularProgress,\r\n  TablePagination\r\n} from '@mui/material';\r\nimport { useTheme, alpha } from '@mui/material/styles';\r\nimport { \r\n  History, \r\n  Download, \r\n  CheckCircle, \r\n  XCircle,\r\n  User,\r\n  Calendar,\r\n  FileText,\r\n  HardDrive,\r\n  RefreshCw\r\n} from 'lucide-react';\r\nimport { RestoreHistoryEntry, RestoreHistoryStats } from '@/types/refactorConsole';\r\nimport refactorConsoleClient from '../api/refactorConsoleClient';\r\n\r\ninterface RestoreHistoryViewerProps {\r\n  open: boolean;\r\n  onClose: () => void;\r\n}\r\n\r\nconst RestoreHistoryViewer: React.FC<RestoreHistoryViewerProps> = ({\r\n  open,\r\n  onClose\r\n}) => {\r\n  const theme = useTheme();\r\n  const [entries, setEntries] = useState<RestoreHistoryEntry[]>([]);\r\n  const [stats, setStats] = useState<RestoreHistoryStats | null>(null);\r\n  const [isLoading, setIsLoading] = useState(false);\r\n  const [error, setError] = useState<string | null>(null);\r\n  const [page, setPage] = useState(0);\r\n  const [rowsPerPage, setRowsPerPage] = useState(25);\r\n  const [total, setTotal] = useState(0);\r\n\r\n  useEffect(() => {\r\n    if (open) {\r\n      loadHistory();\r\n      loadStats();\r\n    }\r\n  }, [open, page, rowsPerPage]);\r\n\r\n  const loadHistory = async () => {\r\n    setIsLoading(true);\r\n    setError(null);\r\n    \r\n    try {\r\n      const result = await refactorConsoleClient.getRestoreHistory(\r\n        rowsPerPage,\r\n        page * rowsPerPage\r\n      );\r\n      \r\n      setEntries(result.entries);\r\n      setTotal(result.total);\r\n    } catch (err) {\r\n      console.error('Failed to load restore history:', err);\r\n      setError(err instanceof Error ? err.message : 'Failed to load history');\r\n    } finally {\r\n      setIsLoading(false);\r\n    }\r\n  };\r\n\r\n  const loadStats = async () => {\r\n    try {\r\n      const result = await refactorConsoleClient.getRestoreHistoryStats();\r\n      setStats(result.stats);\r\n    } catch (err) {\r\n      console.error('Failed to load stats:', err);\r\n    }\r\n  };\r\n\r\n  const handleExport = async () => {\r\n    try {\r\n      await refactorConsoleClient.exportRestoreHistory(1000);\r\n    } catch (err) {\r\n      console.error('Failed to export history:', err);\r\n    }\r\n  };\r\n\r\n  const handleChangePage = (_event: unknown, newPage: number) => {\r\n    setPage(newPage);\r\n  };\r\n\r\n  const handleChangeRowsPerPage = (event: React.ChangeEvent<HTMLInputElement>) => {\r\n    setRowsPerPage(parseInt(event.target.value, 10));\r\n    setPage(0);\r\n  };\r\n\r\n  const formatDate = (timestamp: string) => {\r\n    const date = new Date(timestamp);\r\n    return date.toLocaleString();\r\n  };\r\n\r\n  const formatSize = (bytes: number) => {\r\n    if (bytes === 0) return '0 B';\r\n    const k = 1024;\r\n    const sizes = ['B', 'KB', 'MB', 'GB'];\r\n    const i = Math.floor(Math.log(bytes) / Math.log(k));\r\n    return `${parseFloat((bytes / Math.pow(k, i)).toFixed(2))} ${sizes[i]}`;\r\n  };\r\n\r\n  return (\r\n    <Dialog\r\n      open={open}\r\n      onClose={onClose}\r\n      maxWidth=\"xl\"\r\n      fullWidth\r\n      PaperProps={{\r\n        sx: {\r\n          height: '90vh',\r\n          bgcolor: 'background.paper'\r\n        }\r\n      }}\r\n    >\r\n      <DialogTitle>\r\n        <Box sx={{ display: 'flex', alignItems: 'center', justifyContent: 'space-between' }}>\r\n          <Box sx={{ display: 'flex', alignItems: 'center', gap: 1 }}>\r\n            <History className=\"w-5 h-5\" />\r\n            <Typography variant=\"h6\">Restore History</Typography>\r\n          </Box>\r\n          <Box sx={{ display: 'flex', gap: 1, alignItems: 'center' }}>\r\n            <Tooltip title=\"Export to CSV\">\r\n              <IconButton size=\"small\" onClick={handleExport}>\r\n                <Download className=\"w-4 h-4\" />\r\n              </IconButton>\r\n            </Tooltip>\r\n            <Tooltip title=\"Refresh\">\r\n              <IconButton size=\"small\" onClick={() => { loadHistory(); loadStats(); }}>\r\n                <RefreshCw className=\"w-4 h-4\" />\r\n              </IconButton>\r\n            </Tooltip>\r\n          </Box>\r\n        </Box>\r\n      </DialogTitle>\r\n\r\n      <DialogContent dividers>\r\n        {/* Statistics Cards */}\r\n        {stats && (\r\n          <Box sx={{ \r\n            display: 'grid', \r\n            gridTemplateColumns: 'repeat(auto-fit, minmax(150px, 1fr))', \r\n            gap: 2, \r\n            mb: 3 \r\n          }}>\r\n            <Paper elevation={0} sx={{ p: 2, bgcolor: alpha(theme.palette.primary.main, 0.1), border: 1, borderColor: 'divider' }}>\r\n              <Typography variant=\"caption\" sx={{ color: 'text.secondary' }}>Total Restores</Typography>\r\n              <Typography variant=\"h6\" sx={{ fontWeight: 600 }}>{stats.totalRestores}</Typography>\r\n            </Paper>\r\n            <Paper elevation={0} sx={{ p: 2, bgcolor: alpha(theme.palette.success.main, 0.1), border: 1, borderColor: 'divider' }}>\r\n              <Typography variant=\"caption\" sx={{ color: 'text.secondary' }}>Successful</Typography>\r\n              <Typography variant=\"h6\" sx={{ fontWeight: 600, color: 'success.main' }}>{stats.successfulRestores}</Typography>\r\n            </Paper>\r\n            <Paper elevation={0} sx={{ p: 2, bgcolor: alpha(theme.palette.error.main, 0.1), border: 1, borderColor: 'divider' }}>\r\n              <Typography variant=\"caption\" sx={{ color: 'text.secondary' }}>Failed</Typography>\r\n              <Typography variant=\"h6\" sx={{ fontWeight: 600, color: 'error.main' }}>{stats.failedRestores}</Typography>\r\n            </Paper>\r\n            <Paper elevation={0} sx={{ p: 2, bgcolor: alpha(theme.palette.info.main, 0.1), border: 1, borderColor: 'divider' }}>\r\n              <Typography variant=\"caption\" sx={{ color: 'text.secondary' }}>Unique Files</Typography>\r\n              <Typography variant=\"h6\" sx={{ fontWeight: 600 }}>{stats.uniqueFiles}</Typography>\r\n            </Paper>\r\n            <Paper elevation={0} sx={{ p: 2, bgcolor: alpha(theme.palette.secondary.main, 0.1), border: 1, borderColor: 'divider' }}>\r\n              <Typography variant=\"caption\" sx={{ color: 'text.secondary' }}>Users</Typography>\r\n              <Typography variant=\"h6\" sx={{ fontWeight: 600 }}>{stats.uniqueUsers}</Typography>\r\n            </Paper>\r\n          </Box>\r\n        )}\r\n\r\n        {/* Error Alert */}\r\n        {error && (\r\n          <Alert severity=\"error\" sx={{ mb: 2 }} onClose={() => setError(null)}>\r\n            {error}\r\n          </Alert>\r\n        )}\r\n\r\n        {/* Loading State */}\r\n        {isLoading && (\r\n          <Box sx={{ display: 'flex', justifyContent: 'center', p: 4 }}>\r\n            <CircularProgress />\r\n          </Box>\r\n        )}\r\n\r\n        {/* History Table */}\r\n        {!isLoading && entries.length > 0 && (\r\n          <TableContainer component={Paper} variant=\"outlined\">\r\n            <Table size=\"small\">\r\n              <TableHead>\r\n                <TableRow sx={{ bgcolor: 'action.hover' }}>\r\n                  <TableCell>Status</TableCell>\r\n                  <TableCell>Timestamp</TableCell>\r\n                  <TableCell>User</TableCell>\r\n                  <TableCell>File Path</TableCell>\r\n                  <TableCell>Source</TableCell>\r\n                  <TableCell>Snapshot</TableCell>\r\n                  <TableCell align=\"right\">Size</TableCell>\r\n                </TableRow>\r\n              </TableHead>\r\n              <TableBody>\r\n                {entries.map((entry) => (\r\n                  <TableRow \r\n                    key={entry.id}\r\n                    hover\r\n                    sx={{\r\n                      '&:hover': { bgcolor: alpha(theme.palette.primary.main, 0.05) }\r\n                    }}\r\n                  >\r\n                    <TableCell>\r\n                      {entry.success ? (\r\n                        <Tooltip title=\"Success\">\r\n                          <CheckCircle className=\"w-4 h-4\" style={{ color: theme.palette.success.main }} />\r\n                        </Tooltip>\r\n                      ) : (\r\n                        <Tooltip title={entry.error || 'Failed'}>\r\n                          <XCircle className=\"w-4 h-4\" style={{ color: theme.palette.error.main }} />\r\n                        </Tooltip>\r\n                      )}\r\n                    </TableCell>\r\n                    <TableCell>\r\n                      <Box sx={{ display: 'flex', alignItems: 'center', gap: 0.5 }}>\r\n                        <Calendar className=\"w-3 h-3\" style={{ color: theme.palette.text.secondary }} />\r\n                        <Typography variant=\"caption\">{formatDate(entry.timestamp)}</Typography>\r\n                      </Box>\r\n                    </TableCell>\r\n                    <TableCell>\r\n                      <Box sx={{ display: 'flex', alignItems: 'center', gap: 0.5 }}>\r\n                        <User className=\"w-3 h-3\" style={{ color: theme.palette.text.secondary }} />\r\n                        <Typography variant=\"caption\">\r\n                          {entry.user || entry.userEmail || 'anonymous'}\r\n                        </Typography>\r\n                      </Box>\r\n                    </TableCell>\r\n                    <TableCell>\r\n                      <Box sx={{ display: 'flex', alignItems: 'center', gap: 0.5 }}>\r\n                        <FileText className=\"w-3 h-3\" style={{ color: theme.palette.text.secondary }} />\r\n                        <Typography \r\n                          variant=\"caption\" \r\n                          sx={{ \r\n                            fontFamily: 'monospace',\r\n                            maxWidth: 300,\r\n                            overflow: 'hidden',\r\n                            textOverflow: 'ellipsis',\r\n                            whiteSpace: 'nowrap'\r\n                          }}\r\n                          title={entry.relPath}\r\n                        >\r\n                          {entry.relPath}\r\n                        </Typography>\r\n                      </Box>\r\n                    </TableCell>\r\n                    <TableCell>\r\n                      <Chip \r\n                        label={entry.sourceType} \r\n                        size=\"small\" \r\n                        color={entry.sourceType === 'remote' ? 'secondary' : 'default'}\r\n                        sx={{ height: 20, fontSize: '0.65rem' }}\r\n                      />\r\n                    </TableCell>\r\n                    <TableCell>\r\n                      {entry.snapshotId ? (\r\n                        <Chip \r\n                          label={entry.snapshotId} \r\n                          size=\"small\" \r\n                          color=\"primary\"\r\n                          sx={{ height: 20, fontSize: '0.65rem' }}\r\n                        />\r\n                      ) : (\r\n                        <Typography variant=\"caption\" sx={{ color: 'text.secondary' }}></Typography>\r\n                      )}\r\n                    </TableCell>\r\n                    <TableCell align=\"right\">\r\n                      <Box sx={{ display: 'flex', alignItems: 'center', gap: 0.5, justifyContent: 'flex-end' }}>\r\n                        <HardDrive className=\"w-3 h-3\" style={{ color: theme.palette.text.secondary }} />\r\n                        <Typography variant=\"caption\">{formatSize(entry.fileSize)}</Typography>\r\n                      </Box>\r\n                    </TableCell>\r\n                  </TableRow>\r\n                ))}\r\n              </TableBody>\r\n            </Table>\r\n          </TableContainer>\r\n        )}\r\n\r\n        {/* Empty State */}\r\n        {!isLoading && entries.length === 0 && (\r\n          <Box sx={{ textAlign: 'center', py: 6 }}>\r\n            <History className=\"w-12 h-12 mx-auto mb-2\" style={{ color: theme.palette.text.secondary, opacity: 0.5 }} />\r\n            <Typography variant=\"body1\" sx={{ color: 'text.secondary' }}>\r\n              No restore history yet\r\n            </Typography>\r\n            <Typography variant=\"body2\" sx={{ color: 'text.secondary', mt: 1 }}>\r\n              Restore operations will be logged here for audit purposes\r\n            </Typography>\r\n          </Box>\r\n        )}\r\n\r\n        {/* Pagination */}\r\n        {!isLoading && entries.length > 0 && (\r\n          <TablePagination\r\n            rowsPerPageOptions={[10, 25, 50, 100]}\r\n            component=\"div\"\r\n            count={total}\r\n            rowsPerPage={rowsPerPage}\r\n            page={page}\r\n            onPageChange={handleChangePage}\r\n            onRowsPerPageChange={handleChangeRowsPerPage}\r\n          />\r\n        )}\r\n      </DialogContent>\r\n\r\n      <DialogActions sx={{ p: 2 }}>\r\n        <Button onClick={onClose}>Close</Button>\r\n      </DialogActions>\r\n    </Dialog>\r\n  );\r\n};\r\n\r\nexport default RestoreHistoryViewer;\r\n","/**\r\n * Recursive Bundle Resolver\r\n * \r\n * Follows import paths to group Pages, Components, Hooks, and Services\r\n * into actionable feature bundles.\r\n */\r\n\r\nimport { FileComparison, FileAnalysis, FeatureBundle, ImportDependency, EndpointReference } from '@/types/refactorConsole';\r\n\r\n// Note: This runs in the browser, so we can't access file system directly\r\n// All file paths are relative paths from the backup source\r\n\r\n/**\r\n * Categorize a file based on its path and name\r\n */\r\nfunction categorizeFile(relPath: string): 'page' | 'component' | 'hook' | 'service' | 'other' {\r\n  const lowerPath = relPath.toLowerCase();\r\n  \r\n  if (lowerPath.includes('/pages/') || lowerPath.includes('/page/')) {\r\n    return 'page';\r\n  }\r\n  if (lowerPath.includes('/components/') || lowerPath.includes('/component/')) {\r\n    return 'component';\r\n  }\r\n  if (lowerPath.includes('/hooks/') || lowerPath.includes('/hook/') || lowerPath.includes('use') && relPath.endsWith('.ts')) {\r\n    return 'hook';\r\n  }\r\n  if (lowerPath.includes('/services/') || lowerPath.includes('/service/') || lowerPath.includes('/api/')) {\r\n    return 'service';\r\n  }\r\n  \r\n  return 'other';\r\n}\r\n\r\n/**\r\n * Resolve import path to a relative path within the backup\r\n */\r\nfunction resolveImportPath(\r\n  importPath: string,\r\n  fromFile: string,\r\n  availableFiles: Map<string, FileComparison>\r\n): string | null {\r\n  // Skip node_modules and external imports\r\n  if (!importPath.startsWith('.') && !importPath.startsWith('/') && !importPath.startsWith('@/')) {\r\n    return null;\r\n  }\r\n  \r\n  // Handle alias imports (@/)\r\n  if (importPath.startsWith('@/')) {\r\n    const aliasPath = importPath.replace('@/', '');\r\n    // Try to find in available files\r\n    for (const [relPath] of availableFiles) {\r\n      if (relPath.includes(aliasPath)) {\r\n        return relPath;\r\n      }\r\n    }\r\n    return null;\r\n  }\r\n  \r\n  // Handle relative imports\r\n  const fromDir = fromFile.substring(0, fromFile.lastIndexOf('/'));\r\n  const resolvedPath = importPath.startsWith('/')\r\n    ? importPath.substring(1)\r\n    : `${fromDir}/${importPath}`.replace(/\\/\\.\\//g, '/').replace(/\\/[^/]+\\/\\.\\.\\//g, '/');\r\n  \r\n  // Try exact match\r\n  if (availableFiles.has(resolvedPath)) {\r\n    return resolvedPath;\r\n  }\r\n  \r\n  // Try with extensions\r\n  const extensions = ['.ts', '.tsx', '.js', '.jsx'];\r\n  for (const ext of extensions) {\r\n    if (availableFiles.has(resolvedPath + ext)) {\r\n      return resolvedPath + ext;\r\n    }\r\n  }\r\n  \r\n  // Try directory index files\r\n  for (const ext of extensions) {\r\n    const indexPath = `${resolvedPath}/index${ext}`;\r\n    if (availableFiles.has(indexPath)) {\r\n      return indexPath;\r\n    }\r\n  }\r\n  \r\n  return null;\r\n}\r\n\r\n/**\r\n * Recursively calculate bundle starting from a root file\r\n */\r\nexport function calculateBundle(\r\n  rootFile: FileComparison,\r\n  allFiles: Map<string, FileComparison>,\r\n  fileAnalyses: Map<string, FileAnalysis>\r\n): FeatureBundle {\r\n  const bundle: FeatureBundle = {\r\n    rootFile,\r\n    files: [rootFile],\r\n    components: [],\r\n    hooks: [],\r\n    services: [],\r\n    pages: [],\r\n    allImportsResolved: true,\r\n    missingImports: [],\r\n    requiredEndpoints: [],\r\n    status: 'unknown'\r\n  };\r\n  \r\n  const processed = new Set<string>([rootFile.relPath]);\r\n  const queue: string[] = [rootFile.relPath];\r\n  \r\n  // BFS traversal of imports\r\n  while (queue.length > 0) {\r\n    const currentRelPath = queue.shift()!;\r\n    const fileAnalysis = fileAnalyses.get(currentRelPath);\r\n    \r\n    if (!fileAnalysis) continue;\r\n    \r\n    // Collect endpoints\r\n    bundle.requiredEndpoints.push(...fileAnalysis.endpoints);\r\n    \r\n    // Process imports\r\n    for (const imp of fileAnalysis.imports) {\r\n      if (!imp.resolved) {\r\n        bundle.allImportsResolved = false;\r\n        \r\n        // Try to resolve in backup\r\n        const resolvedPath = resolveImportPath(imp.importPath, currentRelPath, allFiles);\r\n        \r\n        if (resolvedPath && allFiles.has(resolvedPath)) {\r\n          // Found in backup - add to bundle\r\n          if (!processed.has(resolvedPath)) {\r\n            const depFile = allFiles.get(resolvedPath)!;\r\n            bundle.files.push(depFile);\r\n            processed.add(resolvedPath);\r\n            queue.push(resolvedPath);\r\n            \r\n            // Categorize\r\n            const category = categorizeFile(resolvedPath);\r\n            if (category === 'component') bundle.components.push(depFile);\r\n            else if (category === 'hook') bundle.hooks.push(depFile);\r\n            else if (category === 'service') bundle.services.push(depFile);\r\n            else if (category === 'page') bundle.pages.push(depFile);\r\n          }\r\n        } else {\r\n          // Missing import\r\n          bundle.missingImports.push(imp);\r\n        }\r\n      } else {\r\n        // Import resolved - check if it's in backup and should be included\r\n        if (imp.resolvedPath && allFiles.has(imp.resolvedPath)) {\r\n          const resolvedPath = imp.resolvedPath;\r\n          if (!processed.has(resolvedPath)) {\r\n            const depFile = allFiles.get(resolvedPath)!;\r\n            bundle.files.push(depFile);\r\n            processed.add(resolvedPath);\r\n            queue.push(resolvedPath);\r\n            \r\n            const category = categorizeFile(resolvedPath);\r\n            if (category === 'component') bundle.components.push(depFile);\r\n            else if (category === 'hook') bundle.hooks.push(depFile);\r\n            else if (category === 'service') bundle.services.push(depFile);\r\n            else if (category === 'page') bundle.pages.push(depFile);\r\n          }\r\n        }\r\n      }\r\n    }\r\n  }\r\n  \r\n  // Categorize root file\r\n  const rootCategory = categorizeFile(rootFile.relPath);\r\n  if (rootCategory === 'page') bundle.pages.push(rootFile);\r\n  else if (rootCategory === 'component') bundle.components.push(rootFile);\r\n  else if (rootCategory === 'hook') bundle.hooks.push(rootFile);\r\n  else if (rootCategory === 'service') bundle.services.push(rootFile);\r\n  \r\n  // Determine status\r\n  const missingEndpoints = bundle.requiredEndpoints.filter(ep => !ep.existsInServer);\r\n  if (missingEndpoints.length > 0) {\r\n    bundle.status = 'server_blocker';\r\n  } else if (!bundle.allImportsResolved && bundle.missingImports.length > 0) {\r\n    bundle.status = 'missing_deps';\r\n  } else if (bundle.allImportsResolved) {\r\n    bundle.status = 'ready';\r\n  }\r\n  \r\n  return bundle;\r\n}\r\n\r\n/**\r\n * Calculate bundles for all restorable files\r\n */\r\nexport function calculateAllBundles(\r\n  restorableFiles: FileComparison[],\r\n  fileAnalyses: FileAnalysis[]\r\n): Map<string, FeatureBundle> {\r\n  const bundles = new Map<string, FeatureBundle>();\r\n  const allFiles = new Map<string, FileComparison>();\r\n  const analysesMap = new Map<string, FileAnalysis>();\r\n  \r\n  // Build maps\r\n  restorableFiles.forEach(file => {\r\n    allFiles.set(file.relPath, file);\r\n  });\r\n  \r\n  fileAnalyses.forEach(analysis => {\r\n    analysesMap.set(analysis.file.relPath, analysis);\r\n  });\r\n  \r\n  // Calculate bundle for each root file\r\n  // Group files by their likely root (pages are roots, components/hooks/services are dependencies)\r\n  const processed = new Set<string>();\r\n  \r\n  restorableFiles.forEach(rootFile => {\r\n    if (processed.has(rootFile.relPath)) return;\r\n    \r\n    const category = categorizeFile(rootFile.relPath);\r\n    // Create bundles for pages and top-level files (not already part of another bundle)\r\n    if (category === 'page' || (category === 'other' && !rootFile.relPath.includes('/components/') && !rootFile.relPath.includes('/hooks/') && !rootFile.relPath.includes('/services/'))) {\r\n      const bundle = calculateBundle(rootFile, allFiles, analysesMap);\r\n      bundles.set(rootFile.relPath, bundle);\r\n      \r\n      // Mark all files in bundle as processed\r\n      bundle.files.forEach(file => processed.add(file.relPath));\r\n    }\r\n  });\r\n  \r\n  // For remaining files not in bundles, create individual bundles\r\n  restorableFiles.forEach(rootFile => {\r\n    if (!processed.has(rootFile.relPath)) {\r\n      const bundle = calculateBundle(rootFile, allFiles, analysesMap);\r\n      bundles.set(rootFile.relPath, bundle);\r\n    }\r\n  });\r\n  \r\n  return bundles;\r\n}\r\n","import { useState, useEffect, useCallback, useMemo, useRef } from 'react';\r\nimport { RefactorScan, FileNode, Classification, FilterState, SortOption, TreeItem, Phase1Report, FeatureBundle } from '@/types/refactorConsole';\r\nimport refactorConsoleClient from '../api/refactorConsoleClient';\r\nimport { calculateAllBundles } from '../utils/bundleResolver';\r\n\r\n// Phase 1 job status type\r\ntype Phase1Status = 'idle' | 'starting' | 'running' | 'done' | 'error';\r\n\r\ninterface UseRefactorScanReturn {\r\n  scanData: RefactorScan | null;\r\n  isLoading: boolean;\r\n  error: string | null;\r\n  \r\n  // Filtering and search\r\n  filterState: FilterState;\r\n  setFilterState: React.Dispatch<React.SetStateAction<FilterState>>;\r\n  \r\n  // Sorting\r\n  sortOption: SortOption;\r\n  setSortOption: React.Dispatch<React.SetStateAction<SortOption>>;\r\n  \r\n  // Tree structure\r\n  treeItems: TreeItem[];\r\n  expandedPaths: Set<string>;\r\n  setExpandedPaths: React.Dispatch<React.SetStateAction<Set<string>>>;\r\n  \r\n  // Actions\r\n  loadScanData: (rebuild?: boolean, compareWithBackup?: boolean, sourceType?: 'local' | 'remote', snapshotId?: string) => Promise<void>;\r\n  refreshScan: () => Promise<void>;\r\n  \r\n  // Utilities\r\n  toggleExpanded: (path: string) => void;\r\n  expandAll: () => void;\r\n  collapseAll: () => void;\r\n  \r\n  // Statistics\r\n  filteredCount: number;\r\n  visibleNodes: FileNode[];\r\n  \r\n  // Gap Analysis\r\n  compareWithBackup: boolean;\r\n  setCompareWithBackup: React.Dispatch<React.SetStateAction<boolean>>;\r\n  \r\n  // Phase 1 & Bundles\r\n  phase1Report: Phase1Report | null;\r\n  phase1Status: Phase1Status;\r\n  phase1Progress: number;\r\n  phase1CurrentStep: string;\r\n  phase1Error: string | null;\r\n  startPhase1Analysis: () => Promise<void>;\r\n  bundles: Map<string, FeatureBundle>;\r\n  calculateBundle: (rootFileRelPath: string) => FeatureBundle | null;\r\n}\r\n\r\nexport const useRefactorScan = (): UseRefactorScanReturn => {\r\n  const [scanData, setScanData] = useState<RefactorScan | null>(null);\r\n  const [isLoading, setIsLoading] = useState(false);\r\n  const [error, setError] = useState<string | null>(null);\r\n  \r\n  // Phase 1 state\r\n  const [phase1Report, setPhase1Report] = useState<Phase1Report | null>(null);\r\n  const [phase1Status, setPhase1Status] = useState<Phase1Status>('idle');\r\n  const [phase1Progress, setPhase1Progress] = useState(0);\r\n  const [phase1CurrentStep, setPhase1CurrentStep] = useState('');\r\n  const [phase1Error, setPhase1Error] = useState<string | null>(null);\r\n  const [phase1JobId, setPhase1JobId] = useState<string | null>(null);\r\n  const pollingIntervalRef = useRef<NodeJS.Timeout | null>(null);\r\n  \r\n  const [filterState, setFilterState] = useState<FilterState>({\r\n    classifications: ['green', 'orange', 'yellow', 'red'],\r\n    searchQuery: '',\r\n    fileType: '',\r\n    modifiedDays: 0,\r\n    showDuplicates: false,\r\n    recoveryStatus: undefined,\r\n    showMissingOnly: false,\r\n  });\r\n  \r\n  const [compareWithBackup, setCompareWithBackup] = useState(false);\r\n  \r\n  const [sortOption, setSortOption] = useState<SortOption>({\r\n    key: 'score',\r\n    direction: 'desc',\r\n    label: 'Usage Score (High to Low)',\r\n  });\r\n  \r\n  const [expandedPaths, setExpandedPaths] = useState<Set<string>>(new Set());\r\n\r\n  // Load scan data\r\n  const loadScanData = useCallback(async (\r\n    rebuild: boolean = false, \r\n    compareWithBackup: boolean = false,\r\n    sourceType?: 'local' | 'remote',\r\n    snapshotId?: string\r\n  ) => {\r\n    setIsLoading(true);\r\n    setError(null);\r\n    \r\n    try {\r\n      const data = await refactorConsoleClient.scan(rebuild, compareWithBackup, undefined, sourceType, snapshotId);\r\n      setScanData(data);\r\n      \r\n      // Auto-expand first level directories\r\n      const autoExpandPaths = new Set<string>();\r\n      if (data.nodes) {\r\n        data.nodes\r\n          .filter(node => node.type === 'dir')\r\n          .slice(0, 5)  // Expand first 5 directories\r\n          .forEach(node => autoExpandPaths.add(node.path));\r\n      }\r\n      setExpandedPaths(autoExpandPaths);\r\n      \r\n    } catch (err) {\r\n      setError(err instanceof Error ? err.message : 'Failed to load scan data');\r\n      console.error('Scan error:', err);\r\n    } finally {\r\n      setIsLoading(false);\r\n    }\r\n  }, []);\r\n\r\n  const refreshScan = useCallback(() => {\r\n    return loadScanData(true);\r\n  }, [loadScanData]);\r\n\r\n  // Apply filters and sorting\r\n  const filteredAndSortedNodes = useMemo(() => {\r\n    if (!scanData?.nodes) return [];\r\n    \r\n    let filtered = scanData.nodes;\r\n    \r\n    // Apply classification filter\r\n    filtered = filtered.filter(node => \r\n      filterState.classifications.includes(node.classification)\r\n    );\r\n    \r\n    // Apply search query\r\n    if (filterState.searchQuery.trim()) {\r\n      const query = filterState.searchQuery.toLowerCase();\r\n      filtered = filtered.filter(node =>\r\n        node.relPath.toLowerCase().includes(query) ||\r\n        node.reasons.some(reason => reason.toLowerCase().includes(query))\r\n      );\r\n    }\r\n    \r\n    // Apply file type filter\r\n    if (filterState.fileType) {\r\n      filtered = filtered.filter(node => \r\n        node.type === 'file' && \r\n        node.relPath.toLowerCase().endsWith(filterState.fileType.toLowerCase())\r\n      );\r\n    }\r\n    \r\n    // Apply modification date filter\r\n    if (filterState.modifiedDays > 0) {\r\n      const cutoffDate = Date.now() - (filterState.modifiedDays * 24 * 60 * 60 * 1000);\r\n      filtered = filtered.filter(node => node.mtimeMs >= cutoffDate);\r\n    }\r\n    \r\n    // Apply duplicates filter\r\n    if (filterState.showDuplicates) {\r\n      filtered = filtered.filter(node => \r\n        node.similarity?.duplicates.length || node.similarity?.nearMatches.length\r\n      );\r\n    }\r\n    \r\n    // Apply recovery status filter\r\n    if (filterState.recoveryStatus && filterState.recoveryStatus.length > 0) {\r\n      filtered = filtered.filter(node => \r\n        node.recoveryStatus && filterState.recoveryStatus!.includes(node.recoveryStatus)\r\n      );\r\n    }\r\n    \r\n    // Apply missing only filter\r\n    if (filterState.showMissingOnly) {\r\n      filtered = filtered.filter(node => node.recoveryStatus === 'missing_in_prod');\r\n    }\r\n    \r\n    // Apply sorting\r\n    filtered.sort((a, b) => {\r\n      let comparison = 0;\r\n      \r\n      switch (sortOption.key) {\r\n        case 'score':\r\n          comparison = a.usage.score - b.usage.score;\r\n          break;\r\n        case 'name':\r\n          comparison = a.relPath.localeCompare(b.relPath);\r\n          break;\r\n        case 'mtime':\r\n          comparison = a.mtimeMs - b.mtimeMs;\r\n          break;\r\n        case 'classification':\r\n          const classificationOrder = { red: 0, orange: 1, yellow: 2, green: 3 };\r\n          comparison = classificationOrder[a.classification] - classificationOrder[b.classification];\r\n          break;\r\n        case 'recoveryStatus':\r\n          const recoveryOrder = { \r\n            'missing_in_prod': 0, \r\n            'modified_since_backup': 1, \r\n            'new_file': 2, \r\n            'unchanged': 3 \r\n          };\r\n          const aStatus = a.recoveryStatus || 'unchanged';\r\n          const bStatus = b.recoveryStatus || 'unchanged';\r\n          comparison = (recoveryOrder[aStatus] || 3) - (recoveryOrder[bStatus] || 3);\r\n          break;\r\n        default:\r\n          comparison = 0;\r\n      }\r\n      \r\n      return sortOption.direction === 'desc' ? -comparison : comparison;\r\n    });\r\n        \r\n        return filtered;\r\n      }, [scanData?.nodes, filterState, sortOption]);\r\n      \r\n      // Build tree structure\r\n      const treeItems = useMemo(() => {\r\n        if (!filteredAndSortedNodes.length) return [];\r\n        \r\n        const treeMap = new Map<string, TreeItem>();\r\n        const rootItems: TreeItem[] = [];\r\n        \r\n        // Create tree item for each node\r\n        filteredAndSortedNodes.forEach(node => {\r\n          const treeItem: TreeItem = {\r\n            ...node,\r\n            children: [],\r\n            expanded: expandedPaths.has(node.path),\r\n            visible: true,\r\n            parentPath: undefined,\r\n          };\r\n          treeMap.set(node.path, treeItem);\r\n        });\r\n        \r\n        // Build hierarchy\r\n        filteredAndSortedNodes.forEach(node => {\r\n          const treeItem = treeMap.get(node.path)!;\r\n          \r\n          // Find the closest parent directory\r\n          const pathParts = node.path.split('/');\r\n          let parentPath = '';\r\n          \r\n          for (let i = pathParts.length - 1; i > 0; i--) {\r\n            parentPath = pathParts.slice(0, i).join('/');\r\n            const parentItem = treeMap.get(parentPath + '/'); // Directory paths end with '/'\r\n            \r\n            if (parentItem) {\r\n              parentItem.children!.push(treeItem);\r\n              treeItem.parentPath = parentPath;\r\n              break;\r\n            }\r\n            \r\n            parentPath = pathParts.slice(0, i).join('/');\r\n            const parentDirItem = treeMap.get(parentPath);\r\n            \r\n            if (parentDirItem && parentDirItem.type === 'dir') {\r\n              parentDirItem.children!.push(treeItem);\r\n              treeItem.parentPath = parentPath;\r\n              break;\r\n            }\r\n          }\r\n          \r\n          // If no parent found, it's a root item\r\n          if (!treeItem.parentPath) {\r\n            rootItems.push(treeItem);\r\n          }\r\n        });\r\n        \r\n        return rootItems;\r\n      }, [filteredAndSortedNodes, expandedPaths]);\r\n      \r\n      // Utility functions\r\n      const toggleExpanded = useCallback((path: string) => {\r\n        setExpandedPaths(prev => {\r\n          const newSet = new Set(prev);\r\n          if (newSet.has(path)) {\r\n            newSet.delete(path);\r\n          } else {\r\n            newSet.add(path);\r\n          }\r\n          return newSet;\r\n        });\r\n      }, []);\r\n      \r\n      const expandAll = useCallback(() => {\r\n        const allDirPaths = scanData?.nodes\r\n          ?.filter(node => node.type === 'dir')\r\n          .map(node => node.path) || [];\r\n        setExpandedPaths(new Set(allDirPaths));\r\n      }, [scanData?.nodes]);\r\n      \r\n      const collapseAll = useCallback(() => {\r\n        setExpandedPaths(new Set());\r\n      }, []);\r\n      \r\n      // Auto-load on mount and when compareWithBackup changes\r\n      useEffect(() => {\r\n        loadScanData(false, compareWithBackup);\r\n      }, [loadScanData, compareWithBackup]);\r\n      \r\n      // Cleanup polling interval on unmount\r\n      useEffect(() => {\r\n        return () => {\r\n          if (pollingIntervalRef.current) {\r\n            clearInterval(pollingIntervalRef.current);\r\n          }\r\n        };\r\n      }, []);\r\n      \r\n      // Start Phase 1 Analysis with polling\r\n      const startPhase1Analysis = useCallback(async () => {\r\n        // Clear any existing polling\r\n        if (pollingIntervalRef.current) {\r\n          clearInterval(pollingIntervalRef.current);\r\n          pollingIntervalRef.current = null;\r\n        }\r\n        \r\n        // Reset state\r\n        setPhase1Status('starting');\r\n        setPhase1Progress(0);\r\n        setPhase1CurrentStep('Starting analysis...');\r\n        setPhase1Error(null);\r\n        setPhase1Report(null);\r\n        setPhase1JobId(null);\r\n        \r\n        try {\r\n          // Start the background job\r\n          const startResponse = await refactorConsoleClient.startPhase1Analysis();\r\n          const jobId = startResponse.jobId;\r\n          \r\n          if (!jobId) {\r\n            throw new Error('No jobId returned from server');\r\n          }\r\n          \r\n          setPhase1JobId(jobId);\r\n          setPhase1Status('running');\r\n          console.log(`[useRefactorScan] Phase 1 job started: ${jobId}`);\r\n          \r\n          // Start polling for status (every 2 seconds)\r\n          let pollAttempts = 0;\r\n          const MAX_POLL_ATTEMPTS = 600; // 20 minutes max\r\n          \r\n          pollingIntervalRef.current = setInterval(async () => {\r\n            pollAttempts++;\r\n            \r\n            // Safety: Stop polling after max attempts\r\n            if (pollAttempts > MAX_POLL_ATTEMPTS) {\r\n              if (pollingIntervalRef.current) {\r\n                clearInterval(pollingIntervalRef.current);\r\n                pollingIntervalRef.current = null;\r\n              }\r\n              setPhase1Status('error');\r\n              setPhase1Error('Polling timeout: Analysis took too long');\r\n              setPhase1JobId(null);\r\n              console.error('[useRefactorScan] Polling timeout');\r\n              return;\r\n            }\r\n            \r\n            try {\r\n              const status = await refactorConsoleClient.getPhase1JobStatus(jobId);\r\n              \r\n              // Validate status response\r\n              if (!status || typeof status !== 'object') {\r\n                console.warn('[useRefactorScan] Invalid status response, continuing...');\r\n                return;\r\n              }\r\n              \r\n              // Update progress\r\n              setPhase1Progress(status.progress ?? 0);\r\n              setPhase1CurrentStep(status.currentStep || 'Processing...');\r\n              \r\n              // Check if done\r\n              if (status.status === 'done') {\r\n                // Ensure progress is at 100%\r\n                if (status.progress !== undefined && status.progress < 100) {\r\n                  console.log(`[useRefactorScan] Status 'done' but progress ${status.progress}%, waiting...`);\r\n                  return;\r\n                }\r\n                \r\n                // Fetch result\r\n                try {\r\n                  if (pollingIntervalRef.current) {\r\n                    clearInterval(pollingIntervalRef.current);\r\n                    pollingIntervalRef.current = null;\r\n                  }\r\n                  \r\n                  const result = await refactorConsoleClient.getPhase1JobResult(jobId);\r\n                  \r\n                  // Validate and set result\r\n                  if (result && typeof result === 'object' && result.summary) {\r\n                    setPhase1Progress(100);\r\n                    setPhase1CurrentStep('Complete');\r\n                    setPhase1Status('done');\r\n                    setPhase1Report(result);\r\n                    setPhase1JobId(null);\r\n                    console.log(`[useRefactorScan] Phase 1 complete: ${result.summary.missingInTarget} restorable files`);\r\n                  } else {\r\n                    throw new Error('Invalid result structure');\r\n                  }\r\n                } catch (resultError) {\r\n                  // If result not ready, continue polling\r\n                  if (resultError instanceof Error && resultError.message.includes('not ready')) {\r\n                    console.log('[useRefactorScan] Result not ready, continuing...');\r\n                    return;\r\n                  }\r\n                  \r\n                  if (pollingIntervalRef.current) {\r\n                    clearInterval(pollingIntervalRef.current);\r\n                    pollingIntervalRef.current = null;\r\n                  }\r\n                  setPhase1Status('error');\r\n                  setPhase1Error(resultError instanceof Error ? resultError.message : 'Failed to fetch result');\r\n                  setPhase1JobId(null);\r\n                  console.error('[useRefactorScan] Error fetching result:', resultError);\r\n                }\r\n              } else if (status.status === 'error') {\r\n                // Job failed\r\n                if (pollingIntervalRef.current) {\r\n                  clearInterval(pollingIntervalRef.current);\r\n                  pollingIntervalRef.current = null;\r\n                }\r\n                setPhase1Status('error');\r\n                setPhase1Error(status.error || 'Unknown error');\r\n                setPhase1JobId(null);\r\n                console.error('[useRefactorScan] Job error:', status.error);\r\n              }\r\n              // If 'running' or 'queued', continue polling\r\n            } catch (pollError) {\r\n              console.error(`[useRefactorScan] Poll error (attempt ${pollAttempts}):`, pollError);\r\n              // Continue polling on transient errors\r\n            }\r\n          }, 2000); // Poll every 2 seconds\r\n          \r\n        } catch (startError) {\r\n          setPhase1Status('error');\r\n          setPhase1Error(startError instanceof Error ? startError.message : 'Failed to start analysis');\r\n          setPhase1JobId(null);\r\n          console.error('[useRefactorScan] Failed to start Phase 1:', startError);\r\n        }\r\n      }, []);\r\n      \r\n      // Calculate bundles from Phase 1 report\r\n      const bundles = useMemo(() => {\r\n        if (!phase1Report || !phase1Report.restorableFiles || !phase1Report.files) {\r\n          return new Map<string, FeatureBundle>();\r\n        }\r\n        return calculateAllBundles(phase1Report.restorableFiles, phase1Report.files);\r\n      }, [phase1Report]);\r\n      \r\n      const calculateBundle = useCallback((rootFileRelPath: string): FeatureBundle | null => {\r\n        return bundles.get(rootFileRelPath) || null;\r\n      }, [bundles]);\r\n      \r\n      return {\r\n        scanData,\r\n        isLoading,\r\n        error,\r\n        filterState,\r\n        setFilterState,\r\n        sortOption,\r\n        setSortOption,\r\n        treeItems,\r\n        expandedPaths,\r\n        setExpandedPaths,\r\n        loadScanData,\r\n        refreshScan,\r\n        toggleExpanded,\r\n        expandAll,\r\n        collapseAll,\r\n        filteredCount: filteredAndSortedNodes.length,\r\n        visibleNodes: filteredAndSortedNodes,\r\n        compareWithBackup,\r\n        setCompareWithBackup,\r\n        phase1Report,\r\n        phase1Status,\r\n        phase1Progress,\r\n        phase1CurrentStep,\r\n        phase1Error,\r\n        startPhase1Analysis,\r\n        bundles,\r\n        calculateBundle,\r\n      };\r\n    };\r\n","import React, { useState, useEffect, useCallback } from 'react';\nimport {\n  Box,\n  Paper,\n  Typography,\n  CircularProgress,\n  Tooltip,\n  Chip,\n  List,\n  ListItem,\n  ListItemText,\n  IconButton,\n  alpha\n} from '@mui/material';\nimport { useTheme } from '@mui/material/styles';\nimport { Activity, Users, RefreshCw, CheckCircle, AlertTriangle } from 'lucide-react';\n\ninterface SessionStats {\n  totalSessions: number;\n  uniqueUsers: number;\n  isHealthy: boolean;\n  healthMessage: string;\n  recentSessions: {\n    sessionId: string;\n    fullSessionId: string;\n    userId: string | null;\n    email: string | null;\n    role: string | null;\n    expiresAt: string;\n  }[];\n  timestamp: string;\n}\n\ninterface SessionPulseProps {\n  refreshInterval?: number;\n  trackedEmail?: string;\n}\n\n// Default tracked user for session monitoring\nconst DEFAULT_TRACKED_EMAIL = 'frjames@ssppoc.org';\n\nconst SessionPulse: React.FC<SessionPulseProps> = ({ \n  refreshInterval = 10000,\n  trackedEmail = DEFAULT_TRACKED_EMAIL \n}) => {\n  const theme = useTheme();\n  const [stats, setStats] = useState<SessionStats | null>(null);\n  const [loading, setLoading] = useState(true);\n  const [error, setError] = useState<string | null>(null);\n  const [lastRefresh, setLastRefresh] = useState<Date | null>(null);\n  \n  // Check if tracked user has an active session\n  const trackedUserSession = stats?.recentSessions?.find(\n    s => s.email?.toLowerCase() === trackedEmail.toLowerCase()\n  );\n  const isTrackedUserOnline = !!trackedUserSession;\n\n  const fetchStats = useCallback(async () => {\n    try {\n      const response = await fetch('/api/admin/session-stats', {\n        credentials: 'include'\n      });\n      \n      if (!response.ok) {\n        throw new Error(`HTTP ${response.status}`);\n      }\n      \n      const data = await response.json();\n      if (data.success) {\n        setStats(data.stats);\n        setError(null);\n      } else {\n        setError(data.error || 'Failed to fetch stats');\n      }\n    } catch (err) {\n      setError(err instanceof Error ? err.message : 'Network error');\n    } finally {\n      setLoading(false);\n      setLastRefresh(new Date());\n    }\n  }, []);\n\n  useEffect(() => {\n    fetchStats();\n    const interval = setInterval(fetchStats, refreshInterval);\n    return () => clearInterval(interval);\n  }, [fetchStats, refreshInterval]);\n\n  const gaugePercentage = stats \n    ? Math.min((stats.totalSessions / Math.max(stats.uniqueUsers, 1)) * 100, 100)\n    : 0;\n\n  const gaugeColor = stats?.isHealthy \n    ? theme.palette.success.main \n    : theme.palette.warning.main;\n\n  if (loading && !stats) {\n    return (\n      <Paper sx={{ p: 2, display: 'flex', alignItems: 'center', justifyContent: 'center', minHeight: 200 }}>\n        <CircularProgress size={40} />\n      </Paper>\n    );\n  }\n\n  if (error && !stats) {\n    return (\n      <Paper sx={{ p: 2, bgcolor: alpha(theme.palette.error.main, 0.1) }}>\n        <Typography color=\"error\">Session Pulse Error: {error}</Typography>\n      </Paper>\n    );\n  }\n\n  return (\n    <Paper \n      sx={{ \n        p: 2, \n        mb: 2,\n        background: `linear-gradient(135deg, ${alpha(theme.palette.primary.main, 0.05)} 0%, ${alpha(theme.palette.background.paper, 1)} 100%)`,\n        border: `1px solid ${alpha(theme.palette.divider, 0.1)}`\n      }}\n    >\n      <Box sx={{ display: 'flex', alignItems: 'center', justifyContent: 'space-between', mb: 2 }}>\n        <Box sx={{ display: 'flex', alignItems: 'center', gap: 1 }}>\n          <Activity size={20} color={theme.palette.primary.main} />\n          <Typography variant=\"h6\" fontWeight={600}>\n            Session Pulse\n          </Typography>\n        </Box>\n        <Tooltip title={`Last refresh: ${lastRefresh?.toLocaleTimeString() || 'Never'}`}>\n          <IconButton size=\"small\" onClick={fetchStats} disabled={loading}>\n            <RefreshCw size={16} className={loading ? 'animate-spin' : ''} />\n          </IconButton>\n        </Tooltip>\n      </Box>\n\n      {/* Tracked User Status Banner */}\n      <Box \n        sx={{ \n          display: 'flex', \n          alignItems: 'center', \n          gap: 2, \n          mb: 2,\n          p: 1.5,\n          borderRadius: 1,\n          bgcolor: isTrackedUserOnline \n            ? alpha(theme.palette.success.main, 0.1) \n            : alpha(theme.palette.grey[500], 0.1),\n          border: `1px solid ${isTrackedUserOnline \n            ? alpha(theme.palette.success.main, 0.3) \n            : alpha(theme.palette.grey[500], 0.2)}`\n        }}\n      >\n        <Box \n          sx={{ \n            width: 12, \n            height: 12, \n            borderRadius: '50%', \n            bgcolor: isTrackedUserOnline ? 'success.main' : 'grey.500',\n            boxShadow: isTrackedUserOnline ? `0 0 8px ${theme.palette.success.main}` : 'none',\n            animation: isTrackedUserOnline ? 'pulse 2s infinite' : 'none'\n          }} \n        />\n        <Box sx={{ flex: 1 }}>\n          <Typography variant=\"body2\" fontWeight={600}>\n            Fr. James Session Tracker\n          </Typography>\n          <Typography variant=\"caption\" color=\"text.secondary\">\n            {isTrackedUserOnline \n              ? `Online  Role: ${trackedUserSession?.role || 'unknown'}  Session: ${trackedUserSession?.sessionId}`\n              : `${trackedEmail} is currently offline`\n            }\n          </Typography>\n        </Box>\n        <Chip \n          label={isTrackedUserOnline ? 'ONLINE' : 'OFFLINE'}\n          size=\"small\"\n          color={isTrackedUserOnline ? 'success' : 'default'}\n          sx={{ fontWeight: 600 }}\n        />\n      </Box>\n\n      <Box sx={{ display: 'flex', gap: 3, flexWrap: 'wrap' }}>\n        {/* Active Sessions Gauge */}\n        <Box sx={{ display: 'flex', flexDirection: 'column', alignItems: 'center', minWidth: 120 }}>\n          <Box sx={{ position: 'relative', display: 'inline-flex' }}>\n            <CircularProgress\n              variant=\"determinate\"\n              value={100}\n              size={80}\n              thickness={4}\n              sx={{ color: alpha(theme.palette.grey[500], 0.2) }}\n            />\n            <CircularProgress\n              variant=\"determinate\"\n              value={gaugePercentage}\n              size={80}\n              thickness={4}\n              sx={{ \n                color: gaugeColor,\n                position: 'absolute',\n                left: 0\n              }}\n            />\n            <Box\n              sx={{\n                top: 0,\n                left: 0,\n                bottom: 0,\n                right: 0,\n                position: 'absolute',\n                display: 'flex',\n                alignItems: 'center',\n                justifyContent: 'center',\n              }}\n            >\n              <Typography variant=\"h5\" fontWeight={700} color={gaugeColor}>\n                {stats?.totalSessions || 0}\n              </Typography>\n            </Box>\n          </Box>\n          <Typography variant=\"caption\" color=\"text.secondary\" sx={{ mt: 1 }}>\n            Active Sessions\n          </Typography>\n        </Box>\n\n        {/* User Match Indicator */}\n        <Box sx={{ display: 'flex', flexDirection: 'column', alignItems: 'center', justifyContent: 'center', minWidth: 120 }}>\n          <Box sx={{ display: 'flex', alignItems: 'center', gap: 1, mb: 1 }}>\n            <Users size={18} />\n            <Typography variant=\"h6\">{stats?.uniqueUsers || 0}</Typography>\n          </Box>\n          <Chip\n            icon={stats?.isHealthy ? <CheckCircle size={14} /> : <AlertTriangle size={14} />}\n            label={stats?.isHealthy ? 'Healthy' : 'Check'}\n            size=\"small\"\n            color={stats?.isHealthy ? 'success' : 'warning'}\n            sx={{ fontWeight: 500 }}\n          />\n          <Typography variant=\"caption\" color=\"text.secondary\" sx={{ mt: 0.5, textAlign: 'center' }}>\n            {stats?.healthMessage || 'Loading...'}\n          </Typography>\n        </Box>\n\n        {/* Live Session Log */}\n        <Box sx={{ flex: 1, minWidth: 250 }}>\n          <Typography variant=\"subtitle2\" color=\"text.secondary\" sx={{ mb: 1 }}>\n            Recent Sessions\n          </Typography>\n          <List dense sx={{ \n            bgcolor: alpha(theme.palette.background.default, 0.5), \n            borderRadius: 1,\n            maxHeight: 150,\n            overflow: 'auto'\n          }}>\n            {stats?.recentSessions && stats.recentSessions.length > 0 ? (\n              stats.recentSessions.map((session, idx) => {\n                const isTracked = session.email?.toLowerCase() === trackedEmail.toLowerCase();\n                return (\n                  <ListItem \n                    key={session.fullSessionId || idx} \n                    sx={{ \n                      py: 0.5,\n                      bgcolor: isTracked ? alpha(theme.palette.success.main, 0.15) : 'transparent',\n                      borderLeft: isTracked ? `3px solid ${theme.palette.success.main}` : 'none',\n                      pl: isTracked ? 1 : 2\n                    }}\n                  >\n                    <ListItemText\n                      primary={\n                        <Box sx={{ display: 'flex', alignItems: 'center', gap: 1 }}>\n                          {isTracked && (\n                            <Box \n                              sx={{ \n                                width: 8, \n                                height: 8, \n                                borderRadius: '50%', \n                                bgcolor: 'success.main',\n                                animation: 'pulse 2s infinite'\n                              }} \n                            />\n                          )}\n                          <Typography variant=\"body2\" fontFamily=\"monospace\" fontSize={11} fontWeight={isTracked ? 600 : 400}>\n                            {session.sessionId}\n                          </Typography>\n                          {session.role && (\n                            <Chip \n                              label={session.role} \n                              size=\"small\" \n                              sx={{ height: 18, fontSize: 10 }}\n                              color={session.role === 'super_admin' ? 'error' : session.role === 'priest' ? 'primary' : 'default'}\n                            />\n                          )}\n                        </Box>\n                      }\n                      secondary={\n                        <Typography \n                          variant=\"caption\" \n                          fontSize={10} \n                          fontWeight={isTracked ? 600 : 400}\n                          color={isTracked ? 'success.main' : 'text.secondary'}\n                        >\n                          {session.email || 'Anonymous'} {isTracked && ' Tracked'}\n                        </Typography>\n                      }\n                    />\n                  </ListItem>\n                );\n              })\n            ) : (\n              <ListItem>\n                <ListItemText \n                  primary=\"No active sessions\" \n                  primaryTypographyProps={{ color: 'text.secondary', fontSize: 12 }}\n                />\n              </ListItem>\n            )}\n          </List>\n        </Box>\n      </Box>\n    </Paper>\n  );\n};\n\nexport default SessionPulse;\n","import React, { useState, useEffect, useContext, useCallback } from 'react';\r\nimport {\r\n  AlertCircle,\r\n  RefreshCw,\r\n  Search,\r\n  Zap,\r\n  Info,\r\n  Copy,\r\n  ExternalLink,\r\n  Eye,\r\n  Archive,\r\n  FileSearch,\r\n  Settings,\r\n  FolderOpen,\r\n  Check,\r\n  X as XIcon,\r\n  History\r\n} from 'lucide-react';\r\nimport { toast } from 'react-toastify';\r\nimport { CustomizerContext } from '@/context/CustomizerContext';\r\nimport { useTheme, alpha } from '@mui/material/styles';\r\nimport { \r\n  Box, \r\n  Paper, \r\n  Button, \r\n  TextField, \r\n  IconButton, \r\n  Collapse, \r\n  Tooltip,\r\n  Chip,\r\n  CircularProgress\r\n} from '@mui/material';\r\n\r\nimport Tree from './components/Tree';\r\nimport Legend from './components/Legend';\r\nimport Toolbar from './components/Toolbar';\r\nimport RequirementPreviewModal from './components/RequirementPreviewModal';\r\nimport RestoreBundleButton from './components/RestoreBundleButton';\r\nimport DiffViewModal from './components/DiffViewModal';\r\nimport RestoreHistoryViewer from './components/RestoreHistoryViewer';\r\nimport { useRefactorScan } from './hooks/useRefactorScan';\r\nimport { \r\n  SortOption, \r\n  Classification, \r\n  Phase1Report, \r\n  FileAnalysis, \r\n  Snapshot,\r\n  PreviewRestoreResponse\r\n} from '@/types/refactorConsole';\r\nimport refactorConsoleClient, { PathConfig, DEFAULT_PATH_CONFIG } from './api/refactorConsoleClient';\r\nimport SessionPulse from '@/components/admin/SessionPulse';\r\n\r\nconst RefactorConsole: React.FC = () => {\r\n  // Get theme context for dark mode\r\n  const { activeMode } = useContext(CustomizerContext);\r\n  // Get MUI theme for background colors\r\n  const theme = useTheme();\r\n  \r\n  // Diagnostic logging (dev only)\r\n  useEffect(() => {\r\n    if (import.meta.env.DEV) {\r\n      console.log('[RefactorConsole Theme]', {\r\n        activeMode,\r\n        paletteMode: theme.palette.mode,\r\n        backgroundDefault: theme.palette.background.default,\r\n        backgroundPaper: theme.palette.background.paper,\r\n        hasDarkClass: document.documentElement.classList.contains('dark'),\r\n      });\r\n    }\r\n  }, [activeMode, theme.palette.mode]);\r\n  \r\n  const {\r\n    scanData,\r\n    isLoading,\r\n    error,\r\n    filterState,\r\n    setFilterState,\r\n    sortOption,\r\n    setSortOption,\r\n    treeItems,\r\n    expandedPaths,\r\n    setExpandedPaths,\r\n    loadScanData,\r\n    refreshScan,\r\n    toggleExpanded,\r\n    expandAll,\r\n    collapseAll,\r\n    filteredCount,\r\n    visibleNodes,\r\n    compareWithBackup,\r\n    setCompareWithBackup,\r\n    phase1Report: hookPhase1Report,\r\n    bundles,\r\n    calculateBundle\r\n  } = useRefactorScan();\r\n  \r\n  // Note: Dark mode is handled by the app's theme provider, not by this component\r\n  // MUI uses theme.palette.mode, Tailwind uses the 'dark' class on documentElement\r\n  // Both should be managed at the app level (CustomizerContext/ThemeProvider)\r\n\r\n  const [showModal, setShowModal] = useState<{ \r\n    type: 'reasons' | 'duplicates' | 'requirementPreview'; \r\n    data: any \r\n  } | null>(null);\r\n  \r\n  // Phase 1 state management\r\n  type Phase1State = 'idle' | 'starting' | 'running' | 'done' | 'error';\r\n  const [phase1State, setPhase1State] = useState<Phase1State>('idle');\r\n  const [phase1Report, setPhase1Report] = useState<Phase1Report | null>(hookPhase1Report);\r\n  const [phase1Progress, setPhase1Progress] = useState(0);\r\n  const [phase1CurrentStep, setPhase1CurrentStep] = useState<string>('');\r\n  const [phase1Error, setPhase1Error] = useState<string | null>(null);\r\n  const [phase1JobId, setPhase1JobId] = useState<string | null>(null);\r\n  const [healthStatus, setHealthStatus] = useState<'checking' | 'ok' | 'error'>('checking');\r\n  const [healthError, setHealthError] = useState<string | null>(null);\r\n  const [pollingInterval, setPollingInterval] = useState<NodeJS.Timeout | null>(null);\r\n  \r\n  // ========================================================================\r\n  // Path Configuration State\r\n  // ========================================================================\r\n  const [showPathConfig, setShowPathConfig] = useState(false);\r\n  const [pathConfig, setPathConfig] = useState<PathConfig>(() => refactorConsoleClient.getSavedPaths());\r\n  const [pathValidation, setPathValidation] = useState<{\r\n    sourcePath?: { isValid: boolean; exists: boolean; error?: string };\r\n    destinationPath?: { isValid: boolean; exists: boolean; error?: string };\r\n    backupPath?: { isValid: boolean; exists: boolean; error?: string };\r\n  }>({});\r\n  const [isValidatingPaths, setIsValidatingPaths] = useState(false);\r\n  \r\n  // ========================================================================\r\n  // Multi-Source & Snapshot State\r\n  // ========================================================================\r\n  const [sourceType, setSourceType] = useState<'local' | 'remote'>('local');\r\n  const [selectedSnapshot, setSelectedSnapshot] = useState<string | null>(null);\r\n  const [availableSnapshots, setAvailableSnapshots] = useState<any[]>([]);\r\n  const [isLoadingSnapshots, setIsLoadingSnapshots] = useState(false);\r\n  const [snapshotError, setSnapshotError] = useState<string | null>(null);\r\n  \r\n  // ========================================================================\r\n  // Diff Preview & Restore State\r\n  // ========================================================================\r\n  const [showDiffModal, setShowDiffModal] = useState(false);\r\n  const [previewData, setPreviewData] = useState<PreviewRestoreResponse | null>(null);\r\n  const [isLoadingPreview, setIsLoadingPreview] = useState(false);\r\n  const [isRestoring, setIsRestoring] = useState(false);\r\n  const [pendingRestorePath, setPendingRestorePath] = useState<string | null>(null);\r\n  \r\n  // ========================================================================\r\n  // Restore History State\r\n  // ========================================================================\r\n  const [showHistoryViewer, setShowHistoryViewer] = useState(false);\r\n  \r\n  // Validate paths on the server\r\n  const validatePaths = useCallback(async (config: PathConfig) => {\r\n    setIsValidatingPaths(true);\r\n    try {\r\n      const result = await refactorConsoleClient.validatePaths(config);\r\n      setPathValidation({\r\n        sourcePath: result.validations.sourcePath,\r\n        destinationPath: result.validations.destinationPath,\r\n        backupPath: result.validations.backupPath\r\n      });\r\n      return result.ok;\r\n    } catch (error) {\r\n      console.error('Path validation error:', error);\r\n      toast.error('Failed to validate paths');\r\n      return false;\r\n    } finally {\r\n      setIsValidatingPaths(false);\r\n    }\r\n  }, []);\r\n  \r\n  // Save path configuration\r\n  const handleSavePaths = useCallback(async () => {\r\n    const isValid = await validatePaths(pathConfig);\r\n    if (isValid) {\r\n      refactorConsoleClient.savePaths(pathConfig);\r\n      toast.success('Path configuration saved');\r\n      setShowPathConfig(false);\r\n    } else {\r\n      toast.warning('Some paths are invalid. Please check the validation messages.');\r\n    }\r\n  }, [pathConfig, validatePaths]);\r\n  \r\n  // Reset paths to defaults\r\n  const handleResetPaths = useCallback(() => {\r\n    setPathConfig({ ...DEFAULT_PATH_CONFIG });\r\n    setPathValidation({});\r\n    refactorConsoleClient.clearSavedPaths();\r\n    toast.info('Paths reset to defaults');\r\n  }, []);\r\n  \r\n  // Sync phase1Report from hook\r\n  useEffect(() => {\r\n    if (hookPhase1Report) {\r\n      setPhase1Report(hookPhase1Report);\r\n    }\r\n  }, [hookPhase1Report]);\r\n\r\n  // Health check on component mount\r\n  useEffect(() => {\r\n    const verifyConnection = async () => {\r\n      try {\r\n        setHealthStatus('checking');\r\n        setHealthError(null);\r\n        const health = await refactorConsoleClient.healthCheck();\r\n        if (health.ok || health.status === 'ok') {\r\n          setHealthStatus('ok');\r\n        } else {\r\n          setHealthStatus('error');\r\n          setHealthError(health.message || 'Unknown error');\r\n        }\r\n      } catch (error) {\r\n        setHealthStatus('error');\r\n        setHealthError(error instanceof Error ? error.message : 'Connection failed');\r\n        console.error('Health check failed:', error);\r\n        \r\n        // Autonomous fix: If it's a TypeError (500), suggest rebuild\r\n        if (error instanceof Error && error.message.includes('TypeError')) {\r\n          console.warn('[RefactorConsole] Health check failed with TypeError. Server may need rebuild.');\r\n          toast.error('API connection error detected. Server may need rebuild.', {\r\n            autoClose: 5000\r\n          });\r\n        }\r\n      }\r\n    };\r\n\r\n    verifyConnection();\r\n  }, []);\r\n\r\n  // Initialize sourceType and snapshotId from saved config on mount\r\n  useEffect(() => {\r\n    const savedConfig = refactorConsoleClient.getSavedPaths();\r\n    if (savedConfig.sourceType) {\r\n      setSourceType(savedConfig.sourceType);\r\n    }\r\n    if (savedConfig.snapshotId) {\r\n      setSelectedSnapshot(savedConfig.snapshotId);\r\n    }\r\n  }, []);\r\n\r\n  // Load available snapshots when sourceType changes\r\n  useEffect(() => {\r\n    const loadSnapshots = async () => {\r\n      setIsLoadingSnapshots(true);\r\n      setSnapshotError(null);\r\n      try {\r\n        const result = await refactorConsoleClient.fetchSnapshots(sourceType);\r\n        setAvailableSnapshots(result.snapshots);\r\n        \r\n        // Auto-select most recent snapshot if available and no snapshot is currently selected\r\n        if (result.defaultSnapshot && !selectedSnapshot) {\r\n          setSelectedSnapshot(result.defaultSnapshot.id);\r\n          toast.info(`Auto-selected most recent snapshot: ${result.defaultSnapshot.label}`);\r\n        }\r\n      } catch (error) {\r\n        console.error('Failed to load snapshots:', error);\r\n        setSnapshotError(error instanceof Error ? error.message : 'Failed to load snapshots');\r\n        setAvailableSnapshots([]);\r\n        \r\n        // If it's a Samba mount error for remote, show warning\r\n        if (sourceType === 'remote' && error instanceof Error && error.message.includes('mount')) {\r\n          toast.warning('Remote Samba share is not mounted. Please ensure /mnt/refactor-remote is accessible.');\r\n        }\r\n      } finally {\r\n        setIsLoadingSnapshots(false);\r\n      }\r\n    };\r\n\r\n    loadSnapshots();\r\n  }, [sourceType]);\r\n\r\n  // Sort options configuration\r\n  const sortOptions: SortOption[] = [\r\n    { key: 'score', direction: 'desc', label: 'Usage Score (High to Low)' },\r\n    { key: 'score', direction: 'asc', label: 'Usage Score (Low to High)' },\r\n    { key: 'name', direction: 'asc', label: 'File Name (A-Z)' },\r\n    { key: 'name', direction: 'desc', label: 'File Name (Z-A)' },\r\n    { key: 'mtime', direction: 'desc', label: 'Recently Modified' },\r\n    { key: 'mtime', direction: 'asc', label: 'Oldest Modified' },\r\n    { key: 'classification', direction: 'asc', label: 'Classification Priority' },\r\n    ...(compareWithBackup ? [\r\n      { key: 'recoveryStatus', direction: 'asc', label: 'Recovery Status (Missing First)' },\r\n      { key: 'recoveryStatus', direction: 'desc', label: 'Recovery Status (New First)' },\r\n    ] : []),\r\n  ];\r\n\r\n  // Handle toolbar actions\r\n  const handleSearchChange = (query: string) => {\r\n    setFilterState(prev => ({ ...prev, searchQuery: query }));\r\n  };\r\n\r\n  const handleFilterChange = (updates: Partial<typeof filterState>) => {\r\n    setFilterState(prev => ({ ...prev, ...updates }));\r\n  };\r\n\r\n  const handleSortChange = (sort: SortOption) => {\r\n    setSortOption(sort);\r\n  };\r\n\r\n  const handleRefresh = async () => {\r\n    try {\r\n      // Save sourceType and snapshotId to pathConfig for persistence\r\n      const updatedPathConfig = {\r\n        ...pathConfig,\r\n        sourceType,\r\n        snapshotId: selectedSnapshot || undefined\r\n      };\r\n      refactorConsoleClient.savePaths(updatedPathConfig);\r\n      \r\n      // Call loadScanData directly with sourceType and snapshotId\r\n      await loadScanData(true, compareWithBackup, sourceType, selectedSnapshot || undefined);\r\n      toast.success('Scan data refreshed');\r\n    } catch (error) {\r\n      toast.error('Failed to refresh scan data');\r\n    }\r\n  };\r\n\r\n  const handleToggleRecoveryMode = () => {\r\n    setCompareWithBackup(!compareWithBackup);\r\n    toast.info(`Recovery Mode ${!compareWithBackup ? 'enabled' : 'disabled'}`);\r\n  };\r\n\r\n  const handleAnalyze = async () => {\r\n    try {\r\n      await refreshScan(); // This will trigger a rebuild\r\n      toast.success('Codebase analysis completed');\r\n    } catch (error) {\r\n      toast.error('Failed to analyze codebase');\r\n    }\r\n  };\r\n\r\n  const handlePhase1Analysis = async () => {\r\n    // Clear any existing polling interval\r\n    if (pollingInterval) {\r\n      clearInterval(pollingInterval);\r\n      setPollingInterval(null);\r\n    }\r\n\r\n    // Reset state\r\n    setPhase1State('starting');\r\n    setPhase1Progress(0);\r\n    setPhase1CurrentStep('Starting analysis...');\r\n    setPhase1Error(null);\r\n    setPhase1Report(null); // Clear previous report\r\n    setPhase1JobId(null);\r\n    \r\n    try {\r\n      // Start the background job\r\n      const startResponse = await refactorConsoleClient.startPhase1Analysis();\r\n      const jobId = startResponse.jobId;\r\n      \r\n      if (!jobId) {\r\n        throw new Error('No jobId returned from server');\r\n      }\r\n      \r\n      setPhase1JobId(jobId);\r\n      setPhase1State('running');\r\n      toast.info('Phase 1 analysis started in background');\r\n      \r\n      // Start polling for status\r\n      let pollAttempts = 0;\r\n      const MAX_POLL_ATTEMPTS = 600; // 20 minutes max (600 * 2 seconds)\r\n      \r\n      const interval = setInterval(async () => {\r\n        pollAttempts++;\r\n        \r\n        // Safety: Stop polling after max attempts\r\n        if (pollAttempts > MAX_POLL_ATTEMPTS) {\r\n          clearInterval(interval);\r\n          setPollingInterval(null);\r\n          setPhase1State('error');\r\n          setPhase1Error('Polling timeout: Analysis took too long');\r\n          setPhase1JobId(null);\r\n          toast.error('Phase 1 analysis timed out');\r\n          console.error('[Phase1] Polling timeout after', MAX_POLL_ATTEMPTS, 'attempts');\r\n          return;\r\n        }\r\n        \r\n        try {\r\n          const status = await refactorConsoleClient.getPhase1JobStatus(jobId);\r\n          \r\n          // Validate status response structure\r\n          if (!status || typeof status !== 'object') {\r\n            console.warn('[Phase1] Invalid status response format, continuing to poll...');\r\n            return;\r\n          }\r\n          \r\n          // Update progress and current step (always safe to update these)\r\n          setPhase1Progress(status.progress ?? 0);\r\n          setPhase1CurrentStep(status.currentStep || 'Processing...');\r\n          \r\n          // Only proceed if status is explicitly 'done' (not just progress 100%)\r\n          if (status.status === 'done') {\r\n            // Double-check: ensure progress is 100% before fetching results\r\n            if (status.progress !== undefined && status.progress < 100) {\r\n              console.log(`[Phase1] Status is 'done' but progress is ${status.progress}%, continuing to poll...`);\r\n              return;\r\n            }\r\n            \r\n            // Analysis complete - fetch result\r\n            try {\r\n              clearInterval(interval);\r\n              setPollingInterval(null);\r\n              \r\n              const result = await refactorConsoleClient.getPhase1JobResult(jobId);\r\n              \r\n              // Validate result structure before setting state\r\n              if (!result || typeof result !== 'object') {\r\n                throw new Error('Invalid result format: result is not an object');\r\n              }\r\n              \r\n              // Ensure required fields exist with defaults\r\n              const validatedResult: Phase1Report = {\r\n                generatedAt: result.generatedAt || new Date().toISOString(),\r\n                sourcePath: result.sourcePath || '',\r\n                targetPath: result.targetPath || '',\r\n                summary: {\r\n                  totalFilesInSource: result.summary?.totalFilesInSource ?? 0,\r\n                  missingInTarget: result.summary?.missingInTarget ?? 0,\r\n                  modifiedInTarget: result.summary?.modifiedInTarget ?? 0,\r\n                  identical: result.summary?.identical ?? 0,\r\n                  existsOnlyInTarget: result.summary?.existsOnlyInTarget ?? 0\r\n                },\r\n                restorableFiles: Array.isArray(result.restorableFiles) ? result.restorableFiles : [],\r\n                modifiedFiles: Array.isArray(result.modifiedFiles) ? result.modifiedFiles : [],\r\n                documentation: {\r\n                  endpointsFound: result.documentation?.endpointsFound ?? 0,\r\n                  endpointsVerified: result.documentation?.endpointsVerified ?? 0,\r\n                  endpointsMissing: result.documentation?.endpointsMissing ?? 0\r\n                },\r\n                files: Array.isArray(result.files) ? result.files : [],\r\n                integrationPoints: {\r\n                  menuItems: result.integrationPoints?.menuItems || null,\r\n                  router: result.integrationPoints?.router || null\r\n                }\r\n              };\r\n              \r\n              // Final validation: ensure summary exists before setting state\r\n              if (!validatedResult.summary) {\r\n                throw new Error('Result validation failed: summary is missing');\r\n              }\r\n              \r\n              // Only set state if validation passes\r\n              // Ensure progress is set to 100% when marking as done\r\n              setPhase1Progress(100);\r\n              setPhase1CurrentStep('Complete');\r\n              setPhase1State('done');\r\n              setPhase1Report(validatedResult);\r\n              setPhase1JobId(null);\r\n              toast.success(`Phase 1 analysis complete: ${validatedResult.summary.missingInTarget} restorable files found`);\r\n            } catch (resultError) {\r\n              // If result fetch fails, check if it's just not ready yet\r\n              if (resultError instanceof Error && resultError.message.includes('not ready')) {\r\n                // Continue polling - don't clear interval\r\n                console.log('[Phase1] Result not ready yet, continuing to poll...');\r\n                return;\r\n              }\r\n              // Otherwise, show error\r\n              clearInterval(interval);\r\n              setPollingInterval(null);\r\n              setPhase1State('error');\r\n              setPhase1Error(resultError instanceof Error ? resultError.message : 'Failed to fetch results');\r\n              setPhase1JobId(null);\r\n              toast.error(`Failed to fetch Phase 1 results: ${resultError instanceof Error ? resultError.message : 'Unknown error'}`);\r\n              console.error('Phase 1 result fetch error:', resultError);\r\n            }\r\n          } else if (status.status === 'error') {\r\n            // Analysis failed\r\n            clearInterval(interval);\r\n            setPollingInterval(null);\r\n            setPhase1State('error');\r\n            setPhase1Error(status.error || 'Unknown error');\r\n            setPhase1JobId(null);\r\n            toast.error(`Phase 1 analysis failed: ${status.error || 'Unknown error'}`);\r\n            console.error('Phase 1 error:', status.error);\r\n          }\r\n          // If status is 'running' or 'queued', continue polling (no action needed)\r\n        } catch (error) {\r\n          console.error(`[Phase1] Error polling status (attempt ${pollAttempts}):`, error);\r\n          // Don't stop polling on transient errors, but log them\r\n          if (error instanceof Error && !error.message.includes('not ready') && !error.message.includes('Failed to fetch')) {\r\n            console.warn('[Phase1] Non-transient error during polling, will retry:', error.message);\r\n          }\r\n          // Continue polling on errors - network issues are transient\r\n        }\r\n      }, 2000); // Poll every 2 seconds\r\n      \r\n      setPollingInterval(interval);\r\n    } catch (error) {\r\n      setPhase1State('error');\r\n      setPhase1Error(error instanceof Error ? error.message : 'Failed to start Phase 1 analysis');\r\n      setPhase1JobId(null);\r\n      toast.error(error instanceof Error ? error.message : 'Failed to start Phase 1 analysis');\r\n      console.error('Phase 1 start error:', error);\r\n    }\r\n  };\r\n\r\n  // Cleanup polling interval on unmount\r\n  useEffect(() => {\r\n    return () => {\r\n      if (pollingInterval) {\r\n        clearInterval(pollingInterval);\r\n      }\r\n    };\r\n  }, [pollingInterval]);\r\n\r\n  const handleShowRequirementPreview = (fileAnalysis: FileAnalysis) => {\r\n    // Only allow preview when Phase 1 is done and report is validated\r\n    if (phase1State !== 'done' || !phase1Report || !phase1Report.summary) {\r\n      toast.warning('Phase 1 analysis must be completed before viewing requirements');\r\n      return;\r\n    }\r\n    setShowModal({\r\n      type: 'requirementPreview',\r\n      data: {\r\n        fileAnalysis,\r\n        integrationPoints: phase1Report.integrationPoints ?? { menuItems: null, router: null }\r\n      }\r\n    });\r\n  };\r\n\r\n  // Handle tree actions\r\n  const handleNodeAction = async (action: string, node: any) => {\r\n    switch (action) {\r\n      case 'copy':\r\n        navigator.clipboard.writeText(node.relPath);\r\n        toast.success('Path copied to clipboard');\r\n        break;\r\n        \r\n      case 'open':\r\n        // In a real implementation, this would integrate with VS Code or similar\r\n        toast.info(`Would open ${node.relPath} in editor`);\r\n        break;\r\n        \r\n      case 'restore':\r\n        // Show preview/diff modal before restoring\r\n        if (node.recoveryStatus === 'missing_in_prod' && node.backupPath) {\r\n          handlePreviewRestore(node.relPath);\r\n        }\r\n        break;\r\n        \r\n      case 'reasons':\r\n        setShowModal({ \r\n          type: 'reasons', \r\n          data: { \r\n            node, \r\n            reasons: node.reasons,\r\n            classification: node.classification,\r\n            usage: node.usage\r\n          } \r\n        });\r\n        break;\r\n        \r\n      case 'duplicates':\r\n        if (node.similarity?.duplicates.length || node.similarity?.nearMatches.length) {\r\n          setShowModal({ \r\n            type: 'replicates', \r\n            data: { \r\n              node, \r\n              duplicates: node.similarity?.duplicates || [],\r\n              nearMatches: node.similarity?.nearMatches || []\r\n            } \r\n          });\r\n        }\r\n        break;\r\n        \r\n      default:\r\n        console.log('Unknown action:', action);\r\n    }\r\n  };\r\n\r\n  const handleToggleExpanded = (path: string) => {\r\n    toggleExpanded(path);\r\n  };\r\n\r\n  // Handle preview restore (dry run with diff)\r\n  const handlePreviewRestore = async (relPath: string) => {\r\n    setIsLoadingPreview(true);\r\n    setPendingRestorePath(relPath);\r\n    \r\n    try {\r\n      const preview = await refactorConsoleClient.previewRestore(\r\n        relPath,\r\n        undefined,\r\n        sourceType,\r\n        selectedSnapshot || undefined\r\n      );\r\n      \r\n      setPreviewData(preview);\r\n      setShowDiffModal(true);\r\n    } catch (error) {\r\n      console.error('Preview failed:', error);\r\n      toast.error(`Failed to preview file: ${error instanceof Error ? error.message : 'Unknown error'}`);\r\n    } finally {\r\n      setIsLoadingPreview(false);\r\n    }\r\n  };\r\n\r\n  // Handle confirmed restore after preview\r\n  const handleConfirmRestore = async () => {\r\n    if (!pendingRestorePath) return;\r\n    \r\n    setIsRestoring(true);\r\n    \r\n    try {\r\n      await refactorConsoleClient.restore(\r\n        pendingRestorePath,\r\n        undefined,\r\n        sourceType,\r\n        selectedSnapshot || undefined\r\n      );\r\n      \r\n      toast.success(`File restored: ${pendingRestorePath}`);\r\n      \r\n      // Close modal\r\n      setShowDiffModal(false);\r\n      setPreviewData(null);\r\n      setPendingRestorePath(null);\r\n      \r\n      // Refresh scan to update status\r\n      await loadScanData(true, compareWithBackup, sourceType, selectedSnapshot || undefined);\r\n    } catch (error) {\r\n      console.error('Restore failed:', error);\r\n      toast.error(`Failed to restore file: ${error instanceof Error ? error.message : 'Unknown error'}`);\r\n    } finally {\r\n      setIsRestoring(false);\r\n    }\r\n  };\r\n\r\n  // Handle cancel diff modal\r\n  const handleCancelDiff = () => {\r\n    setShowDiffModal(false);\r\n    setPreviewData(null);\r\n    setPendingRestorePath(null);\r\n  };\r\n\r\n  // Modal component for showing details\r\n  const Modal = ({ onClose }: { onClose: () => void }) => {\r\n    if (!showModal || showModal.type === 'requirementPreview') return null;\r\n\r\n    const { type, data } = showModal;\r\n\r\n    return (\r\n      <Box\r\n        sx={{\r\n          position: 'fixed',\r\n          inset: 0,\r\n          bgcolor: 'rgba(0, 0, 0, 0.5)',\r\n          display: 'flex',\r\n          alignItems: 'center',\r\n          justifyContent: 'center',\r\n          zIndex: 1300\r\n        }}\r\n      >\r\n        <Paper\r\n          elevation={8}\r\n          sx={{\r\n            bgcolor: 'background.paper',\r\n            borderRadius: 1,\r\n            maxWidth: '42rem',\r\n            width: '100%',\r\n            mx: 2,\r\n            maxHeight: '80vh',\r\n            overflow: 'auto'\r\n          }}\r\n        >\r\n          <Box sx={{ p: 3 }}>\r\n            <Box sx={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center', mb: 2 }}>\r\n              <h2 style={{ fontSize: '1.25rem', fontWeight: 600, color: theme.palette.text.primary }}>\r\n                {type === 'reasons' ? 'Classification Details' : 'Duplicate Analysis'}\r\n              </h2>\r\n              <button\r\n                onClick={onClose}\r\n                style={{\r\n                  background: 'none',\r\n                  border: 'none',\r\n                  color: theme.palette.text.secondary,\r\n                  cursor: 'pointer',\r\n                  fontSize: '1.5rem',\r\n                  lineHeight: 1,\r\n                  padding: 0,\r\n                  width: 24,\r\n                  height: 24\r\n                }}\r\n                onMouseEnter={(e) => {\r\n                  e.currentTarget.style.color = theme.palette.text.primary;\r\n                }}\r\n                onMouseLeave={(e) => {\r\n                  e.currentTarget.style.color = theme.palette.text.secondary;\r\n                }}\r\n              >\r\n                \r\n              </button>\r\n            </Box>\r\n\r\n            {type === 'reasons' && (\r\n              <Box sx={{ display: 'flex', flexDirection: 'column', gap: 2 }}>\r\n                <div>\r\n                  <h3 style={{ fontWeight: 500, color: theme.palette.text.primary, marginBottom: '0.5rem' }}>File Information</h3>\r\n                  <Box sx={{ bgcolor: theme.palette.mode === 'dark' ? 'rgba(255,255,255,0.05)' : theme.palette.grey[50], p: 1.5, borderRadius: 1 }}>\r\n                    <p style={{ fontSize: '0.875rem', fontFamily: 'monospace', color: theme.palette.text.primary }}>{data.node.relPath}</p>\r\n                    <p style={{ fontSize: '0.875rem', color: theme.palette.text.secondary, marginTop: '0.25rem' }}>\r\n                      Classification: <span style={{ fontWeight: 500 }}>{data.classification}</span>\r\n                    </p>\r\n                  </Box>\r\n                </div>\r\n\r\n                <div>\r\n                  <h3 style={{ fontWeight: 500, color: theme.palette.text.primary, marginBottom: '0.5rem' }}>Usage Statistics</h3>\r\n                  <div className=\"grid grid-cols-2 gap-4\">\r\n                    <Box sx={{ bgcolor: alpha(theme.palette.info.main, 0.1), p: 1.5, borderRadius: 1 }}>\r\n                      <p style={{ fontSize: '0.875rem', color: theme.palette.info.main }}>Import References</p>\r\n                      <p style={{ fontSize: '1.125rem', fontWeight: 600, color: theme.palette.info.main }}>{data.usage.importRefs}</p>\r\n                    </Box>\r\n                    <Box sx={{ bgcolor: alpha(theme.palette.success.main, 0.1), p: 1.5, borderRadius: 1 }}>\r\n                      <p style={{ fontSize: '0.875rem', color: theme.palette.success.main }}>Server References</p>\r\n                      <p style={{ fontSize: '1.125rem', fontWeight: 600, color: theme.palette.success.main }}>{data.usage.serverRefs}</p>\r\n                    </Box>\r\n                    <Box sx={{ bgcolor: alpha(theme.palette.secondary.main, 0.1), p: 1.5, borderRadius: 1 }}>\r\n                      <p style={{ fontSize: '0.875rem', color: theme.palette.secondary.main }}>Route References</p>\r\n                      <p style={{ fontSize: '1.125rem', fontWeight: 600, color: theme.palette.secondary.main }}>{data.usage.routeRefs}</p>\r\n                    </Box>\r\n                    <Box sx={{ bgcolor: alpha(theme.palette.warning.main, 0.1), p: 1.5, borderRadius: 1 }}>\r\n                      <p style={{ fontSize: '0.875rem', color: theme.palette.warning.main }}>Usage Score</p>\r\n                      <p style={{ fontSize: '1.125rem', fontWeight: 600, color: theme.palette.warning.main }}>{data.usage.score}</p>\r\n                    </Box>\r\n                  </div>\r\n                </div>\r\n\r\n                <div>\r\n                  <h3 style={{ fontWeight: 500, color: theme.palette.text.primary, marginBottom: '0.5rem' }}>Classification Reasons</h3>\r\n                  <ul className=\"space-y-1\">\r\n                    {data.reasons.map((reason: string, index: number) => (\r\n                      <li key={index} className=\"flex items-start gap-2 text-sm\" style={{ color: theme.palette.text.primary }}>\r\n                        <span style={{ color: theme.palette.info.main, marginTop: '0.125rem' }}></span>\r\n                        <span>{reason}</span>\r\n                      </li>\r\n                    ))}\r\n                  </ul>\r\n                </div>\r\n              </Box>\r\n            )}\r\n\r\n            {type === 'duplicates' && (\r\n              <Box sx={{ display: 'flex', flexDirection: 'column', gap: 2 }}>\r\n                <div>\r\n                  <h3 style={{ fontWeight: 500, color: theme.palette.text.primary, marginBottom: '0.5rem' }}>Duplicate Analysis</h3>\r\n                  <Box sx={{ bgcolor: theme.palette.mode === 'dark' ? 'rgba(255,255,255,0.05)' : theme.palette.grey[50], p: 1.5, borderRadius: 1 }}>\r\n                    <p style={{ fontSize: '0.875rem', fontFamily: 'monospace', color: theme.palette.text.primary }}>{data.node.relPath}</p>\r\n                  </Box>\r\n                </div>\r\n\r\n                {data.duplicates.length > 0 && (\r\n                  <div>\r\n                    <h3 style={{ fontWeight: 500, color: theme.palette.text.primary, marginBottom: '0.5rem' }}>Exact Duplicates</h3>\r\n                    <ul className=\"space-y-1\">\r\n                      {data.duplicates.map((duplicate: string, index: number) => (\r\n                        <li key={index} className=\"flex items-start gap-2 text-sm\" style={{ color: theme.palette.text.primary }}>\r\n                          <span style={{ color: theme.palette.error.main, marginTop: '0.125rem' }}></span>\r\n                          <span className=\"font-mono\">{duplicate}</span>\r\n                        </li>\r\n                      ))}\r\n                    </ul>\r\n                  </div>\r\n                )}\r\n\r\n                {data.nearMatches.length > 0 && (\r\n                  <div>\r\n                    <h3 style={{ fontWeight: 500, color: theme.palette.text.primary, marginBottom: '0.5rem' }}>Near Matches</h3>\r\n                    <ul className=\"space-y-2\">\r\n                      {data.nearMatches.map((match: any, index: number) => (\r\n                        <li key={index}>\r\n                          <Box sx={{ \r\n                            bgcolor: theme.palette.mode === 'dark' ? theme.palette.warning.dark + '20' : theme.palette.warning.light,\r\n                            p: 1.5,\r\n                            borderRadius: 1,\r\n                            display: 'flex',\r\n                            justifyContent: 'space-between',\r\n                            alignItems: 'flex-start'\r\n                          }}>\r\n                            <span className=\"font-mono text-sm\" style={{ color: theme.palette.text.primary }}>{match.target}</span>\r\n                            <Box sx={{\r\n                              fontSize: '0.75rem',\r\n                              bgcolor: theme.palette.mode === 'dark' ? theme.palette.warning.dark + '40' : theme.palette.warning.main,\r\n                              color: theme.palette.mode === 'dark' ? theme.palette.warning.light : theme.palette.warning.contrastText,\r\n                              px: 1,\r\n                              py: 0.5,\r\n                              borderRadius: 0.5\r\n                            }}>\r\n                              {Math.round(match.similarity * 100)}% similar\r\n                            </Box>\r\n                          </Box>\r\n                        </li>\r\n                      ))}\r\n                    </ul>\r\n                  </div>\r\n                )}\r\n              </Box>\r\n            )}\r\n          </Box>\r\n\r\n          <Box sx={{ px: 3, py: 2, borderTop: 1, borderColor: 'divider', bgcolor: 'action.hover' }}>\r\n            <Button\r\n              variant=\"outlined\"\r\n              onClick={onClose}\r\n              sx={{ textTransform: 'none' }}\r\n            >\r\n              Close\r\n            </Button>\r\n          </Box>\r\n        </Paper>\r\n      </Box>\r\n    );\r\n  };\r\n\r\n  return (\r\n    <Box \r\n      sx={{ \r\n        minHeight: '100vh',\r\n        bgcolor: 'background.default',\r\n        color: 'text.primary'\r\n      }}\r\n      className=\"min-h-screen\"\r\n    >\r\n      {/* Header */}\r\n      <Box \r\n        sx={{ \r\n          bgcolor: 'background.paper',\r\n          borderBottom: 1,\r\n          borderColor: 'divider'\r\n        }}\r\n        className=\"border-b\"\r\n      >\r\n        <Box sx={{ px: 3, py: 2 }}>\r\n          <Box sx={{ display: 'flex', alignItems: 'center', justifyContent: 'space-between' }}>\r\n            <Box>\r\n              <Box sx={{ display: 'flex', alignItems: 'center', gap: 1.5 }}>\r\n                <h1 className=\"text-2xl font-bold\" style={{ color: theme.palette.text.primary }}>Refactor Console</h1>\r\n                {/* Dev-only theme debug indicator */}\r\n                {import.meta.env.DEV && (\r\n                  <Box sx={{ \r\n                    fontSize: '0.75rem',\r\n                    px: 1,\r\n                    py: 0.5,\r\n                    bgcolor: 'action.hover',\r\n                    color: theme.palette.text.secondary,\r\n                    borderRadius: 1,\r\n                    fontFamily: 'monospace'\r\n                  }}>\r\n                    {activeMode} {document.documentElement.classList.contains('dark') ? '' : ''}\r\n                  </Box>\r\n                )}\r\n                {/* Health Status Indicator */}\r\n                <Box sx={{ display: 'flex', alignItems: 'center', gap: 1 }}>\r\n                  {healthStatus === 'checking' && (\r\n                    <Box sx={{ width: 12, height: 12, borderRadius: '50%', bgcolor: 'warning.main', animation: 'pulse 2s infinite' }} title=\"Checking connection...\" />\r\n                  )}\r\n                  {healthStatus === 'ok' && (\r\n                    <Box sx={{ width: 12, height: 12, borderRadius: '50%', bgcolor: 'success.main' }} title=\"API connection healthy\" />\r\n                  )}\r\n                  {healthStatus === 'error' && (\r\n                    <Box \r\n                      sx={{ width: 12, height: 12, borderRadius: '50%', bgcolor: 'error.main', cursor: 'help' }}\r\n                      title={healthError || 'API connection failed'}\r\n                    />\r\n                  )}\r\n                </Box>\r\n              </Box>\r\n              <Box sx={{ display: 'flex', alignItems: 'center', gap: 1, mt: 0.5, flexWrap: 'wrap' }}>\r\n                <p style={{ color: theme.palette.text.secondary, margin: 0 }}>\r\n                  Analyze your codebase for duplicates, usage patterns, and refactoring opportunities\r\n                </p>\r\n                <Tooltip title=\"Configure source and destination paths\">\r\n                  <IconButton \r\n                    size=\"small\" \r\n                    onClick={() => setShowPathConfig(!showPathConfig)}\r\n                    sx={{ \r\n                      color: showPathConfig ? theme.palette.primary.main : theme.palette.text.secondary,\r\n                      bgcolor: showPathConfig ? alpha(theme.palette.primary.main, 0.1) : 'transparent'\r\n                    }}\r\n                  >\r\n                    <Settings className=\"w-4 h-4\" />\r\n                  </IconButton>\r\n                </Tooltip>\r\n                {/* Source Type & Snapshot Indicator */}\r\n                <Box sx={{ display: 'flex', gap: 0.5, ml: 1 }}>\r\n                  <Chip \r\n                    label={sourceType === 'local' ? 'Local' : 'Remote'} \r\n                    size=\"small\" \r\n                    color={sourceType === 'remote' ? 'secondary' : 'default'}\r\n                    sx={{ height: 20, fontSize: '0.7rem' }}\r\n                  />\r\n                  {selectedSnapshot && (\r\n                    <Chip \r\n                      label={` ${selectedSnapshot}`} \r\n                      size=\"small\" \r\n                      color=\"primary\"\r\n                      sx={{ height: 20, fontSize: '0.7rem' }}\r\n                    />\r\n                  )}\r\n                </Box>\r\n              </Box>\r\n              {healthStatus === 'error' && healthError && (\r\n                <p style={{ fontSize: '0.75rem', marginTop: '0.25rem', color: theme.palette.error.main }}>\r\n                   {healthError}\r\n                </p>\r\n              )}\r\n            </Box>\r\n            \r\n            <Box sx={{ display: 'flex', alignItems: 'center', gap: 2 }}>\r\n              {scanData && (\r\n                <Box sx={{ textAlign: 'right' }}>\r\n                  <div style={{ fontSize: '0.875rem', color: theme.palette.text.secondary }}>Last scan</div>\r\n                  <div style={{ fontSize: '0.875rem', fontWeight: 500, color: theme.palette.text.primary }}>\r\n                    {new Date(scanData.generatedAt).toLocaleString()}\r\n                  </div>\r\n                </Box>\r\n              )}\r\n              \r\n              {/* Action Buttons */}\r\n              <Box sx={{ display: 'flex', gap: 1 }}>\r\n                {/* Restore History Button */}\r\n                <Button\r\n                  variant=\"outlined\"\r\n                  onClick={() => setShowHistoryViewer(true)}\r\n                  startIcon={<History className=\"w-4 h-4\" />}\r\n                  sx={{ textTransform: 'none' }}\r\n                  title=\"View restore history\"\r\n                >\r\n                  History\r\n                </Button>\r\n                \r\n                {/* Phase 1 Analysis Button */}\r\n                <Box sx={{ display: 'flex', flexDirection: 'column', alignItems: 'flex-end', gap: 0.5 }}>\r\n                  <Button\r\n                    variant=\"contained\"\r\n                    color=\"primary\"\r\n                    onClick={handlePhase1Analysis}\r\n                    disabled={phase1State === 'running' || phase1State === 'starting' || healthStatus !== 'ok'}\r\n                    startIcon={<Archive className={`w-4 h-4 ${(phase1State === 'running' || phase1State === 'starting') ? 'animate-spin' : ''}`} />}\r\n                    sx={{ textTransform: 'none' }}\r\n                    title={\r\n                      healthStatus !== 'ok' \r\n                        ? 'Please wait for API health check to complete' \r\n                        : phase1State === 'running' || phase1State === 'starting'\r\n                        ? 'Phase 1 analysis in progress'\r\n                        : 'Phase 1: Discovery & Gap Analysis'\r\n                    }\r\n                  >\r\n                    Phase 1 Analysis\r\n                  </Button>\r\n                  {(phase1State === 'running' || phase1State === 'starting') && (\r\n                    <Box sx={{ fontSize: '0.75rem', color: 'text.secondary', width: '100%' }}>\r\n                      <div className=\"flex items-center justify-between mb-1\">\r\n                        <span>{phase1CurrentStep || 'Processing...'}</span>\r\n                        <span>{phase1Progress}%</span>\r\n                      </div>\r\n                      <Box sx={{ \r\n                        width: '100%',\r\n                        bgcolor: 'action.hover',\r\n                        borderRadius: '9999px',\r\n                        height: 6\r\n                      }}>\r\n                        <Box \r\n                          sx={{\r\n                            bgcolor: theme.palette.secondary.main,\r\n                            height: 6,\r\n                            borderRadius: '9999px',\r\n                            transition: 'width 0.3s'\r\n                          }}\r\n                          style={{ width: `${phase1Progress}%` }}\r\n                        />\r\n                      </Box>\r\n                    </Box>\r\n                  )}\r\n                  {phase1State === 'error' && phase1Error && (\r\n                    <Box sx={{ fontSize: '0.75rem', color: 'error.main', width: '100%' }}>\r\n                      Error: {phase1Error}\r\n                    </Box>\r\n                  )}\r\n                </Box>\r\n              </Box>\r\n              \r\n              <Button\r\n                variant=\"contained\"\r\n                color=\"primary\"\r\n                onClick={handleRefresh}\r\n                disabled={isLoading}\r\n                startIcon={<RefreshCw className={`w-4 h-4 ${isLoading ? 'animate-spin' : ''}`} />}\r\n                sx={{\r\n                  textTransform: 'none',\r\n                  fontWeight: 500,\r\n                  px: 2,\r\n                  py: 1\r\n                }}\r\n              >\r\n                Refresh\r\n              </Button>\r\n            </Box>\r\n          </Box>\r\n        </Box>\r\n      </Box>\r\n\r\n      {/* Session Pulse Dashboard */}\r\n      <Box sx={{ px: 3, pt: 2 }}>\r\n        <SessionPulse refreshInterval={10000} />\r\n      </Box>\r\n\r\n      {/* Path Configuration Panel */}\r\n      <Collapse in={showPathConfig}>\r\n        <Paper \r\n          elevation={0}\r\n          sx={{ \r\n            mx: 3, \r\n            mt: 2,\r\n            p: 2, \r\n            bgcolor: alpha(theme.palette.primary.main, 0.05),\r\n            border: 1,\r\n            borderColor: alpha(theme.palette.primary.main, 0.2),\r\n            borderRadius: 1\r\n          }}\r\n        >\r\n          <Box sx={{ display: 'flex', alignItems: 'center', justifyContent: 'space-between', mb: 2 }}>\r\n            <Box sx={{ display: 'flex', alignItems: 'center', gap: 1 }}>\r\n              <FolderOpen className=\"w-5 h-5\" style={{ color: theme.palette.primary.main }} />\r\n              <h3 style={{ fontWeight: 600, color: theme.palette.text.primary, margin: 0 }}>\r\n                Path Configuration\r\n              </h3>\r\n              <Chip \r\n                label=\"Persisted in localStorage\" \r\n                size=\"small\" \r\n                sx={{ fontSize: '0.7rem', height: 20 }}\r\n              />\r\n            </Box>\r\n            <Box sx={{ display: 'flex', gap: 1 }}>\r\n              <Button\r\n                variant=\"outlined\"\r\n                size=\"small\"\r\n                onClick={handleResetPaths}\r\n                sx={{ textTransform: 'none' }}\r\n              >\r\n                Reset to Defaults\r\n              </Button>\r\n              <Button\r\n                variant=\"contained\"\r\n                size=\"small\"\r\n                onClick={handleSavePaths}\r\n                disabled={isValidatingPaths}\r\n                startIcon={isValidatingPaths ? <CircularProgress size={14} /> : <Check className=\"w-4 h-4\" />}\r\n                sx={{ textTransform: 'none' }}\r\n              >\r\n                {isValidatingPaths ? 'Validating...' : 'Save & Validate'}\r\n              </Button>\r\n            </Box>\r\n          </Box>\r\n          \r\n          {/* Source Type & Snapshot Selection */}\r\n          <Box sx={{ display: 'grid', gridTemplateColumns: { xs: '1fr', md: 'repeat(2, 1fr)' }, gap: 2, mb: 2 }}>\r\n            {/* Source Type Toggle */}\r\n            <Box>\r\n              <label style={{ \r\n                display: 'block', \r\n                fontSize: '0.875rem', \r\n                fontWeight: 500, \r\n                color: theme.palette.text.primary, \r\n                marginBottom: '0.5rem' \r\n              }}>\r\n                Source Type\r\n              </label>\r\n              <Box sx={{ display: 'flex', gap: 1 }}>\r\n                <Button\r\n                  variant={sourceType === 'local' ? 'contained' : 'outlined'}\r\n                  size=\"small\"\r\n                  onClick={() => setSourceType('local')}\r\n                  sx={{ flex: 1, textTransform: 'none' }}\r\n                >\r\n                  Local File System\r\n                </Button>\r\n                <Button\r\n                  variant={sourceType === 'remote' ? 'contained' : 'outlined'}\r\n                  size=\"small\"\r\n                  onClick={() => setSourceType('remote')}\r\n                  sx={{ flex: 1, textTransform: 'none' }}\r\n                  color=\"secondary\"\r\n                >\r\n                  Remote Samba\r\n                </Button>\r\n              </Box>\r\n              <Box sx={{ fontSize: '0.75rem', color: 'text.secondary', mt: 0.5 }}>\r\n                {sourceType === 'local' ? 'Using local production files' : 'Using remote Samba mount (192.168.1.221)'}\r\n              </Box>\r\n            </Box>\r\n            \r\n            {/* Snapshot Selection */}\r\n            <Box>\r\n              <label style={{ \r\n                display: 'block', \r\n                fontSize: '0.875rem', \r\n                fontWeight: 500, \r\n                color: theme.palette.text.primary, \r\n                marginBottom: '0.5rem' \r\n              }}>\r\n                Snapshot (MM-YYYY)\r\n              </label>\r\n              <TextField\r\n                select\r\n                fullWidth\r\n                size=\"small\"\r\n                value={selectedSnapshot || ''}\r\n                onChange={(e) => setSelectedSnapshot(e.target.value || null)}\r\n                disabled={isLoadingSnapshots || availableSnapshots.length === 0}\r\n                helperText={\r\n                  isLoadingSnapshots ? 'Loading snapshots...' :\r\n                  snapshotError ? `Error: ${snapshotError}` :\r\n                  availableSnapshots.length === 0 ? 'No snapshots available' :\r\n                  selectedSnapshot ? `Selected: ${availableSnapshots.find(s => s.id === selectedSnapshot)?.label || selectedSnapshot}` :\r\n                  'Select a snapshot to scan'\r\n                }\r\n                error={!!snapshotError}\r\n                SelectProps={{\r\n                  displayEmpty: true\r\n                }}\r\n              >\r\n                <option value=\"\">Current / Latest</option>\r\n                {availableSnapshots.map((snapshot) => (\r\n                  <option key={snapshot.id} value={snapshot.id}>\r\n                    {snapshot.label} ({snapshot.id})\r\n                  </option>\r\n                ))}\r\n              </TextField>\r\n            </Box>\r\n          </Box>\r\n          \r\n          <Box sx={{ display: 'grid', gridTemplateColumns: { xs: '1fr', md: 'repeat(3, 1fr)' }, gap: 2 }}>\r\n            {/* Source Path */}\r\n            <Box>\r\n              <TextField\r\n                fullWidth\r\n                size=\"small\"\r\n                label=\"Source Directory\"\r\n                placeholder=\"/var/www/orthodoxmetrics/prod/refactor-src/\"\r\n                value={pathConfig.sourcePath}\r\n                onChange={(e) => setPathConfig(prev => ({ ...prev, sourcePath: e.target.value }))}\r\n                helperText={\r\n                  pathValidation.sourcePath?.error || \r\n                  (pathValidation.sourcePath?.isValid \r\n                    ? (pathValidation.sourcePath.exists ? ' Valid & exists' : ' Valid but does not exist')\r\n                    : 'Directory containing files to restore from')\r\n                }\r\n                error={pathValidation.sourcePath?.isValid === false}\r\n                InputProps={{\r\n                  sx: { fontFamily: 'monospace', fontSize: '0.85rem' },\r\n                  endAdornment: pathValidation.sourcePath?.isValid && (\r\n                    <Check className=\"w-4 h-4\" style={{ color: theme.palette.success.main }} />\r\n                  )\r\n                }}\r\n              />\r\n            </Box>\r\n            \r\n            {/* Destination Path */}\r\n            <Box>\r\n              <TextField\r\n                fullWidth\r\n                size=\"small\"\r\n                label=\"Destination Directory\"\r\n                placeholder=\"/var/www/orthodoxmetrics/prod/front-end/src/\"\r\n                value={pathConfig.destinationPath}\r\n                onChange={(e) => setPathConfig(prev => ({ ...prev, destinationPath: e.target.value }))}\r\n                helperText={\r\n                  pathValidation.destinationPath?.error || \r\n                  (pathValidation.destinationPath?.isValid \r\n                    ? (pathValidation.destinationPath.exists ? ' Valid & exists' : ' Valid but does not exist')\r\n                    : 'Directory where files will be restored to')\r\n                }\r\n                error={pathValidation.destinationPath?.isValid === false}\r\n                InputProps={{\r\n                  sx: { fontFamily: 'monospace', fontSize: '0.85rem' },\r\n                  endAdornment: pathValidation.destinationPath?.isValid && (\r\n                    <Check className=\"w-4 h-4\" style={{ color: theme.palette.success.main }} />\r\n                  )\r\n                }}\r\n              />\r\n            </Box>\r\n            \r\n            {/* Backup Path */}\r\n            <Box>\r\n              <TextField\r\n                fullWidth\r\n                size=\"small\"\r\n                label=\"Backup Directory (for Gap Analysis)\"\r\n                placeholder=\"/var/www/orthodoxmetrics/backup\"\r\n                value={pathConfig.backupPath || ''}\r\n                onChange={(e) => setPathConfig(prev => ({ ...prev, backupPath: e.target.value }))}\r\n                helperText={\r\n                  pathValidation.backupPath?.error || \r\n                  (pathValidation.backupPath?.isValid \r\n                    ? (pathValidation.backupPath.exists ? ' Valid & exists' : ' Valid but does not exist')\r\n                    : 'September 2025 backup location for recovery')\r\n                }\r\n                error={pathValidation.backupPath?.isValid === false}\r\n                InputProps={{\r\n                  sx: { fontFamily: 'monospace', fontSize: '0.85rem' },\r\n                  endAdornment: pathValidation.backupPath?.isValid && (\r\n                    <Check className=\"w-4 h-4\" style={{ color: theme.palette.success.main }} />\r\n                  )\r\n                }}\r\n              />\r\n            </Box>\r\n          </Box>\r\n          \r\n          <Box sx={{ mt: 2, p: 1.5, bgcolor: 'background.paper', borderRadius: 1, border: 1, borderColor: 'divider' }}>\r\n            <p style={{ fontSize: '0.75rem', color: theme.palette.text.secondary, margin: 0 }}>\r\n              <strong>Security:</strong> All paths must be within <code style={{ \r\n                backgroundColor: alpha(theme.palette.primary.main, 0.1), \r\n                padding: '0 4px', \r\n                borderRadius: 2 \r\n              }}>/var/www/orthodoxmetrics/</code>. \r\n              Path traversal and shell injection are blocked.\r\n            </p>\r\n          </Box>\r\n        </Paper>\r\n      </Collapse>\r\n\r\n      {/* Main Content */}\r\n      <Box sx={{ px: 3, py: 3 }}>\r\n        {error && (\r\n          <Box sx={{ \r\n            mb: 3,\r\n            bgcolor: alpha(theme.palette.error.main, 0.1),\r\n            border: 1,\r\n            borderColor: theme.palette.error.main,\r\n            borderRadius: 1,\r\n            p: 2\r\n          }}>\r\n            <Box sx={{ display: 'flex', alignItems: 'center', gap: 1 }}>\r\n              <AlertCircle style={{ width: 20, height: 20, color: theme.palette.error.main }} />\r\n              <h3 style={{ fontWeight: 500, color: theme.palette.error.main }}>Error Loading Data</h3>\r\n            </Box>\r\n            <p style={{ color: theme.palette.error.main, marginTop: '0.25rem' }}>{error}</p>\r\n            <Button\r\n              variant=\"contained\"\r\n              color=\"error\"\r\n              onClick={handleRefresh}\r\n              sx={{ mt: 1.5, textTransform: 'none' }}\r\n            >\r\n              Try Again\r\n            </Button>\r\n          </Box>\r\n        )}\r\n\r\n        {isLoading && !scanData && (\r\n          <Box sx={{ display: 'flex', alignItems: 'center', justifyContent: 'center', minHeight: 400 }}>\r\n            <Box sx={{ textAlign: 'center' }}>\r\n              <RefreshCw className=\"w-8 h-8 animate-spin mx-auto mb-4\" style={{ color: theme.palette.primary.main }} />\r\n              <h3 style={{ fontWeight: 500, color: theme.palette.text.primary, marginBottom: '0.5rem' }}>Analyzing Codebase</h3>\r\n              <p style={{ color: theme.palette.text.secondary }}>This may take a few moments...</p>\r\n            </Box>\r\n          </Box>\r\n        )}\r\n\r\n        {scanData && (\r\n          <Box sx={{ display: 'flex', flexDirection: 'column', gap: 3 }}>\r\n            {/* Toolbar */}\r\n            <Toolbar\r\n              searchQuery={filterState.searchQuery}\r\n              onSearchChange={handleSearchChange}\r\n              sortOptions={sortOptions}\r\n              currentSort={sortOption}\r\n              onSortChange={handleSortChange}\r\n              filterState={filterState}\r\n              onFilterChange={handleFilterChange}\r\n              isLoading={isLoading}\r\n              onRefresh={handleRefresh}\r\n              onAnalyze={handleAnalyze}\r\n              filteredCount={filteredCount}\r\n              totalCount={scanData.summary.totalFiles + scanData.summary.totalDirs}\r\n              compareWithBackup={compareWithBackup}\r\n              onToggleRecoveryMode={handleToggleRecoveryMode}\r\n            />\r\n\r\n            {/* Stats Summary */}\r\n            <Paper \r\n              elevation={0}\r\n              sx={{ \r\n                bgcolor: 'background.paper',\r\n                border: 1,\r\n                borderColor: 'divider',\r\n                p: 2\r\n              }}\r\n              className=\"rounded-lg\"\r\n            >\r\n              {/* Phase 1 Results - Only render when explicitly completed, validated, and progress is 100% */}\r\n              {phase1State === 'done' && phase1Report && phase1Report.summary && phase1Progress === 100 ? (\r\n                <div className=\"space-y-4\">\r\n                  <div className=\"grid grid-cols-2 md:grid-cols-5 gap-4\">\r\n                    <div className=\"text-center\">\r\n                      <div style={{ fontSize: '1.5rem', fontWeight: 700, color: theme.palette.mode === 'dark' ? theme.palette.secondary.light : theme.palette.secondary.main }}>\r\n                        {phase1Report.summary?.missingInTarget ?? 0}\r\n                      </div>\r\n                      <div className=\"text-sm\" style={{ color: theme.palette.text.secondary }}>Restorable Files</div>\r\n                    </div>\r\n                    <div className=\"text-center\">\r\n                      <div style={{ fontSize: '1.5rem', fontWeight: 700, color: theme.palette.mode === 'dark' ? theme.palette.warning.light : theme.palette.warning.main }}>\r\n                        {phase1Report.summary?.modifiedInTarget ?? 0}\r\n                      </div>\r\n                      <div className=\"text-sm\" style={{ color: theme.palette.text.secondary }}>Modified (Protected)</div>\r\n                    </div>\r\n                    <div className=\"text-center\">\r\n                      <div style={{ fontSize: '1.5rem', fontWeight: 700, color: theme.palette.mode === 'dark' ? theme.palette.success.light : theme.palette.success.main }}>\r\n                        {phase1Report.summary?.identical ?? 0}\r\n                      </div>\r\n                      <div className=\"text-sm\" style={{ color: theme.palette.text.secondary }}>Identical</div>\r\n                    </div>\r\n                    <div className=\"text-center\">\r\n                      <div style={{ fontSize: '1.5rem', fontWeight: 700, color: theme.palette.mode === 'dark' ? theme.palette.info.light : theme.palette.info.main }}>\r\n                        {phase1Report.documentation?.endpointsVerified ?? 0}\r\n                      </div>\r\n                      <div className=\"text-sm\" style={{ color: theme.palette.text.secondary }}>Endpoints Verified</div>\r\n                    </div>\r\n                    <div className=\"text-center\">\r\n                      <div style={{ fontSize: '1.5rem', fontWeight: 700, color: theme.palette.mode === 'dark' ? theme.palette.error.light : theme.palette.error.main }}>\r\n                        {phase1Report.documentation?.endpointsMissing ?? 0}\r\n                      </div>\r\n                      <div className=\"text-sm\" style={{ color: theme.palette.text.secondary }}>Endpoints Missing</div>\r\n                    </div>\r\n                  </div>\r\n                  {(phase1Report.documentation?.endpointsFound ?? 0) > 0 && (\r\n                    <div className=\"text-center text-sm\" style={{ color: theme.palette.text.secondary }}>\r\n                      Found {phase1Report.documentation?.endpointsFound ?? 0} endpoints in documentation\r\n                    </div>\r\n                  )}\r\n                </div>\r\n              ) : (phase1State === 'running' || phase1State === 'starting') ? (\r\n                // Show loading state while Phase 1 is running\r\n                <Box sx={{ textAlign: 'center', py: 4 }}>\r\n                  <div className=\"flex flex-col items-center gap-4\">\r\n                    <div className=\"animate-spin rounded-full h-12 w-12 border-b-2\" style={{ borderColor: theme.palette.secondary.main }}></div>\r\n                    <div className=\"text-lg font-medium\" style={{ color: theme.palette.text.primary }}>\r\n                      {phase1CurrentStep || 'Processing...'}\r\n                    </div>\r\n                    <div className=\"w-full max-w-md\">\r\n                      <div className=\"flex items-center justify-between mb-2\">\r\n                        <span className=\"text-sm\" style={{ color: theme.palette.text.secondary }}>Progress</span>\r\n                        <span className=\"text-sm font-medium\" style={{ color: theme.palette.text.primary }}>{phase1Progress}%</span>\r\n                      </div>\r\n                      <Box sx={{ \r\n                        width: '100%',\r\n                        bgcolor: 'action.hover',\r\n                        borderRadius: '9999px',\r\n                        height: 8\r\n                      }}>\r\n                        <Box \r\n                          sx={{\r\n                            bgcolor: theme.palette.secondary.main,\r\n                            height: 8,\r\n                            borderRadius: '9999px',\r\n                            transition: 'width 0.3s'\r\n                          }}\r\n                          style={{ width: `${phase1Progress}%` }}\r\n                        />\r\n                      </Box>\r\n                    </div>\r\n                  </div>\r\n                </Box>\r\n              ) : scanData?.gapAnalysisEnabled ? (\r\n                <div className=\"grid grid-cols-2 md:grid-cols-5 gap-4\">\r\n                  <div className=\"text-center\">\r\n                    <div style={{ fontSize: '1.5rem', fontWeight: 700, color: theme.palette.mode === 'dark' ? theme.palette.secondary.light : theme.palette.secondary.main }}>\r\n                      {scanData.summary.missingInProd || 0}\r\n                    </div>\r\n                    <div className=\"text-sm\" style={{ color: theme.palette.text.secondary }}>Missing in Prod</div>\r\n                  </div>\r\n                  <div className=\"text-center\">\r\n                    <div style={{ fontSize: '1.5rem', fontWeight: 700, color: theme.palette.mode === 'dark' ? theme.palette.warning.light : theme.palette.warning.main }}>\r\n                      {scanData.summary.modifiedSinceBackup || 0}\r\n                    </div>\r\n                    <div className=\"text-sm\" style={{ color: theme.palette.text.secondary }}>Modified</div>\r\n                  </div>\r\n                  <div className=\"text-center\">\r\n                    <div style={{ fontSize: '1.5rem', fontWeight: 700, color: theme.palette.mode === 'dark' ? theme.palette.success.light : theme.palette.success.main }}>\r\n                      {scanData.summary.newFiles || 0}\r\n                    </div>\r\n                    <div className=\"text-sm\" style={{ color: theme.palette.text.secondary }}>New Files</div>\r\n                  </div>\r\n                  <div className=\"text-center\">\r\n                    <div style={{ fontSize: '1.5rem', fontWeight: 700, color: theme.palette.mode === 'dark' ? theme.palette.success.light : theme.palette.success.main }}>\r\n                      {scanData.summary.likelyInProd}\r\n                    </div>\r\n                    <div className=\"text-sm\" style={{ color: theme.palette.text.secondary }}>Production Ready</div>\r\n                  </div>\r\n                  <div className=\"text-center\">\r\n                    <div style={{ fontSize: '1.5rem', fontWeight: 700, color: theme.palette.mode === 'dark' ? theme.palette.error.light : theme.palette.error.main }}>\r\n                      {scanData.summary.legacyOrDupes}\r\n                    </div>\r\n                    <div className=\"text-sm\" style={{ color: theme.palette.text.secondary }}>Legacy/Duplicates</div>\r\n                  </div>\r\n                </div>\r\n              ) : (\r\n                <div className=\"grid grid-cols-2 md:grid-cols-4 gap-4\">\r\n                  <div className=\"text-center\">\r\n                    <div style={{ fontSize: '1.5rem', fontWeight: 700, color: theme.palette.mode === 'dark' ? theme.palette.success.light : theme.palette.success.main }}>\r\n                      {scanData.summary.likelyInProd}\r\n                    </div>\r\n                    <div className=\"text-sm\" style={{ color: theme.palette.text.secondary }}>Production Ready</div>\r\n                  </div>\r\n                  <div className=\"text-center\">\r\n                    <div style={{ fontSize: '1.5rem', fontWeight: 700, color: theme.palette.mode === 'dark' ? theme.palette.warning.light : theme.palette.warning.main }}>\r\n                      {scanData.summary.highRisk}\r\n                    </div>\r\n                    <div className=\"text-sm\" style={{ color: theme.palette.text.secondary }}>High Risk</div>\r\n                  </div>\r\n                  <div className=\"text-center\">\r\n                    <div style={{ fontSize: '1.5rem', fontWeight: 700, color: theme.palette.mode === 'dark' ? theme.palette.warning.light : theme.palette.warning.main }}>\r\n                      {scanData.summary.inDevelopment}\r\n                    </div>\r\n                    <div className=\"text-sm\" style={{ color: theme.palette.text.secondary }}>In Development</div>\r\n                  </div>\r\n                  <div className=\"text-center\">\r\n                    <div style={{ fontSize: '1.5rem', fontWeight: 700, color: theme.palette.mode === 'dark' ? theme.palette.error.light : theme.palette.error.main }}>\r\n                      {scanData.summary.legacyOrDupes}\r\n                    </div>\r\n                    <div className=\"text-sm\" style={{ color: theme.palette.text.secondary }}>Legacy/Duplicates</div>\r\n                  </div>\r\n                </div>\r\n              )}\r\n            </Paper>\r\n\r\n            {/* Phase 1 Restorable Files Section - Only render when explicitly completed, validated, and progress is 100% */}\r\n            {phase1State === 'done' && phase1Progress === 100 && phase1Report && phase1Report.summary && Array.isArray(phase1Report.restorableFiles) && phase1Report.restorableFiles.length > 0 && (\r\n              <Paper \r\n                elevation={0}\r\n                sx={{ \r\n                  bgcolor: 'background.paper',\r\n                  border: 1,\r\n                  borderColor: 'divider',\r\n                  p: 2\r\n                }}\r\n                className=\"rounded-lg\"\r\n              >\r\n                <div className=\"flex items-center justify-between mb-4\">\r\n                  <h3 className=\"text-lg font-semibold flex items-center gap-2\" style={{ color: theme.palette.text.primary }}>\r\n                    <FileSearch className=\"w-5 h-5\" style={{ color: theme.palette.secondary.main }} />\r\n                    Restorable Bundles ({bundles.size > 0 ? bundles.size : (phase1Report.restorableFiles?.length ?? 0)} {bundles.size > 0 ? 'bundles' : 'files'})\r\n                  </h3>\r\n                  <Button\r\n                    variant=\"contained\"\r\n                    color=\"secondary\"\r\n                    onClick={() => {\r\n                      // Only allow export when Phase 1 is done and report is validated\r\n                      if (phase1State !== 'done' || !phase1Report || !phase1Report.summary) {\r\n                        toast.warning('Phase 1 analysis must be completed before exporting');\r\n                        return;\r\n                      }\r\n                      // Export JSON report\r\n                      try {\r\n                        const dataStr = JSON.stringify(phase1Report, null, 2);\r\n                        const dataBlob = new Blob([dataStr], { type: 'application/json' });\r\n                        const url = URL.createObjectURL(dataBlob);\r\n                        const link = document.createElement('a');\r\n                        link.href = url;\r\n                        link.download = `phase1-report-${new Date().toISOString().split('T')[0]}.json`;\r\n                        link.click();\r\n                        URL.revokeObjectURL(url);\r\n                        toast.success('Report exported successfully');\r\n                      } catch (error) {\r\n                        console.error('Export error:', error);\r\n                        toast.error('Failed to export report');\r\n                      }\r\n                    }}\r\n                    sx={{ textTransform: 'none' }}\r\n                  >\r\n                    Export JSON Report\r\n                  </Button>\r\n                </div>\r\n                \r\n                {bundles.size > 0 ? (\r\n                  <div className=\"space-y-3 max-h-96 overflow-y-auto\">\r\n                    {Array.from(bundles.values()).map((bundle, index) => (\r\n                      <Box\r\n                        key={index}\r\n                        sx={{\r\n                          p: 2,\r\n                          bgcolor: theme.palette.mode === 'dark' ? theme.palette.secondary.dark + '20' : theme.palette.secondary.light,\r\n                          border: 1,\r\n                          borderColor: theme.palette.mode === 'dark' ? theme.palette.secondary.dark : theme.palette.secondary.main,\r\n                          borderRadius: 1\r\n                        }}\r\n                      >\r\n                        <div className=\"flex items-start justify-between mb-3\">\r\n                          <div className=\"flex-1\">\r\n                            <div className=\"font-mono text-sm font-semibold mb-1\" style={{ color: theme.palette.text.primary }}>\r\n                              {bundle.rootFile.relPath}\r\n                            </div>\r\n                            <div className=\"text-xs space-y-1\" style={{ color: theme.palette.text.secondary }}>\r\n                              <div>\r\n                                {bundle.files.length} files  {bundle.components.length} components  {bundle.hooks.length} hooks  {bundle.services.length} services\r\n                              </div>\r\n                              {bundle.requiredEndpoints.length > 0 && (\r\n                                <div>\r\n                                  {bundle.requiredEndpoints.filter(ep => ep.existsInServer).length} / {bundle.requiredEndpoints.length} endpoints verified\r\n                                </div>\r\n                              )}\r\n                            </div>\r\n                          </div>\r\n                          <button\r\n                            onClick={() => handleShowRequirementPreview({\r\n                              file: bundle.rootFile,\r\n                              imports: bundle.missingImports,\r\n                              endpoints: bundle.requiredEndpoints,\r\n                              integrationPoints: (phase1Report.integrationPoints?.menuItems || phase1Report.integrationPoints?.router)\r\n                                ? [phase1Report.integrationPoints.menuItems, phase1Report.integrationPoints.router].filter(Boolean) as any\r\n                                : []\r\n                            })}\r\n                            style={{\r\n                              padding: '0.5rem',\r\n                              color: theme.palette.secondary.main,\r\n                              background: 'none',\r\n                              border: 'none',\r\n                              cursor: 'pointer',\r\n                              borderRadius: '0.25rem'\r\n                            }}\r\n                            onMouseEnter={(e) => {\r\n                              e.currentTarget.style.backgroundColor = theme.palette.mode === 'dark' \r\n                                ? theme.palette.secondary.dark + '30'\r\n                                : theme.palette.secondary.light;\r\n                            }}\r\n                            onMouseLeave={(e) => {\r\n                              e.currentTarget.style.backgroundColor = 'transparent';\r\n                            }}\r\n                            title=\"View requirements\"\r\n                          >\r\n                            <Eye className=\"w-4 h-4\" />\r\n                          </button>\r\n                        </div>\r\n                        <RestoreBundleButton\r\n                          bundle={bundle}\r\n                          onRestoreComplete={() => {\r\n                            handlePhase1Analysis(); // Refresh analysis\r\n                            refreshScan(); // Refresh scan\r\n                          }}\r\n                        />\r\n                      </Box>\r\n                    ))}\r\n                  </div>\r\n                ) : (\r\n                  <Box sx={{ textAlign: 'center', py: 4, color: 'text.secondary' }}>\r\n                    <p>No bundles calculated yet. Bundles are created for page files.</p>\r\n                    <p style={{ fontSize: '0.875rem', marginTop: '0.5rem' }}>Individual files: {phase1Report.restorableFiles?.length ?? 0}</p>\r\n                  </Box>\r\n                )}\r\n              </Paper>\r\n            )}\r\n\r\n            {/* Main Layout */}\r\n            <Box sx={{ display: 'grid', gridTemplateColumns: { xs: '1fr', lg: 'repeat(4, 1fr)' }, gap: 3 }}>\r\n              {/* Legend */}\r\n              <Box sx={{ gridColumn: { lg: 'span 1' } }}>\r\n                <Legend\r\n                  scanData={scanData}\r\n                  filterState={filterState}\r\n                  onFilterChange={handleFilterChange}\r\n                />\r\n              </Box>\r\n\r\n              {/* File Tree */}\r\n              <Box sx={{ gridColumn: { lg: 'span 3' } }}>\r\n                <Tree\r\n                  treeItems={treeItems}\r\n                  expandedPaths={expandedPaths}\r\n                  onToggleExpanded={handleToggleExpanded}\r\n                  onNodeAction={handleNodeAction}\r\n                  isDark={activeMode === 'dark'}\r\n                />\r\n              </Box>\r\n            </Box>\r\n          </Box>\r\n        )}\r\n      </Box>\r\n\r\n      {/* Modal */}\r\n      <Modal onClose={() => setShowModal(null)} />\r\n      \r\n      {/* Requirement Preview Modal */}\r\n      {showModal?.type === 'requirementPreview' && (\r\n        <RequirementPreviewModal\r\n          fileAnalysis={showModal.data.fileAnalysis}\r\n          integrationPoints={showModal.data.integrationPoints}\r\n          onClose={() => setShowModal(null)}\r\n        />\r\n      )}\r\n      \r\n      {/* Diff View Modal */}\r\n      <DiffViewModal\r\n        open={showDiffModal}\r\n        onClose={handleCancelDiff}\r\n        onConfirmRestore={handleConfirmRestore}\r\n        preview={previewData?.preview || null}\r\n        dependencies={previewData?.dependencies || null}\r\n        isRestoring={isRestoring}\r\n      />\r\n      \r\n      {/* Restore History Viewer */}\r\n      <RestoreHistoryViewer\r\n        open={showHistoryViewer}\r\n        onClose={() => setShowHistoryViewer(false)}\r\n      />\r\n    </Box>\r\n  );\r\n};\r\n\r\nexport default RefactorConsole;\r\n"],"names":["__iconNode","Archive","createLucideIcon","ArrowDownWideNarrow","ArrowUpNarrowWide","Calendar","Check","Clock","Code","Copy","Download","ExternalLink","Eye","FileCheck","FileCode","FileSearch","FileText","FileX","FolderOpen","Folder","Funnel","GitBranch","GitCompare","HardDrive","History","LoaderCircle","Package","RotateCcw","Search","TriangleAlert","User","Users","Zap","pathBasename","filePath","parts","pathExtname","basename","lastDot","getRecoveryStatusIcon","recoveryStatus","jsx","AlertTriangle","CheckCircle","getClassificationIcon","classification","XCircle","getFileIcon","TreeNode","memo","item","level","onToggleExpanded","onNodeAction","showBadges","isDark","showActions","setShowActions","useState","isExpanded","hasChildren","isDirectory","indentStyle","textColor","handleAction","e","action","renderBadges","badges","getBadgeStyle","type","styles","statusLabels","style","classStyle","blueStyle","jsxs","_a","_b","redStyle","greenStyle","__spreadProps","__spreadValues","ChevronDown","ChevronRight","Tree","treeItems","expandedPaths","className","isDarkProp","theme","useTheme","flattenedList","setFlattenedList","flattenTree","items","result","flattenedItem","useEffect","flattened","index","Legend","scanData","filterState","onFilterChange","classificationConfigs","handleClassificationToggle","newClassifications","c","handleSelectAllClassifications","handleDeselectAllClassifications","getColorStyles","color","colors","alpha","Paper","Box","Typography","ButtonGroup","Button","config","Icon","isSelected","Toolbar","searchQuery","onSearchChange","sortOptions","currentSort","onSortChange","isLoading","onRefresh","onAnalyze","filteredCount","totalCount","compareWithBackup","onToggleRecoveryMode","showFilters","setShowFilters","showFileTypePicker","setShowFileTypePicker","showSortPicker","setShowSortPicker","fileTypes","modifiedTimeOptions","handleFileTypeSelect","value","handleSortSelect","sort","handleModifiedTimeSelect","days","clearFilters","hasActiveFilters","TextField","AlertCircle","option","SortAsc","SortDesc","Filter","RefreshCw","FormControl","InputLabel","Select","MenuItem","Fragment","Chip","_c","_d","_e","_f","RequirementPreviewModal","fileAnalysis","integrationPoints","onClose","file","imports","endpoints","allImportsResolved","imp","allEndpointsVerified","ep","X","endpoint","getComponentName","getMenuLabel","relPath","calculateRestorationStatus","missingImportsInBackup","RestorationStatusBadge","bundleSize","status","DEFAULT_PATH_CONFIG","PATHS_STORAGE_KEY","RefactorConsoleClient","__publicField","saved","parsed","current","updated","__async","response","error","sourceType","sourcePath","params","errorData","rebuild","pathConfig","snapshotId","paths","actualSourceType","actualSnapshotId","contentType","text","jobId","data","bundleRequest","age","limit","offset","url","refactorConsoleClient","RestoreBundleButton","bundle","onRestoreComplete","isRestoring","setIsRestoring","showConfirm","setShowConfirm","canRestore","handleRestore","toast","routePath","menuLabel","f","Loader2","TabPanel","props","children","other","__objRest","DiffViewModal","open","onConfirmRestore","preview","dependencies","activeTab","setActiveTab","diffLines","useMemo","sourceLines","targetLines","maxLines","unified","i","sourceLine","targetLine","handleTabChange","_event","newValue","hasMissingDeps","isNewFile","Dialog","DialogTitle","DialogContent","Alert","AlertTitle","Tabs","Tab","line","diffLine","isChanged","List","idx","React","ListItem","Divider","DialogActions","CircularProgress","RestoreHistoryViewer","entries","setEntries","stats","setStats","setIsLoading","setError","page","setPage","rowsPerPage","setRowsPerPage","total","setTotal","loadHistory","loadStats","err","handleExport","handleChangePage","newPage","handleChangeRowsPerPage","event","formatDate","timestamp","formatSize","bytes","k","sizes","Tooltip","IconButton","TableContainer","Table","TableHead","TableRow","TableCell","TableBody","entry","TablePagination","categorizeFile","lowerPath","resolveImportPath","importPath","fromFile","availableFiles","aliasPath","fromDir","resolvedPath","extensions","ext","indexPath","calculateBundle","rootFile","allFiles","fileAnalyses","processed","queue","currentRelPath","depFile","category","rootCategory","calculateAllBundles","restorableFiles","bundles","analysesMap","analysis","useRefactorScan","setScanData","phase1Report","setPhase1Report","phase1Status","setPhase1Status","phase1Progress","setPhase1Progress","phase1CurrentStep","setPhase1CurrentStep","phase1Error","setPhase1Error","phase1JobId","setPhase1JobId","pollingIntervalRef","useRef","setFilterState","setCompareWithBackup","sortOption","setSortOption","setExpandedPaths","loadScanData","useCallback","autoExpandPaths","node","refreshScan","filteredAndSortedNodes","filtered","query","reason","cutoffDate","a","b","comparison","classificationOrder","recoveryOrder","aStatus","bStatus","treeMap","rootItems","treeItem","pathParts","parentPath","parentItem","parentDirItem","toggleExpanded","path","prev","newSet","expandAll","allDirPaths","collapseAll","startPhase1Analysis","pollAttempts","MAX_POLL_ATTEMPTS","resultError","pollError","startError","rootFileRelPath","DEFAULT_TRACKED_EMAIL","SessionPulse","refreshInterval","trackedEmail","loading","setLoading","lastRefresh","setLastRefresh","trackedUserSession","s","isTrackedUserOnline","fetchStats","interval","gaugePercentage","gaugeColor","Activity","session","isTracked","ListItemText","RefactorConsole","activeMode","useContext","CustomizerContext","hookPhase1Report","showModal","setShowModal","phase1State","setPhase1State","healthStatus","setHealthStatus","healthError","setHealthError","pollingInterval","setPollingInterval","showPathConfig","setShowPathConfig","setPathConfig","pathValidation","setPathValidation","isValidatingPaths","setIsValidatingPaths","setSourceType","selectedSnapshot","setSelectedSnapshot","availableSnapshots","setAvailableSnapshots","isLoadingSnapshots","setIsLoadingSnapshots","snapshotError","setSnapshotError","showDiffModal","setShowDiffModal","previewData","setPreviewData","isLoadingPreview","setIsLoadingPreview","pendingRestorePath","setPendingRestorePath","showHistoryViewer","setShowHistoryViewer","validatePaths","handleSavePaths","handleResetPaths","health","savedConfig","handleSearchChange","handleFilterChange","updates","handleSortChange","handleRefresh","updatedPathConfig","handleToggleRecoveryMode","handleAnalyze","handlePhase1Analysis","validatedResult","_g","_i","_h","_k","_j","_m","_l","_o","_n","_q","_p","_r","_s","handleShowRequirementPreview","handleNodeAction","handlePreviewRestore","handleToggleExpanded","handleConfirmRestore","handleCancelDiff","Modal","duplicate","match","Settings","Collapse","snapshot","_u","_t","_w","_v","_y","_x","_A","_z","_C","_B","dataStr","dataBlob","link","_E","_D"],"mappings":"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","x_google_ignoreList":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30]}