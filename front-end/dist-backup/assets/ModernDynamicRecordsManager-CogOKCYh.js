var ke=Object.defineProperty,De=Object.defineProperties;var Ae=Object.getOwnPropertyDescriptors;var oe=Object.getOwnPropertySymbols;var Ue=Object.prototype.hasOwnProperty,qe=Object.prototype.propertyIsEnumerable;var Z=(a,r,t)=>r in a?ke(a,r,{enumerable:!0,configurable:!0,writable:!0,value:t}):a[r]=t,x=(a,r)=>{for(var t in r||(r={}))Ue.call(r,t)&&Z(a,t,r[t]);if(oe)for(var t of oe(r))qe.call(r,t)&&Z(a,t,r[t]);return a},W=(a,r)=>De(a,Ae(r));var B=(a,r,t)=>Z(a,typeof r!="symbol"?r+"":r,t);var c=(a,r,t)=>new Promise((e,s)=>{var i=p=>{try{l(t.next(p))}catch(f){s(f)}},u=p=>{try{l(t.throw(p))}catch(f){s(f)}},l=p=>p.done?e(p.value):Promise.resolve(p.value).then(i,u);l((t=t.apply(a,r)).next())});import{c4 as be,j as o,B as m,C as ae,d as w,a0 as ie,e as v,U as Le,h as ne,T as ce,I as le,i as Me,s as Pe,a1 as Ke,t as Ge,f as We,b3 as Be,aG as ze,K as de,Z as ue,O as ge,a2 as fe,a4 as Qe}from"./index-Dgvcv9SG.js";import{r as d}from"./vendor-Dkfty7_r.js";import{u as T}from"./useQuery-BeRsGj__.js";import{u as z}from"./useMutation-DuQE6Vmq.js";import{a as y,R as Ve,b as Oe}from"./RecordsModal-Db6bFUX8.js";import{V as Je}from"./Visibility-BRqBEhW9.js";import{E as He}from"./Edit-CACFOr_F.js";import{D as Ze}from"./Delete-SFEnB1j-.js";import{T as he}from"./TableChart-B_uuWqe4.js";import{L as pe,a as me}from"./LockOpen-DB8vBIkB.js";import{U as Xe}from"./Upload-D4oKozt9.js";import{D as Ye}from"./Download-BCSjqcF1.js";import"./AdapterDateFns-CgoHhI9-.js";import"./index-Ch3W3BYh.js";import"./useThemeProps-Bx5KRT9e.js";import"./InputAdornment-fA5QdII4.js";import"./index-EAhLm5eq.js";import"./ListItem-mECUil91.js";import"./listItemButtonClasses-BdhSRkE2.js";import"./index-B1bRoNFx.js";import"./index-3N2x77cv.js";import"./typeof-QjJsDpFa.js";import"./index-Dtz6yYVN.js";import"./index-DX-X-EIo.js";import"./index-Bw55A4Pz.js";import"./index-BJCbXUy8.js";import"./toPropertyKey-BRA8pAMC.js";import"./Clear-CsqKhKdA.js";import"./Search-CVIOtvh3.js";import"./Badge-BUrrLqig.js";import"./usePreviousProps-0UclgRtt.js";import"./FilterList-C57LYOAr.js";import"./DatePicker-B0w8vwgQ.js";import"./Close-DYrMclkX.js";class Ie{constructor(){B(this,"baseUrl","/api/record-table-config")}getTableConfigs(r){return c(this,null,function*(){try{const t=yield y.get(`${this.baseUrl}?church_id=${r}`);if(!t.success)throw new Error(t.error||"Failed to fetch table configurations");return Array.isArray(t.data)?t.data:[t.data]}catch(t){throw console.error("Error fetching table configurations:",t),t}})}getTableConfig(r,t){return c(this,null,function*(){var e;try{const s=yield y.get(`${this.baseUrl}/${t}?church_id=${r}`);if(!s.success){if((e=s.error)!=null&&e.includes("not found"))return null;throw new Error(s.error||"Failed to fetch table configuration")}return Array.isArray(s.data)?s.data[0]:s.data}catch(s){throw console.error("Error fetching table configuration:",s),s}})}createTableConfig(r,t){return c(this,null,function*(){try{const e=yield y.post(`${this.baseUrl}?church_id=${r}`,t);if(!e.success)throw new Error(e.error||"Failed to create table configuration");return Array.isArray(e.data)?e.data[0]:e.data}catch(e){throw console.error("Error creating table configuration:",e),e}})}updateTableConfig(r,t,e){return c(this,null,function*(){try{const s=yield y.put(`${this.baseUrl}/${t}?church_id=${r}`,e);if(!s.success)throw new Error(s.error||"Failed to update table configuration");return Array.isArray(s.data)?s.data[0]:s.data}catch(s){throw console.error("Error updating table configuration:",s),s}})}deleteTableConfig(r,t){return c(this,null,function*(){try{const e=yield y.delete(`${this.baseUrl}/${t}?church_id=${r}`);if(!e.success)throw new Error(e.error||"Failed to delete table configuration")}catch(e){throw console.error("Error deleting table configuration:",e),e}})}getFieldDefinitions(r,t){return c(this,null,function*(){try{const e=yield y.get(`${this.baseUrl}/${t}/fields?church_id=${r}`);if(!e.success)throw new Error(e.error||"Failed to fetch field definitions");return e.data}catch(e){throw console.error("Error fetching field definitions:",e),e}})}getDisplaySettings(r,t){return c(this,null,function*(){try{const e=yield y.get(`${this.baseUrl}/${t}/display-settings?church_id=${r}`);if(!e.success)throw new Error(e.error||"Failed to fetch display settings");return e.data}catch(e){throw console.error("Error fetching display settings:",e),e}})}getSearchConfig(r,t){return c(this,null,function*(){try{const e=yield y.get(`${this.baseUrl}/${t}/search-config?church_id=${r}`);if(!e.success)throw new Error(e.error||"Failed to fetch search configuration");return e.data}catch(e){throw console.error("Error fetching search configuration:",e),e}})}getValidationRules(r,t){return c(this,null,function*(){try{const e=yield this.getTableConfig(r,t);return(e==null?void 0:e.validation_rules)||{required_fields:[],field_validations:{}}}catch(e){throw console.error("Error fetching validation rules:",e),e}})}getImportExportConfig(r,t){return c(this,null,function*(){try{const e=yield this.getTableConfig(r,t);return(e==null?void 0:e.import_export_config)||{supported_formats:[],export_fields:[],import_mapping:{},bulk_import_limit:1e3}}catch(e){throw console.error("Error fetching import/export configuration:",e),e}})}getCertificateConfig(r,t){return c(this,null,function*(){try{const e=yield this.getTableConfig(r,t);return(e==null?void 0:e.certificate_config)||{enabled:!1,template_path:"",field_positions:{},field_mapping:{},output_format:"png",quality:95}}catch(e){throw console.error("Error fetching certificate configuration:",e),e}})}validateRecordData(r,t,e){return c(this,null,function*(){try{const s=yield y.post(`${this.baseUrl}/${t}/validate?church_id=${r}`,e);if(!s.success)throw new Error(s.error||"Failed to validate record data");return s.data}catch(s){throw console.error("Error validating record data:",s),s}})}getTableSchema(r,t){return c(this,null,function*(){try{const e=yield this.getTableConfig(r,t);return e?{tableName:e.table_name,displayName:e.display_name,description:e.description,tableType:e.table_type,primaryKey:e.table_config.primary_key,churchIdField:e.table_config.church_id_field,dateField:e.table_config.date_field,nameFields:e.table_config.name_fields,sortDefault:e.table_config.sort_default,sortDirection:e.table_config.sort_direction,fields:e.field_definitions,displaySettings:e.display_settings,searchConfig:e.search_config,validationRules:e.validation_rules,importExportConfig:e.import_export_config,certificateConfig:e.certificate_config}:null}catch(e){throw console.error("Error fetching table schema:",e),e}})}}const ye=new Ie;class Ne{constructor(r="/api/ag-grid-config"){B(this,"baseUrl");this.baseUrl=r}getConfigs(){return c(this,null,function*(){return console.log("Getting AgGrid configs"),[]})}getConfig(r){return c(this,null,function*(){return console.log("Getting AgGrid config:",r),null})}createConfig(r){return c(this,null,function*(){return console.log("Creating AgGrid config:",r),x({id:Date.now().toString()},r)})}updateConfig(r,t){return c(this,null,function*(){return console.log("Updating AgGrid config:",r,t),null})}deleteConfig(r){return c(this,null,function*(){return console.log("Deleting AgGrid config:",r),!0})}}const Q=new Ne;class er{constructor(){B(this,"baseUrl","/api/dynamic-records")}getUnifiedConfig(r,t,e="default"){return c(this,null,function*(){try{const[s,i]=yield Promise.all([ye.getTableConfig(r,t),Q.getGridConfig(r,t,e)]);if(!s||!i)return null;const u=this.createUnifiedSchema(s,i);return{tableConfig:s,agGridConfig:i,schema:u}}catch(s){throw console.error("Error fetching unified configuration:",s),s}})}getRecords(s,i){return c(this,arguments,function*(r,t,e={}){try{const u=new URLSearchParams(x(x(x(x({church_id:r.toString()},e.search&&{search:e.search}),e.sort&&{sortField:e.sort.field,sortDirection:e.sort.direction}),e.pagination&&{page:e.pagination.page.toString(),limit:e.pagination.limit.toString()}),e.filters&&{filters:JSON.stringify(e.filters)})),l=yield y.get(`${this.baseUrl}/tables/${t}/records?${u}`);if(!l.success)throw new Error(l.error||"Failed to fetch records");return l.data}catch(u){throw console.error("Error fetching records:",u),u}})}getRecord(r,t,e){return c(this,null,function*(){try{const s=yield y.get(`${this.baseUrl}/tables/${t}/records/${e}?church_id=${r}`);if(!s.success)throw new Error(s.error||"Failed to fetch record");return s.data.record}catch(s){throw console.error("Error fetching record:",s),s}})}createRecord(r,t,e){return c(this,null,function*(){try{const s=yield y.post(`${this.baseUrl}/tables/${t}/records?church_id=${r}`,e);if(!s.success)throw new Error(s.error||"Failed to create record");return s.data}catch(s){throw console.error("Error creating record:",s),s}})}updateRecord(r,t,e,s){return c(this,null,function*(){try{const i=yield y.put(`${this.baseUrl}/tables/${t}/records/${e}?church_id=${r}`,s);if(!i.success)throw new Error(i.error||"Failed to update record");return i.data}catch(i){throw console.error("Error updating record:",i),i}})}deleteRecord(r,t,e){return c(this,null,function*(){try{const s=yield y.delete(`${this.baseUrl}/tables/${t}/records/${e}?church_id=${r}`);if(!s.success)throw new Error(s.error||"Failed to delete record")}catch(s){throw console.error("Error deleting record:",s),s}})}validateRecord(r,t,e){return c(this,null,function*(){try{const s=yield y.post(`${this.baseUrl}/tables/${t}/validate?church_id=${r}`,e);if(!s.success)throw new Error(s.error||"Failed to validate record");return s.data}catch(s){throw console.error("Error validating record:",s),s}})}getAvailableTables(r){return c(this,null,function*(){try{const t=yield y.get(`${this.baseUrl}/tables?church_id=${r}`);if(!t.success)throw new Error(t.error||"Failed to fetch available tables");return t.data}catch(t){throw console.error("Error fetching available tables:",t),t}})}getTableSchema(r,t){return c(this,null,function*(){try{const e=yield this.getUnifiedConfig(r,t);return(e==null?void 0:e.schema)||null}catch(e){throw console.error("Error fetching table schema:",e),e}})}saveGridState(r,t,e,s="default"){return c(this,null,function*(){try{yield Q.saveGridState(r,t,e,s)}catch(i){throw console.error("Error saving grid state:",i),i}})}loadGridState(r,t,e="default"){return c(this,null,function*(){try{return yield Q.loadGridState(r,t,e)}catch(s){throw console.error("Error loading grid state:",s),s}})}getFieldDefinitions(r,t){return c(this,null,function*(){try{return yield ye.getFieldDefinitions(r,t)}catch(e){throw console.error("Error fetching field definitions:",e),e}})}getColumnDefinitions(r,t,e="default"){return c(this,null,function*(){try{return yield Q.getColumnDefinitions(r,t,e)}catch(s){throw console.error("Error fetching column definitions:",s),s}})}createUnifiedSchema(r,t){return{tableName:r.table_name,displayName:r.display_name,description:r.description,tableType:r.table_type,primaryKey:r.table_config.primary_key,churchIdField:r.table_config.church_id_field,dateField:r.table_config.date_field,nameFields:r.table_config.name_fields,sortDefault:r.table_config.sort_default,sortDirection:r.table_config.sort_direction,fields:r.field_definitions,displaySettings:r.display_settings,searchConfig:r.search_config,validationRules:r.validation_rules,importExportConfig:r.import_export_config,certificateConfig:r.certificate_config,gridOptions:t.grid_options,columnDefs:t.column_definitions,defaultColDef:t.default_column_state,themeSettings:t.theme_settings,exportSettings:t.export_settings}}getSearchableFields(r,t){return c(this,null,function*(){try{const e=yield this.getTableSchema(r,t);return(e==null?void 0:e.searchConfig.searchable_fields)||[]}catch(e){throw console.error("Error fetching searchable fields:",e),e}})}getSortableFields(r,t){return c(this,null,function*(){try{const e=yield this.getTableSchema(r,t);return(e==null?void 0:e.searchConfig.sortable_fields)||[]}catch(e){throw console.error("Error fetching sortable fields:",e),e}})}getRequiredFields(r,t){return c(this,null,function*(){try{const e=yield this.getTableSchema(r,t);return(e==null?void 0:e.validationRules.required_fields)||[]}catch(e){throw console.error("Error fetching required fields:",e),e}})}getDropdownOptions(r,t,e){return c(this,null,function*(){try{return[]}catch(s){throw console.error("Error fetching dropdown options:",s),s}})}}const _=new er,rr=(a={})=>d.useMemo(()=>x({defaultColDef:{flex:1,minWidth:100,resizable:!0,sortable:!0,filter:!0},columnDefs:[],rowData:[],pagination:!0,paginationPageSize:20},a),[a]),tr=({churchId:a,tableName:r,agGridConfigName:t="default",filters:e={},enabled:s=!0,refetchInterval:i})=>{const[u,l]=d.useState(e);be();const{data:p,isLoading:f,error:C,refetch:S}=T({queryKey:["unifiedConfig",a,r,t],queryFn:()=>_.getUnifiedConfig(a,r,t),enabled:s&&!!a&&!!r,staleTime:5*60*1e3,retry:3}),{data:h,isLoading:g,error:b,refetch:U}=T({queryKey:["unifiedRecords",a,r,u],queryFn:()=>_.getRecords(a,r,u),enabled:s&&!!a&&!!r,refetchInterval:i,staleTime:1*60*1e3,retry:3}),{saveState:V,loadState:O,isSaving:k,isLoading:J}=rr({churchId:a,tableName:r,configName:t,enabled:s&&!!a&&!!r}),E=d.useMemo(()=>h==null?void 0:h.records,[h]),D=d.useMemo(()=>h==null?void 0:h.pagination,[h]),q=d.useMemo(()=>(h==null?void 0:h.schema)||(p==null?void 0:p.schema),[h,p]),L=f||g,j=(C==null?void 0:C.message)||(b==null?void 0:b.message)||null,A=d.useCallback(F=>{l($=>x(x({},$),F))},[]),M=d.useCallback(F=>{l($=>W(x({},$),{sort:F}))},[]),H=d.useCallback(F=>{l($=>W(x({},$),{pagination:F}))},[]),P=d.useCallback(()=>{S(),U()},[S,U]);return{records:E,pagination:D,schema:q,config:p,loading:L,recordsLoading:g,configLoading:f,error:j,refetch:P,refetchRecords:U,refetchConfig:S,setFilters:A,setSort:M,setPagination:H,saveGridState:V,loadGridState:O,isSavingState:k,isLoadingState:J}},sr=({churchId:a,tableName:r,onSuccess:t,onError:e})=>{var f,C,S,h;const s=be(),i=z({mutationFn:g=>_.createRecord(a,r,g),onSuccess:g=>{s.invalidateQueries({queryKey:["unifiedRecords",a,r]}),t==null||t(g)},onError:g=>{e==null||e(g)}}),u=z({mutationFn:({id:g,data:b})=>_.updateRecord(a,r,g,b),onSuccess:g=>{s.invalidateQueries({queryKey:["unifiedRecords",a,r]}),t==null||t(g)},onError:g=>{e==null||e(g)}}),l=z({mutationFn:g=>_.deleteRecord(a,r,g),onSuccess:()=>{s.invalidateQueries({queryKey:["unifiedRecords",a,r]})},onError:g=>{e==null||e(g)}}),p=z({mutationFn:g=>_.validateRecord(a,r,g),onError:g=>{e==null||e(g)}});return{createRecord:i.mutateAsync,updateRecord:(g,b)=>u.mutateAsync({id:g,data:b}),deleteRecord:l.mutateAsync,validateRecord:p.mutateAsync,isCreating:i.isPending,isUpdating:u.isPending,isDeleting:l.isPending,isValidating:p.isPending,error:((f=i.error)==null?void 0:f.message)||((C=u.error)==null?void 0:C.message)||((S=l.error)==null?void 0:S.message)||((h=p.error)==null?void 0:h.message)||null}},or=({churchId:a,enabled:r=!0})=>{const{data:t=[],isLoading:e,error:s,refetch:i}=T({queryKey:["availableTables",a],queryFn:()=>_.getAvailableTables(a),enabled:r&&!!a,staleTime:3e5,retry:3});return{tables:t,loading:e,error:(s==null?void 0:s.message)||null,refetch:i}},ar=(a,r,t=!0)=>{const{data:e,isLoading:s,error:i,refetch:u}=T({queryKey:["tableSchema",a,r],queryFn:()=>_.getTableSchema(a,r),enabled:t&&!!a&&!!r,staleTime:6e5,retry:3});return{schema:e,loading:s,error:(i==null?void 0:i.message)||null,refetch:u}},ir=(a,r,t=!0)=>{const{data:e=[],isLoading:s,error:i,refetch:u}=T({queryKey:["fieldDefinitions",a,r],queryFn:()=>_.getFieldDefinitions(a,r),enabled:t&&!!a&&!!r,staleTime:6e5,retry:3});return{fields:e,loading:s,error:(i==null?void 0:i.message)||null,refetch:u}},nr=(a,r,t=!0)=>{const{data:e=[],isLoading:s,error:i,refetch:u}=T({queryKey:["searchableFields",a,r],queryFn:()=>_.getSearchableFields(a,r),enabled:t&&!!a&&!!r,staleTime:6e5,retry:3});return{fields:e,loading:s,error:(i==null?void 0:i.message)||null,refetch:u}},cr=(a,r,t=!0)=>{const{data:e=[],isLoading:s,error:i,refetch:u}=T({queryKey:["sortableFields",a,r],queryFn:()=>_.getSortableFields(a,r),enabled:t&&!!a&&!!r,staleTime:6e5,retry:3});return{fields:e,loading:s,error:(i==null?void 0:i.message)||null,refetch:u}},lr=(a,r,t=!0)=>{const{data:e=[],isLoading:s,error:i,refetch:u}=T({queryKey:["requiredFields",a,r],queryFn:()=>_.getRequiredFields(a,r),enabled:t&&!!a&&!!r,staleTime:6e5,retry:3});return{fields:e,loading:s,error:(i==null?void 0:i.message)||null,refetch:u}},dr=()=>"default",ur=()=>null;function Jr({churchId:a,initialTableName:r="",readOnly:t=!1,onTableChange:e,onRecordSelect:s,className:i,style:u}){const[l,p]=d.useState(r),[f,C]=d.useState(t),[S,h]=d.useState(null),[g,b]=d.useState(!1),[U,V]=d.useState(!1),[O,k]=d.useState(!1),[J,E]=d.useState(!1),[D,q]=d.useState(null),[L,j]=d.useState({open:!1,message:"",severity:"info"}),A=dr(),{tables:M,loading:H,error:P,refetch:F}=or(a),{schema:$,loading:xe,error:X}=ar(a,l);ir(a,l);const{fields:we}=nr(a,l);cr(a,l),lr(a,l);const{records:_e,pagination:je,loading:Y,error:ve,refetch:I,setFilters:K,setSort:N,setPagination:G}=tr({churchId:a,tableName:l,enabled:!!l}),{deleteRecord:ee,isDeleting:re}=sr({churchId:a,tableName:l,onSuccess:n=>{j({open:!0,message:"Record saved successfully",severity:"success"}),I()},onError:n=>{j({open:!0,message:`Error: ${n.message}`,severity:"error"})}}),Ce=d.useMemo(()=>ur(),[A]);d.useMemo(()=>[{key:"view",label:"View",icon:o.jsx(Je,{}),color:"primary"},{key:"edit",label:"Edit",icon:o.jsx(He,{}),color:"primary"},{key:"delete",label:"Delete",icon:o.jsx(Ze,{}),color:"error"}],[]);const Se=d.useCallback(n=>{p(n),e==null||e(n),K({}),G({page:1,limit:50})},[e,K,G]),te=d.useCallback(n=>{K(n)},[K]),Fe=d.useCallback((n,R)=>{N({field:n,direction:R})},[N]),Re=d.useCallback((n,R)=>{G({page:n,limit:R})},[G]),se=d.useCallback((n,R)=>{switch(n){case"view":h(R),b(!0),s==null||s(R);break;case"edit":h(R),b(!0);break;case"delete":q(R),E(!0);break}},[s]),Te=d.useCallback(()=>c(this,null,function*(){if(D)try{yield ee(D.id),E(!1),q(null),j({open:!0,message:"Record deleted successfully",severity:"success"})}catch(n){j({open:!0,message:`Error deleting record: ${n instanceof Error?n.message:"Unknown error"}`,severity:"error"})}}),[D,ee]);d.useCallback(n=>{b(!1),h(null),j({open:!0,message:"Record saved successfully",severity:"success"})},[]),d.useCallback(n=>{j({open:!0,message:`Form error: ${n}`,severity:"error"})},[]);const $e=d.useCallback(()=>{C(!f)},[f]),Ee=d.useCallback(n=>{j({open:!0,message:`Switched to ${n} template`,severity:"info"})},[]);return H?o.jsxs(m,{sx:{p:3,textAlign:"center"},children:[o.jsx(ae,{}),o.jsx(w,{sx:{mt:2},children:"Discovering record tables..."})]}):P?o.jsxs(ie,{severity:"error",sx:{m:2},children:["Error discovering tables: ",P,o.jsx(v,{onClick:()=>F(),sx:{ml:2},children:"Retry"})]}):M.length===0?o.jsxs(m,{sx:{p:3,textAlign:"center"},children:[o.jsx(w,{variant:"h6",color:"text.secondary",children:"No record tables found"}),o.jsx(w,{variant:"body2",color:"text.secondary",sx:{mt:1},children:"Tables should be named with pattern: om_church_##_*_records"}),o.jsx(v,{onClick:()=>F(),sx:{mt:2},children:"Refresh"})]}):o.jsxs(m,{className:i,style:u,children:[o.jsxs(Le,{elevation:2,sx:{mb:2},children:[o.jsxs(m,{sx:{p:3,borderBottom:"1px solid",borderColor:"divider"},children:[o.jsxs(m,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:2},children:[o.jsxs(m,{sx:{display:"flex",alignItems:"center",gap:1},children:[o.jsx(he,{sx:{color:"primary.main",fontSize:32}}),o.jsx(w,{variant:"h4",component:"h1",sx:{fontWeight:600},children:"Dynamic Records Manager"}),o.jsx(ne,{label:A.toUpperCase(),color:"primary",size:"small",sx:{ml:1}})]}),o.jsxs(m,{sx:{display:"flex",gap:1,alignItems:"center"},children:[o.jsx(ne,{label:f?"Locked":"Unlocked",color:f?"error":"success",icon:f?o.jsx(pe,{}):o.jsx(me,{})}),o.jsx(ce,{title:"Toggle Lock",children:o.jsx(le,{onClick:$e,disabled:t,children:f?o.jsx(pe,{}):o.jsx(me,{})})}),o.jsx(ce,{title:"Settings",children:o.jsx(le,{onClick:()=>k(!0),children:o.jsx(Me,{})})})]})]}),o.jsx(m,{sx:{mb:2},children:o.jsxs(Pe,{fullWidth:!0,sx:{maxWidth:400},children:[o.jsx(Ke,{children:"Select Record Table"}),o.jsx(Ge,{value:l,onChange:n=>Se(n.target.value),label:"Select Record Table",children:M.map(n=>o.jsx(We,{value:n.tableName,children:o.jsxs(m,{sx:{display:"flex",alignItems:"center",gap:1},children:[o.jsx(he,{fontSize:"small"}),o.jsxs(m,{children:[o.jsx(w,{variant:"body1",children:n.displayName}),o.jsxs(w,{variant:"caption",color:"text.secondary",children:[n.tableName," â€¢ ",n.fieldCount," fields"]})]})]})},n.tableName))})]})}),l&&o.jsxs(m,{sx:{display:"flex",gap:1,flexWrap:"wrap"},children:[o.jsx(v,{variant:"contained",startIcon:o.jsx(Be,{}),onClick:()=>b(!0),disabled:f,children:"Add Record"}),o.jsx(v,{variant:"outlined",startIcon:o.jsx(Xe,{}),onClick:()=>V(!0),disabled:f,children:"Import"}),o.jsx(v,{variant:"outlined",startIcon:o.jsx(Ye,{}),onClick:()=>{},children:"Export"}),o.jsx(v,{variant:"outlined",startIcon:o.jsx(ze,{}),onClick:()=>I(),children:"Refresh"})]})]}),l?o.jsxs(o.Fragment,{children:[o.jsx(m,{sx:{p:3,pb:0},children:o.jsx(Ve,{churchId:a,tableName:l,onSearch:te,searchableFields:we,loading:Y})}),o.jsx(m,{sx:{p:3,pt:0},children:xe?o.jsx(m,{sx:{display:"flex",justifyContent:"center",p:3},children:o.jsx(ae,{})}):X?o.jsxs(ie,{severity:"error",children:["Error loading table schema: ",X]}):o.jsx(Ce,{data:_e||[],schema:$,churchId:a,tableName:l,loading:Y,error:ve,onRecordSelect:s,onRecordEdit:n=>se("edit",n),onRecordDelete:n=>se("delete",n),onRecordCreate:()=>b(!0),onFiltersChange:te,onSortChange:Fe,onPaginationChange:Re,pagination:je,enableSelection:!f,enableSorting:!0,enableFiltering:!0,enablePagination:!0,enableSearch:!0,enableExport:!0,enableBulkActions:!f,enableRowActions:!f})})]}):o.jsxs(m,{sx:{p:3,textAlign:"center"},children:[o.jsx(w,{variant:"h6",color:"text.secondary",children:"Select a table to view records"}),o.jsx(w,{variant:"body2",color:"text.secondary",sx:{mt:1},children:"Choose from the dropdown above to start managing records"})]})]}),l&&o.jsx(Oe,{open:g,onClose:()=>{b(!1),h(null)},title:S?"Edit Record":"Add New Record",maxWidth:"md",children:o.jsxs(m,{sx:{p:2},children:[o.jsxs(w,{variant:"body1",children:["Form implementation for ",l," records"]}),o.jsx(w,{variant:"body2",color:"text.secondary",sx:{mt:1},children:"This would contain the dynamic form based on field definitions"})]})}),o.jsxs(de,{open:J,onClose:()=>E(!1),maxWidth:"sm",fullWidth:!0,children:[o.jsx(ue,{children:"Confirm Delete"}),o.jsx(ge,{children:o.jsx(w,{children:"Are you sure you want to delete this record? This action cannot be undone."})}),o.jsxs(fe,{children:[o.jsx(v,{onClick:()=>E(!1),children:"Cancel"}),o.jsx(v,{onClick:Te,color:"error",variant:"contained",disabled:re,children:re?"Deleting...":"Delete"})]})]}),o.jsxs(de,{open:O,onClose:()=>k(!1),maxWidth:"sm",fullWidth:!0,children:[o.jsx(ue,{children:"Settings"}),o.jsx(ge,{children:o.jsxs(m,{sx:{p:2},children:[o.jsx(w,{variant:"h6",gutterBottom:!0,children:"Template Settings"}),o.jsx(m,{sx:{display:"flex",gap:1,flexWrap:"wrap"},children:["mui","berry","antd","chakra"].map(n=>o.jsx(v,{variant:A===n?"contained":"outlined",onClick:()=>Ee(n),size:"small",children:n.toUpperCase()},n))})]})}),o.jsx(fe,{children:o.jsx(v,{onClick:()=>k(!1),children:"Close"})})]}),o.jsx(Qe,{open:L.open,autoHideDuration:6e3,onClose:()=>j(n=>W(x({},n),{open:!1})),message:L.message})]})}export{Jr as ModernDynamicRecordsManager,Jr as default};
//# sourceMappingURL=ModernDynamicRecordsManager-CogOKCYh.js.map
