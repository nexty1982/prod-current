{"version":3,"file":"ChurchSetupWizard-D3mLLnTu.js","sources":["../../src/features/devel-tools/om-church-wizard/ChurchSetupWizard.tsx"],"sourcesContent":["import React, { useState, useEffect } from 'react';\r\nimport {\r\n  Box,\r\n  Stepper,\r\n  Step,\r\n  StepLabel,\r\n  StepContent,\r\n  Button,\r\n  Typography,\r\n  Card,\r\n  CardContent,\r\n  Grid,\r\n  TextField,\r\n  FormControl,\r\n  InputLabel,\r\n  Select,\r\n  MenuItem,\r\n  Switch,\r\n  FormControlLabel,\r\n  Chip,\r\n  IconButton,\r\n  Alert,\r\n  Divider,\r\n  List,\r\n  ListItem,\r\n  ListItemText,\r\n  ListItemSecondaryAction,\r\n  Dialog,\r\n  DialogTitle,\r\n  DialogContent,\r\n  DialogActions,\r\n  CircularProgress,\r\n  Paper,\r\n  Stack,\r\n  Autocomplete,\r\n  FormGroup,\r\n  Checkbox\r\n} from '@mui/material';\r\nimport {\r\n  Add as AddIcon,\r\n  Delete as DeleteIcon,\r\n  Edit as EditIcon,\r\n  Save as SaveIcon,\r\n  Cancel as CancelIcon,\r\n  CheckCircle as CheckIcon,\r\n  Info as InfoIcon,\r\n  Warning as WarningIcon,\r\n  Church as ChurchIcon,\r\n  People as PeopleIcon,\r\n  Settings as SettingsIcon,\r\n  Web as WebIcon,\r\n  Storage as StorageIcon,\r\n  Person as PersonIcon\r\n} from '@mui/icons-material';\r\nimport { useNavigate } from 'react-router-dom';\r\nimport { useAuth } from '@/context/AuthContext';\r\nimport { useFormik } from 'formik';\r\nimport * as Yup from 'yup';\r\n\r\n// Types\r\ninterface ChurchWizardData {\r\n  // Basic Info\r\n  name: string;\r\n  email: string;\r\n  phone: string;\r\n  address: string;\r\n  city: string;\r\n  state_province: string;\r\n  postal_code: string;\r\n  country: string;\r\n  website: string;\r\n  preferred_language: string;\r\n  timezone: string;\r\n  currency: string;\r\n  is_active: boolean;\r\n  \r\n  // Template Selection\r\n  template_church_id: number | null;\r\n  selected_tables: string[];\r\n  \r\n  // Custom Fields\r\n  custom_fields: CustomField[];\r\n  \r\n  // User Management\r\n  initial_users: ChurchUser[];\r\n  \r\n  // Landing Page\r\n  custom_landing_page: {\r\n    enabled: boolean;\r\n    title: string;\r\n    welcome_message: string;\r\n    primary_color: string;\r\n    logo_url: string;\r\n    default_app: 'liturgical_calendar' | 'church_records' | 'notes_app';\r\n  };\r\n}\r\n\r\ninterface CustomField {\r\n  id: string;\r\n  table_name: string;\r\n  field_name: string;\r\n  field_type: 'VARCHAR' | 'TEXT' | 'INT' | 'DATE' | 'BOOLEAN';\r\n  field_length?: number;\r\n  is_required: boolean;\r\n  default_value?: string;\r\n  description: string;\r\n}\r\n\r\ninterface ChurchUser {\r\n  id: string;\r\n  email: string;\r\n  first_name: string;\r\n  last_name: string;\r\n  role: 'admin' | 'manager' | 'user' | 'viewer';\r\n  permissions: string[];\r\n  send_invite: boolean;\r\n}\r\n\r\ninterface TemplateChurch {\r\n  id: number;\r\n  name: string;\r\n  city: string;\r\n  country: string;\r\n  available_tables: string[];\r\n}\r\n\r\nconst steps = [\r\n  'Basic Information',\r\n  'Template Selection',\r\n  'Record Tables & Custom Fields',\r\n  'User Management',\r\n  'Landing Page Configuration',\r\n  'Review & Create'\r\n];\r\n\r\nconst AVAILABLE_RECORD_TABLES = [\r\n  { key: 'baptism_records', label: 'Baptism Records', description: 'Track baptism ceremonies and certificates' },\r\n  { key: 'marriage_records', label: 'Marriage Records', description: 'Manage wedding ceremonies and certificates' },\r\n  { key: 'funeral_records', label: 'Funeral Records', description: 'Record funeral services and memorials' },\r\n  { key: 'clergy', label: 'Clergy Management', description: 'Manage priests, deacons, and church staff' },\r\n  { key: 'members', label: 'Church Members', description: 'Comprehensive membership database' },\r\n  { key: 'donations', label: 'Donations & Offerings', description: 'Track financial contributions' },\r\n  { key: 'calendar_events', label: 'Calendar Events', description: 'Liturgical and parish events' },\r\n  { key: 'confession_records', label: 'Confession Records', description: 'Private confession tracking (encrypted)' },\r\n  { key: 'communion_records', label: 'Communion Records', description: 'Holy Communion participation' },\r\n  { key: 'chrismation_records', label: 'Chrismation Records', description: 'Confirmation ceremonies' }\r\n];\r\n\r\nconst FIELD_TYPES = [\r\n  { value: 'VARCHAR', label: 'Text (Short)', maxLength: 255 },\r\n  { value: 'TEXT', label: 'Text (Long)', maxLength: null },\r\n  { value: 'INT', label: 'Number', maxLength: null },\r\n  { value: 'DATE', label: 'Date', maxLength: null },\r\n  { value: 'BOOLEAN', label: 'Yes/No', maxLength: null }\r\n];\r\n\r\nconst USER_ROLES = [\r\n  { value: 'church_admin', label: 'Church Administrator', description: 'Full access to all church functions' },\r\n  { value: 'priest', label: 'Priest', description: 'Full clergy privileges and record lifecycle authority' },\r\n  { value: 'deacon', label: 'Deacon', description: 'Partial clergy privileges' },\r\n  { value: 'editor', label: 'Editor', description: 'Add and edit records' },\r\n  { value: 'viewer', label: 'Viewer', description: 'View-only access' }\r\n];\r\n\r\nconst AVAILABLE_PERMISSIONS = [\r\n  'view_records', 'create_records', 'edit_records', 'delete_records',\r\n  'view_reports', 'export_data', 'manage_users', 'view_analytics'\r\n];\r\n\r\nconst DEFAULT_APP_OPTIONS = [\r\n  { \r\n    value: 'liturgical_calendar', \r\n    label: 'ðŸ“… Liturgical Calendar', \r\n    description: 'Orthodox liturgical calendar with feast days and fasting periods' \r\n  },\r\n  { \r\n    value: 'church_records', \r\n    label: 'ðŸ“‹ Church Records', \r\n    description: 'Manage baptism, marriage, and funeral records' \r\n  },\r\n  { \r\n    value: 'notes_app', \r\n    label: 'ðŸ“ Notes App', \r\n    description: 'Personal notes and task management' \r\n  }\r\n];\r\n\r\nconst ChurchSetupWizard: React.FC = () => {\r\n  const navigate = useNavigate();\r\n  const { user, hasRole } = useAuth();\r\n  const [activeStep, setActiveStep] = useState(0);\r\n  const [loading, setLoading] = useState(false);\r\n  const [templateChurches, setTemplateChurches] = useState<TemplateChurch[]>([]);\r\n  const [selectedTemplate, setSelectedTemplate] = useState<TemplateChurch | null>(null);\r\n  const [isSubmitting, setIsSubmitting] = useState(false);\r\n  \r\n  // Dialog states\r\n  const [customFieldDialog, setCustomFieldDialog] = useState(false);\r\n  const [userDialog, setUserDialog] = useState(false);\r\n  const [editingField, setEditingField] = useState<CustomField | null>(null);\r\n  const [editingUser, setEditingUser] = useState<ChurchUser | null>(null);\r\n\r\n  // Validation schemas for each step\r\n  const validationSchemas = [\r\n    // Step 1: Basic Information\r\n    Yup.object({\r\n      name: Yup.string().required('Church name is required').min(3, 'Name must be at least 3 characters'),\r\n      email: Yup.string().email('Invalid email format').required('Email is required'),\r\n      phone: Yup.string().required('Phone number is required'),\r\n      city: Yup.string().required('City is required'),\r\n      country: Yup.string().required('Country is required'),\r\n      preferred_language: Yup.string().required('Language is required'),\r\n    }),\r\n    // Additional schemas for other steps can be added as needed\r\n  ];\r\n\r\n  // Formik setup\r\n  const formik = useFormik<ChurchWizardData>({\r\n    initialValues: {\r\n      name: '',\r\n      email: '',\r\n      phone: '',\r\n      address: '',\r\n      city: '',\r\n      state_province: '',\r\n      postal_code: '',\r\n      country: '',\r\n      website: '',\r\n      preferred_language: 'en',\r\n      timezone: 'UTC',\r\n      currency: 'USD',\r\n      is_active: true,\r\n      template_church_id: null,\r\n      selected_tables: ['baptism_records', 'marriage_records', 'funeral_records'],\r\n      custom_fields: [],\r\n      initial_users: [],\r\n      custom_landing_page: {\r\n        enabled: false,\r\n        title: '',\r\n        welcome_message: '',\r\n        primary_color: '#1976d2',\r\n        logo_url: '',\r\n        default_app: 'liturgical_calendar'\r\n      }\r\n    },\r\n    validationSchema: validationSchemas[0],\r\n    onSubmit: async (values) => {\r\n      await handleFinalSubmit(values);\r\n    }\r\n  });\r\n\r\n  // Load template churches\r\n  useEffect(() => {\r\n    const fetchTemplateChurches = async () => {\r\n      try {\r\n        setLoading(true);\r\n        const response = await fetch('/api/admin/churches?preferred_language=en', {\r\n          credentials: 'include'\r\n        });\r\n        \r\n        if (response.ok) {\r\n          const data = await response.json();\r\n          const templatesWithTables = await Promise.all(\r\n            data.churches.map(async (church: any) => {\r\n              // Fetch available tables for each template\r\n              try {\r\n                const tablesResponse = await fetch(`/api/admin/churches/${church.id}/tables`, {\r\n                  credentials: 'include'\r\n                });\r\n                const tablesData = await tablesResponse.json();\r\n                return {\r\n                  ...church,\r\n                  available_tables: tablesData.tables || []\r\n                };\r\n              } catch {\r\n                return {\r\n                  ...church,\r\n                  available_tables: []\r\n                };\r\n              }\r\n            })\r\n          );\r\n          setTemplateChurches(templatesWithTables);\r\n        }\r\n      } catch (error) {\r\n        console.error('Error fetching template churches:', error);\r\n      } finally {\r\n        setLoading(false);\r\n      }\r\n    };\r\n\r\n    fetchTemplateChurches();\r\n  }, []);\r\n\r\n  // Handle template selection\r\n  const handleTemplateSelection = (templateId: number | null) => {\r\n    const template = templateChurches.find(t => t.id === templateId) || null;\r\n    setSelectedTemplate(template);\r\n    formik.setFieldValue('template_church_id', templateId);\r\n    \r\n    if (template) {\r\n      // Pre-populate with template's available tables\r\n      formik.setFieldValue('selected_tables', template.available_tables);\r\n    }\r\n  };\r\n\r\n  // Handle adding custom field\r\n  const handleAddCustomField = (field: CustomField) => {\r\n    const currentFields = formik.values.custom_fields;\r\n    if (editingField) {\r\n      // Update existing field\r\n      const updatedFields = currentFields.map(f => f.id === field.id ? field : f);\r\n      formik.setFieldValue('custom_fields', updatedFields);\r\n      setEditingField(null);\r\n    } else {\r\n      // Add new field\r\n      formik.setFieldValue('custom_fields', [...currentFields, { ...field, id: Date.now().toString() }]);\r\n    }\r\n    setCustomFieldDialog(false);\r\n  };\r\n\r\n  // Handle adding user\r\n  const handleAddUser = (user: ChurchUser) => {\r\n    const currentUsers = formik.values.initial_users;\r\n    if (editingUser) {\r\n      // Update existing user\r\n      const updatedUsers = currentUsers.map(u => u.id === user.id ? user : u);\r\n      formik.setFieldValue('initial_users', updatedUsers);\r\n      setEditingUser(null);\r\n    } else {\r\n      // Add new user\r\n      formik.setFieldValue('initial_users', [...currentUsers, { ...user, id: Date.now().toString() }]);\r\n    }\r\n    setUserDialog(false);\r\n  };\r\n\r\n  // Handle step navigation\r\n  const handleNext = () => {\r\n    if (activeStep < steps.length - 1) {\r\n      setActiveStep(activeStep + 1);\r\n    }\r\n  };\r\n\r\n  const handleBack = () => {\r\n    setActiveStep(activeStep - 1);\r\n  };\r\n\r\n  // Handle final submission\r\n  const handleFinalSubmit = async (values: ChurchWizardData) => {\r\n    try {\r\n      setIsSubmitting(true);\r\n      \r\n      const response = await fetch('/api/admin/churches/wizard', {\r\n        method: 'POST',\r\n        headers: {\r\n          'Content-Type': 'application/json'\r\n        },\r\n        credentials: 'include',\r\n        body: JSON.stringify(values)\r\n      });\r\n\r\n      if (response.ok) {\r\n        const result = await response.json();\r\n        // Show success and redirect\r\n        navigate(`/apps/church-management/edit/${result.church.id}`, {\r\n          state: { \r\n            message: `Church \"${values.name}\" created successfully with wizard setup!`,\r\n            severity: 'success'\r\n          }\r\n        });\r\n      } else {\r\n        const errorData = await response.json();\r\n        \r\n        // Handle 400 validation errors by showing specific missing fields\r\n        if (response.status === 400 && errorData.required) {\r\n          const missingFields = errorData.required.join(\", \");\r\n          alert(`Please fill in all required fields: ${missingFields}`);\r\n        } else {\r\n          alert(errorData.message || \"Failed to create church\");\r\n        }\r\n        \r\n        throw new Error(errorData.message || \"Failed to create church\");\r\n      }\r\n    } catch (error) {\r\n      console.error(\"Error creating church:\", error);\r\n      // Error is already handled above for API responses\r\n      // This catch handles network errors or other unexpected issues\r\n      if (!error.message.includes(\"required fields\")) {\r\n        alert(\"Network error or unexpected issue occurred. Please try again.\");\r\n      }\r\n    } finally {\r\n      setIsSubmitting(false);\r\n    }\r\n  };\r\n\r\n  // Render step content\r\n  const renderStepContent = (step: number) => {\r\n    switch (step) {\r\n      case 0:\r\n        return <BasicInformationStep formik={formik} />;\r\n      case 1:\r\n        return (\r\n          <TemplateSelectionStep \r\n            formik={formik}\r\n            templateChurches={templateChurches}\r\n            selectedTemplate={selectedTemplate}\r\n            onTemplateSelect={handleTemplateSelection}\r\n            loading={loading}\r\n          />\r\n        );\r\n      case 2:\r\n        return (\r\n          <RecordTablesStep \r\n            formik={formik}\r\n            selectedTemplate={selectedTemplate}\r\n            onAddCustomField={() => setCustomFieldDialog(true)}\r\n            onEditCustomField={(field) => {\r\n              setEditingField(field);\r\n              setCustomFieldDialog(true);\r\n            }}\r\n            onDeleteCustomField={(fieldId) => {\r\n              const updatedFields = formik.values.custom_fields.filter(f => f.id !== fieldId);\r\n              formik.setFieldValue('custom_fields', updatedFields);\r\n            }}\r\n          />\r\n        );\r\n      case 3:\r\n        return (\r\n          <UserManagementStep \r\n            formik={formik}\r\n            onAddUser={() => setUserDialog(true)}\r\n            onEditUser={(user) => {\r\n              setEditingUser(user);\r\n              setUserDialog(true);\r\n            }}\r\n            onDeleteUser={(userId) => {\r\n              const updatedUsers = formik.values.initial_users.filter(u => u.id !== userId);\r\n              formik.setFieldValue('initial_users', updatedUsers);\r\n            }}\r\n          />\r\n        );\r\n      case 4:\r\n        return <LandingPageStep formik={formik} />;\r\n      case 5:\r\n        return <ReviewStep formik={formik} selectedTemplate={selectedTemplate} />;\r\n      default:\r\n        return null;\r\n    }\r\n  };\r\n\r\n  // Check if user has permission to create churches\r\n  if (!hasRole(['super_admin'])) {\r\n    return (\r\n      <Box p={3}>\r\n        <Alert severity=\"error\">\r\n          You don't have permission to create churches. Please contact a system administrator.\r\n        </Alert>\r\n      </Box>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <Box p={3}>\r\n      <Card>\r\n        <CardContent>\r\n          <Box mb={3}>\r\n            <Typography variant=\"h4\" gutterBottom>\r\n              <ChurchIcon sx={{ mr: 1, verticalAlign: 'middle' }} />\r\n              Church Setup Wizard\r\n            </Typography>\r\n            <Typography variant=\"body1\" color=\"text.secondary\">\r\n              Create a new church with comprehensive setup including templates, custom fields, users, and landing page configuration.\r\n            </Typography>\r\n          </Box>\r\n\r\n          <Stepper activeStep={activeStep} orientation=\"vertical\">\r\n            {steps.map((label, index) => (\r\n              <Step key={label}>\r\n                <StepLabel>\r\n                  <Typography variant=\"h6\">{label}</Typography>\r\n                </StepLabel>\r\n                <StepContent>\r\n                  <Box my={2}>\r\n                    {renderStepContent(index)}\r\n                  </Box>\r\n                  \r\n                  <Box mt={3}>\r\n                    <Button\r\n                      disabled={activeStep === 0}\r\n                      onClick={handleBack}\r\n                      sx={{ mr: 1 }}\r\n                    >\r\n                      Back\r\n                    </Button>\r\n                    \r\n                    {activeStep === steps.length - 1 ? (\r\n                      <Button\r\n                        variant=\"contained\"\r\n                        onClick={() => formik.handleSubmit()}\r\n                        disabled={isSubmitting}\r\n                        startIcon={isSubmitting ? <CircularProgress size={20} /> : <SaveIcon />}\r\n                      >\r\n                        {isSubmitting ? 'Creating Church...' : 'Create Church'}\r\n                      </Button>\r\n                    ) : (\r\n                      <Button\r\n                        variant=\"contained\"\r\n                        onClick={handleNext}\r\n                      >\r\n                        Next\r\n                      </Button>\r\n                    )}\r\n                  </Box>\r\n                </StepContent>\r\n              </Step>\r\n            ))}\r\n          </Stepper>\r\n        </CardContent>\r\n      </Card>\r\n\r\n      {/* Custom Field Dialog */}\r\n      <CustomFieldDialog\r\n        open={customFieldDialog}\r\n        onClose={() => {\r\n          setCustomFieldDialog(false);\r\n          setEditingField(null);\r\n        }}\r\n        onSave={handleAddCustomField}\r\n        editingField={editingField}\r\n        existingTables={formik.values.selected_tables}\r\n      />\r\n\r\n      {/* User Dialog */}\r\n      <UserDialog\r\n        open={userDialog}\r\n        onClose={() => {\r\n          setUserDialog(false);\r\n          setEditingUser(null);\r\n        }}\r\n        onSave={handleAddUser}\r\n        editingUser={editingUser}\r\n      />\r\n    </Box>\r\n  );\r\n};\r\n\r\n// Step Components\r\nconst BasicInformationStep: React.FC<{ formik: any }> = ({ formik }) => (\r\n  <Grid container spacing={3}>\r\n    <Grid item xs={12} md={6}>\r\n      <TextField\r\n        fullWidth\r\n        name=\"name\"\r\n        label=\"Church Name\"\r\n        value={formik.values.name}\r\n        onChange={formik.handleChange}\r\n        error={formik.touched.name && Boolean(formik.errors.name)}\r\n        helperText={formik.touched.name && formik.errors.name}\r\n        required\r\n      />\r\n    </Grid>\r\n    <Grid item xs={12} md={6}>\r\n      <TextField\r\n        fullWidth\r\n        name=\"email\"\r\n        label=\"Admin Email\"\r\n        type=\"email\"\r\n        value={formik.values.email}\r\n        onChange={formik.handleChange}\r\n        error={formik.touched.email && Boolean(formik.errors.email)}\r\n        helperText={formik.touched.email && formik.errors.email}\r\n        required\r\n      />\r\n    </Grid>\r\n    <Grid item xs={12} md={6}>\r\n      <TextField\r\n        fullWidth\r\n        name=\"phone\"\r\n        label=\"Phone Number\"\r\n        value={formik.values.phone}\r\n        onChange={formik.handleChange}\r\n        error={formik.touched.phone && Boolean(formik.errors.phone)}\r\n        helperText={formik.touched.phone && formik.errors.phone}\r\n        required\r\n      />\r\n    </Grid>\r\n    <Grid item xs={12} md={6}>\r\n      <TextField\r\n        fullWidth\r\n        name=\"website\"\r\n        label=\"Website URL\"\r\n        value={formik.values.website}\r\n        onChange={formik.handleChange}\r\n      />\r\n    </Grid>\r\n    <Grid item xs={12}>\r\n      <TextField\r\n        fullWidth\r\n        name=\"address\"\r\n        label=\"Address\"\r\n        value={formik.values.address}\r\n        onChange={formik.handleChange}\r\n      />\r\n    </Grid>\r\n    <Grid item xs={12} md={4}>\r\n      <TextField\r\n        fullWidth\r\n        name=\"city\"\r\n        label=\"City\"\r\n        value={formik.values.city}\r\n        onChange={formik.handleChange}\r\n        error={formik.touched.city && Boolean(formik.errors.city)}\r\n        helperText={formik.touched.city && formik.errors.city}\r\n        required\r\n      />\r\n    </Grid>\r\n    <Grid item xs={12} md={4}>\r\n      <TextField\r\n        fullWidth\r\n        name=\"state_province\"\r\n        label=\"State/Province\"\r\n        value={formik.values.state_province}\r\n        onChange={formik.handleChange}\r\n      />\r\n    </Grid>\r\n    <Grid item xs={12} md={4}>\r\n      <TextField\r\n        fullWidth\r\n        name=\"postal_code\"\r\n        label=\"Postal Code\"\r\n        value={formik.values.postal_code}\r\n        onChange={formik.handleChange}\r\n      />\r\n    </Grid>\r\n    <Grid item xs={12} md={4}>\r\n      <FormControl fullWidth>\r\n        <InputLabel>Country</InputLabel>\r\n        <Select\r\n          name=\"country\"\r\n          value={formik.values.country}\r\n          onChange={formik.handleChange}\r\n          error={formik.touched.country && Boolean(formik.errors.country)}\r\n        >\r\n          <MenuItem value=\"United States\">United States</MenuItem>\r\n          <MenuItem value=\"Canada\">Canada</MenuItem>\r\n          <MenuItem value=\"Greece\">Greece</MenuItem>\r\n          <MenuItem value=\"Romania\">Romania</MenuItem>\r\n          <MenuItem value=\"Russia\">Russia</MenuItem>\r\n          <MenuItem value=\"Serbia\">Serbia</MenuItem>\r\n          <MenuItem value=\"Bulgaria\">Bulgaria</MenuItem>\r\n          <MenuItem value=\"Other\">Other</MenuItem>\r\n        </Select>\r\n      </FormControl>\r\n    </Grid>\r\n    <Grid item xs={12} md={4}>\r\n      <FormControl fullWidth>\r\n        <InputLabel>Language</InputLabel>\r\n        <Select\r\n          name=\"preferred_language\"\r\n          value={formik.values.preferred_language}\r\n          onChange={formik.handleChange}\r\n        >\r\n          <MenuItem value=\"en\">English</MenuItem>\r\n          <MenuItem value=\"el\">Greek</MenuItem>\r\n          <MenuItem value=\"ro\">Romanian</MenuItem>\r\n          <MenuItem value=\"ru\">Russian</MenuItem>\r\n          <MenuItem value=\"sr\">Serbian</MenuItem>\r\n          <MenuItem value=\"bg\">Bulgarian</MenuItem>\r\n        </Select>\r\n      </FormControl>\r\n    </Grid>\r\n    <Grid item xs={12} md={4}>\r\n      <FormControl fullWidth>\r\n        <InputLabel>Currency</InputLabel>\r\n        <Select\r\n          name=\"currency\"\r\n          value={formik.values.currency}\r\n          onChange={formik.handleChange}\r\n        >\r\n          <MenuItem value=\"USD\">USD ($)</MenuItem>\r\n          <MenuItem value=\"CAD\">CAD ($)</MenuItem>\r\n          <MenuItem value=\"EUR\">EUR (â‚¬)</MenuItem>\r\n          <MenuItem value=\"GBP\">GBP (Â£)</MenuItem>\r\n          <MenuItem value=\"RON\">RON (lei)</MenuItem>\r\n          <MenuItem value=\"RUB\">RUB (â‚½)</MenuItem>\r\n        </Select>\r\n      </FormControl>\r\n    </Grid>\r\n  </Grid>\r\n);\r\n\r\nconst TemplateSelectionStep: React.FC<{\r\n  formik: any;\r\n  templateChurches: TemplateChurch[];\r\n  selectedTemplate: TemplateChurch | null;\r\n  onTemplateSelect: (templateId: number | null) => void;\r\n  loading: boolean;\r\n}> = ({ formik, templateChurches, selectedTemplate, onTemplateSelect, loading }) => (\r\n  <Box>\r\n    <Typography variant=\"h6\" gutterBottom>\r\n      Choose a Template Church (Optional)\r\n    </Typography>\r\n    <Typography variant=\"body2\" color=\"text.secondary\" paragraph>\r\n      Select an existing English-language church to use as a template. This will copy its structure, pages, themes, and settings.\r\n    </Typography>\r\n\r\n    {loading ? (\r\n      <Box display=\"flex\" justifyContent=\"center\" py={4}>\r\n        <CircularProgress />\r\n        <Typography ml={2}>Loading template churches...</Typography>\r\n      </Box>\r\n    ) : (\r\n      <Grid container spacing={2}>\r\n        <Grid item xs={12}>\r\n          <Paper variant=\"outlined\" sx={{ p: 2, mb: 2 }}>\r\n            <FormControlLabel\r\n              control={\r\n                <Checkbox\r\n                  checked={formik.values.template_church_id === null}\r\n                  onChange={() => onTemplateSelect(null)}\r\n                />\r\n              }\r\n              label={\r\n                <Box>\r\n                  <Typography variant=\"subtitle1\">Start from Scratch</Typography>\r\n                  <Typography variant=\"body2\" color=\"text.secondary\">\r\n                    Create a new church without using any template\r\n                  </Typography>\r\n                </Box>\r\n              }\r\n            />\r\n          </Paper>\r\n        </Grid>\r\n\r\n        {templateChurches.map((church) => (\r\n          <Grid item xs={12} md={6} key={church.id}>\r\n            <Paper \r\n              variant=\"outlined\" \r\n              sx={{ \r\n                p: 2, \r\n                cursor: 'pointer',\r\n                border: selectedTemplate?.id === church.id ? 2 : 1,\r\n                borderColor: selectedTemplate?.id === church.id ? 'primary.main' : 'divider'\r\n              }}\r\n              onClick={() => onTemplateSelect(church.id)}\r\n            >\r\n              <FormControlLabel\r\n                control={\r\n                  <Checkbox\r\n                    checked={selectedTemplate?.id === church.id}\r\n                    onChange={() => onTemplateSelect(church.id)}\r\n                  />\r\n                }\r\n                label={\r\n                  <Box>\r\n                    <Typography variant=\"subtitle1\">{church.name}</Typography>\r\n                    <Typography variant=\"body2\" color=\"text.secondary\">\r\n                      {church.city}, {church.country}\r\n                    </Typography>\r\n                    <Typography variant=\"caption\" display=\"block\">\r\n                      {church.available_tables.length} available table(s)\r\n                    </Typography>\r\n                  </Box>\r\n                }\r\n              />\r\n            </Paper>\r\n          </Grid>\r\n        ))}\r\n      </Grid>\r\n    )}\r\n\r\n    {selectedTemplate && (\r\n      <Alert severity=\"info\" sx={{ mt: 2 }}>\r\n        <strong>Template Selected:</strong> {selectedTemplate.name}\r\n        <br />\r\n        This church's structure and settings will be copied to your new church.\r\n      </Alert>\r\n    )}\r\n  </Box>\r\n);\r\n\r\nconst RecordTablesStep: React.FC<{\r\n  formik: any;\r\n  selectedTemplate: TemplateChurch | null;\r\n  onAddCustomField: () => void;\r\n  onEditCustomField: (field: CustomField) => void;\r\n  onDeleteCustomField: (fieldId: string) => void;\r\n}> = ({ formik, selectedTemplate, onAddCustomField, onEditCustomField, onDeleteCustomField }) => (\r\n  <Box>\r\n    <Typography variant=\"h6\" gutterBottom>\r\n      Select Record Tables\r\n    </Typography>\r\n    <Typography variant=\"body2\" color=\"text.secondary\" paragraph>\r\n      Choose which record tables to create in your church database. Standard tables are always created, \r\n      but you can select additional specialized tables.\r\n    </Typography>\r\n\r\n    <Grid container spacing={2}>\r\n      {AVAILABLE_RECORD_TABLES.map((table) => (\r\n        <Grid item xs={12} md={6} key={table.key}>\r\n          <Paper variant=\"outlined\" sx={{ p: 2 }}>\r\n            <FormControlLabel\r\n              control={\r\n                <Checkbox\r\n                  checked={formik.values.selected_tables.includes(table.key)}\r\n                  onChange={(e) => {\r\n                    const currentTables = formik.values.selected_tables;\r\n                    if (e.target.checked) {\r\n                      formik.setFieldValue('selected_tables', [...currentTables, table.key]);\r\n                    } else {\r\n                      formik.setFieldValue('selected_tables', currentTables.filter(t => t !== table.key));\r\n                    }\r\n                  }}\r\n                />\r\n              }\r\n              label={\r\n                <Box>\r\n                  <Typography variant=\"subtitle1\">{table.label}</Typography>\r\n                  <Typography variant=\"body2\" color=\"text.secondary\">\r\n                    {table.description}\r\n                  </Typography>\r\n                </Box>\r\n              }\r\n            />\r\n          </Paper>\r\n        </Grid>\r\n      ))}\r\n    </Grid>\r\n\r\n    <Divider sx={{ my: 3 }} />\r\n\r\n    <Box display=\"flex\" justifyContent=\"space-between\" alignItems=\"center\" mb={2}>\r\n      <Typography variant=\"h6\">Custom Fields</Typography>\r\n      <Button\r\n        variant=\"contained\"\r\n        startIcon={<AddIcon />}\r\n        onClick={onAddCustomField}\r\n      >\r\n        Add Custom Field\r\n      </Button>\r\n    </Box>\r\n\r\n    {formik.values.custom_fields.length === 0 ? (\r\n      <Alert severity=\"info\">\r\n        No custom fields added yet. You can add custom fields to extend the functionality of your record tables.\r\n      </Alert>\r\n    ) : (\r\n      <List>\r\n        {formik.values.custom_fields.map((field) => (\r\n          <ListItem key={field.id} divider>\r\n            <ListItemText\r\n              primary={`${field.field_name} (${field.field_type})`}\r\n              secondary={`Table: ${field.table_name} - ${field.description}`}\r\n            />\r\n            <ListItemSecondaryAction>\r\n              <IconButton onClick={() => onEditCustomField(field)}>\r\n                <EditIcon />\r\n              </IconButton>\r\n              <IconButton onClick={() => onDeleteCustomField(field.id)} color=\"error\">\r\n                <DeleteIcon />\r\n              </IconButton>\r\n            </ListItemSecondaryAction>\r\n          </ListItem>\r\n        ))}\r\n      </List>\r\n    )}\r\n  </Box>\r\n);\r\n\r\nconst UserManagementStep: React.FC<{\r\n  formik: any;\r\n  onAddUser: () => void;\r\n  onEditUser: (user: ChurchUser) => void;\r\n  onDeleteUser: (userId: string) => void;\r\n}> = ({ formik, onAddUser, onEditUser, onDeleteUser }) => (\r\n  <Box>\r\n    <Typography variant=\"h6\" gutterBottom>\r\n      Initial Users\r\n    </Typography>\r\n    <Typography variant=\"body2\" color=\"text.secondary\" paragraph>\r\n      Add users who will have access to the new church's records. They will receive email invitations.\r\n    </Typography>\r\n\r\n    <Box display=\"flex\" justifyContent=\"space-between\" alignItems=\"center\" mb={2}>\r\n      <Typography variant=\"subtitle1\">Users</Typography>\r\n      <Button\r\n        variant=\"contained\"\r\n        startIcon={<AddIcon />}\r\n        onClick={onAddUser}\r\n      >\r\n        Add User\r\n      </Button>\r\n    </Box>\r\n\r\n    {formik.values.initial_users.length === 0 ? (\r\n      <Alert severity=\"info\">\r\n        No users added yet. You can add users after church creation from the church management panel.\r\n      </Alert>\r\n    ) : (\r\n      <List>\r\n        {formik.values.initial_users.map((user) => (\r\n          <ListItem key={user.id} divider>\r\n            <ListItemText\r\n              primary={`${user.first_name} ${user.last_name}`}\r\n              secondary={`${user.email} - ${user.role.toUpperCase()}`}\r\n            />\r\n            <ListItemSecondaryAction>\r\n              <Chip\r\n                label={user.send_invite ? 'Will send invite' : 'No invite'}\r\n                color={user.send_invite ? 'success' : 'default'}\r\n                size=\"small\"\r\n                sx={{ mr: 1 }}\r\n              />\r\n              <IconButton onClick={() => onEditUser(user)}>\r\n                <EditIcon />\r\n              </IconButton>\r\n              <IconButton onClick={() => onDeleteUser(user.id)} color=\"error\">\r\n                <DeleteIcon />\r\n              </IconButton>\r\n            </ListItemSecondaryAction>\r\n          </ListItem>\r\n        ))}\r\n      </List>\r\n    )}\r\n  </Box>\r\n);\r\n\r\nconst LandingPageStep: React.FC<{ formik: any }> = ({ formik }) => (\r\n  <Box>\r\n    <Typography variant=\"h6\" gutterBottom>\r\n      Custom Landing Page\r\n    </Typography>\r\n    <Typography variant=\"body2\" color=\"text.secondary\" paragraph>\r\n      Configure a custom landing page that new users will see when they first access the church system.\r\n    </Typography>\r\n\r\n    <FormControlLabel\r\n      control={\r\n        <Switch\r\n          checked={formik.values.custom_landing_page.enabled}\r\n          onChange={(e) => \r\n            formik.setFieldValue('custom_landing_page.enabled', e.target.checked)\r\n          }\r\n        />\r\n      }\r\n      label=\"Enable Custom Landing Page\"\r\n      sx={{ mb: 3 }}\r\n    />\r\n\r\n    {formik.values.custom_landing_page.enabled && (\r\n      <Grid container spacing={3}>\r\n        <Grid item xs={12} md={6}>\r\n          <TextField\r\n            fullWidth\r\n            label=\"Landing Page Title\"\r\n            value={formik.values.custom_landing_page.title}\r\n            onChange={(e) => \r\n              formik.setFieldValue('custom_landing_page.title', e.target.value)\r\n            }\r\n            placeholder=\"Welcome to Our Church\"\r\n          />\r\n        </Grid>\r\n        <Grid item xs={12} md={6}>\r\n          <TextField\r\n            fullWidth\r\n            label=\"Primary Color\"\r\n            type=\"color\"\r\n            value={formik.values.custom_landing_page.primary_color}\r\n            onChange={(e) => \r\n              formik.setFieldValue('custom_landing_page.primary_color', e.target.value)\r\n            }\r\n          />\r\n        </Grid>\r\n        <Grid item xs={12}>\r\n          <TextField\r\n            fullWidth\r\n            multiline\r\n            rows={4}\r\n            label=\"Welcome Message\"\r\n            value={formik.values.custom_landing_page.welcome_message}\r\n            onChange={(e) => \r\n              formik.setFieldValue('custom_landing_page.welcome_message', e.target.value)\r\n            }\r\n            placeholder=\"Enter a welcome message for new users...\"\r\n          />\r\n        </Grid>\r\n        <Grid item xs={12}>\r\n          <TextField\r\n            fullWidth\r\n            label=\"Logo URL\"\r\n            value={formik.values.custom_landing_page.logo_url}\r\n            onChange={(e) => \r\n              formik.setFieldValue('custom_landing_page.logo_url', e.target.value)\r\n            }\r\n            placeholder=\"https://example.com/logo.png\"\r\n          />\r\n        </Grid>\r\n        <Grid item xs={12}>\r\n          <FormControl fullWidth>\r\n            <InputLabel>Default Application</InputLabel>\r\n            <Select\r\n              value={formik.values.custom_landing_page.default_app}\r\n              onChange={(e) => \r\n                formik.setFieldValue('custom_landing_page.default_app', e.target.value)\r\n              }\r\n              label=\"Default Application\"\r\n            >\r\n              {DEFAULT_APP_OPTIONS.map((option) => (\r\n                <MenuItem key={option.value} value={option.value}>\r\n                  {option.label}\r\n                </MenuItem>\r\n              ))}\r\n            </Select>\r\n          </FormControl>\r\n          <Typography variant=\"body2\" color=\"text.secondary\" sx={{ mt: 1 }}>\r\n            Select which application users will see by default when they access the church system.\r\n          </Typography>\r\n          {formik.values.custom_landing_page.default_app && (\r\n            <Alert severity=\"info\" sx={{ mt: 2 }}>\r\n              <Typography variant=\"body2\">\r\n                <strong>Selected:</strong> {\r\n                  DEFAULT_APP_OPTIONS.find(option => \r\n                    option.value === formik.values.custom_landing_page.default_app\r\n                  )?.description\r\n                }\r\n              </Typography>\r\n            </Alert>\r\n          )}\r\n        </Grid>\r\n      </Grid>\r\n    )}\r\n  </Box>\r\n);\r\n\r\nconst ReviewStep: React.FC<{ \r\n  formik: any; \r\n  selectedTemplate: TemplateChurch | null;\r\n}> = ({ formik, selectedTemplate }) => (\r\n  <Box>\r\n    <Typography variant=\"h6\" gutterBottom>\r\n      Review Church Configuration\r\n    </Typography>\r\n    <Typography variant=\"body2\" color=\"text.secondary\" paragraph>\r\n      Please review all settings before creating the church.\r\n    </Typography>\r\n\r\n    <Grid container spacing={3}>\r\n      <Grid item xs={12} md={6}>\r\n        <Paper sx={{ p: 2 }}>\r\n          <Typography variant=\"subtitle1\" gutterBottom>\r\n            <ChurchIcon sx={{ mr: 1, verticalAlign: 'middle' }} />\r\n            Basic Information\r\n          </Typography>\r\n          <Typography variant=\"body2\"><strong>Name:</strong> {formik.values.name}</Typography>\r\n          <Typography variant=\"body2\"><strong>Email:</strong> {formik.values.email}</Typography>\r\n          <Typography variant=\"body2\"><strong>Location:</strong> {formik.values.city}, {formik.values.country}</Typography>\r\n          <Typography variant=\"body2\"><strong>Language:</strong> {formik.values.preferred_language}</Typography>\r\n        </Paper>\r\n      </Grid>\r\n\r\n      <Grid item xs={12} md={6}>\r\n        <Paper sx={{ p: 2 }}>\r\n          <Typography variant=\"subtitle1\" gutterBottom>\r\n            <SettingsIcon sx={{ mr: 1, verticalAlign: 'middle' }} />\r\n            Template & Tables\r\n          </Typography>\r\n          <Typography variant=\"body2\">\r\n            <strong>Template:</strong> {selectedTemplate ? selectedTemplate.name : 'None (Start from scratch)'}\r\n          </Typography>\r\n          <Typography variant=\"body2\">\r\n            <strong>Selected Tables:</strong> {formik.values.selected_tables.length}\r\n          </Typography>\r\n          <Typography variant=\"body2\">\r\n            <strong>Custom Fields:</strong> {formik.values.custom_fields.length}\r\n          </Typography>\r\n        </Paper>\r\n      </Grid>\r\n\r\n      <Grid item xs={12} md={6}>\r\n        <Paper sx={{ p: 2 }}>\r\n          <Typography variant=\"subtitle1\" gutterBottom>\r\n            <PeopleIcon sx={{ mr: 1, verticalAlign: 'middle' }} />\r\n            Users\r\n          </Typography>\r\n          <Typography variant=\"body2\">\r\n            <strong>Initial Users:</strong> {formik.values.initial_users.length}\r\n          </Typography>\r\n          {formik.values.initial_users.slice(0, 3).map((user) => (\r\n            <Typography key={user.id} variant=\"body2\">\r\n              â€¢ {user.first_name} {user.last_name} ({user.role})\r\n            </Typography>\r\n          ))}\r\n          {formik.values.initial_users.length > 3 && (\r\n            <Typography variant=\"body2\">\r\n              ... and {formik.values.initial_users.length - 3} more\r\n            </Typography>\r\n          )}\r\n        </Paper>\r\n      </Grid>\r\n\r\n      <Grid item xs={12} md={6}>\r\n        <Paper sx={{ p: 2 }}>\r\n          <Typography variant=\"subtitle1\" gutterBottom>\r\n            <WebIcon sx={{ mr: 1, verticalAlign: 'middle' }} />\r\n            Landing Page\r\n          </Typography>\r\n          <Typography variant=\"body2\">\r\n            <strong>Custom Landing:</strong> {formik.values.custom_landing_page.enabled ? 'Yes' : 'No'}\r\n          </Typography>\r\n          {formik.values.custom_landing_page.enabled && (\r\n            <>\r\n              <Typography variant=\"body2\">\r\n                <strong>Title:</strong> {formik.values.custom_landing_page.title || 'Not set'}\r\n              </Typography>\r\n              <Typography variant=\"body2\">\r\n                <strong>Has Welcome Message:</strong> {formik.values.custom_landing_page.welcome_message ? 'Yes' : 'No'}\r\n              </Typography>\r\n              <Typography variant=\"body2\">\r\n                <strong>Default App:</strong> {\r\n                  DEFAULT_APP_OPTIONS.find(option => \r\n                    option.value === formik.values.custom_landing_page.default_app\r\n                  )?.label || 'Not set'\r\n                }\r\n              </Typography>\r\n            </>\r\n          )}\r\n        </Paper>\r\n      </Grid>\r\n    </Grid>\r\n\r\n    <Alert severity=\"warning\" sx={{ mt: 3 }}>\r\n      <strong>Important:</strong> Once created, some settings like the database structure cannot be easily changed. \r\n      Please ensure all information is correct before proceeding.\r\n    </Alert>\r\n  </Box>\r\n);\r\n\r\n// Dialog Components\r\nconst CustomFieldDialog: React.FC<{\r\n  open: boolean;\r\n  onClose: () => void;\r\n  onSave: (field: CustomField) => void;\r\n  editingField: CustomField | null;\r\n  existingTables: string[];\r\n}> = ({ open, onClose, onSave, editingField, existingTables }) => {\r\n  const [fieldData, setFieldData] = useState<Partial<CustomField>>({\r\n    table_name: '',\r\n    field_name: '',\r\n    field_type: 'VARCHAR',\r\n    is_required: false,\r\n    description: ''\r\n  });\r\n\r\n  useEffect(() => {\r\n    if (editingField) {\r\n      setFieldData(editingField);\r\n    } else {\r\n      setFieldData({\r\n        table_name: '',\r\n        field_name: '',\r\n        field_type: 'VARCHAR',\r\n        is_required: false,\r\n        description: ''\r\n      });\r\n    }\r\n  }, [editingField, open]);\r\n\r\n  const handleSave = () => {\r\n    if (fieldData.table_name && fieldData.field_name && fieldData.field_type) {\r\n      onSave({\r\n        ...fieldData,\r\n        id: editingField?.id || Date.now().toString()\r\n      } as CustomField);\r\n    }\r\n  };\r\n\r\n  return (\r\n    <Dialog open={open} onClose={onClose} maxWidth=\"md\" fullWidth>\r\n      <DialogTitle>\r\n        {editingField ? 'Edit Custom Field' : 'Add Custom Field'}\r\n      </DialogTitle>\r\n      <DialogContent>\r\n        <Grid container spacing={2} sx={{ mt: 1 }}>\r\n          <Grid item xs={12} md={6}>\r\n            <FormControl fullWidth>\r\n              <InputLabel>Table</InputLabel>\r\n              <Select\r\n                value={fieldData.table_name || ''}\r\n                onChange={(e) => setFieldData({ ...fieldData, table_name: e.target.value })}\r\n              >\r\n                {existingTables.map((table) => (\r\n                  <MenuItem key={table} value={table}>\r\n                    {AVAILABLE_RECORD_TABLES.find(t => t.key === table)?.label || table}\r\n                  </MenuItem>\r\n                ))}\r\n              </Select>\r\n            </FormControl>\r\n          </Grid>\r\n          <Grid item xs={12} md={6}>\r\n            <TextField\r\n              fullWidth\r\n              label=\"Field Name\"\r\n              value={fieldData.field_name || ''}\r\n              onChange={(e) => setFieldData({ ...fieldData, field_name: e.target.value })}\r\n              placeholder=\"e.g., sponsor_name\"\r\n            />\r\n          </Grid>\r\n          <Grid item xs={12} md={6}>\r\n            <FormControl fullWidth>\r\n              <InputLabel>Field Type</InputLabel>\r\n              <Select\r\n                value={fieldData.field_type || 'VARCHAR'}\r\n                onChange={(e) => setFieldData({ ...fieldData, field_type: e.target.value as any })}\r\n              >\r\n                {FIELD_TYPES.map((type) => (\r\n                  <MenuItem key={type.value} value={type.value}>\r\n                    {type.label}\r\n                  </MenuItem>\r\n                ))}\r\n              </Select>\r\n            </FormControl>\r\n          </Grid>\r\n          <Grid item xs={12} md={6}>\r\n            {fieldData.field_type === 'VARCHAR' && (\r\n              <TextField\r\n                fullWidth\r\n                type=\"number\"\r\n                label=\"Max Length\"\r\n                value={fieldData.field_length || 255}\r\n                onChange={(e) => setFieldData({ ...fieldData, field_length: parseInt(e.target.value) })}\r\n              />\r\n            )}\r\n          </Grid>\r\n          <Grid item xs={12}>\r\n            <TextField\r\n              fullWidth\r\n              multiline\r\n              rows={2}\r\n              label=\"Description\"\r\n              value={fieldData.description || ''}\r\n              onChange={(e) => setFieldData({ ...fieldData, description: e.target.value })}\r\n              placeholder=\"Describe what this field is for...\"\r\n            />\r\n          </Grid>\r\n          <Grid item xs={12}>\r\n            <FormControlLabel\r\n              control={\r\n                <Checkbox\r\n                  checked={fieldData.is_required || false}\r\n                  onChange={(e) => setFieldData({ ...fieldData, is_required: e.target.checked })}\r\n                />\r\n              }\r\n              label=\"Required Field\"\r\n            />\r\n          </Grid>\r\n        </Grid>\r\n      </DialogContent>\r\n      <DialogActions>\r\n        <Button onClick={onClose}>Cancel</Button>\r\n        <Button \r\n          onClick={handleSave} \r\n          variant=\"contained\"\r\n          disabled={!fieldData.table_name || !fieldData.field_name || !fieldData.field_type}\r\n        >\r\n          {editingField ? 'Update' : 'Add'} Field\r\n        </Button>\r\n      </DialogActions>\r\n    </Dialog>\r\n  );\r\n};\r\n\r\nconst UserDialog: React.FC<{\r\n  open: boolean;\r\n  onClose: () => void;\r\n  onSave: (user: ChurchUser) => void;\r\n  editingUser: ChurchUser | null;\r\n}> = ({ open, onClose, onSave, editingUser }) => {\r\n  const [userData, setUserData] = useState<Partial<ChurchUser>>({\r\n    email: '',\r\n    first_name: '',\r\n    last_name: '',\r\n    role: 'user',\r\n    permissions: [],\r\n    send_invite: true\r\n  });\r\n\r\n  useEffect(() => {\r\n    if (editingUser) {\r\n      setUserData(editingUser);\r\n    } else {\r\n      setUserData({\r\n        email: '',\r\n        first_name: '',\r\n        last_name: '',\r\n        role: 'user',\r\n        permissions: [],\r\n        send_invite: true\r\n      });\r\n    }\r\n  }, [editingUser, open]);\r\n\r\n  const handleSave = () => {\r\n    if (userData.email && userData.first_name && userData.last_name) {\r\n      onSave({\r\n        ...userData,\r\n        id: editingUser?.id || Date.now().toString()\r\n      } as ChurchUser);\r\n    }\r\n  };\r\n\r\n  return (\r\n    <Dialog open={open} onClose={onClose} maxWidth=\"md\" fullWidth>\r\n      <DialogTitle>\r\n        {editingUser ? 'Edit User' : 'Add User'}\r\n      </DialogTitle>\r\n      <DialogContent>\r\n        <Grid container spacing={2} sx={{ mt: 1 }}>\r\n          <Grid item xs={12} md={6}>\r\n            <TextField\r\n              fullWidth\r\n              label=\"First Name\"\r\n              value={userData.first_name || ''}\r\n              onChange={(e) => setUserData({ ...userData, first_name: e.target.value })}\r\n              required\r\n            />\r\n          </Grid>\r\n          <Grid item xs={12} md={6}>\r\n            <TextField\r\n              fullWidth\r\n              label=\"Last Name\"\r\n              value={userData.last_name || ''}\r\n              onChange={(e) => setUserData({ ...userData, last_name: e.target.value })}\r\n              required\r\n            />\r\n          </Grid>\r\n          <Grid item xs={12}>\r\n            <TextField\r\n              fullWidth\r\n              type=\"email\"\r\n              label=\"Email Address\"\r\n              value={userData.email || ''}\r\n              onChange={(e) => setUserData({ ...userData, email: e.target.value })}\r\n              required\r\n            />\r\n          </Grid>\r\n          <Grid item xs={12} md={6}>\r\n            <FormControl fullWidth>\r\n              <InputLabel>Role</InputLabel>\r\n              <Select\r\n                value={userData.role || 'user'}\r\n                onChange={(e) => setUserData({ ...userData, role: e.target.value as any })}\r\n              >\r\n                {USER_ROLES.map((role) => (\r\n                  <MenuItem key={role.value} value={role.value}>\r\n                    {role.label}\r\n                  </MenuItem>\r\n                ))}\r\n              </Select>\r\n            </FormControl>\r\n          </Grid>\r\n          <Grid item xs={12} md={6}>\r\n            <FormControlLabel\r\n              control={\r\n                <Switch\r\n                  checked={userData.send_invite || false}\r\n                  onChange={(e) => setUserData({ ...userData, send_invite: e.target.checked })}\r\n                />\r\n              }\r\n              label=\"Send Email Invitation\"\r\n            />\r\n          </Grid>\r\n          <Grid item xs={12}>\r\n            <Typography variant=\"subtitle2\" gutterBottom>\r\n              Permissions\r\n            </Typography>\r\n            <FormGroup row>\r\n              {AVAILABLE_PERMISSIONS.map((permission) => (\r\n                <FormControlLabel\r\n                  key={permission}\r\n                  control={\r\n                    <Checkbox\r\n                      checked={userData.permissions?.includes(permission) || false}\r\n                      onChange={(e) => {\r\n                        const currentPermissions = userData.permissions || [];\r\n                        if (e.target.checked) {\r\n                          setUserData({ \r\n                            ...userData, \r\n                            permissions: [...currentPermissions, permission] \r\n                          });\r\n                        } else {\r\n                          setUserData({ \r\n                            ...userData, \r\n                            permissions: currentPermissions.filter(p => p !== permission) \r\n                          });\r\n                        }\r\n                      }}\r\n                    />\r\n                  }\r\n                  label={permission.replace('_', ' ').replace(/\\b\\w/g, l => l.toUpperCase())}\r\n                />\r\n              ))}\r\n            </FormGroup>\r\n          </Grid>\r\n        </Grid>\r\n      </DialogContent>\r\n      <DialogActions>\r\n        <Button onClick={onClose}>Cancel</Button>\r\n        <Button \r\n          onClick={handleSave} \r\n          variant=\"contained\"\r\n          disabled={!userData.email || !userData.first_name || !userData.last_name}\r\n        >\r\n          {editingUser ? 'Update' : 'Add'} User\r\n        </Button>\r\n      </DialogActions>\r\n    </Dialog>\r\n  );\r\n};\r\n\r\nexport default ChurchSetupWizard; "],"names":["steps","AVAILABLE_RECORD_TABLES","FIELD_TYPES","USER_ROLES","AVAILABLE_PERMISSIONS","DEFAULT_APP_OPTIONS","ChurchSetupWizard","navigate","useNavigate","user","hasRole","useAuth","activeStep","setActiveStep","useState","loading","setLoading","templateChurches","setTemplateChurches","selectedTemplate","setSelectedTemplate","isSubmitting","setIsSubmitting","customFieldDialog","setCustomFieldDialog","userDialog","setUserDialog","editingField","setEditingField","editingUser","setEditingUser","validationSchemas","Yup.object","Yup.string","formik","useFormik","values","__async","handleFinalSubmit","useEffect","response","data","templatesWithTables","church","tablesData","__spreadProps","__spreadValues","e","error","handleTemplateSelection","templateId","template","t","handleAddCustomField","field","currentFields","updatedFields","handleAddUser","currentUsers","updatedUsers","u","handleNext","handleBack","result","errorData","missingFields","renderStepContent","step","jsx","BasicInformationStep","TemplateSelectionStep","RecordTablesStep","fieldId","UserManagementStep","userId","LandingPageStep","ReviewStep","jsxs","Box","Card","CardContent","Typography","ChurchIcon","Stepper","label","index","Step","StepLabel","StepContent","Button","CircularProgress","SaveIcon","CustomFieldDialog","UserDialog","Alert","Grid","TextField","FormControl","InputLabel","Select","MenuItem","onTemplateSelect","Paper","FormControlLabel","Checkbox","onAddCustomField","onEditCustomField","onDeleteCustomField","table","currentTables","Divider","AddIcon","List","ListItem","ListItemText","ListItemSecondaryAction","IconButton","EditIcon","DeleteIcon","onAddUser","onEditUser","onDeleteUser","Chip","Switch","option","_a","SettingsIcon","PeopleIcon","WebIcon","Fragment","open","onClose","onSave","existingTables","fieldData","setFieldData","handleSave","Dialog","DialogTitle","DialogContent","type","DialogActions","userData","setUserData","role","FormGroup","permission","currentPermissions","p","l"],"mappings":"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"}