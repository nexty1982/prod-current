var $=(g,i,a)=>new Promise((s,o)=>{var l=d=>{try{n(a.next(d))}catch(f){o(f)}},m=d=>{try{n(a.throw(d))}catch(f){o(f)}},n=d=>d.done?s(d.value):Promise.resolve(d.value).then(l,m);n((a=a.apply(g,i)).next())});import{j as e,J as K,Y as Q,K as X,B as k,h as Z,d as O,O as H,$ as P,e as _,a3 as M,A as ee,C as te,cs as se,ct as re,cu as ae}from"./index-CNFXvQ6i.js";import{r as x,b as oe}from"./vendor-DgfDxsY7.js";import{I as G}from"./IconBrandGithub-B22chLmQ.js";const ne=({title:g,isLive:i,onToggleLive:a,isDarkMode:s,onToggleDarkMode:o,activeFilters:l,onPause:m,onRefresh:n,isPaused:d,logFilter:f,onLogFilterChange:b,realTimeLogCount:p=25,onRealTimeLogCountChange:w,debugMode:t=!1,onDebugModeToggle:u,showInfoLogs:h=!1,onShowInfoLogsToggle:c})=>e.jsx("header",{className:`border-b backdrop-blur-sm sticky top-0 z-50 ${s?"border-gray-700 bg-gray-900/50":"border-gray-300 bg-gray-100/90"}`,children:e.jsx("div",{className:"container mx-auto px-4 py-3",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("h1",{className:`text-2xl font-mono font-medium ${s?"text-white":"text-gray-900"}`,children:g}),e.jsxs("button",{onClick:a,className:`flex items-center space-x-2 px-3 py-1.5 rounded-lg text-sm font-medium transition-colors ${i?"bg-green-500/20 text-green-400 border border-green-500/30":"bg-red-500/20 text-red-400 border border-red-500/30"}`,children:[e.jsx("div",{className:`w-2 h-2 rounded-full ${i?"bg-green-400 animate-pulse":"bg-red-400"}`}),e.jsx("span",{children:i?"LIVE":"OFFLINE"})]})]}),e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsxs("select",{value:f,onChange:r=>b(r.target.value),className:"px-3 py-2 rounded-lg text-sm border bg-gray-800 border-gray-600 text-white focus:ring-2 focus:ring-blue-500 focus:border-transparent",style:{color:"white",backgroundColor:"#1f2937",borderColor:"#4b5563"},children:[e.jsx("option",{value:"All Logs",style:{color:"white",backgroundColor:"#1f2937"},children:"All Logs"}),e.jsx("option",{value:"Errors Only",style:{color:"white",backgroundColor:"#1f2937"},children:"Errors Only"}),e.jsx("option",{value:"Warnings Only",style:{color:"white",backgroundColor:"#1f2937"},children:"Warnings Only"}),e.jsx("option",{value:"Info Only",style:{color:"white",backgroundColor:"#1f2937"},children:"Info Only"}),e.jsx("option",{value:"Success Only",style:{color:"white",backgroundColor:"#1f2937"},children:"Success Only"}),e.jsx("option",{value:"Debug Only",style:{color:"white",backgroundColor:"#1f2937"},children:"Debug Only"})]}),e.jsx("button",{onClick:m,className:`px-3 py-2 rounded-lg text-sm font-bold transition-colors border ${d?"bg-red-500 hover:bg-red-600 border-red-600":s?"bg-gray-700 hover:bg-gray-600 border-gray-600":"bg-gray-600 hover:bg-gray-700 border-gray-700"}`,style:{color:"white",fontWeight:"bold"},children:d?"â–¶ï¸ Resume":"â¸ï¸ Pause"}),e.jsx("button",{onClick:n,className:`px-3 py-2 rounded-lg text-sm font-bold transition-colors border ${s?"bg-gray-700 hover:bg-gray-600 border-gray-600":"bg-gray-600 hover:bg-gray-700 border-gray-700"}`,style:{color:"white",fontWeight:"bold"},children:"ðŸ”„ Refresh"}),e.jsxs("select",{value:p,onChange:r=>w&&w(Number(r.target.value)),className:"px-3 py-2 rounded-lg text-sm border bg-gray-800 border-gray-600 text-white focus:ring-2 focus:ring-green-500 focus:border-transparent",style:{color:"white",backgroundColor:"#1f2937",borderColor:"#4b5563"},title:"Real-Time Log Count",children:[e.jsx("option",{value:5,style:{color:"white",backgroundColor:"#1f2937"},children:"5 logs"}),e.jsx("option",{value:10,style:{color:"white",backgroundColor:"#1f2937"},children:"10 logs"}),e.jsx("option",{value:25,style:{color:"white",backgroundColor:"#1f2937"},children:"25 logs"}),e.jsx("option",{value:50,style:{color:"white",backgroundColor:"#1f2937"},children:"50 logs"})]}),e.jsx("button",{onClick:()=>u&&u(!t),className:`px-3 py-2 rounded-lg text-sm font-bold transition-colors border ${t?"bg-orange-500 hover:bg-orange-600 border-orange-600 animate-pulse":s?"bg-gray-700 hover:bg-gray-600 border-gray-600":"bg-gray-600 hover:bg-gray-700 border-gray-700"}`,style:{color:"white",fontWeight:"bold"},title:"Toggle Debug Mode Capture",children:t?"ðŸŸ  Debug ON":"ðŸ”§ Debug OFF"}),e.jsx("button",{onClick:()=>c&&c(!h),className:`px-3 py-2 rounded-lg text-sm font-bold transition-colors border ${h?"bg-blue-500 hover:bg-blue-600 border-blue-600":s?"bg-gray-700 hover:bg-gray-600 border-gray-600":"bg-gray-600 hover:bg-gray-700 border-gray-700"}`,style:{color:"white",fontWeight:"bold"},title:h?"Hide INFO logs":"Show INFO logs (hidden by default)",children:h?"ðŸ“„ Info ON":"ðŸ“„ Info OFF"}),e.jsx("button",{onClick:()=>o(!s),className:`px-3 py-2 rounded-lg text-sm font-bold transition-colors border ${s?"bg-gray-700 hover:bg-gray-600 border-gray-600":"bg-gray-600 hover:bg-gray-700 border-gray-700"}`,style:{color:"white",fontWeight:"bold"},children:s?"â˜€ï¸ Light":"ðŸŒ™ Dark"})]})]})})}),A=({title:g,titleColor:i,icon:a,badge:s,children:o,className:l="",isDarkMode:m=!0})=>e.jsxs("div",{className:`console-card h-full flex flex-col border rounded-lg shadow-lg ${l} ${m?"bg-gray-900 border-gray-700":"bg-white border-gray-300"}`,children:[e.jsx("div",{className:`flex-shrink-0 p-4 pb-3 border-b ${m?"border-gray-700":"border-gray-300"}`,children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:`p-1.5 rounded-lg ${i}`,children:a}),e.jsx("h3",{className:`text-lg font-medium ${i}`,children:g})]}),s&&e.jsx("div",{className:`px-3 py-1 rounded-full text-sm font-medium border ${s.color}`,children:s.text})]})}),e.jsx("div",{className:"flex-1 min-h-0 overflow-hidden",children:o})]}),le=({timestamp:g,level:i,source:a,message:s,service:o,meta:l,isDarkMode:m=!0})=>{const n=b=>b.toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit",second:"2-digit",hour12:!1}),d=b=>{if(m)switch(b){case"ERROR":return"text-red-400 bg-red-900/20 border-red-700/50";case"WARN":return"text-yellow-400 bg-yellow-900/20 border-yellow-700/50";case"SUCCESS":return"text-green-400 bg-green-900/20 border-green-700/50";case"INFO":return"text-blue-400 bg-blue-900/20 border-blue-700/50";case"DEBUG":return"text-gray-400 bg-gray-900/20 border-gray-700/50";default:return"text-gray-400 bg-gray-900/20 border-gray-700/50"}else switch(b){case"ERROR":return"text-red-600 bg-red-50 border-red-300";case"WARN":return"text-yellow-600 bg-yellow-50 border-yellow-300";case"SUCCESS":return"text-green-600 bg-green-50 border-green-300";case"INFO":return"text-blue-600 bg-blue-50 border-blue-300";case"DEBUG":return"text-gray-600 bg-gray-50 border-gray-300";default:return"text-gray-600 bg-gray-50 border-gray-300"}},f=b=>{if(m)switch(b){case"frontend":return"text-green-400";case"backend":return"text-purple-400";case"dev":return"text-orange-400";default:return"text-gray-400"}else switch(b){case"frontend":return"text-green-600";case"backend":return"text-purple-600";case"dev":return"text-orange-600";default:return"text-gray-600"}};return e.jsxs("div",{className:`log-entry flex items-start space-x-3 p-1 rounded ${m?"text-gray-300 hover:bg-gray-800/50":"text-gray-700 hover:bg-gray-100"}`,children:[e.jsx("span",{className:`text-xs w-20 flex-shrink-0 font-mono ${m?"text-gray-500":"text-gray-400"}`,children:n(g)}),e.jsx("span",{className:`px-2 py-0.5 rounded text-xs font-medium border w-16 flex-shrink-0 text-center ${d(i)}`,children:i}),e.jsxs("span",{className:`text-xs w-16 flex-shrink-0 font-mono ${f(a)}`,children:["[",a,"]"]}),e.jsxs("div",{className:`flex-1 ${m?"text-gray-300":"text-gray-700"}`,children:[e.jsx("div",{className:"text-sm font-mono leading-relaxed",children:s}),o&&e.jsxs("div",{className:`text-xs mt-1 ${m?"text-gray-400":"text-gray-500"}`,children:["Service: ",e.jsx("span",{className:"font-medium",children:o})]}),l&&e.jsx("div",{className:`text-xs mt-1 ${m?"text-gray-500":"text-gray-400"}`,children:e.jsxs("details",{className:"cursor-pointer",children:[e.jsx("summary",{className:`hover:opacity-80 ${m?"text-gray-400":"text-gray-600"}`,children:"Details"}),e.jsx("pre",{className:`mt-1 p-2 rounded text-xs overflow-x-auto ${m?"bg-gray-800/50":"bg-gray-100"}`,children:JSON.stringify(l,null,2)})]})})]})]})},W=({isLive:g,logFilter:i="All Logs",maxLogs:a=25,showInfoLogs:s=!1,isDarkMode:o=!0})=>{const[l,m]=x.useState([]),[n,d]=x.useState(!0),f=x.useRef(null),b=x.useRef(null);x.useEffect(()=>{console.log("RealTimeConsole: Filter changed to:",i)},[i]);const p=()=>{console.log("RealTimeConsole filter:",i,"Total logs:",l.length,"showInfoLogs:",s);let t=l;if(s||(t=l.filter(h=>h.level!=="INFO"),console.log("Hiding INFO logs, remaining:",t.length)),!i||i==="All Logs"){console.log("Showing all logs before maxLogs filter:",t.length);const h=t.slice(-a);return console.log("Final logs after maxLogs filter:",h.length,"maxLogs:",a),h}let u;switch(i){case"Errors Only":u=t.filter(h=>h.level==="ERROR"),console.log("Filtered ERROR logs:",u.length);break;case"Warnings Only":u=t.filter(h=>h.level==="WARN"),console.log("Filtered WARN logs:",u.length);break;case"Info Only":u=l.filter(h=>h.level==="INFO"),console.log("Filtered INFO logs:",u.length);break;case"Success Only":u=t.filter(h=>h.level==="SUCCESS"),console.log("Filtered SUCCESS logs:",u.length);break;case"Debug Only":u=t.filter(h=>h.level==="DEBUG"),console.log("Filtered DEBUG logs:",u.length);break;default:u=t;break}return u.slice(-a)};x.useEffect(()=>{if(n&&f.current){const t=f.current;t.scrollTo({top:t.scrollHeight,behavior:"smooth"})}},[l,n]),x.useEffect(()=>{const t=()=>$(void 0,null,function*(){try{const c=yield(yield fetch("/api/admin/logs/database?limit=100&sort=desc")).json();if(c.logs&&Array.isArray(c.logs)){const r=c.logs.map((v,y)=>({id:v.id||y,timestamp:new Date(v.timestamp),level:v.level||"INFO",source:v.source||"backend",message:v.message||"No message",service:v.service,meta:v.meta}));m(r.reverse())}}catch(u){console.warn("Failed to fetch logs, using mock data");const h=[{id:1,timestamp:new Date,level:"INFO",source:"backend",message:"User authentication successful",service:"auth-service",origin:"server",source_component:"AuthController"},{id:2,timestamp:new Date(Date.now()-2e3),level:"SUCCESS",source:"frontend",message:"Page loaded successfully",service:"ui-service",origin:"browser",source_component:"PageLoader"},{id:3,timestamp:new Date(Date.now()-4e3),level:"WARN",source:"frontend",message:"API response time exceeded threshold",service:"api-gateway",origin:"browser",source_component:"ApiClient"},{id:4,timestamp:new Date(Date.now()-6e3),level:"WARN",source:"backend",message:"Memory usage approaching limit",service:"monitoring",origin:"server",source_component:"MemoryMonitor"},{id:5,timestamp:new Date(Date.now()-8e3),level:"ERROR",source:"backend",message:"Database connection failed",service:"db-service",origin:"server",source_component:"DatabasePool"},{id:6,timestamp:new Date(Date.now()-1e4),level:"ERROR",source:"backend",message:"Payment processing failure",service:"payment-service",origin:"server",source_component:"PaymentProcessor"},{id:7,timestamp:new Date(Date.now()-12e3),level:"SUCCESS",source:"backend",message:"Backup completed successfully",service:"backup-service",origin:"server",source_component:"BackupManager"},{id:8,timestamp:new Date(Date.now()-14e3),level:"DEBUG",source:"browser",message:"Component state updated",service:"ui-service",origin:"browser",source_component:"ReactComponent"},{id:9,timestamp:new Date(Date.now()-16e3),level:"DEBUG",source:"dev",message:"Component mounted and initialized",service:"logger-service",origin:"devtools",source_component:"DevLogger"},{id:10,timestamp:new Date(Date.now()-18e3),level:"SUCCESS",source:"backend",message:"Session cleanup completed",service:"session-service",origin:"server",source_component:"SessionManager"},{id:11,timestamp:new Date(Date.now()-2e4),level:"DEBUG",source:"frontend",message:"Network request initiated",service:"api-client",origin:"browser",source_component:"HttpClient"},{id:12,timestamp:new Date(Date.now()-22e3),level:"INFO",source:"backend",message:"Health check passed",service:"monitoring",origin:"server",source_component:"HealthMonitor"}];m(h)}});if(t(),g){const u=setInterval(t,2e3);return()=>clearInterval(u)}},[g]);const w=e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})});return e.jsx(A,{title:"Real-Time Logs",titleColor:o?"text-green-400":"text-green-600",icon:w,badge:{text:`${p().length} logs`,color:o?"bg-green-500/20 text-green-400 border-green-500/30":"bg-green-100 text-green-700 border-green-300"},isDarkMode:o,children:e.jsxs("div",{className:"h-full flex flex-col",children:[e.jsx("div",{className:`p-4 border-b ${o?"border-gray-700 bg-gray-800/30":"border-gray-300 bg-gray-50"}`,children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("label",{className:"flex items-center space-x-2 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:n,onChange:t=>d(t.target.checked),className:`rounded text-green-500 focus:ring-green-500 ${o?"border-gray-600 bg-gray-700":"border-gray-300 bg-white"}`}),e.jsx("span",{className:`text-sm ${o?"text-gray-300":"text-gray-700"}`,children:"Auto-scroll"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("span",{className:`w-2 h-2 rounded-full ${g?"bg-green-400 animate-pulse":"bg-red-400"}`}),e.jsx("span",{className:`text-xs ${g?"text-green-400":"text-red-400"}`,children:g?"LIVE":"PAUSED"})]})]})}),e.jsx("div",{ref:f,className:`console-scroll-area flex-1 overflow-y-auto p-4 space-y-1 ${o?"":"bg-white"}`,children:p().length===0?e.jsx("div",{className:`flex items-center justify-center h-full ${o?"text-gray-400":"text-gray-500"}`,children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:`w-12 h-12 mx-auto mb-3 rounded-full flex items-center justify-center ${o?"bg-gray-700/50":"bg-gray-200"}`,children:e.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})})}),e.jsx("p",{className:`text-sm font-medium mb-1 ${o?"text-gray-300":"text-gray-700"}`,children:l.length===0?g?"Waiting for logs...":"No logs available":`No ${i==null?void 0:i.toLowerCase().replace(" only","")} logs`}),e.jsx("p",{className:`text-xs ${o?"text-gray-400":"text-gray-500"}`,children:l.length===0?g?"New entries will appear automatically":"Click refresh to load logs":"Try changing the filter or refreshing"})]})}):e.jsxs(e.Fragment,{children:[p().map(t=>e.jsx(le,{timestamp:t.timestamp,level:t.level,source:t.source,message:t.message,service:t.service,meta:t.meta,isDarkMode:o},t.id)),g&&e.jsxs("div",{className:`flex items-center space-x-2 opacity-70 ${o?"text-green-400":"text-green-600"}`,children:[e.jsx("span",{className:"text-xs font-mono",children:new Date().toLocaleTimeString("en-US",{hour12:!1})}),e.jsx("span",{className:"terminal-cursor",children:"â–Š"})]}),e.jsx("div",{ref:b})]})})]})})},ce=({level:g,source:i,message:a,icon:s,timestamp:o,onDismiss:l,onCreateGitHubIssue:m,canCreateGitHubIssue:n=!1,isDarkMode:d=!0})=>{const f=t=>t.toLocaleString("en-US",{month:"short",day:"numeric",hour:"2-digit",minute:"2-digit",second:"2-digit"}),b=t=>{if(d)switch(t){case"CRITICAL":return{container:"bg-red-950/30 border-red-600/70 border-2 animate-pulse",text:"text-red-300",badge:"bg-red-800 text-red-200 animate-pulse"};case"ERROR":return{container:"bg-red-900/20 border-red-700/50 border",text:"text-red-400",badge:"bg-red-900 text-red-400"};case"WARN":return{container:"bg-yellow-900/20 border-yellow-700/50 border",text:"text-yellow-400",badge:"bg-yellow-900 text-yellow-400"};default:return{container:"bg-gray-900/20 border-gray-700/50 border",text:"text-gray-400",badge:"bg-gray-900 text-gray-400"}}else switch(t){case"CRITICAL":return{container:"bg-red-50 border-red-400 border-2 animate-pulse",text:"text-red-700",badge:"bg-red-200 text-red-800 animate-pulse"};case"ERROR":return{container:"bg-red-50 border-red-300 border",text:"text-red-600",badge:"bg-red-100 text-red-700"};case"WARN":return{container:"bg-yellow-50 border-yellow-300 border",text:"text-yellow-600",badge:"bg-yellow-100 text-yellow-700"};default:return{container:"bg-gray-50 border-gray-300 border",text:"text-gray-600",badge:"bg-gray-100 text-gray-700"}}},p=t=>{if(d)switch(t){case"frontend":return"text-green-400";case"backend":return"text-purple-400";case"dev":return"text-orange-400";default:return"text-gray-400"}else switch(t){case"frontend":return"text-green-600";case"backend":return"text-purple-600";case"dev":return"text-orange-600";default:return"text-gray-600"}},w=b(g);return e.jsx("div",{className:`rounded-lg p-3 relative group hover:shadow-lg transition-all duration-200 ${w.container}`,children:e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx("div",{className:"text-lg flex-shrink-0",children:s}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[e.jsx("span",{className:`px-2 py-0.5 rounded text-xs font-medium ${w.badge}`,children:g}),e.jsxs("span",{className:`text-xs font-mono ${p(i)}`,children:["[",i,"]"]}),e.jsx("span",{className:"text-xs text-gray-400",children:f(o)})]}),e.jsx("div",{className:`font-medium text-sm ${w.text}`,children:a})]}),e.jsxs("div",{className:"flex items-center space-x-1",children:[n&&m&&e.jsx("button",{onClick:m,className:"opacity-0 group-hover:opacity-100 transition-opacity text-orange-400 hover:text-orange-300 p-1 rounded",title:"Create GitHub Issue",children:e.jsx("svg",{className:"w-4 h-4",fill:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{fillRule:"evenodd",d:"M12 2C6.477 2 2 6.484 2 12.017c0 4.425 2.865 8.18 6.839 9.504.5.092.682-.217.682-.483 0-.237-.008-.868-.013-1.703-2.782.605-3.369-1.343-3.369-1.343-.454-1.158-1.11-1.466-1.11-1.466-.908-.62.069-.608.069-.608 1.003.07 1.531 1.032 1.531 1.032.892 1.53 2.341 1.088 2.91.832.092-.647.35-1.088.636-1.338-2.22-.253-4.555-1.113-4.555-4.951 0-1.093.39-1.988 1.029-2.688-.103-.253-.446-1.272.098-2.65 0 0 .84-.27 2.75 1.026A9.564 9.564 0 0112 6.844c.85.004 1.705.115 2.504.337 1.909-1.296 2.747-1.027 2.747-1.027.546 1.379.202 2.398.1 2.651.64.7 1.028 1.595 1.028 2.688 0 3.848-2.339 4.695-4.566 4.943.359.309.678.92.678 1.855 0 1.338-.012 2.419-.012 2.747 0 .268.18.58.688.482A10.019 10.019 0 0022 12.017C22 6.484 17.522 2 12 2z",clipRule:"evenodd"})})}),e.jsx("button",{onClick:l,className:"opacity-0 group-hover:opacity-100 transition-opacity text-gray-400 hover:text-gray-200 p-1 rounded",title:"Dismiss alert",children:e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]})]})})},ie=({open:g,onClose:i,logEntry:a})=>{const[s,o]=x.useState(!1),[l,m]=x.useState(null),[n,d]=x.useState(null),[f,b]=x.useState(""),[p,w]=x.useState(""),t=()=>$(void 0,null,function*(){if(a){o(!0),m(null);try{const r={error_hash:a.hash||`temp_${Date.now()}`,log_message:a.message,log_details:a.details||"",log_level:a.level,source_component:a.source_component||a.source,occurrence_count:a.occurrences||1,custom_title:f.trim(),custom_description:p.trim()},y=yield fetch("/api/errors/report-to-github",{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify(r)}),C=yield y.json();if(!y.ok)throw new Error(C.message||"Failed to create GitHub issue");d({url:C.github_url,number:C.issue_number})}catch(r){console.error("GitHub Issue Creation Error:",r),m(r.message||"Failed to create GitHub issue")}finally{o(!1)}}}),u=()=>{m(null),d(null),b(""),w(""),i()},h=r=>{switch(r){case"CRITICAL":return"error";case"ERROR":return"warning";case"WARN":return"info";default:return"default"}},c=()=>{if(f.trim())return f;if(!a)return"";const r=a.message.substring(0,60);return`[${a.level}] ${r}${a.message.length>60?"...":""}`};return e.jsxs(K,{open:g,onClose:u,maxWidth:"md",fullWidth:!0,PaperProps:{sx:{backgroundColor:"#1e293b",color:"white",border:"1px solid #475569"}},children:[e.jsxs(Q,{sx:{backgroundColor:"#0f172a",borderBottom:"1px solid #475569",display:"flex",alignItems:"center",gap:2,color:"white",fontSize:"1.25rem",fontWeight:"bold"},children:[e.jsx(G,{size:24,color:"#f59e0b"}),"Create GitHub Issue"]}),e.jsx(X,{sx:{padding:3},children:a&&e.jsxs(k,{children:[e.jsxs(k,{sx:{marginBottom:3,padding:2,backgroundColor:"#374151",borderRadius:2},children:[e.jsxs(k,{sx:{display:"flex",alignItems:"center",gap:2,marginBottom:2},children:[e.jsx(Z,{label:a.level,color:h(a.level),size:"small",sx:{fontWeight:"bold"}}),e.jsxs(O,{variant:"body2",sx:{color:"#9ca3af"},children:[a.source_component||a.source," â€¢ ",a.occurrences||1," occurrence(s)"]})]}),e.jsx(O,{variant:"h6",sx:{color:"white",marginBottom:1},children:a.message}),a.details&&e.jsx(O,{variant:"body2",sx:{color:"#d1d5db",fontFamily:"monospace"},children:a.details})]}),e.jsx(H,{fullWidth:!0,label:"Issue Title (Optional)",placeholder:c(),value:f,onChange:r=>b(r.target.value),sx:{marginBottom:2,"& .MuiOutlinedInput-root":{color:"white","& fieldset":{borderColor:"#6b7280"},"&:hover fieldset":{borderColor:"#9ca3af"},"&.Mui-focused fieldset":{borderColor:"#3b82f6"}},"& .MuiInputLabel-root":{color:"#9ca3af"}}}),e.jsx(H,{fullWidth:!0,multiline:!0,rows:3,label:"Additional Description (Optional)",placeholder:"Add any additional context or steps to reproduce...",value:p,onChange:r=>w(r.target.value),sx:{marginBottom:2,"& .MuiOutlinedInput-root":{color:"white","& fieldset":{borderColor:"#6b7280"},"&:hover fieldset":{borderColor:"#9ca3af"},"&.Mui-focused fieldset":{borderColor:"#3b82f6"}},"& .MuiInputLabel-root":{color:"#9ca3af"}}}),e.jsxs(k,{sx:{marginBottom:2,padding:2,backgroundColor:"#111827",borderRadius:2},children:[e.jsx(O,{variant:"subtitle2",sx:{color:"#f59e0b",marginBottom:1},children:"Preview Issue:"}),e.jsx(O,{variant:"body2",sx:{color:"#e5e7eb",fontWeight:"bold"},children:c()})]}),l&&e.jsx(P,{severity:"error",sx:{marginBottom:2,backgroundColor:"#7f1d1d",color:"white"},children:l}),n&&e.jsx(P,{severity:"success",sx:{marginBottom:2,backgroundColor:"#14532d",color:"white"},action:e.jsxs(_,{size:"small",href:n.url,target:"_blank",rel:"noopener noreferrer",sx:{color:"white"},children:["View Issue #",n.number]}),children:"GitHub issue created successfully!"})]})}),e.jsxs(M,{sx:{padding:3,backgroundColor:"#0f172a",borderTop:"1px solid #475569",gap:2},children:[e.jsx(_,{onClick:u,variant:"outlined",startIcon:e.jsx(ee,{size:16}),sx:{color:"white",borderColor:"#6b7280","&:hover":{borderColor:"#9ca3af",backgroundColor:"#374151"}},children:"Cancel"}),!n&&e.jsx(_,{onClick:t,disabled:s||!a,variant:"contained",startIcon:s?e.jsx(te,{size:16}):e.jsx(G,{size:16}),sx:{backgroundColor:"#f59e0b",color:"black",fontWeight:"bold","&:hover":{backgroundColor:"#d97706"},"&:disabled":{backgroundColor:"#6b7280",color:"#9ca3af"}},children:s?"Creating...":"Create GitHub Issue"})]})]})},F=({isLive:g,logFilter:i="All Logs",showInfoLogs:a=!1,isDarkMode:s=!0})=>{const[o,l]=x.useState([]),[m,n]=x.useState(!1),[d,f]=x.useState(!1),[b,p]=x.useState(null),w=()=>(console.log("CriticalConsole: Always showing all critical events (ERROR + WARN)"),console.log("Total critical events:",o.length),o),t=r=>{(r.level==="ERROR"||r.level==="CRITICAL")&&(p(r),f(!0))},u=()=>{f(!1),p(null)};x.useEffect(()=>{const r=()=>$(void 0,null,function*(){n(!0);try{const N=yield(yield fetch("/api/admin/logs/database/critical?limit=20")).json();if(N.events&&Array.isArray(N.events)&&N.events.length>0){const I=N.events.map((S,L)=>({id:S.id||L,level:S.level==="ERROR"?"ERROR":"WARN",source:S.source||"backend",message:S.message||"Critical event occurred",timestamp:new Date(S.timestamp),icon:S.level==="ERROR"?"ðŸ”´":"ðŸŸ¡",severity:S.severity||"medium"}));l(I)}else l(v())}catch(y){console.warn("Failed to fetch critical events, using mock data"),l(v())}finally{n(!1)}}),v=()=>[{id:1,level:"CRITICAL",source:"backend",message:"System memory usage exceeded 95%",timestamp:new Date,icon:"ðŸ†˜",severity:"high",details:"Memory usage: 96.2%, Swap usage: 89%, System stability compromised",hash:"critical_memory_exhaustion",occurrences:1,source_component:"SystemMonitor"},{id:2,level:"ERROR",source:"backend",message:"Database connection pool exhausted",timestamp:new Date(Date.now()-18e4),icon:"ðŸ”´",severity:"high",details:"All 50 connections in use, new requests timing out",hash:"db_connection_pool_exhausted",occurrences:3,source_component:"DatabaseManager"},{id:3,level:"WARN",source:"frontend",message:"API response time exceeded threshold",timestamp:new Date(Date.now()-3e5),icon:"ðŸŸ¡",severity:"medium",details:"Average response time: 2.8s, Threshold: 2.0s",hash:"api_response_time_slow",occurrences:12,source_component:"ApiClient"},{id:4,level:"ERROR",source:"backend",message:"Payment processing failure detected",timestamp:new Date(Date.now()-6e5),icon:"ðŸ”´",severity:"high",details:"Payment gateway returned error 500, transaction ID: txn_1234567890",hash:"payment_gateway_error",occurrences:2,source_component:"PaymentProcessor"},{id:5,level:"CRITICAL",source:"backend",message:"Security breach attempt detected",timestamp:new Date(Date.now()-9e5),icon:"ðŸ†˜",severity:"high",details:"Multiple failed authentication attempts from IP: 192.168.1.100",hash:"security_breach_attempt",occurrences:1,source_component:"SecurityMonitor"}];if(r(),g){const y=setInterval(r,3e4);return()=>clearInterval(y)}},[g]);const h=r=>{l(v=>v.filter(y=>y.id!==r))},c=e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.99-.833-2.598 0L4.732 15.5c-.77.833.192 2.5 1.732 2.5z"})});return e.jsxs(A,{title:"Critical Events",titleColor:s?"text-red-400":"text-red-600",icon:c,badge:{text:`${o.length} alerts`,color:s?"bg-red-500/20 text-red-400 border-red-500/30":"bg-red-100 text-red-700 border-red-300"},isDarkMode:s,children:[e.jsx("div",{className:`h-full overflow-y-auto console-scroll-area ${s?"":"bg-white"}`,children:m?e.jsx("div",{className:"flex items-center justify-center h-full",children:e.jsxs("div",{className:`text-center ${s?"text-gray-400":"text-gray-600"}`,children:[e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-red-500 mx-auto mb-2"}),e.jsx("div",{className:"text-sm",children:"Loading critical events..."})]})}):w().length===0?e.jsx("div",{className:"flex items-center justify-center h-full p-4",children:e.jsxs("div",{className:`text-center ${s?"text-gray-400":"text-gray-600"}`,children:[e.jsx("div",{className:"text-6xl mb-4",children:"âœ…"}),e.jsx("div",{className:`text-lg font-medium mb-2 ${s?"text-gray-300":"text-gray-700"}`,children:o.length===0?"No critical events detected":`No ${i==null?void 0:i.toLowerCase().replace(" only","")} events`}),e.jsx("div",{className:"text-sm",children:o.length===0?"System is running normally":"Try changing the filter or refreshing"}),e.jsx("div",{className:"text-xs mt-2 opacity-60",children:"Critical Console Active"})]})}):e.jsx("div",{className:"p-4 space-y-3",children:w().map(r=>e.jsx(ce,{level:r.level,source:r.source,message:r.message,icon:r.icon,timestamp:r.timestamp,onDismiss:()=>h(r.id),onCreateGitHubIssue:()=>t(r),canCreateGitHubIssue:r.level==="ERROR"||r.level==="CRITICAL",isDarkMode:s},r.id))})}),e.jsx(ie,{open:d,onClose:u,logEntry:b?{id:b.id,timestamp:b.timestamp,level:b.level,source:b.source,message:b.message,details:b.details,hash:b.hash,occurrences:b.occurrences,source_component:b.source_component}:null})]})},de=({type:g,category:i,title:a,description:s,timestamp:o,onDismiss:l,isDarkMode:m=!0})=>{const n=p=>p.toLocaleString("en-US",{month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}),d=p=>{if(m)switch(p){case"success":return{container:"bg-green-900/30 border-green-700/50",icon:"âœ…",badge:"bg-green-900 text-green-400",text:"text-green-400"};case"info":return{container:"bg-blue-900/30 border-blue-700/50",icon:"â„¹ï¸",badge:"bg-blue-900 text-blue-400",text:"text-blue-400"};case"warning":return{container:"bg-yellow-900/30 border-yellow-700/50",icon:"âš ï¸",badge:"bg-yellow-900 text-yellow-400",text:"text-yellow-400"};case"error":return{container:"bg-red-900/30 border-red-700/50",icon:"âŒ",badge:"bg-red-900 text-red-400",text:"text-red-400"};default:return{container:"bg-gray-900/30 border-gray-700/50",icon:"ðŸ“‹",badge:"bg-gray-900 text-gray-400",text:"text-gray-400"}}else switch(p){case"success":return{container:"bg-green-50 border-green-300",icon:"âœ…",badge:"bg-green-100 text-green-700",text:"text-green-600"};case"info":return{container:"bg-blue-50 border-blue-300",icon:"â„¹ï¸",badge:"bg-blue-100 text-blue-700",text:"text-blue-600"};case"warning":return{container:"bg-yellow-50 border-yellow-300",icon:"âš ï¸",badge:"bg-yellow-100 text-yellow-700",text:"text-yellow-600"};case"error":return{container:"bg-red-50 border-red-300",icon:"âŒ",badge:"bg-red-100 text-red-700",text:"text-red-600"};default:return{container:"bg-gray-50 border-gray-300",icon:"ðŸ“‹",badge:"bg-gray-100 text-gray-700",text:"text-gray-600"}}},f=p=>{switch(p){case"service":return"ðŸ”§";case"security":return"ðŸ”’";case"backup":return"ðŸ’¾";case"notification":return"ðŸ””";case"config":return"âš™ï¸";case"performance":return"ðŸ“ˆ";default:return"ðŸ“‹"}},b=d(g);return e.jsx("div",{className:`p-4 rounded-lg border transition-all duration-300 hover:shadow-lg group ${b.container}`,children:e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx("div",{className:"text-xl flex-shrink-0",children:f(i)}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("span",{className:`px-2 py-0.5 rounded text-xs font-medium border ${b.badge}`,children:g.toUpperCase()}),e.jsx("span",{className:`text-xs capitalize ${m?"text-gray-400":"text-gray-600"}`,children:i})]}),e.jsx("span",{className:`text-xs ${m?"text-gray-500":"text-gray-400"}`,children:n(o)})]}),e.jsx("div",{className:`font-medium text-sm mb-1 ${b.text}`,children:a}),e.jsx("div",{className:`text-sm leading-relaxed ${m?"text-gray-300":"text-gray-700"}`,children:s})]}),e.jsx("button",{onClick:l,className:`opacity-0 group-hover:opacity-100 transition-opacity flex-shrink-0 p-1 rounded ${m?"text-gray-400 hover:text-gray-200":"text-gray-500 hover:text-gray-700"}`,title:"Dismiss message",children:e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]})})},U=({isLive:g,logFilter:i="All Logs",showInfoLogs:a=!1,isDarkMode:s=!0})=>{const[o,l]=x.useState([]),[m,n]=x.useState(!1),d=()=>{if(console.log("SystemMessagesConsole filter:",i,"Total messages:",o.length),!i||i==="All Logs")return console.log("Showing all system messages:",o.length),o;let t;switch(i){case"Errors Only":t=[],console.log("Filtered ERROR messages: 0 (system console)");break;case"Warnings Only":t=[],console.log("Filtered WARN messages: 0 (system console)");break;case"Info Only":t=o.filter(u=>u.type==="info"),console.log("Filtered INFO messages:",t.length);break;case"Success Only":t=o.filter(u=>u.type==="success"),console.log("Filtered SUCCESS messages:",t.length);break;case"Debug Only":t=[],console.log("Filtered DEBUG messages: 0 (system console)");break;default:t=o;break}return t};x.useEffect(()=>{const t=()=>$(void 0,null,function*(){n(!0);try{const h="/api/admin/logs/database?level=INFO,SUCCESS&source=system&limit=15&sort=desc";console.log("SystemMessagesConsole: Fetching from",h);const r=yield(yield fetch(h)).json();if(console.log("SystemMessagesConsole: Received data",r),r.logs&&Array.isArray(r.logs)){const v=r.logs.map((y,C)=>{var N;return{id:y.id||C,type:((N=y.level)==null?void 0:N.toLowerCase())==="success"?"success":"info",category:y.service?f(y.service):"service",title:b(y.message),description:y.message,timestamp:new Date(y.timestamp)}});console.log("SystemMessagesConsole: Formatted messages",v),l(v)}else console.log("SystemMessagesConsole: No logs found, using mock data"),l(u())}catch(h){console.warn("SystemMessagesConsole: Failed to fetch, using mock data",h),l(u())}finally{n(!1)}}),u=()=>[{id:1,type:"success",category:"backup",title:"Database Backup Completed",description:"Daily database backup completed successfully. 2.4GB archived.",timestamp:new Date},{id:2,type:"info",category:"service",title:"Maintenance Window Started",description:"Weekly maintenance window has begun. Expected duration: 2 hours.",timestamp:new Date(Date.now()-9e5)},{id:3,type:"success",category:"security",title:"SSL Certificates Renewed",description:"All SSL certificates have been automatically renewed. Valid until 2026.",timestamp:new Date(Date.now()-18e5)},{id:4,type:"info",category:"performance",title:"Cache Optimization Complete",description:"Redis cache optimization finished. Hit rate improved to 98.7%.",timestamp:new Date(Date.now()-36e5)}];if(t(),g){const h=setInterval(t,6e4);return()=>clearInterval(h)}},[g]);const f=t=>({"backup-service":"backup","auth-service":"security",security:"security",cache:"performance",redis:"performance",scheduler:"service",maintenance:"service",notification:"notification",config:"config"})[t]||"service",b=t=>{const u=t.split(".")[0];return u.length>50?u.substring(0,47)+"...":u},p=t=>{l(u=>u.filter(h=>h.id!==t))},w=e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z"})});return e.jsx(A,{title:"System Messages",titleColor:s?"text-blue-400":"text-blue-600",icon:w,badge:{text:`${d().length} messages`,color:s?"bg-blue-500/20 text-blue-400 border-blue-500/30":"bg-blue-100 text-blue-700 border-blue-300"},isDarkMode:s,children:e.jsx("div",{className:`h-full overflow-y-auto console-scroll-area ${s?"":"bg-white"}`,children:m?e.jsx("div",{className:"flex items-center justify-center h-full",children:e.jsxs("div",{className:`text-center ${s?"text-gray-400":"text-gray-600"}`,children:[e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-500 mx-auto mb-2"}),e.jsx("div",{className:"text-sm",children:"Loading system messages..."})]})}):d().length===0?e.jsx("div",{className:"flex items-center justify-center h-full p-4",children:e.jsxs("div",{className:`text-center ${s?"text-gray-400":"text-gray-600"}`,children:[e.jsx("div",{className:"text-4xl mb-4",children:"ðŸ“­"}),e.jsx("div",{className:`text-lg font-medium mb-2 ${s?"text-gray-300":"text-gray-700"}`,children:o.length===0?"No system messages":`No ${i==null?void 0:i.toLowerCase().replace(" only","")} system messages`}),e.jsx("div",{className:"text-sm",children:o.length===0?"All systems operating normally":"Try changing the filter or refreshing"}),e.jsx("div",{className:"text-xs mt-2 opacity-60",children:"System Console Active"})]})}):e.jsx("div",{className:"p-4 space-y-3",children:d().map(t=>e.jsx(de,{type:t.type,category:t.category,title:t.title,description:t.description,timestamp:t.timestamp,onDismiss:()=>p(t.id),isDarkMode:s},t.id))})})})},ge=({level:g,source:i,description:a,firstOccurrence:s,occurrences:o,details:l,expanded:m,onToggleExpand:n,isDarkMode:d=!0})=>{const f=t=>t.toLocaleString("en-US",{month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}),b=t=>{if(d)switch(t){case"ERROR":return{badge:"text-red-400 bg-red-900/20 border-red-700/50",text:"text-red-400"};case"WARN":return{badge:"text-yellow-400 bg-yellow-900/20 border-yellow-700/50",text:"text-yellow-400"};case"INFO":return{badge:"text-blue-400 bg-blue-900/20 border-blue-700/50",text:"text-blue-400"};default:return{badge:"text-gray-400 bg-gray-900/20 border-gray-700/50",text:"text-gray-400"}}else switch(t){case"ERROR":return{badge:"text-red-600 bg-red-50 border-red-300",text:"text-red-600"};case"WARN":return{badge:"text-yellow-600 bg-yellow-50 border-yellow-300",text:"text-yellow-600"};case"INFO":return{badge:"text-blue-600 bg-blue-50 border-blue-300",text:"text-blue-600"};default:return{badge:"text-gray-600 bg-gray-50 border-gray-300",text:"text-gray-600"}}},p=t=>{if(d)switch(t){case"frontend":return"text-green-400";case"backend":return"text-purple-400";case"dev":return"text-orange-400";default:return"text-gray-400"}else switch(t){case"frontend":return"text-green-600";case"backend":return"text-purple-600";case"dev":return"text-orange-600";default:return"text-gray-600"}},w=b(g);return e.jsxs("div",{className:`rounded-lg border transition-all duration-200 hover:shadow-lg ${d?"bg-gray-900/50 border-gray-700":"bg-white border-gray-300"}`,children:[e.jsx("div",{className:`p-4 cursor-pointer transition-colors ${d?"hover:bg-gray-800/30":"hover:bg-gray-50"}`,onClick:n,children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[e.jsx("span",{className:`px-2 py-0.5 rounded text-xs font-medium border ${w.badge}`,children:g}),e.jsxs("span",{className:`text-xs font-mono ${p(i)}`,children:["[",i,"]"]}),e.jsx("span",{className:`text-xs ${d?"text-gray-400":"text-gray-500"}`,children:f(s)}),o>1&&e.jsxs("span",{className:`px-2 py-0.5 rounded text-xs font-medium ${d?"bg-orange-500/20 text-orange-400":"bg-orange-100 text-orange-700"}`,children:["Occurred ",o," times"]})]}),e.jsx("div",{className:`font-medium text-sm ${d?"text-white":"text-gray-900"}`,children:a})]}),e.jsx("div",{className:`ml-4 text-lg transition-transform duration-200 ${d?"text-gray-400":"text-gray-500"}`,style:{transform:m?"rotate(90deg)":"rotate(0deg)"},children:"â–¶"})]})}),m&&e.jsx("div",{className:`border-t p-4 ${d?"border-gray-700 bg-gray-800/30":"border-gray-300 bg-gray-50"}`,children:e.jsxs("div",{className:"space-y-3",children:[e.jsx("div",{className:`text-xs font-medium ${d?"text-gray-300":"text-gray-700"}`,children:"Additional Details:"}),l.length>0?e.jsx("div",{className:"space-y-2",children:l.map((t,u)=>e.jsx("div",{className:`text-sm p-2 rounded border-l-2 ${d?"text-gray-400 bg-gray-900/50 border-gray-600":"text-gray-600 bg-gray-100 border-gray-400"}`,children:t},u))}):e.jsx("div",{className:`text-sm italic ${d?"text-gray-500":"text-gray-400"}`,children:"No additional details available"}),e.jsxs("div",{className:`pt-2 border-t ${d?"border-gray-700/50":"border-gray-300"}`,children:[e.jsxs("div",{className:`text-xs ${d?"text-gray-400":"text-gray-500"}`,children:[e.jsx("span",{className:"font-medium",children:"First seen:"})," ",f(s)]}),e.jsxs("div",{className:`text-xs ${d?"text-gray-400":"text-gray-500"}`,children:[e.jsx("span",{className:"font-medium",children:"Total occurrences:"})," ",o]})]})]})})]})},B=({logFilter:g="All Logs",showInfoLogs:i=!1,isDarkMode:a=!0})=>{const[s,o]=x.useState([]),[l,m]=x.useState(!1),[n,d]=x.useState("today"),[f,b]=x.useState(new Set),p=()=>{if(console.log("DateLogsConsole filter:",g,"Total logs:",s.length),!g||g==="All Logs")return console.log("Showing all historical logs:",s.length),s;let c;switch(g){case"Errors Only":c=s.filter(r=>r.level==="ERROR"),console.log("Filtered historical ERROR logs:",c.length);break;case"Warnings Only":c=s.filter(r=>r.level==="WARN"),console.log("Filtered historical WARN logs:",c.length);break;case"Info Only":c=s.filter(r=>r.level==="INFO"),console.log("Filtered historical INFO logs:",c.length);break;case"Success Only":c=s.filter(r=>r.level==="SUCCESS"),console.log("Filtered historical SUCCESS logs:",c.length);break;case"Debug Only":c=s.filter(r=>r.level==="DEBUG"),console.log("Filtered historical DEBUG logs:",c.length);break;default:c=s;break}return c},w=c=>{const r=new Date,v=new Date(r.getFullYear(),r.getMonth(),r.getDate());switch(c){case"yesterday":return{start:new Date(v.getTime()-864e5),end:v};case"today":return{start:v,end:new Date(v.getTime()+24*60*60*1e3)};case"24h":return{start:new Date(r.getTime()-24*60*60*1e3),end:r};case"week":return{start:new Date(r.getTime()-7*24*60*60*1e3),end:r};case"month":return{start:new Date(r.getTime()-30*24*60*60*1e3),end:r};default:return{start:y,end:v}}};x.useEffect(()=>{const c=()=>$(void 0,null,function*(){m(!0);try{const{start:v,end:y}=w(n),C=v.toISOString(),N=y.toISOString(),I=`/api/admin/logs/database?start_date=${C}&end_date=${N}&limit=50&sort=desc&group_similar=true`,L=yield(yield fetch(I)).json();if(L.logs&&Array.isArray(L.logs)&&L.logs.length>0){const T=L.logs.map((R,E)=>({id:R.id||E,level:R.level||"INFO",source:R.source||"backend",description:R.message||"No description available",firstOccurrence:new Date(R.latest_timestamp||R.timestamp),occurrences:R.occurrence_count||1,details:R.details||[]}));o(T)}else o(r())}catch(v){console.warn("Failed to fetch historical logs, using mock data"),o(r())}finally{m(!1)}}),r=()=>[{id:1,level:"ERROR",source:"backend",description:"Database connection timeout",firstOccurrence:new Date(Date.now()-36e5),occurrences:27,details:["Connection timeout after 30 seconds","Query: SELECT * FROM users WHERE active = 1","Database host: db-primary-01.internal","Connection pool: exhausted (50/50)"]},{id:2,level:"WARN",source:"frontend",description:"API response time exceeded threshold",firstOccurrence:new Date(Date.now()-72e5),occurrences:15,details:["Response time: 2.3 seconds (threshold: 2.0s)","Endpoint: /api/users/profile","User agent: Mozilla/5.0...","Client IP: 192.168.1.100"]},{id:3,level:"INFO",source:"backend",description:"User session expired",firstOccurrence:new Date(Date.now()-108e5),occurrences:8,details:["Session ID: sess_abc123def456","User ID: 1234","Last activity: 2 hours ago","Expiry reason: inactivity timeout"]}];c()},[n]);const t=c=>{b(r=>{const v=new Set(r);return v.has(c)?v.delete(c):v.add(c),v})},u=c=>{switch(c){case"yesterday":return"Yesterday";case"today":return"Today";case"24h":return"Last 24h";case"week":return"This Week";case"month":return"This Month";default:return"Yesterday"}},h=e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"})});return e.jsx(A,{title:"Historical Logs",titleColor:a?"text-purple-400":"text-purple-600",icon:h,badge:{text:`${p().length} entries`,color:a?"bg-purple-500/20 text-purple-400 border-purple-500/30":"bg-purple-100 text-purple-700 border-purple-300"},isDarkMode:a,children:e.jsxs("div",{className:"h-full flex flex-col",children:[e.jsx("div",{className:`p-4 border-b ${a?"border-gray-700 bg-gray-800/30":"border-gray-300 bg-gray-50"}`,children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("select",{value:n,onChange:c=>d(c.target.value),className:`px-3 py-1 rounded text-sm border focus:ring-2 focus:ring-purple-500 ${a?"bg-gray-800 border-gray-600 text-white":"bg-white border-gray-300 text-gray-900"}`,children:[e.jsx("option",{value:"today",children:"Today"}),e.jsx("option",{value:"yesterday",children:"Yesterday"}),e.jsx("option",{value:"24h",children:"Last 24h"}),e.jsx("option",{value:"week",children:"This Week"}),e.jsx("option",{value:"month",children:"This Month"})]}),e.jsxs("div",{className:`text-xs ${a?"text-gray-400":"text-gray-600"}`,children:["Filter: ",u(n)]})]})}),e.jsx("div",{className:`flex-1 overflow-y-auto console-scroll-area ${a?"":"bg-white"}`,children:l?e.jsx("div",{className:"flex items-center justify-center h-full",children:e.jsxs("div",{className:`text-center ${a?"text-gray-400":"text-gray-600"}`,children:[e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-purple-500 mx-auto mb-2"}),e.jsx("div",{className:"text-sm",children:"Loading historical logs..."})]})}):p().length===0?e.jsx("div",{className:"flex items-center justify-center h-full p-4",children:e.jsxs("div",{className:`text-center ${a?"text-gray-400":"text-gray-600"}`,children:[e.jsx("div",{className:"text-4xl mb-4",children:"ðŸ“ˆ"}),e.jsx("div",{className:`text-lg font-medium mb-2 ${a?"text-gray-300":"text-gray-700"}`,children:s.length===0?"No logs found":`No ${g==null?void 0:g.toLowerCase().replace(" only","")} logs`}),e.jsx("div",{className:"text-sm",children:s.length===0?`No entries for ${u(n).toLowerCase()}`:"Try changing the filter or time period"}),e.jsx("div",{className:"text-xs mt-2 opacity-60",children:"Historical Console Active"})]})}):e.jsx("div",{className:"p-4 space-y-3",children:p().map(c=>e.jsx(ge,{level:c.level,source:c.source,description:c.description,firstOccurrence:c.firstOccurrence,occurrences:c.occurrences,details:c.details,expanded:f.has(c.id),onToggleExpand:()=>t(c.id),isDarkMode:a},c.id))})})]})})},ue=({isLive:g=!0,activeFilters:i=0,isDarkMode:a=!0})=>e.jsx("footer",{className:`border-t px-4 py-2 flex-shrink-0 ${a?"border-gray-700 bg-gray-900/50":"border-gray-300 bg-gray-50"}`,children:e.jsxs("div",{className:`flex items-center justify-between text-xs ${a?"text-gray-400":"text-gray-600"}`,children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("span",{children:["Status: ",e.jsx("span",{className:g?"text-green-400":"text-red-400",children:g?"Live":"Paused"})]}),e.jsxs("span",{children:["Active filters: ",i]})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("span",{children:"OrthodoxMetrics.com"}),e.jsx("span",{children:new Date().toLocaleTimeString()})]})]})}),pe=({autoScroll:g=!0,defaultFilter:i={},refreshInterval:a=3e4})=>{const[s,o]=x.useState(!0),[l,m]=x.useState(!1),[n,d]=x.useState(!0),[f,b]=x.useState(0),[p,w]=x.useState("All Logs"),[t,u]=x.useState("realtime"),[h,c]=x.useState(25),[r,v]=x.useState(!1),[y,C]=x.useState(!1),N=oe.useMemo(()=>se({palette:{mode:n?"dark":"light",primary:{main:n?"#3b82f6":"#2563eb"},background:{default:n?"#0f172a":"#f8fafc",paper:n?"#1e293b":"#ffffff"},text:{primary:n?"#f1f5f9":"#0f172a",secondary:n?"#94a3b8":"#64748b"}}}),[n]);x.useEffect(()=>{n?document.documentElement.classList.add("dark"):document.documentElement.classList.remove("dark")},[n]);const I=x.useCallback(()=>{o(j=>!j)},[]),S=x.useCallback(()=>{m(j=>!j),o(!!l)},[l]),L=x.useCallback(()=>{window.dispatchEvent(new CustomEvent("logsRefresh"))},[]),T=x.useCallback(j=>{d(j)},[]),R=x.useCallback(j=>{w(j);const D=(j==="All Logs"?0:1)+(y?0:1);b(D)},[y]),E=x.useCallback(j=>{C(j);const D=(p==="All Logs"?0:1)+(j?0:1);b(D)},[p]),z=x.useCallback(j=>{console.log("LoggerDashboard: Real-time log count changed to:",j),c(j)},[]),V=x.useCallback(j=>{console.log("LoggerDashboard: Debug mode toggled:",j),v(j),j?J():Y()},[]),J=()=>{console.log("ðŸŸ  Starting debug capture mode..."),sessionStorage.setItem("omaiDebugMode","true"),sessionStorage.setItem("omaiDebugStartTime",Date.now().toString()),sessionStorage.setItem("omaiDebugLogs",JSON.stringify([])),performance&&performance.mark&&performance.mark("debug-capture-start")},Y=()=>{console.log("â¹ï¸ Stopping debug capture mode..."),sessionStorage.setItem("omaiDebugMode","false");const j=JSON.parse(sessionStorage.getItem("omaiDebugLogs")||"[]");j.length>0&&console.log(`Uploading ${j.length} debug logs...`)},q=[{id:"realtime",name:"Real-Time",component:e.jsx(W,{isLive:s&&!l})},{id:"critical",name:"Critical",component:e.jsx(F,{isLive:s&&!l})},{id:"system",name:"System",component:e.jsx(U,{isLive:s&&!l})},{id:"historical",name:"Historical",component:e.jsx(B,{})}];return e.jsxs(re,{theme:N,children:[e.jsx(ae,{}),e.jsxs("div",{className:`h-screen flex flex-col logger-page-container ${n?"bg-slate-950 text-white":"bg-slate-50 text-gray-900"}`,children:[e.jsx(ne,{title:"OMAI Ultimate Logger",isLive:s,onToggleLive:I,isDarkMode:n,onToggleDarkMode:T,activeFilters:f,onPause:S,onRefresh:L,isPaused:l,logFilter:p,onLogFilterChange:R,realTimeLogCount:h,onRealTimeLogCountChange:z,debugMode:r,onDebugModeToggle:V,showInfoLogs:y,onShowInfoLogsToggle:E}),e.jsxs("main",{className:"flex-1 flex flex-col p-4 min-h-0",children:[e.jsxs("div",{className:"grid grid-cols-2 grid-rows-2 gap-4 h-full min-h-0 logger-grid",children:[e.jsx(W,{isLive:s&&!l,logFilter:p,maxLogs:h,showInfoLogs:y,isDarkMode:n}),e.jsx(F,{isLive:s&&!l,logFilter:p,showInfoLogs:y,isDarkMode:n}),e.jsx(U,{isLive:s&&!l,logFilter:p,showInfoLogs:y,isDarkMode:n}),e.jsx(B,{logFilter:p,showInfoLogs:y,isDarkMode:n})]}),e.jsxs("div",{className:"hidden flex flex-col h-full",children:[e.jsx("div",{className:"border-b border-gray-700 mb-4 flex-shrink-0",children:e.jsx("nav",{className:"flex space-x-1 overflow-x-auto",children:q.map(j=>e.jsx("button",{onClick:()=>u(j.id),className:`py-2 px-3 border-b-2 font-medium text-sm transition-colors whitespace-nowrap ${t===j.id?"border-blue-500 text-blue-400":"border-transparent text-gray-400 hover:text-gray-300 hover:border-gray-300"}`,children:j.name},j.id))})}),e.jsxs("div",{className:"flex-1 min-h-0",children:[t==="realtime"&&e.jsx(W,{isLive:s&&!l,logFilter:p,maxLogs:h,showInfoLogs:y}),t==="critical"&&e.jsx(F,{isLive:s&&!l,logFilter:p,showInfoLogs:y}),t==="system"&&e.jsx(U,{isLive:s&&!l,logFilter:p,showInfoLogs:y}),t==="historical"&&e.jsx(B,{logFilter:p,showInfoLogs:y})]})]})]}),e.jsx(ue,{isLive:s,activeFilters:f,isDarkMode:n})]})]})};export{pe as LoggerDashboard,pe as default};
//# sourceMappingURL=LoggerDashboard-o6rqUBAg.js.map
