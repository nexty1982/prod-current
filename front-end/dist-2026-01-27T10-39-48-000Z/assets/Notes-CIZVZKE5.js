var ee=Object.defineProperty,te=Object.defineProperties;var se=Object.getOwnPropertyDescriptors;var G=Object.getOwnPropertySymbols;var ae=Object.prototype.hasOwnProperty,ne=Object.prototype.propertyIsEnumerable;var R=(l,a,r)=>a in l?ee(l,a,{enumerable:!0,configurable:!0,writable:!0,value:r}):l[a]=r,D=(l,a)=>{for(var r in a||(a={}))ae.call(a,r)&&R(l,r,a[r]);if(G)for(var r of G(a))ne.call(a,r)&&R(l,r,a[r]);return l},P=(l,a)=>te(l,se(a));var f=(l,a,r)=>new Promise((j,y)=>{var m=c=>{try{w(r.next(c))}catch(x){y(x)}},C=c=>{try{w(r.throw(c))}catch(x){y(x)}},w=c=>c.done?j(c.value):Promise.resolve(c.value).then(m,C);w((r=r.apply(l,a)).next())});import{k as oe,j as e,B as v,O,d as F,S as re,T as ie,I as q,$ as le,e as M,J as ce,K as de,a0 as he,a1 as ue,a2 as pe,f as T,h as fe,a3 as ge,m as me,D as xe,Z as je}from"./index-CNFXvQ6i.js";import{r as g,b as E}from"./vendor-DgfDxsY7.js";import{B as ye}from"./Breadcrumb-COvnK_QX.js";import{P as Ce}from"./PageContainer-B0tMf9F3.js";import{S as we}from"./Scrollbar-C4qo6gH4.js";import{I as Ne}from"./IconTrash-ByQmiQ4q.js";import{u as H}from"./index-B1ndscEH.js";import{D as ve}from"./Drawer-yOvFpOCX.js";import{D as Se}from"./DialogContentText-Ce7Pzi8H.js";import{F as K}from"./Fab-CcDsHThN.js";import{I as Q}from"./IconCheck-DIkpgZMD.js";import{I as be}from"./IconMenu2-DjeYHRRp.js";import{A as Te}from"./AppCard-D14TNGMn.js";import"./Breadcrumbs-C2lu88Wm.js";import"./Link-CFOV57Jo.js";import"./Helmet-DNWYwtrp.js";import"./index-BvdvJza9.js";import"./index-BRz8C_rJ.js";import"./isSymbol-D488ncVs.js";const Z={notes:[],categories:[],loading:!0,error:null,selectedNoteId:null,filters:{category:"all",search:"",archived:!1,pinned:!1},selectNote:()=>{},addNote:()=>f(void 0,null,function*(){}),updateNote:()=>f(void 0,null,function*(){}),deleteNote:()=>f(void 0,null,function*(){}),bulkDeleteNotes:()=>f(void 0,null,function*(){}),togglePin:()=>f(void 0,null,function*(){}),toggleArchive:()=>f(void 0,null,function*(){}),setFilter:()=>{},refreshNotes:()=>f(void 0,null,function*(){}),shareNote:()=>f(void 0,null,function*(){})},W=g.createContext(Z),ke=({children:l})=>{const[a,r]=g.useState([]),[j,y]=g.useState([]),[m,C]=g.useState(!0),[w,c]=g.useState(null),[x,i]=g.useState(null),[h,S]=g.useState(Z.filters),{authenticated:N,user:I}=oe(),b=()=>f(void 0,null,function*(){if(N)try{C(!0),c(null);const t=new URLSearchParams;h.category!=="all"&&t.append("category",h.category),h.search&&t.append("search",h.search),h.archived&&t.append("archived","true"),h.pinned&&t.append("pinned","true");const s=yield fetch(`/api/notes?${t.toString()}`,{method:"GET",credentials:"include",headers:{"Content-Type":"application/json"}});if(!s.ok)throw new Error(`Failed to fetch notes: ${s.status}`);const n=yield s.json();if(n.success){const o=n.notes.map(u=>P(D({},u),{tags:Array.isArray(u.tags)?u.tags:u.tags?JSON.parse(u.tags):[],datef:u.created_at||u.updated_at}));r(o),!x&&o.length>0&&i(o[0].id)}else c(n.message||"Failed to fetch notes")}catch(t){c(t.message||"Failed to fetch notes")}finally{C(!1)}}),p=()=>f(void 0,null,function*(){if(N)try{const t=yield fetch("/api/notes/categories",{method:"GET",credentials:"include",headers:{"Content-Type":"application/json"}});if(t.ok){const s=yield t.json();s.success&&y(s.categories)}}catch(t){console.error("Error fetching categories:",t)}});g.useEffect(()=>{N?(b(),p()):(r([]),y([]),C(!1))},[N,h]);const _=t=>{i(t)},$=t=>f(void 0,null,function*(){try{const s=yield fetch("/api/notes",{method:"POST",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)});if(!s.ok)throw new Error(`Failed to create note: ${s.status}`);const n=yield s.json();if(n.success){const o=P(D({},n.note),{tags:Array.isArray(n.note.tags)?n.note.tags:n.note.tags?JSON.parse(n.note.tags):[],datef:n.note.created_at||n.note.updated_at});r(u=>[o,...u]),i(o.id)}else throw new Error(n.message||"Failed to create note")}catch(s){throw c(s.message||"Failed to create note"),s}}),k=(t,s)=>f(void 0,null,function*(){try{const n=yield fetch(`/api/notes/${t}`,{method:"PUT",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify(s)});if(!n.ok)throw new Error(`Failed to update note: ${n.status}`);const o=yield n.json();if(o.success){const u=P(D({},o.note),{tags:Array.isArray(o.note.tags)?o.note.tags:o.note.tags?JSON.parse(o.note.tags):[],datef:o.note.created_at||o.note.updated_at});r(Y=>Y.map(J=>J.id===t?u:J))}else throw new Error(o.message||"Failed to update note")}catch(n){throw c(n.message||"Failed to update note"),n}}),z=t=>f(void 0,null,function*(){try{const s=yield fetch(`/api/notes/${t}`,{method:"DELETE",credentials:"include",headers:{"Content-Type":"application/json"}});if(!s.ok)throw new Error(`Failed to delete note: ${s.status}`);const n=yield s.json();if(n.success){if(r(o=>o.filter(u=>u.id!==t)),x===t){const o=a.filter(u=>u.id!==t);i(o.length>0?o[0].id:null)}}else throw new Error(n.message||"Failed to delete note")}catch(s){throw c(s.message||"Failed to delete note"),s}}),L=t=>f(void 0,null,function*(){try{const s=yield fetch("/api/notes/bulk-delete",{method:"POST",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify({noteIds:t})});if(!s.ok)throw new Error(`Failed to delete notes: ${s.status}`);const n=yield s.json();if(n.success){if(r(o=>o.filter(u=>!t.includes(u.id))),x&&t.includes(x)){const o=a.filter(u=>!t.includes(u.id));i(o.length>0?o[0].id:null)}}else throw new Error(n.message||"Failed to delete notes")}catch(s){throw c(s.message||"Failed to delete notes"),s}}),B=t=>f(void 0,null,function*(){const s=a.find(n=>n.id===t);s&&(yield k(t,{is_pinned:!s.is_pinned}))}),d=t=>f(void 0,null,function*(){const s=a.find(n=>n.id===t);s&&(yield k(t,{is_archived:!s.is_archived}))}),A=(t,s)=>{S(n=>P(D({},n),{[t]:s}))},V=()=>f(void 0,null,function*(){yield b()}),X=(t,s,n)=>f(void 0,null,function*(){try{const o=yield fetch(`/api/notes/${t}/share`,{method:"POST",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify({shared_with_user_id:s,permission:n})});if(!o.ok)throw new Error(`Failed to share note: ${o.status}`);const u=yield o.json();if(u.success)yield b();else throw new Error(u.message||"Failed to share note")}catch(o){throw c(o.message||"Failed to share note"),o}});return e.jsx(W.Provider,{value:{notes:a,categories:j,loading:m,error:w,selectedNoteId:x,filters:h,selectNote:_,addNote:$,updateNote:k,deleteNote:z,bulkDeleteNotes:L,togglePin:B,toggleArchive:d,setFilter:A,refreshNotes:V,shareNote:X},children:l})},Ee=()=>{const{notes:l,selectNote:a,deleteNote:r}=g.useContext(W),[j,y]=g.useState(""),[m,C]=g.useState(null);g.useEffect(()=>{if(l.length>0){const i=l[0].id;C(i)}},[l]);const c=((i,h)=>h!==""?i.filter(S=>!S.deleted&&S.title.toLocaleLowerCase().concat(" ").includes(h.toLocaleLowerCase())):i.filter(S=>!S.deleted))(l,j),x=i=>{C(i),a(i)};return e.jsxs(e.Fragment,{children:[e.jsxs(v,{p:3,px:2,children:[e.jsx(O,{id:"search",value:j,placeholder:"Search Notes",inputProps:{"aria-label":"Search Notes"},size:"small",type:"search",variant:"outlined",fullWidth:!0,onChange:i=>y(i.target.value)}),e.jsx(F,{variant:"h6",mb:0,mt:4,pl:1,children:"All Notes"})]}),e.jsx(v,{children:e.jsx(we,{sx:{height:{lg:"calc(100vh - 300px)",sm:"100vh"},maxHeight:"700px"},children:c&&c.length?c.map(i=>e.jsx(v,{px:2,children:e.jsxs(v,{p:2,sx:{position:"relative",cursor:"pointer",mb:1,transition:"0.1s ease-in",transform:m===i.id?"scale(1)":"scale(0.95)",backgroundColor:`${i.color}.light`},onClick:()=>x(i.id),children:[e.jsx(F,{variant:"h6",noWrap:!0,color:i.color+".main",children:i.title}),e.jsxs(re,{direction:"row",justifyContent:"space-between",alignItems:"center",children:[e.jsx(F,{variant:"caption",children:(()=>{try{const h=new Date(i.datef);return isNaN(h.getTime())?"Invalid Date":h.toLocaleDateString()}catch(h){return"Invalid Date"}})()}),e.jsx(ie,{title:"Delete",children:e.jsx(q,{"aria-label":"delete",size:"small",onClick:h=>{h.stopPropagation(),r(i.id)},children:e.jsx(Ne,{width:18})})})]})]})},i.id)):e.jsx(v,{m:2,children:e.jsx(le,{severity:"error",variant:"filled",sx:{color:"white"},children:"No Notes Found!"})})})})]})},Fe=260,U=({isMobileSidebarOpen:l,onSidebarClose:a})=>{const r=H(j=>j.breakpoints.up("lg"));return e.jsx(ve,{sx:{width:Fe,flexShrink:0,zIndex:r?0:1,"& .MuiDrawer-paper":{position:"relative"}},open:l,onClose:a,variant:r?"persistent":"temporary",children:e.jsx(Ee,{})})},Ie=({colors:l})=>{const{addNote:a,categories:r}=g.useContext(W),[j,y]=E.useState(!1),[m,C]=E.useState("#ffffff"),[w,c]=E.useState(""),[x,i]=E.useState(""),[h,S]=E.useState("General"),[N,I]=E.useState([]),[b,p]=E.useState(""),_=d=>{C(d)},$=()=>{y(!0)},k=()=>{y(!1),c(""),i(""),S("General"),I([]),p(""),C("#ffffff")},z=()=>{b.trim()&&!N.includes(b.trim())&&(I([...N,b.trim()]),p(""))},L=d=>{I(N.filter(A=>A!==d))},B=()=>f(void 0,null,function*(){try{yield a({title:w,content:x,category:h,tags:N,color:m,is_pinned:!1,is_archived:!1}),k()}catch(d){console.error("Error adding note:",d)}});return e.jsxs(e.Fragment,{children:[e.jsx(M,{variant:"contained",disableElevation:!0,color:"primary",onClick:$,children:"Add Note"}),e.jsxs(ce,{open:j,onClose:k,children:[e.jsxs(de,{children:[e.jsx(F,{variant:"h5",mb:2,fontWeight:700,children:"Add New Note"}),e.jsx(Se,{children:"Create a new note with title, content, category, and tags."}),e.jsx(O,{value:w,onChange:d=>c(d.target.value),margin:"normal",id:"title",label:"Note Title",type:"text",fullWidth:!0,size:"small",variant:"outlined",required:!0}),e.jsx(O,{multiline:!0,rows:5,value:x,onChange:d=>i(d.target.value),margin:"normal",id:"content",label:"Note Content",type:"text",fullWidth:!0,size:"small",variant:"outlined",required:!0}),e.jsxs(he,{fullWidth:!0,margin:"normal",size:"small",children:[e.jsx(ue,{id:"category-label",children:"Category"}),e.jsxs(pe,{labelId:"category-label",id:"category",value:h,label:"Category",onChange:d=>S(d.target.value),children:[e.jsx(T,{value:"General",children:"General"}),e.jsx(T,{value:"Meeting",children:"Meeting"}),e.jsx(T,{value:"Church",children:"Church"}),e.jsx(T,{value:"Personal",children:"Personal"}),e.jsx(T,{value:"Important",children:"Important"}),e.jsx(T,{value:"Ideas",children:"Ideas"}),e.jsx(T,{value:"Tasks",children:"Tasks"}),e.jsx(T,{value:"Scripture",children:"Scripture"})]})]}),e.jsxs(v,{sx:{mt:2},children:[e.jsx(O,{value:b,onChange:d=>p(d.target.value),label:"Add Tags",size:"small",variant:"outlined",fullWidth:!0,onKeyPress:d=>{d.key==="Enter"&&(d.preventDefault(),z())},helperText:"Press Enter to add a tag"}),e.jsx(v,{sx:{mt:1,display:"flex",flexWrap:"wrap",gap:1},children:N.map((d,A)=>e.jsx(fe,{label:d,onDelete:()=>L(d),size:"small",color:"primary",variant:"outlined"},A))})]}),e.jsx(F,{variant:"h6",my:2,children:"Choose Color"}),l.map(d=>e.jsx(K,{sx:{marginRight:"3px",transition:"0.1s ease-in",scale:m===d.lineColor?"0.9":"0.7",backgroundColor:d.lineColor},size:"small",onClick:()=>_(d.lineColor),children:m===d.lineColor?e.jsx(Q,{style:{color:"white"}}):""},d.id))]}),e.jsxs(ge,{children:[e.jsx(M,{onClick:k,children:"Cancel"}),e.jsx(M,{disabled:w===""||x==="",onClick:B,variant:"contained",children:"Add Note"})]})]})]})},Ae=({toggleNoteSidebar:l})=>{const a=me(),{notes:r,updateNote:j,selectedNoteId:y}=g.useContext(W),m=r.find(p=>p.id===y),[C,w]=g.useState(""),[c,x]=g.useState(""),[i,h]=g.useState(!1);g.useEffect(()=>{m&&(w(m.title),x(m.title))},[m]);const S=p=>{x(p.target.value),h(!0)},N=p=>{j(y,i?c:C,p),console.log(p)},I=()=>{h(!1),j(y,c,m.color)},b=[{id:1,lineColor:a.palette.warning.main,disp:"warning"},{id:2,lineColor:a.palette.info.main,disp:"info"},{id:3,lineColor:a.palette.error.main,disp:"error"},{id:4,lineColor:a.palette.success.main,disp:"success"},{id:5,lineColor:a.palette.primary.main,disp:"primary"}];return e.jsxs(v,{sx:{height:{lg:"calc(100vh - 250px)",sm:"100vh"},maxHeight:"700px"},children:[e.jsxs(v,{display:"flex",alignItems:"center",justifyContent:"space-between",p:2,children:[e.jsx(q,{onClick:l,children:e.jsx(be,{stroke:1.5})}),e.jsx(Ie,{colors:b})]}),e.jsx(xe,{}),m?e.jsxs(v,{p:3,children:[e.jsx(je,{htmlFor:"outlined-multiline-static",children:e.jsx(F,{variant:"h6",mb:2,fontWeight:600,color:"text.primary",children:"Edit Note"})}),e.jsx(O,{id:"outlined-multiline-static",placeholder:"Edit Note",multiline:!0,fullWidth:!0,rows:5,variant:"outlined",value:i?c:C,onChange:S,onBlur:I}),e.jsx("br",{}),e.jsx(F,{variant:"h6",mt:3,mb:2,fontWeight:600,children:"Change Note Color"}),b.map(p=>e.jsx(K,{sx:{marginRight:"3px",boxShadow:"none",transition:"0.1s ease-in",scale:m.color===p.disp?"0.9":"0.7"},size:"small",color:p==null?void 0:p.disp,onClick:()=>N(p.disp),children:m.color===p.disp?e.jsx(Q,{width:"16"}):""},p.id))]}):e.jsx(v,{sx:{textAlign:"center",fontSize:"24px",mt:2},children:"Select a Note"})]})},De=[{to:"/",title:"Home"},{title:"Notes"}],Ye=()=>{const[l,a]=g.useState(!0),r=H(j=>j.breakpoints.down("lg"));return e.jsx(ke,{children:e.jsxs(Ce,{title:"Note App",description:"this is Note App",children:[e.jsx(ye,{title:"Note app",items:De}),e.jsxs(Te,{children:[r?e.jsx(U,{isMobileSidebarOpen:l,onSidebarClose:()=>a(!1)}):e.jsx(U,{isMobileSidebarOpen:!0,onSidebarClose:()=>a(!1)}),e.jsx(v,{flexGrow:1,children:e.jsx(Ae,{toggleNoteSidebar:()=>a(!l)})})]})]})})};export{Ye as default};
//# sourceMappingURL=Notes-CIZVZKE5.js.map
