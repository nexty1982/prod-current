var y=(A,j,t)=>new Promise((p,a)=>{var d=r=>{try{c(t.next(r))}catch(n){a(n)}},h=r=>{try{c(t.throw(r))}catch(n){a(n)}},c=r=>r.done?p(r.value):Promise.resolve(r.value).then(d,h);c((t=t.apply(A,j)).next())});import{k as B,l as R,j as e,$ as b,B as m,C as S,d as l,e as _,aI as k,U as z,Q as N,R as P,h as I,T as w,I as E}from"./index-CNFXvQ6i.js";import{r as u}from"./vendor-DgfDxsY7.js";import{P as x}from"./PageContainer-jzGZZ3Dt.js";import{B as C}from"./Breadcrumb-COvnK_QX.js";import{I as L}from"./IconBuilding-D1WwWfPA.js";import{T as H,a as U,b as q,c as g,d as F}from"./TableRow-AyUKSpjR.js";import{T as s}from"./TableCell-DwyxNY3j.js";import{I as $}from"./IconUsers-DP7VmWEP.js";import{I as D}from"./IconEye-D23pS7kv.js";import"./Helmet-DNWYwtrp.js";import"./index-BvdvJza9.js";import"./Breadcrumbs-C2lu88Wm.js";import"./Link-CFOV57Jo.js";const re=()=>{const{isSuperAdmin:A,hasRole:j}=B(),t=R(),[p,a]=u.useState(!0),[d,h]=u.useState(null),[c,r]=u.useState([]),n=j(["admin","super_admin"]),v=()=>y(void 0,null,function*(){try{a(!0),h(null);const i=yield fetch("/api/admin/churches",{credentials:"include"});if(!i.ok)throw new Error("Failed to fetch churches");const o=yield i.json();if(o.success)r(o.churches||[]);else throw new Error(o.message||"Failed to fetch churches")}catch(i){console.error("Error fetching churches:",i),h(i instanceof Error?i.message:"An error occurred")}finally{a(!1)}}),T=()=>{v()};if(u.useEffect(()=>{if(!n){h("Administrative privileges required"),a(!1);return}v()},[n]),!n)return e.jsx(x,{title:"Church Administration",description:"Church administration panel selection",children:e.jsx(b,{severity:"error",children:"Administrative privileges required"})});const f=[{to:"/",title:"Home"},{to:"/admin",title:"Admin"},{title:"Church Administration"}];return p?e.jsxs(x,{title:"Church Administration",description:"Church administration panel selection",children:[e.jsx(C,{title:"Church Administration",items:f}),e.jsx(m,{display:"flex",justifyContent:"center",alignItems:"center",minHeight:"200px",children:e.jsx(S,{})})]}):d?e.jsxs(x,{title:"Church Administration",description:"Church administration panel selection",children:[e.jsx(C,{title:"Church Administration",items:f}),e.jsx(b,{severity:"error",children:d})]}):e.jsxs(x,{title:"Church Administration",description:"Church administration panel selection",children:[e.jsx(C,{title:"Church Administration",items:f}),e.jsxs(m,{p:3,children:[e.jsxs(m,{display:"flex",alignItems:"center",justifyContent:"space-between",mb:3,children:[e.jsxs(m,{display:"flex",alignItems:"center",children:[e.jsx(L,{size:"24",style:{marginRight:8}}),e.jsx(l,{variant:"h4",children:"Church Administration"})]}),e.jsx(_,{variant:"outlined",startIcon:e.jsx(k,{}),onClick:T,children:"Refresh"})]}),e.jsx(z,{children:e.jsxs(N,{children:[e.jsx(l,{variant:"h6",gutterBottom:!0,children:"Select a Church to Administer"}),e.jsx(l,{variant:"body2",color:"text.secondary",sx:{mb:3},children:"Choose a church below to access its admin panel with user management, records, logs, and administrative tools."}),e.jsx(H,{component:P,elevation:0,children:e.jsxs(U,{children:[e.jsx(q,{children:e.jsxs(g,{children:[e.jsx(s,{children:"Church Name"}),e.jsx(s,{children:"Location"}),e.jsx(s,{children:"Language"}),e.jsx(s,{children:"Status"}),e.jsx(s,{children:"Admin Email"}),e.jsx(s,{children:"Actions"})]})}),e.jsxs(F,{children:[c.map(i=>{var o;return e.jsxs(g,{children:[e.jsx(s,{children:e.jsx(l,{variant:"subtitle2",fontWeight:"bold",children:i.church_name})}),e.jsx(s,{children:i.location||"Not specified"}),e.jsx(s,{children:e.jsx(I,{label:((o=i.language_preference)==null?void 0:o.toUpperCase())||"EN",size:"small",variant:"outlined"})}),e.jsx(s,{children:e.jsx(I,{label:i.is_active?"Active":"Inactive",size:"small",color:i.is_active?"success":"error"})}),e.jsx(s,{children:e.jsx(l,{variant:"body2",children:i.admin_email})}),e.jsxs(s,{children:[e.jsx(w,{title:"Open Church Admin Panel",children:e.jsx(E,{size:"small",color:"primary",onClick:()=>t(`/admin/church/${i.id}`),children:e.jsx($,{})})}),e.jsx(w,{title:"View Church Details",children:e.jsx(E,{size:"small",onClick:()=>t("/apps/church-management"),children:e.jsx(D,{})})})]})]},i.id)}),c.length===0&&e.jsx(g,{children:e.jsx(s,{colSpan:6,align:"center",children:e.jsx(l,{variant:"body2",color:"text.secondary",children:"No churches found"})})})]})]})})]})})]})]})};export{re as default};
//# sourceMappingURL=ChurchAdminList-WYSexFZo.js.map
