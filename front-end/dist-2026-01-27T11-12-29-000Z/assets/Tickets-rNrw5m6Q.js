var S=(o,c,l)=>new Promise((u,d)=>{var i=n=>{try{m(l.next(n))}catch(t){d(t)}},g=n=>{try{m(l.throw(n))}catch(t){d(t)}},m=n=>n.done?u(n.value):Promise.resolve(n.value).then(i,g);m((l=l.apply(o,c)).next())});import{j as e,m as B,B as j,O as E,d as r,S as W,h as z,T as A,I as D,G as p,s as O}from"./index-CHjTtHW2.js";import{B as F}from"./Breadcrumb-DTsvC1YP.js";import{P as M}from"./PageContainer-DmS_qDLp.js";import{r as h}from"./vendor-DgfDxsY7.js";import{g as R,d as _}from"./globalFetcher-qMb07D1K.js";import{u as G}from"./index-B5AtgTPY.js";import{T as H,a as N,b as V,c as w,d as U}from"./TableRow-BN3XqCeO.js";import{T as a}from"./TableCell-BB5sPEEy.js";import{A as $}from"./Avatar-D2sTLy3N.js";import{f as q}from"./index-B8Cm0CAq.js";import{I as J}from"./IconTrash-jBxZUPzf.js";import{P as K}from"./Pagination-BNes6xM4.js";import{C as Q}from"./ChildCard-D2FNJael.js";import"./Breadcrumbs-Cb-T7Rgi.js";import"./Link-CQ4x0WOQ.js";import"./Helmet-DNWYwtrp.js";import"./index-BvdvJza9.js";import"./typeof-QjJsDpFa.js";import"./index-B9SIr0Qh.js";import"./LastPage-31v30Pdf.js";import"./CardHeader-DyWZbi8Y.js";const b=h.createContext({}),X=({children:o})=>{const[c,l]=h.useState([]),[u,d]=h.useState(""),[i,g]=h.useState("total_tickets"),[m,n]=h.useState(!0),[t,T]=h.useState(null),{data:x,isLoading:s,error:f,mutate:y}=G("/api/data/ticket/TicketData",R);h.useEffect(()=>{x?(l(x.data),n(s)):(f&&T(f),n(s))},[x,f,s]);const L=k=>S(void 0,null,function*(){try{yield y(_("/api/data/ticket/delete",{id:k})),l(v=>v.filter(I=>I.Id!==k))}catch(v){console.error("Error deleting ticket:",v)}}),P=k=>{d(k)};return e.jsx(b.Provider,{value:{tickets:c,error:t,loading:m,deleteTicket:L,setTicketSearch:d,searchTickets:P,ticketSearch:u,filter:i,setFilter:g},children:o})},Y=()=>{const{tickets:o,deleteTicket:c,searchTickets:l,ticketSearch:u,filter:d}=h.useContext(b),i=B(),m=((t,T,x)=>{switch(T){case"total_tickets":return t.filter(s=>!s.deleted&&s.ticketTitle.toLocaleLowerCase().includes(x));case"Pending":return t.filter(s=>!s.deleted&&s.Status==="Pending"&&s.ticketTitle.toLocaleLowerCase().includes(x));case"Closed":return t.filter(s=>!s.deleted&&s.Status==="Closed"&&s.ticketTitle.toLocaleLowerCase().includes(x));case"Open":return t.filter(s=>!s.deleted&&s.Status==="Open"&&s.ticketTitle.toLocaleLowerCase().includes(x));default:throw new Error(`Unknown filter: ${T}`)}})(o,d,u.toLowerCase()),n=t=>t.Status==="Open"?i.palette.success.light:t.Status==="Closed"?i.palette.error.light:t.Status==="Pending"?i.palette.warning.light:t.Status==="Moderate"?i.palette.primary.light:"primary";return e.jsxs(j,{mt:4,children:[e.jsx(j,{sx:{maxWidth:"260px",ml:"auto"},mb:3,children:e.jsx(E,{size:"small",label:"Search",fullWidth:!0,onChange:t=>l(t.target.value)})}),e.jsx(H,{children:e.jsxs(N,{children:[e.jsx(V,{children:e.jsxs(w,{children:[e.jsx(a,{children:e.jsx(r,{variant:"h6",children:"Id"})}),e.jsx(a,{children:e.jsx(r,{variant:"h6",children:"Ticket"})}),e.jsx(a,{children:e.jsx(r,{variant:"h6",children:"Assigned To"})}),e.jsx(a,{children:e.jsx(r,{variant:"h6",children:"Status"})}),e.jsx(a,{children:e.jsx(r,{variant:"h6",children:"Date"})}),e.jsx(a,{align:"right",children:e.jsx(r,{variant:"h6",children:"Action"})})]})}),e.jsx(U,{children:m.map(t=>e.jsxs(w,{hover:!0,children:[e.jsx(a,{children:t.Id}),e.jsx(a,{children:e.jsxs(j,{children:[e.jsx(r,{variant:"h6",fontWeight:600,noWrap:!0,children:t.ticketTitle}),e.jsx(r,{color:"textSecondary",noWrap:!0,sx:{maxWidth:"250px"},variant:"subtitle2",fontWeight:400,children:t.ticketDescription})]})}),e.jsx(a,{children:e.jsxs(W,{direction:"row",gap:"10px",alignItems:"center",children:[e.jsx($,{src:t.thumb,alt:t.thumb,sx:{borderRadius:"100%",width:"35"}}),e.jsx(r,{variant:"h6",children:t.AgentName})]})}),e.jsx(a,{children:e.jsx(z,{sx:{backgroundColor:n(t)},size:"small",label:t.Status})}),e.jsx(a,{children:e.jsx(r,{variant:"subtitle1",children:q(new Date(t.Date),"E, MMM d")})}),e.jsx(a,{align:"right",children:e.jsx(A,{title:"Delete Ticket",children:e.jsx(D,{onClick:()=>c(t.Id),children:e.jsx(J,{size:"18"})})})})]},t.Id))})]})}),e.jsx(j,{my:3,display:"flex",justifyContent:"center",children:e.jsx(K,{count:10,color:"primary"})})]})},C=O(j)(()=>({padding:"30px",transition:"0.1s ease-in",cursor:"pointer",color:"inherit","&:hover":{transform:"scale(1.03)"}})),Z=()=>{const{tickets:o,setFilter:c}=h.useContext(b),l=o.filter(i=>i.Status==="Pending").length,u=o.filter(i=>i.Status==="Open").length,d=o.filter(i=>i.Status==="Closed").length;return e.jsxs(p,{container:!0,spacing:3,textAlign:"center",children:[e.jsx(p,{size:{lg:3,sm:6,xs:12},children:e.jsxs(C,{onClick:()=>c("total_tickets"),sx:{backgroundColor:"primary.light",color:"primary.main"},children:[e.jsx(r,{variant:"h3",children:o.length}),e.jsx(r,{variant:"h6",children:"Total Tickets"})]})}),e.jsx(p,{size:{lg:3,sm:6,xs:12},children:e.jsxs(C,{onClick:()=>c("Pending"),sx:{backgroundColor:"warning.light",color:"warning.main"},children:[e.jsx(r,{variant:"h3",children:l}),e.jsx(r,{variant:"h6",children:"Pending Tickets"})]})}),e.jsx(p,{size:{lg:3,sm:6,xs:12},children:e.jsxs(C,{onClick:()=>c("Open"),sx:{backgroundColor:"success.light",color:"success.main"},children:[e.jsx(r,{variant:"h3",children:u}),e.jsx(r,{variant:"h6",children:"Open Tickets"})]})}),e.jsx(p,{size:{lg:3,sm:6,xs:12},children:e.jsxs(C,{onClick:()=>c("Closed"),sx:{backgroundColor:"error.light",color:"error.main"},children:[e.jsx(r,{variant:"h3",children:d}),e.jsx(r,{variant:"h6",children:"Closed Tickets"})]})})]})},ee=[{to:"/",title:"Home"},{title:"Tickets"}],Se=()=>e.jsx(X,{children:e.jsxs(M,{title:"Tickets App",description:"this is Note page",children:[e.jsx(F,{title:"Tickets app",items:ee}),e.jsxs(Q,{children:[e.jsx(Z,{}),e.jsx(Y,{})]})]})});export{Se as default};
//# sourceMappingURL=Tickets-rNrw5m6Q.js.map
