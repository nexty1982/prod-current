var R=(o,r,a)=>new Promise((x,h)=>{var u=s=>{try{g(a.next(s))}catch(f){h(f)}},t=s=>{try{g(a.throw(s))}catch(f){h(f)}},g=s=>s.done?x(s.value):Promise.resolve(s.value).then(u,t);g((a=a.apply(o,r)).next())});import{aK as S,l as T,j as e,B as i,C as D,d as n,R as B,I as k,b8 as $,$ as v,e as w,aH as L,dg as H,T as z}from"./index-CHjTtHW2.js";import{r as p,b as F}from"./vendor-DgfDxsY7.js";import{B as N}from"./Breadcrumbs-Cb-T7Rgi.js";import{L as P}from"./Link-CQ4x0WOQ.js";class U extends F.Component{constructor(r){super(r),this.state={hasError:!1}}static getDerivedStateFromError(r){return{hasError:!0,error:r}}componentDidCatch(r,a){console.error(`Error in Big Book component "${this.props.componentName}":`,r,a)}render(){var r;return this.state.hasError?e.jsxs(v,{severity:"error",sx:{m:2},children:[e.jsxs(n,{variant:"subtitle2",gutterBottom:!0,children:["Component Error: ",this.props.componentName]}),e.jsx(n,{variant:"body2",children:((r=this.state.error)==null?void 0:r.message)||"Unknown error occurred while rendering component"}),e.jsx(w,{variant:"outlined",onClick:()=>window.location.reload(),sx:{mt:1},children:"Reload Page"})]}):this.props.children}}const G=()=>{const{componentId:o}=S(),r=T(),[a,x]=p.useState(!0),[h,u]=p.useState(null),[t,g]=p.useState(null),[s,f]=p.useState(null);p.useEffect(()=>{o?E(o):(u("No component ID provided"),x(!1))},[o]);const E=l=>R(void 0,null,function*(){x(!0),u(null);try{console.log(`ðŸ” Loading Big Book component: ${l}`);const d=yield fetch("/api/bigbook/custom-components-registry",{credentials:"include"});if(!d.ok)throw new Error(`Failed to load registry: HTTP ${d.status}`);const y=yield d.json();console.log("ðŸ“‹ Registry loaded:",y);const c=y.components[l];if(!c)throw new Error(`Component "${l}" not found in registry`);console.log("âœ… Component found:",c),g(c);try{const m=c.path.replace("src/","../");console.log(`ðŸ“¦ Importing component from: ${m}`);const I=yield import(m);let C;if(c.isDefaultExport?C=I.default:C=I[c.name],!C)throw new Error(`Component "${c.name}" not found in module`);console.log("ðŸŽ‰ Component imported successfully"),f(()=>C)}catch(m){throw console.error("âŒ Component import failed:",m),new Error(`Failed to load component: ${m instanceof Error?m.message:"Import failed"}`)}}catch(d){const y=d instanceof Error?d.message:"Unknown error occurred";console.error("âŒ Big Book component loading failed:",y),u(y)}finally{x(!1)}}),j=()=>{r("/admin/settings")},b=()=>{o&&E(o)};return a?e.jsxs(i,{sx:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",minHeight:"60vh",gap:2},children:[e.jsx(D,{size:48}),e.jsx(n,{variant:"h6",color:"text.secondary",children:"Loading Big Book Component..."}),e.jsx(n,{variant:"body2",color:"text.secondary",children:o})]}):h?e.jsx(i,{sx:{p:3},children:e.jsxs(B,{sx:{p:3},children:[e.jsxs(i,{display:"flex",alignItems:"center",gap:1,mb:2,children:[e.jsx(k,{onClick:j,size:"small",children:e.jsx($,{})}),e.jsxs(N,{children:[e.jsx(P,{color:"inherit",href:"#",onClick:l=>{l.preventDefault(),j()},sx:{cursor:"pointer"},children:"Big Book"}),e.jsx(n,{color:"text.primary",children:"Error"})]})]}),e.jsxs(v,{severity:"error",children:[e.jsx(n,{variant:"subtitle2",gutterBottom:!0,children:"Failed to Load Component"}),e.jsx(n,{variant:"body2",gutterBottom:!0,children:h}),e.jsxs(i,{sx:{mt:2,display:"flex",gap:1},children:[e.jsx(w,{variant:"outlined",onClick:b,startIcon:e.jsx(L,{}),children:"Retry"}),e.jsx(w,{variant:"outlined",onClick:j,startIcon:e.jsx(H,{}),children:"Back to Big Book"})]})]})]})}):e.jsxs(i,{sx:{height:"100vh",display:"flex",flexDirection:"column"},children:[e.jsxs(B,{sx:{p:2,mb:2},children:[e.jsxs(i,{display:"flex",alignItems:"center",justifyContent:"space-between",children:[e.jsxs(i,{display:"flex",alignItems:"center",gap:1,children:[e.jsx(k,{onClick:j,size:"small",children:e.jsx($,{})}),e.jsxs(N,{children:[e.jsx(P,{color:"inherit",href:"#",onClick:l=>{l.preventDefault(),j()},sx:{cursor:"pointer"},children:"Big Book"}),e.jsx(n,{color:"text.primary",children:"Custom Components"}),e.jsx(n,{color:"text.primary",fontWeight:600,children:(t==null?void 0:t.displayName)||o})]})]}),e.jsx(i,{display:"flex",alignItems:"center",gap:1,children:e.jsx(z,{title:"Refresh component",children:e.jsx(k,{onClick:b,size:"small",children:e.jsx(L,{})})})})]}),(t==null?void 0:t.description)&&e.jsx(n,{variant:"body2",color:"text.secondary",sx:{mt:1},children:t.description})]}),e.jsx(B,{sx:{flex:1,overflow:"auto"},children:e.jsx(p.Suspense,{fallback:e.jsx(i,{display:"flex",justifyContent:"center",alignItems:"center",minHeight:400,children:e.jsx(D,{})}),children:s?e.jsx(U,{componentName:(t==null?void 0:t.name)||o||"Unknown",children:e.jsx(s,{})}):e.jsx(v,{severity:"warning",sx:{m:2},children:e.jsxs(n,{variant:"body2",children:['Component "',o,'" loaded but is not renderable.']})})})})]})};export{G as default};
//# sourceMappingURL=BigBookDynamicRoute-CzI5rsS4.js.map
