var _e=Object.defineProperty,ye=Object.defineProperties;var ke=Object.getOwnPropertyDescriptors;var T=Object.getOwnPropertySymbols;var G=Object.prototype.hasOwnProperty,J=Object.prototype.propertyIsEnumerable;var V=(l,o,a)=>o in l?_e(l,o,{enumerable:!0,configurable:!0,writable:!0,value:a}):l[o]=a,m=(l,o)=>{for(var a in o||(o={}))G.call(o,a)&&V(l,a,o[a]);if(T)for(var a of T(o))J.call(o,a)&&V(l,a,o[a]);return l},p=(l,o)=>ye(l,ke(o));var K=(l,o)=>{var a={};for(var c in l)G.call(l,c)&&o.indexOf(c)<0&&(a[c]=l[c]);if(l!=null&&T)for(var c of T(l))o.indexOf(c)<0&&J.call(l,c)&&(a[c]=l[c]);return a};var y=(l,o,a)=>new Promise((c,d)=>{var h=g=>{try{S(a.next(g))}catch(A){d(A)}},n=g=>{try{S(a.throw(g))}catch(A){d(A)}},S=g=>g.done?c(g.value):Promise.resolve(g.value).then(h,n);S((a=a.apply(l,o)).next())});import{c as ce,k as Ce,l as Ie,j as e,U as ve,B as j,S as u,d as k,e as L,aI as we,I as D,y as Q,$ as Ne,p as X,h as Z,M as Se,f as ee,J as Ae,Y as ze,K as Be,F as C,r as I,D as Me,a3 as Te}from"./index-CHjTtHW2.js";import{r as f}from"./vendor-DgfDxsY7.js";import{P as Le}from"./PageContainer-CBBkI0xD.js";import{B as Re}from"./Breadcrumb-DTsvC1YP.js";import{s as N}from"./social.api-7hpoR5jH.js";import{B as Ee}from"./Badge-CkwDvTX6.js";import{I as te}from"./IconTrash-jBxZUPzf.js";import{I as se}from"./IconCheck-BL6R6MPS.js";import{T as Fe,a as R}from"./Tabs-exSKFVtY.js";import{L as De}from"./ListItem-Dfjv7Y1Q.js";import{L as ie}from"./ListItemAvatar-B8A0FhNQ.js";import{S as q}from"./Skeleton-DurLVXPa.js";import{L as ae}from"./ListItemText-DvUVlISZ.js";import{I as P}from"./IconBell-IcdHSyeF.js";import{L as qe}from"./ListItemButton-zKC6Tqi4.js";import{A as Oe}from"./Avatar-D2sTLy3N.js";import{I as Pe}from"./IconDots-DoL1dg4u.js";import{I as re}from"./IconMessage-BuJC4oVO.js";import{I as $e}from"./IconHeart-pvpWnx9H.js";import{I as oe}from"./IconUserPlus-BXY1SrmO.js";import{i as He,a as Ye}from"./index-D_ik0EIw.js";import{f as ne}from"./index-B8Cm0CAq.js";import"./Helmet-DNWYwtrp.js";import"./index-BvdvJza9.js";import"./Breadcrumbs-Cb-T7Rgi.js";import"./Link-CQ4x0WOQ.js";import"./usePreviousProps-BWumOsHT.js";import"./KeyboardArrowRight-D5zkCLUN.js";import"./listItemButtonClasses-CP5ZoM92.js";import"./index-CCbV6T5K.js";import"./index-B9SIr0Qh.js";import"./typeof-QjJsDpFa.js";/**
 * @license @tabler/icons-react v3.34.1 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ue=[["path",{d:"M9 11l3 3l8 -8",key:"svg-0"}],["path",{d:"M20 12v6a2 2 0 0 1 -2 2h-12a2 2 0 0 1 -2 -2v-12a2 2 0 0 1 2 -2h9",key:"svg-1"}]],We=ce("outline","checkbox","Checkbox",Ue);/**
 * @license @tabler/icons-react v3.34.1 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ve=[["path",{d:"M3 5m0 2a2 2 0 0 1 2 -2h14a2 2 0 0 1 2 2v10a2 2 0 0 1 -2 2h-14a2 2 0 0 1 -2 -2z",key:"svg-0"}],["path",{d:"M7 15v-6l2 2l2 -2v6",key:"svg-1"}],["path",{d:"M14 13l2 2l2 -2m-2 2v-6",key:"svg-2"}]],Ge=ce("outline","markdown","Markdown",Ve);function Je(l){const h=l,{children:o,value:a,index:c}=h,d=K(h,["children","value","index"]);return e.jsx("div",p(m({role:"tabpanel",hidden:a!==c,id:`notifications-tabpanel-${c}`,"aria-labelledby":`notifications-tab-${c}`},d),{children:a===c&&e.jsx(j,{children:o})}))}const le={friend_request:oe,friend_accepted:oe,blog_comment:re,blog_like:$e,chat_message:re,mention:Ge,system:P,default:P},O={friend_request:"primary",friend_accepted:"success",blog_comment:"info",blog_like:"error",chat_message:"info",mention:"warning",system:"default",default:"default"},zt=()=>{const{user:l}=Ce(),o=Ie(),[a,c]=f.useState(0),[d,h]=f.useState([]),[n,S]=f.useState(null),[g,A]=f.useState(!1),[b,$]=f.useState(!1),[H,v]=f.useState(null),[de,E]=f.useState(!1),[z,F]=f.useState([]),[x,B]=f.useState(null),me=[{to:"/",title:"Home"},{title:"Social"},{title:"Notifications"}];f.useEffect(()=>{Y(),he()},[a]);const Y=()=>y(void 0,null,function*(){var t,s;try{A(!0),v(null);let i={limit:"50"};a===1&&(i.is_read="false"),a===2&&(i.type="friend_request"),a===3&&(i.type="blog_comment,blog_like");const r=yield N.notifications.getAll(i);h(r.notifications||[])}catch(i){console.error("Error fetching notifications:",i),v(((s=(t=i.response)==null?void 0:t.data)==null?void 0:s.message)||"Failed to load notifications")}finally{A(!1)}}),he=()=>y(void 0,null,function*(){try{const t=yield N.notifications.getSettings();S(t.settings)}catch(t){console.error("Error fetching notification settings:",t)}}),U=t=>y(void 0,null,function*(){var s,i;try{yield N.notifications.markAsRead(t),h(r=>r.map(w=>w.id===t?p(m({},w),{is_read:!0}):w))}catch(r){console.error("Error marking as read:",r),v(((i=(s=r.response)==null?void 0:s.data)==null?void 0:i.message)||"Failed to mark as read")}}),ge=()=>y(void 0,null,function*(){var t,s;try{yield N.notifications.markAllAsRead(),h(i=>i.map(r=>p(m({},r),{is_read:!0})))}catch(i){console.error("Error marking all as read:",i),v(((s=(t=i.response)==null?void 0:t.data)==null?void 0:s.message)||"Failed to mark all as read")}}),ue=t=>y(void 0,null,function*(){var s,i;try{yield N.notifications.delete(t),h(r=>r.filter(w=>w.id!==t))}catch(r){console.error("Error deleting notification:",r),v(((i=(s=r.response)==null?void 0:s.data)==null?void 0:i.message)||"Failed to delete notification")}}),fe=()=>y(void 0,null,function*(){var t,s;try{yield Promise.all(z.map(i=>N.notifications.delete(i))),h(i=>i.filter(r=>!z.includes(r.id))),F([])}catch(i){console.error("Error deleting notifications:",i),v(((s=(t=i.response)==null?void 0:t.data)==null?void 0:s.message)||"Failed to delete notifications")}}),_=t=>y(void 0,null,function*(){var s,i;try{$(!0),yield N.notifications.updateSettings(t),S(r=>r?m(m({},r),t):null)}catch(r){console.error("Error updating settings:",r),v(((i=(s=r.response)==null?void 0:s.data)==null?void 0:i.message)||"Failed to update settings")}finally{$(!1)}}),xe=t=>{var s,i;if(t.is_read||U(t.id),t.action_url)o(t.action_url);else switch(t.type){case"friend_request":o("/social/friends",{state:{tab:1}});break;case"blog_comment":case"blog_like":(s=t.data)!=null&&s.post_id&&o(`/social/blog/post/${t.data.post_id}`);break;case"chat_message":(i=t.data)!=null&&i.conversation_id&&o("/social/chat",{state:{conversationId:t.data.conversation_id}});break}},pe=t=>{const s=le[t]||le.default;return e.jsx(s,{size:18})},je=t=>{const s=new Date(t);return He(s)?ne(s,"HH:mm"):Ye(s)?"Yesterday":ne(s,"MMM dd")},be=t=>{switch(t){case"urgent":return"error";case"high":return"warning";case"normal":return"info";case"low":return"default";default:return"default"}},W=(()=>{switch(a){case 1:return d.filter(t=>!t.is_read);case 2:return d.filter(t=>t.type==="friend_request");case 3:return d.filter(t=>["blog_comment","blog_like"].includes(t.type));default:return d}})(),M=d.filter(t=>!t.is_read).length;return e.jsxs(Le,{title:"Notifications",description:"Manage your notifications",children:[e.jsx(Re,{title:"Notifications",items:me}),e.jsxs(ve,{children:[e.jsx(j,{sx:{p:3,borderBottom:1,borderColor:"divider"},children:e.jsxs(u,{direction:"row",justifyContent:"space-between",alignItems:"center",children:[e.jsxs(k,{variant:"h5",children:["Notifications",M>0&&e.jsx(Ee,{badgeContent:M,color:"primary",sx:{ml:2}})]}),e.jsxs(u,{direction:"row",spacing:1,children:[z.length>0&&e.jsxs(L,{variant:"outlined",color:"error",size:"small",startIcon:e.jsx(te,{size:16}),onClick:fe,children:["Delete (",z.length,")"]}),M>0&&e.jsx(L,{variant:"outlined",size:"small",startIcon:e.jsx(se,{size:16}),onClick:ge,children:"Mark All Read"}),e.jsx(L,{variant:"outlined",size:"small",startIcon:e.jsx(we,{size:16}),onClick:Y,disabled:g,children:"Refresh"}),e.jsx(D,{onClick:()=>E(!0),size:"small",children:e.jsx(Q,{size:20})})]})]})}),e.jsx(j,{sx:{borderBottom:1,borderColor:"divider"},children:e.jsxs(Fe,{value:a,onChange:(t,s)=>c(s),children:[e.jsx(R,{label:`All (${d.length})`}),e.jsx(R,{label:`Unread (${M})`}),e.jsx(R,{label:"Friend Requests"}),e.jsx(R,{label:"Blog Activity"})]})}),H&&e.jsx(Ne,{severity:"error",sx:{m:2},children:H}),e.jsx(Je,{value:a,index:a,children:e.jsx(j,{children:g?e.jsx(X,{children:[...Array(5)].map((t,s)=>e.jsxs(De,{children:[e.jsx(ie,{children:e.jsx(q,{variant:"circular",width:40,height:40})}),e.jsx(ae,{primary:e.jsx(q,{variant:"text",width:"60%"}),secondary:e.jsx(q,{variant:"text",width:"80%"})})]},s))}):W.length===0?e.jsxs(j,{sx:{p:8,textAlign:"center"},children:[e.jsx(P,{size:64,color:"lightgray"}),e.jsx(k,{variant:"h6",mt:2,color:"text.secondary",children:"No notifications"}),e.jsx(k,{variant:"body2",color:"text.secondary",children:a===1?"You're all caught up!":"No notifications to show"})]}):e.jsx(X,{sx:{p:0},children:W.map(t=>e.jsxs(qe,{onClick:()=>xe(t),sx:{py:2,px:3,bgcolor:t.is_read?"transparent":"action.hover",borderLeft:4,borderColor:t.is_read?"transparent":"primary.main"},children:[e.jsx(ie,{children:e.jsxs(u,{direction:"row",spacing:1,alignItems:"center",children:[e.jsx(j,{sx:{display:"flex",alignItems:"center",justifyContent:"center",width:32,height:32,borderRadius:1,bgcolor:`${O[t.type]||"default"}.light`,color:`${O[t.type]||"default"}.main`},children:pe(t.type)}),t.sender&&e.jsx(Oe,{src:t.sender.profile_image_url,sx:{width:32,height:32},children:t.sender.first_name[0]})]})}),e.jsx(ae,{primary:e.jsxs(u,{direction:"row",justifyContent:"space-between",alignItems:"flex-start",children:[e.jsx(k,{variant:"subtitle2",fontWeight:t.is_read?"normal":"bold",children:t.title}),e.jsx(k,{variant:"caption",color:"text.secondary",children:je(t.created_at)})]}),secondary:e.jsxs(j,{children:[e.jsx(k,{variant:"body2",color:"text.secondary",sx:{mb:1},children:t.message}),e.jsxs(u,{direction:"row",spacing:1,alignItems:"center",children:[e.jsx(Z,{label:t.type.replace("_"," "),size:"small",variant:"outlined",color:O[t.type]}),t.priority!=="normal"&&e.jsx(Z,{label:t.priority,size:"small",color:be(t.priority)})]})]})}),e.jsxs(u,{direction:"row",spacing:1,alignItems:"center",children:[e.jsx(D,{size:"small",onClick:s=>{s.stopPropagation();const i=z.includes(t.id);F(i?r=>r.filter(w=>w!==t.id):r=>[...r,t.id])},color:z.includes(t.id)?"primary":"default",children:e.jsx(We,{size:16})}),e.jsx(D,{size:"small",onClick:s=>{s.stopPropagation(),B({element:s.currentTarget,notificationId:t.id})},children:e.jsx(Pe,{size:16})})]})]},t.id))})})}),e.jsxs(Se,{anchorEl:x==null?void 0:x.element,open:!!x,onClose:()=>B(null),children:[e.jsxs(ee,{onClick:()=>{if(x){const t=d.find(s=>s.id===x.notificationId);t&&!t.is_read&&U(x.notificationId)}B(null)},children:[e.jsx(se,{size:16,style:{marginRight:8}}),"Mark as Read"]}),e.jsxs(ee,{onClick:()=>{x&&ue(x.notificationId),B(null)},children:[e.jsx(te,{size:16,style:{marginRight:8}}),"Delete"]})]}),e.jsxs(Ae,{open:de,onClose:()=>E(!1),maxWidth:"sm",fullWidth:!0,children:[e.jsx(ze,{children:e.jsxs(u,{direction:"row",alignItems:"center",spacing:1,children:[e.jsx(Q,{size:24}),"Notification Settings"]})}),e.jsx(Be,{children:n&&e.jsxs(u,{spacing:3,children:[e.jsxs(j,{children:[e.jsx(k,{variant:"h6",gutterBottom:!0,children:"General"}),e.jsxs(u,{spacing:2,children:[e.jsx(C,{control:e.jsx(I,{checked:n.notifications_enabled,onChange:t=>_({notifications_enabled:t.target.checked}),disabled:b}),label:"Enable notifications"}),e.jsx(C,{control:e.jsx(I,{checked:n.email_notifications,onChange:t=>_({email_notifications:t.target.checked}),disabled:b||!n.notifications_enabled}),label:"Email notifications"}),e.jsx(C,{control:e.jsx(I,{checked:n.push_notifications,onChange:t=>_({push_notifications:t.target.checked}),disabled:b||!n.notifications_enabled}),label:"Browser notifications"})]})]}),e.jsx(Me,{}),e.jsxs(j,{children:[e.jsx(k,{variant:"h6",gutterBottom:!0,children:"Notification Types"}),e.jsxs(u,{spacing:2,children:[e.jsx(C,{control:e.jsx(I,{checked:n.custom_settings.friend_requests,onChange:t=>_({custom_settings:p(m({},n.custom_settings),{friend_requests:t.target.checked})}),disabled:b||!n.notifications_enabled}),label:"Friend requests"}),e.jsx(C,{control:e.jsx(I,{checked:n.custom_settings.blog_comments,onChange:t=>_({custom_settings:p(m({},n.custom_settings),{blog_comments:t.target.checked})}),disabled:b||!n.notifications_enabled}),label:"Blog comments"}),e.jsx(C,{control:e.jsx(I,{checked:n.custom_settings.blog_likes,onChange:t=>_({custom_settings:p(m({},n.custom_settings),{blog_likes:t.target.checked})}),disabled:b||!n.notifications_enabled}),label:"Blog reactions"}),e.jsx(C,{control:e.jsx(I,{checked:n.custom_settings.chat_messages,onChange:t=>_({custom_settings:p(m({},n.custom_settings),{chat_messages:t.target.checked})}),disabled:b||!n.notifications_enabled}),label:"Chat messages"}),e.jsx(C,{control:e.jsx(I,{checked:n.custom_settings.mentions,onChange:t=>_({custom_settings:p(m({},n.custom_settings),{mentions:t.target.checked})}),disabled:b||!n.notifications_enabled}),label:"Mentions"})]})]})]})}),e.jsx(Te,{children:e.jsx(L,{onClick:()=>E(!1),children:"Close"})})]})]})]})};export{zt as default};
//# sourceMappingURL=NotificationCenter-BoqitWyM.js.map
