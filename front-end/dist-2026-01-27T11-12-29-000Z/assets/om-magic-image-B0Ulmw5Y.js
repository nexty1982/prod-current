import{c as me,j as e,B as v,d as C,R as N,S as pe,e as z,s as fe,h as be,a0 as Q,a1 as V,a2 as Y,f as I,G as M,O as F,D as je,C as ye,$ as we,U as ve,Q as Ie}from"./index-CHjTtHW2.js";import{r as h}from"./vendor-DgfDxsY7.js";import{I as Se}from"./IconWand-BxrUvYW5.js";import{S as Ce}from"./Slider-CJJ0y_L7.js";import{L as Me}from"./ListSubheader-dLZD_tUg.js";import{I as Pe}from"./IconPhoto-BO7CJtoB.js";import{I as te}from"./IconDownload-CcXQtViJ.js";import{C as Ae}from"./CardActions-vDoMUY-n.js";/**
 * @license @tabler/icons-react v3.34.1 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */const We=[["path",{d:"M7 18a4.6 4.4 0 0 1 0 -9a5 4.5 0 0 1 11 2h1a3.5 3.5 0 0 1 0 7h-1",key:"svg-0"}],["path",{d:"M9 15l3 -3l3 3",key:"svg-1"}],["path",{d:"M12 12l0 9",key:"svg-2"}]],Re=me("outline","cloud-upload","CloudUpload",We),Ee=fe("input")({clip:"rect(0 0 0 0)",clipPath:"inset(50%)",height:1,overflow:"hidden",position:"absolute",bottom:0,left:0,whiteSpace:"nowrap",width:1}),ae=[{label:"Hero - 1920 × 1080",category:"Hero / Banner",width:1920,height:1080},{label:"Hero - 1920 × 1200",category:"Hero / Banner",width:1920,height:1200},{label:"Hero - 1600 × 900",category:"Hero / Banner",width:1600,height:900},{label:"Section - 1200 × 800",category:"Section Images",width:1200,height:800},{label:"Section - 1000 × 600",category:"Section Images",width:1e3,height:600},{label:"Thumbnail - 400 × 400",category:"Thumbnails",width:400,height:400},{label:"Thumbnail - 300 × 300",category:"Thumbnails",width:300,height:300},{label:"Icon - 128 × 128",category:"Icons",width:128,height:128},{label:"Icon - 64 × 64",category:"Icons",width:64,height:64},{label:"Avatar - 512 × 512",category:"Avatars",width:512,height:512},{label:"Avatar - 256 × 256",category:"Avatars",width:256,height:256},{label:"Avatar - 200 × 200",category:"Avatars",width:200,height:200},{label:"Avatar - 180 × 180",category:"Avatars",width:180,height:180},{label:"Avatar - 120 × 120",category:"Avatars",width:120,height:120},{label:"Facebook Profile - 170 × 170",category:"Social Media",width:170,height:170},{label:"Facebook Cover - 820 × 312",category:"Social Media",width:820,height:312},{label:"Instagram Profile - 320 × 320",category:"Social Media",width:320,height:320},{label:"Instagram Post - 1080 × 1080",category:"Social Media",width:1080,height:1080},{label:"Twitter Profile - 400 × 400",category:"Social Media",width:400,height:400},{label:"Twitter Header - 1500 × 500",category:"Social Media",width:1500,height:500},{label:"YouTube Banner - 2560 × 1440",category:"Social Media",width:2560,height:1440},{label:"YouTube Thumbnail - 1280 × 720",category:"Social Media",width:1280,height:720},{label:"App Icon - 1024 × 1024",category:"App / UI",width:1024,height:1024},{label:"UI Element - 96 × 96",category:"App / UI",width:96,height:96},{label:"UI Element - 48 × 48",category:"App / UI",width:48,height:48},{label:"Print Letter - 2550 × 3300",category:"Print",width:2550,height:3300},{label:"Business Card - 1050 × 600",category:"Print",width:1050,height:600}],Le=()=>{const[R,Z]=h.useState(null),[U,q]=h.useState(null),[T,L]=h.useState([]),[f,E]=h.useState(!1),[J,P]=h.useState(null),[H,se]=h.useState("auto"),[B,ie]=h.useState(3),[D,le]=h.useState(3),[O,oe]=h.useState(50),[A,ne]=h.useState("original"),[$,re]=h.useState(200),[G,ce]=h.useState(200),[k,he]=h.useState("maintain"),K=h.useRef(null),de=h.useRef(null),ue=t=>{var y;const a=(y=t.target.files)==null?void 0:y[0];if(!a)return;L([]),P(null),q(a);const d=URL.createObjectURL(a);Z(d)},_=h.useCallback((t,a,d)=>{const y=[],u=t.data,b=O/100*255,g=new Set,W=(i,o)=>{if(i===0||o===0||i===a-1||o===d-1)return!0;const n=(o*a+i)*4,r=u[n],m=u[n+1],j=u[n+2];u[n+3];const S=[{x:i-1,y:o},{x:i+1,y:o},{x:i,y:o-1},{x:i,y:o+1}];for(const x of S){if(x.x<0||x.x>=a||x.y<0||x.y>=d)continue;const p=(x.y*a+x.x)*4,l=u[p],c=u[p+1],w=u[p+2];if(Math.abs(r-l)+Math.abs(m-c)+Math.abs(j-w)>b)return!0}return!1},s=(i,o)=>{const n=`${i},${o}`;if(g.has(n)||W(i,o))return null;const r=[{x:i,y:o}],m=[];let j=i,S=i,x=o,p=o;for(;r.length>0;){const{x:l,y:c}=r.pop(),w=`${l},${c}`;g.has(w)||l<0||l>=a||c<0||c>=d||W(l,c)||(g.add(w),m.push({x:l,y:c}),j=Math.min(j,l),S=Math.max(S,l),x=Math.min(x,c),p=Math.max(p,c),r.push({x:l+1,y:c},{x:l-1,y:c},{x:l,y:c+1},{x:l,y:c-1}))}return m.length<100?null:{x:j,y:x,w:S-j+1,h:p-x+1}};for(let i=10;i<d-10;i+=20)for(let o=10;o<a-10;o+=20){const n=s(o,i);n&&y.push(n)}return y.length>0?y:[{x:0,y:0,w:a,h:d}]},[O]),ge=h.useCallback(()=>{if(!R||!U){P("Please upload an image first");return}E(!0),P(null);const t=new Image;t.onload=()=>{try{const a=K.current;if(!a)throw new Error("Canvas not available");const d=a.getContext("2d");if(!d)throw new Error("Could not get canvas context");a.width=t.width,a.height=t.height,d.drawImage(t,0,0);const y=[];let u=[];if(H==="grid"){const s=t.width/D,i=t.height/B;let o=1;for(let n=0;n<B;n++)for(let r=0;r<D;r++){const m=r*s,j=n*i;u.push({x:Math.floor(m),y:Math.floor(j),w:Math.floor(s),h:Math.floor(i)})}}else if(H==="detect"){const s=d.getImageData(0,0,t.width,t.height);u=_(s,t.width,t.height)}else{const s=d.getImageData(0,0,t.width,t.height),i=_(s,t.width,t.height);if(i.length>1)u=i;else{const o=t.width/3,n=t.height/3;for(let r=0;r<3;r++)for(let m=0;m<3;m++)u.push({x:Math.floor(m*o),y:Math.floor(r*n),w:Math.floor(o),h:Math.floor(n)})}}let b,g;if(A==="original")b=0,g=0;else if(A==="custom")b=$,g=G;else{const s=ae.find(i=>i.label===A);s?(b=s.width,g=s.height):(b=0,g=0)}let W=0;u.forEach((s,i)=>{const o=document.createElement("canvas");let n,r,m=0,j=0,S=s.w,x=s.h;if(b>0&&g>0)if(k==="maintain"){const l=Math.min(b/s.w,g/s.h);n=Math.round(s.w*l),r=Math.round(s.h*l)}else if(k==="crop"){n=b,r=g;const l=Math.max(b/s.w,g/s.h),c=s.w*l,w=s.h*l;m=(s.w-c/l)/2,j=(s.h-w/l)/2,S=c/l,x=w/l}else n=b,r=g;else n=s.w,r=s.h;o.width=n,o.height=r;const p=o.getContext("2d");p&&(p.imageSmoothingEnabled=!0,p.imageSmoothingQuality="high",k==="crop"&&b>0&&g>0?p.drawImage(a,s.x+m,s.y+j,S,x,0,0,n,r):p.drawImage(a,s.x,s.y,s.w,s.h,0,0,n,r),o.toBlob(l=>{if(l){const c=URL.createObjectURL(l);y.push({id:i+1,blob:l,url:c,width:n,height:r}),W++,W===u.length&&(y.sort((w,ee)=>w.id-ee.id),L(y),E(!1))}else W++,W===u.length&&E(!1)},"image/jpeg",.95))}),u.length===0&&(P("No images detected. Try adjusting the sensitivity or using grid mode."),E(!1))}catch(a){P(a instanceof Error?a.message:"An unknown error occurred"),E(!1)}},t.onerror=()=>{P("Failed to load the image"),E(!1)},t.src=R},[R,U,H,B,D,_,A,$,G,k]),X=t=>{const a=document.createElement("a");a.href=t.url,a.download=`image${t.id}.jpg`,document.body.appendChild(a),a.click(),document.body.removeChild(a)},xe=()=>{T.forEach((t,a)=>{setTimeout(()=>{X(t)},a*100)})};return e.jsxs(v,{sx:{p:3,maxWidth:"1400px",margin:"0 auto"},children:[e.jsx(C,{variant:"h4",gutterBottom:!0,sx:{mb:3,fontWeight:600},children:"OM Magic Image Splitter"}),e.jsx(C,{variant:"body1",color:"text.secondary",sx:{mb:4},children:"Upload an image file containing multiple images. The tool will automatically detect and split them into separate files."}),e.jsx(N,{elevation:2,sx:{p:3,mb:3},children:e.jsxs(pe,{spacing:3,children:[e.jsxs(v,{children:[e.jsxs(z,{component:"label",variant:"contained",startIcon:e.jsx(Re,{}),disabled:f,sx:{mb:2},children:["Upload Source Image",e.jsx(Ee,{type:"file",accept:"image/*",onChange:ue})]}),U&&e.jsx(be,{label:U.name,onDelete:()=>{Z(null),q(null),L([])},sx:{ml:2}})]}),e.jsxs(v,{children:[e.jsxs(Q,{fullWidth:!0,sx:{mb:2},children:[e.jsx(V,{children:"Split Mode"}),e.jsxs(Y,{value:H,label:"Split Mode",onChange:t=>se(t.target.value),disabled:f,children:[e.jsx(I,{value:"auto",children:e.jsxs(v,{sx:{display:"flex",alignItems:"center",gap:1},children:[e.jsx(Se,{size:18}),"Auto (Detect or Grid)"]})}),e.jsx(I,{value:"detect",children:"Detect Regions"}),e.jsx(I,{value:"grid",children:"Manual Grid"})]})]}),H==="grid"&&e.jsxs(M,{container:!0,spacing:2,sx:{mb:2},children:[e.jsx(M,{item:!0,xs:6,children:e.jsx(F,{label:"Rows",type:"number",value:B,onChange:t=>ie(parseInt(t.target.value)||1),inputProps:{min:1,max:10},fullWidth:!0,disabled:f})}),e.jsx(M,{item:!0,xs:6,children:e.jsx(F,{label:"Columns",type:"number",value:D,onChange:t=>le(parseInt(t.target.value)||1),inputProps:{min:1,max:10},fullWidth:!0,disabled:f})})]}),H==="detect"&&e.jsxs(v,{sx:{mb:2},children:[e.jsx(C,{gutterBottom:!0,children:"Edge Detection Sensitivity"}),e.jsx(Ce,{value:O,onChange:(t,a)=>oe(a),min:10,max:90,step:5,marks:!0,disabled:f})]}),e.jsx(je,{sx:{my:2}}),e.jsxs(v,{children:[e.jsx(C,{variant:"h6",gutterBottom:!0,sx:{mb:2},children:"Output Size"}),e.jsxs(Q,{fullWidth:!0,sx:{mb:2},children:[e.jsx(V,{children:"Size Preset"}),e.jsxs(Y,{value:A,label:"Size Preset",onChange:t=>ne(t.target.value),disabled:f,children:[e.jsx(I,{value:"original",children:"Original Size"}),e.jsx(I,{value:"custom",children:"Custom Size"}),Object.entries(ae.reduce((t,a)=>(t[a.category]||(t[a.category]=[]),t[a.category].push(a),t),{})).flatMap(([t,a])=>[e.jsx(Me,{sx:{fontWeight:"bold"},children:t},`category-${t}`),...a.map(d=>e.jsx(I,{value:d.label,sx:{pl:3},children:d.label},d.label))])]})]}),A==="custom"&&e.jsxs(M,{container:!0,spacing:2,sx:{mb:2},children:[e.jsx(M,{item:!0,xs:6,children:e.jsx(F,{label:"Width (px)",type:"number",value:$,onChange:t=>re(parseInt(t.target.value)||1),inputProps:{min:1},fullWidth:!0,disabled:f})}),e.jsx(M,{item:!0,xs:6,children:e.jsx(F,{label:"Height (px)",type:"number",value:G,onChange:t=>ce(parseInt(t.target.value)||1),inputProps:{min:1},fullWidth:!0,disabled:f})})]}),A!=="original"&&e.jsxs(Q,{fullWidth:!0,sx:{mb:2},children:[e.jsx(V,{children:"Aspect Ratio Mode"}),e.jsxs(Y,{value:k,label:"Aspect Ratio Mode",onChange:t=>he(t.target.value),disabled:f,children:[e.jsx(I,{value:"maintain",children:"Maintain Aspect Ratio (Fit)"}),e.jsx(I,{value:"stretch",children:"Stretch to Exact Size"}),e.jsx(I,{value:"crop",children:"Crop to Fill"})]})]})]}),e.jsx(z,{variant:"contained",color:"primary",onClick:ge,disabled:!R||f,startIcon:f?e.jsx(ye,{size:20}):e.jsx(Pe,{}),fullWidth:!0,size:"large",children:f?"Processing...":"Extract Images"})]})]})}),J&&e.jsx(we,{severity:"error",sx:{mb:3},onClose:()=>P(null),children:J}),R&&e.jsxs(N,{elevation:2,sx:{p:3,mb:3},children:[e.jsx(C,{variant:"h6",gutterBottom:!0,children:"Source Image"}),e.jsx(v,{sx:{display:"flex",justifyContent:"center",alignItems:"center",maxHeight:"400px",overflow:"auto",border:"1px solid",borderColor:"divider",borderRadius:1,p:2},children:e.jsx("img",{ref:de,src:R,alt:"Source",style:{maxWidth:"100%",maxHeight:"400px",objectFit:"contain"}})})]}),T.length>0&&e.jsxs(N,{elevation:2,sx:{p:3},children:[e.jsxs(v,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:2},children:[e.jsxs(C,{variant:"h6",children:["Extracted Images (",T.length,")"]}),e.jsx(z,{variant:"outlined",startIcon:e.jsx(te,{}),onClick:xe,children:"Download All"})]}),e.jsx(M,{container:!0,spacing:2,children:T.map(t=>e.jsx(M,{item:!0,xs:12,sm:6,md:4,lg:3,children:e.jsxs(ve,{children:[e.jsx(v,{sx:{display:"flex",justifyContent:"center",alignItems:"center",height:200,bgcolor:"grey.100",overflow:"hidden"},children:e.jsx("img",{src:t.url,alt:`Image ${t.id}`,style:{maxWidth:"100%",maxHeight:"100%",objectFit:"contain"}})}),e.jsxs(Ie,{children:[e.jsxs(C,{variant:"body2",color:"text.secondary",children:["image",t.id,".jpg"]}),e.jsxs(C,{variant:"caption",color:"text.secondary",children:[t.width," × ",t.height,"px"]})]}),e.jsx(Ae,{children:e.jsx(z,{size:"small",startIcon:e.jsx(te,{}),onClick:()=>X(t),fullWidth:!0,children:"Download"})})]})},t.id))})]}),e.jsx("canvas",{ref:K,style:{display:"none"}})]})};export{Le as default};
//# sourceMappingURL=om-magic-image-B0Ulmw5Y.js.map
