var xa=Object.defineProperty,pa=Object.defineProperties;var ga=Object.getOwnPropertyDescriptors;var Lt=Object.getOwnPropertySymbols;var Gn=Object.prototype.hasOwnProperty,Jn=Object.prototype.propertyIsEnumerable;var cn=Math.pow,ln=(s,n,r)=>n in s?xa(s,n,{enumerable:!0,configurable:!0,writable:!0,value:r}):s[n]=r,V=(s,n)=>{for(var r in n||(n={}))Gn.call(n,r)&&ln(s,r,n[r]);if(Lt)for(var r of Lt(n))Jn.call(n,r)&&ln(s,r,n[r]);return s},G=(s,n)=>pa(s,ga(n));var Qn=(s,n)=>{var r={};for(var a in s)Gn.call(s,a)&&n.indexOf(a)<0&&(r[a]=s[a]);if(s!=null&&Lt)for(var a of Lt(s))n.indexOf(a)<0&&Jn.call(s,a)&&(r[a]=s[a]);return r};var Kn=(s,n,r)=>ln(s,typeof n!="symbol"?n+"":n,r);var E=(s,n,r)=>new Promise((a,u)=>{var l=v=>{try{m(r.next(v))}catch(b){u(b)}},h=v=>{try{m(r.throw(v))}catch(b){u(b)}},m=v=>v.done?a(v.value):Promise.resolve(v.value).then(l,h);m((r=r.apply(s,n)).next())});import{c as Bs,a as ja,j as e,_ as Ss,s as We,V as re,W as _s,d as t,e as _,k as It,B as o,$ as ue,Q as de,G as M,S as Q,I as be,aH as js,i as wt,F as Be,r as Ae,a0 as hs,a1 as ps,a2 as gs,f as xe,O as Ne,D as ks,C as Oe,p as xs,h as H,T as ye,J as as,Y as os,K as is,a3 as ls,A as Cn,U as pe,aI as gn,a5 as wn,X as kr,m as fa,aV as qt,cq as Ir,y as Gt,R as De,b9 as Tr,q as ya,Z as Dr,b8 as Yn,bd as Xn,b6 as Qe,E as Ps,x as jn,z as Zn,c3 as ba,cp as va}from"./index-CHjTtHW2.js";import{r as i,b as fn}from"./vendor-DgfDxsY7.js";import{B as ut}from"./BlankCard-CTflXlGL.js";import{T as ot,a as ze,t as Ca}from"./Tabs-exSKFVtY.js";import{S as at}from"./Storage-B2F95tg6.js";import{L as Ms}from"./LinearProgress-BfBMXEDi.js";import{B as er}from"./Backup-B2GnILNY.js";import{F as Sn,C as Pr,P as kn,A as In,V as Tn,I as Dn,J as Pn,a as Mn,H as $n,b as Fn,c as wa,K as Sa,G as ka,T as Ia,d as Ft,L as Ta,S as Da,e as Pa,E as Ma,M as $a,R as Fa,f as Ra,g as sr}from"./VideoFile-Dkov79_g.js";import{F as At}from"./Folder-9yhGOxOU.js";import{I as Ut}from"./GetApp-i8UjzZre.js";import{L as Ze,a as Rn}from"./ListItem-Dfjv7Y1Q.js";import{L as es}from"./ListItemText-DvUVlISZ.js";import{D as St}from"./Delete-DeWtZK2F.js";import{I as Jt}from"./IconLayoutGrid-DHgmVv5Z.js";import{I as st}from"./IconUpload-f74VBfYQ.js";import{I as An}from"./IconDownload-CcXQtViJ.js";import{I as Qt}from"./IconPhoto-BO7CJtoB.js";import{a as Zs,c as Mt}from"./admin.api-BRdbrdSp.js";import{I as Aa}from"./IconFilter-CIk8hdWF.js";import{I as dn}from"./IconFolderPlus-C0n2Zqwc.js";import{I as tr}from"./IconFolder-VW_gRVYE.js";import{I as nr}from"./IconTrash-jBxZUPzf.js";import{I as zt}from"./IconEye-WSFv2Grr.js";import{I as za}from"./IconMoodSmile-B6TjPKDk.js";import{T as ht,a as mt,b as xt,c as vs,d as pt}from"./TableRow-BN3XqCeO.js";import{T as W}from"./TableCell-BB5sPEEy.js";import{I as Oa}from"./IconPlayerPlay-CSQd5x0V.js";import{I as Ea}from"./IconHelp-CsK1qviN.js";import{I as Ba}from"./IconCheck-BL6R6MPS.js";import{a as Ls,g as Ns,c as As,x as _a,y as rn,v as La,s as Na,i as Ua,u as Ks,d as Mr,h as Kt,j as Wa,k as jt,l as $r,m as Va,z as Ha,T as qa,b as it,B as Wt,E as zn,M as $t,F as Js,P as Ga,e as Fr,f as Ja,G as Rr,H as Ar,I as Qa,S as Ka,J as On,K as En,N as Yt,O as Bn,Q as Xt,R as _n,U as Ya,V as Xa,W as Za,X as Ot,o as Ln,Y as tt,Z as eo,_ as so,r as rr,$ as ar,n as vt,p as zr,C as to,q as no,t as Or,w as ro,D as ao,L as oo,A as io}from"./AdapterDateFns-DuWaSDz5.js";import{I as or}from"./IconPlus-BFaVkmeq.js";import{I as Vt}from"./IconClock-C0ZoUuiS.js";import{A as Hs,a as qs,b as Gs}from"./AccordionSummary-CKC2_P9a.js";import{I as Er}from"./IconChevronDown-igsdVXwZ.js";import{I as Zt}from"./IconUsers-1CvAMUmN.js";import{I as Br}from"./IconMail-mhh1urmd.js";import{B as en}from"./Badge-CkwDvTX6.js";import{u as lo}from"./index-BUiSEnyI.js";import{u as Is}from"./useThemeProps-B4gCAohh.js";import{P as x}from"./index-BvdvJza9.js";import{I as co}from"./IconSend-DeUfy-Dx.js";import{I as sn}from"./InputAdornment-DLJId_9B.js";import{S as Nn}from"./Search-ydDKI0z7.js";import{L as uo}from"./ListItemButton-zKC6Tqi4.js";import{L as Qs}from"./ListItemIcon-adOcSfm6.js";import{B as nt}from"./Psychology-CX5Zfe-a.js";import{S as gt}from"./PlayArrow-D7Jgmgc0.js";import{C as ds}from"./Code-BhdofW-m.js";import{D as Rt,T as ir}from"./TrendingUp-x5pf9ku_.js";import{D as Ct}from"./Description-v9dWFlGo.js";import{V as Os}from"./Visibility-DDtcFTOl.js";import{C as ho,S as mo}from"./Send-4Dt0terJ.js";import{D as xo}from"./Download-NoW3AJ4D.js";import{E as rt}from"./ExpandMore-D52hm1T1.js";import{U as po}from"./Palette-zFQxAIi0.js";import{C as tn}from"./CheckCircle-BCcdMYjw.js";import{S as an}from"./Security-CGvcXQrW.js";import{T as nn}from"./Terminal-CaFmAMGn.js";import{C as lr}from"./Clear-vQnoTNab.js";import{a as cr,L as go}from"./LockOpen-BJOAJARV.js";import{I as _r}from"./Info-oqKws1vt.js";import{E as Un}from"./Error-BmMkJCet.js";import{W as Lr}from"./Warning-DlHDX1cJ.js";import{C as jo}from"./Close-Dy0Ehze3.js";import{S as fo}from"./Schedule-Bw6f72xi.js";import{S as Nr}from"./Assessment-B6jUd2Bg.js";import{A as Ht}from"./Extension-C-9soigZ.js";import{S as yo,a as bo,b as vo}from"./Stepper-DFtr5qcT.js";import{B as Co}from"./Breadcrumbs-Cb-T7Rgi.js";import{L as wo}from"./Link-CQ4x0WOQ.js";import{M as yn,S as So}from"./Speed-3zA3Ju8i.js";import{F as ko}from"./FilterList-VccNiU1_.js";import{E as Io}from"./Edit-C9MNfJRw.js";import{P as Wn}from"./Pagination-BNes6xM4.js";import{S as un}from"./School-Da45FK7W.js";import{A as dr}from"./Analytics-BYcdYFYj.js";import{C as To}from"./CloudUpload-C_-A4Hmw.js";import{T as Do}from"./Assignment-DpXc3smd.js";import{B as hn}from"./Article-hZQtHgnM.js";import{I as Po}from"./IconSearch-BeE07OV0.js";import{A as Mo}from"./Avatar-D2sTLy3N.js";import{I as bn}from"./IconCpu-Dhv1VQDQ.js";import{D as $o}from"./DialogContentText-CZLqQfHW.js";import{I as Ur}from"./IconActivity-C2exbrhs.js";import{C as Fo}from"./Computer-TTYfu9gY.js";import{P as Ro}from"./PageContainer-DmS_qDLp.js";import{B as Ao}from"./Breadcrumb-DTsvC1YP.js";import{I as ur}from"./IconServer-LT5pz8rk.js";import{I as hr}from"./IconDatabase-DXxjTReF.js";import{I as zo}from"./IconBook-DtphSYBG.js";import{I as mr}from"./IconDeviceDesktop-CVzHrYnb.js";import{I as Oo}from"./IconCalendar-CJDnTql3.js";import"./KeyboardArrowRight-D5zkCLUN.js";import"./listItemButtonClasses-CP5ZoM92.js";import"./api.config-C9UNSeTF.js";import"./index-CCbV6T5K.js";import"./index-B8Cm0CAq.js";import"./typeof-QjJsDpFa.js";import"./index-B9SIr0Qh.js";import"./index-DmKFFksY.js";import"./index-B8a_guEX.js";import"./index-Bl18lNLp.js";import"./toPropertyKey-BRA8pAMC.js";import"./usePreviousProps-BWumOsHT.js";import"./LastPage-31v30Pdf.js";import"./Helmet-DNWYwtrp.js";/**
 * @license @tabler/icons-react v3.34.1 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */const Eo=[["path",{d:"M5.64 5.632a9 9 0 1 0 6.36 -2.632v7.714",key:"svg-0"}]],Bo=Bs("outline","brand-gravatar","BrandGravatar",Eo);/**
 * @license @tabler/icons-react v3.34.1 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */const _o=[["path",{d:"M12 12m-9 0a9 9 0 1 0 18 0a9 9 0 1 0 -18 0",key:"svg-0"}],["path",{d:"M9 12l2 2l4 -4",key:"svg-1"}]],xr=Bs("outline","circle-check","CircleCheck",_o);/**
 * @license @tabler/icons-react v3.34.1 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */const Lo=[["path",{d:"M12 12m-9 0a9 9 0 1 0 18 0a9 9 0 1 0 -18 0",key:"svg-0"}],["path",{d:"M10 10l4 4m0 -4l-4 4",key:"svg-1"}]],pr=Bs("outline","circle-x","CircleX",Lo);/**
 * @license @tabler/icons-react v3.34.1 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */const No=[["path",{d:"M4 6c0 1.657 3.582 3 8 3s8 -1.343 8 -3s-3.582 -3 -8 -3s-8 1.343 -8 3",key:"svg-0"}],["path",{d:"M4 6v6c0 1.657 3.582 3 8 3c1.118 0 2.183 -.086 3.15 -.241",key:"svg-1"}],["path",{d:"M20 12v-6",key:"svg-2"}],["path",{d:"M4 12v6c0 1.657 3.582 3 8 3c.157 0 .312 -.002 .466 -.005",key:"svg-3"}],["path",{d:"M16 19h6",key:"svg-4"}],["path",{d:"M19 16l3 3l-3 3",key:"svg-5"}]],gr=Bs("outline","database-export","DatabaseExport",No);/**
 * @license @tabler/icons-react v3.34.1 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */const Uo=[["path",{d:"M5 5m0 2a2 2 0 0 1 2 -2h10a2 2 0 0 1 2 2v10a2 2 0 0 1 -2 2h-10a2 2 0 0 1 -2 -2z",key:"svg-0"}]],Wo=Bs("outline","player-stop","PlayerStop",Uo);/**
 * @license @tabler/icons-react v3.34.1 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */const Vo=[["path",{d:"M19.95 11a8 8 0 1 0 -.5 4m.5 5v-5h-5",key:"svg-0"}]],Ho=Bs("outline","rotate","Rotate",Vo);/**
 * @license @tabler/icons-react v3.34.1 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */const qo=[["path",{d:"M12 12m-1 0a1 1 0 1 0 2 0a1 1 0 1 0 -2 0",key:"svg-0"}],["path",{d:"M12 12m-5 0a5 5 0 1 0 10 0a5 5 0 1 0 -10 0",key:"svg-1"}],["path",{d:"M12 12m-9 0a9 9 0 1 0 18 0a9 9 0 1 0 -18 0",key:"svg-2"}]],Go=Bs("outline","target","Target",qo);/**
 * @license @tabler/icons-react v3.34.1 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */const Jo=[["path",{d:"M20 8.04l-12.122 12.124a2.857 2.857 0 1 1 -4.041 -4.04l12.122 -12.124",key:"svg-0"}],["path",{d:"M7 13h8",key:"svg-1"}],["path",{d:"M19 15l1.5 1.6a2 2 0 1 1 -3 0l1.5 -1.6z",key:"svg-2"}],["path",{d:"M15 3l6 6",key:"svg-3"}]],jr=Bs("outline","test-pipe","TestPipe",Jo);/**
 * @license @tabler/icons-react v3.34.1 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qo=[["path",{d:"M10 5m0 2a2 2 0 0 1 2 -2h6a2 2 0 0 1 2 2v10a2 2 0 0 1 -2 2h-6a2 2 0 0 1 -2 -2z",key:"svg-0"}],["path",{d:"M7 7l0 10",key:"svg-1"}],["path",{d:"M4 8l0 8",key:"svg-2"}]],fr=Bs("outline","versions","Versions",Qo);/**
 * @license @tabler/icons-react v3.34.1 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ko=[["path",{d:"M3 12a9 9 0 1 0 18 0a9 9 0 0 0 -18 0",key:"svg-0"}],["path",{d:"M3.6 9h16.8",key:"svg-1"}],["path",{d:"M3.6 15h16.8",key:"svg-2"}],["path",{d:"M11.5 3a17 17 0 0 0 0 18",key:"svg-3"}],["path",{d:"M12.5 3a17 17 0 0 1 0 18",key:"svg-4"}]],Yo=Bs("outline","world","World",Ko),Xo=ja(e.jsx("path",{d:"M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12zm-1 4 6 6v10c0 1.1-.9 2-2 2H7.99C6.89 23 6 22.1 6 21l.01-14c0-1.1.89-2 1.99-2zm-1 7h5.5L14 6.5z"}));function Zo(s){return Ns("MuiPickersToolbarText",s)}const yr=Ls("MuiPickersToolbarText",["root","selected"]),ei=["className","selected","value"],si=s=>{const{classes:n,selected:r}=s;return As({root:["root",r&&"selected"]},Zo,n)},ti=We(t,{name:"MuiPickersToolbarText",slot:"Root",overridesResolver:(s,n)=>[n.root,{[`&.${yr.selected}`]:n.selected}]})(({theme:s})=>({transition:s.transitions.create("color"),color:(s.vars||s).palette.text.secondary,[`&.${yr.selected}`]:{color:(s.vars||s).palette.text.primary}})),Wr=i.forwardRef(function(n,r){const a=Is({props:n,name:"MuiPickersToolbarText"}),{className:u,value:l}=a,h=Ss(a,ei),m=si(a);return e.jsx(ti,re({ref:r,className:_s(u,m.root),component:"span"},h,{children:l}))}),ni=["align","className","selected","typographyClassName","value","variant","width"],ri=s=>{const{classes:n}=s;return As({root:["root"]},_a,n)},ai=We(_,{name:"MuiPickersToolbarButton",slot:"Root",overridesResolver:(s,n)=>n.root})({padding:0,minWidth:16,textTransform:"none"}),et=i.forwardRef(function(n,r){const a=Is({props:n,name:"MuiPickersToolbarButton"}),{align:u,className:l,selected:h,typographyClassName:m,value:v,variant:b,width:D}=a,S=Ss(a,ni),g=ri(a);return e.jsx(ai,re({variant:"text",ref:r,className:_s(l,g.root)},D?{sx:{width:D}}:{},S,{children:e.jsx(Wr,{align:u,className:m,variant:b,value:v,selected:h})}))}),oi=({adapter:s,value:n,props:r})=>{if(n===null)return null;const{minTime:a,maxTime:u,minutesStep:l,shouldDisableClock:h,shouldDisableTime:m,disableIgnoringDatePartForTimeValidation:v=!1,disablePast:b,disableFuture:D,timezone:S}=r,g=s.utils.dateWithTimezone(void 0,S),T=rn(v,s.utils);switch(!0){case!s.utils.isValid(n):return"invalidDate";case!!(a&&T(a,n)):return"minTime";case!!(u&&T(n,u)):return"maxTime";case!!(D&&s.utils.isAfter(n,g)):return"disableFuture";case!!(b&&s.utils.isBefore(n,g)):return"disablePast";case!!(m&&m(n,"hours")):return"shouldDisableTime-hours";case!!(m&&m(n,"minutes")):return"shouldDisableTime-minutes";case!!(m&&m(n,"seconds")):return"shouldDisableTime-seconds";case!!(h&&h(s.utils.getHours(n),"hours")):return"shouldDisableClock-hours";case!!(h&&h(s.utils.getMinutes(n),"minutes")):return"shouldDisableClock-minutes";case!!(h&&h(s.utils.getSeconds(n),"seconds")):return"shouldDisableClock-seconds";case!!(l&&s.utils.getMinutes(n)%l!==0):return"minutesStep";default:return null}},Vn=({props:s,value:n,adapter:r})=>{const a=La({adapter:r,value:n,props:s});return a!==null?a:oi({adapter:r,value:n,props:s})},ii=()=>{const{user:s}=It(),[n,r]=i.useState(0),[a,u]=i.useState({enabled:!0,schedule:"0 2 * * *",retention_days:30,include_database:!0,include_files:!0,include_uploads:!0,compression:!0,email_notifications:!1,notification_email:"",backup_location:"/opt/backups/orthodox-metrics",max_backups:50}),[l,h]=i.useState([]),[m,v]=i.useState(!1),[b,D]=i.useState(!1),[S,g]=i.useState(!1),[T,O]=i.useState(null),[p,y]=i.useState(!1),[C,j]=i.useState(null),[U,q]=i.useState({total_space:0,used_space:0,backup_space:0}),w=[{value:"0 2 * * *",label:"Daily at 2:00 AM"},{value:"0 2 * * 0",label:"Weekly (Sunday at 2:00 AM)"},{value:"0 2 1 * *",label:"Monthly (1st day at 2:00 AM)"},{value:"0 */6 * * *",label:"Every 6 hours"},{value:"0 */12 * * *",label:"Every 12 hours"},{value:"custom",label:"Custom Cron Expression"}];i.useEffect(()=>{z(),te(),I()},[]);const z=()=>E(void 0,null,function*(){try{v(!0)}catch(B){console.error("Error loading backup settings:",B)}finally{v(!1)}}),te=()=>E(void 0,null,function*(){}),I=()=>E(void 0,null,function*(){}),A=()=>E(void 0,null,function*(){try{D(!0),O({type:"success",message:"Backup settings saved successfully"})}catch(B){O({type:"error",message:B.message||"Failed to save settings"})}finally{D(!1)}}),L=B=>E(void 0,null,function*(){try{g(!0),O({type:"success",message:"Backup started successfully"})}catch(ae){O({type:"error",message:ae.message||"Failed to start backup"})}finally{g(!1)}}),X=B=>E(void 0,null,function*(){try{O({type:"info",message:"Download functionality coming soon"})}catch(ae){O({type:"error",message:ae.message||"Failed to download backup"})}}),Se=B=>E(void 0,null,function*(){try{O({type:"success",message:"Backup deleted successfully"}),y(!1),j(null)}catch(ae){console.error("Error deleting backup:",ae),O({type:"error",message:"Failed to delete backup"}),y(!1),j(null)}}),Ce=B=>{if(B===0)return"0 Bytes";const ae=1024,_e=["Bytes","KB","MB","GB"],R=Math.floor(Math.log(B)/Math.log(ae));return parseFloat((B/Math.pow(ae,R)).toFixed(2))+" "+_e[R]},le=B=>new Date(B).toLocaleString(),$=B=>{switch(B){case"full":return"primary";case"database":return"secondary";case"files":return"info";default:return"default"}},f=U.total_space>0?U.used_space/U.total_space*100:0,J=U.total_space>0?U.backup_space/U.total_space*100:0,ve=(B,ae)=>{r(ae)};return e.jsxs(o,{children:[T&&e.jsx(ue,{severity:T.type,sx:{mb:2},onClose:()=>O(null),children:T.message}),e.jsx(ut,{children:e.jsxs(de,{children:[e.jsxs(ot,{value:n,onChange:ve,sx:{mb:3},children:[e.jsx(ze,{label:"Backup Settings"}),e.jsx(ze,{label:"Your Backups"})]}),n===0&&e.jsxs(M,{container:!0,spacing:3,children:[e.jsx(M,{item:!0,xs:12,children:e.jsx(ut,{children:e.jsxs(de,{children:[e.jsxs(Q,{direction:"row",alignItems:"center",spacing:2,sx:{mb:2},children:[e.jsx(at,{color:"primary"}),e.jsx(t,{variant:"h6",children:"Storage Information"}),e.jsx(be,{size:"small",onClick:I,children:e.jsx(js,{})})]}),e.jsxs(M,{container:!0,spacing:3,children:[e.jsx(M,{item:!0,xs:12,md:4,children:e.jsxs(o,{children:[e.jsx(t,{variant:"body2",color:"textSecondary",children:"Total Storage"}),e.jsx(t,{variant:"h6",children:Ce(U.total_space)})]})}),e.jsx(M,{item:!0,xs:12,md:4,children:e.jsxs(o,{children:[e.jsx(t,{variant:"body2",color:"textSecondary",children:"Used Space"}),e.jsx(t,{variant:"h6",children:Ce(U.used_space)}),e.jsx(Ms,{variant:"determinate",value:f,sx:{mt:1},color:f>80?"error":"primary"}),e.jsxs(t,{variant:"caption",children:[f.toFixed(1),"% used"]})]})}),e.jsx(M,{item:!0,xs:12,md:4,children:e.jsxs(o,{children:[e.jsx(t,{variant:"body2",color:"textSecondary",children:"Backup Space"}),e.jsx(t,{variant:"h6",children:Ce(U.backup_space)}),e.jsx(Ms,{variant:"determinate",value:J,sx:{mt:1},color:"secondary"}),e.jsxs(t,{variant:"caption",children:[J.toFixed(1),"% of total"]})]})})]})]})})}),e.jsx(M,{item:!0,xs:12,lg:6,children:e.jsx(ut,{children:e.jsxs(de,{children:[e.jsxs(Q,{direction:"row",alignItems:"center",spacing:2,sx:{mb:3},children:[e.jsx(wt,{color:"primary"}),e.jsx(t,{variant:"h6",children:"Backup Configuration"})]}),e.jsxs(Q,{spacing:3,children:[e.jsx(Be,{control:e.jsx(Ae,{checked:a.enabled,onChange:B=>u(G(V({},a),{enabled:B.target.checked}))}),label:"Enable Automatic Backups"}),e.jsxs(Q,{direction:{xs:"column",md:"row"},spacing:2,children:[e.jsxs(hs,{sx:{minWidth:200,flex:1},children:[e.jsx(ps,{children:"Backup Schedule"}),e.jsx(gs,{value:a.schedule,label:"Backup Schedule",onChange:B=>u(G(V({},a),{schedule:B.target.value})),children:w.map(B=>e.jsx(xe,{value:B.value,children:B.label},B.value))})]}),e.jsx(Ne,{sx:{minWidth:150,flex:1},type:"number",label:"Retention Period (days)",value:a.retention_days,onChange:B=>u(G(V({},a),{retention_days:parseInt(B.target.value)})),helperText:"How long to keep backup files"}),e.jsx(Ne,{sx:{minWidth:150,flex:1},type:"number",label:"Maximum Backups",value:a.max_backups,onChange:B=>u(G(V({},a),{max_backups:parseInt(B.target.value)})),helperText:"Maximum backup files to keep"})]}),e.jsx(ks,{}),e.jsx(t,{variant:"subtitle2",children:"Backup Content"}),e.jsxs(Q,{direction:{xs:"column",sm:"row"},spacing:2,flexWrap:"wrap",children:[e.jsx(Be,{control:e.jsx(Ae,{checked:a.include_database,onChange:B=>u(G(V({},a),{include_database:B.target.checked}))}),label:"Include Database"}),e.jsx(Be,{control:e.jsx(Ae,{checked:a.include_files,onChange:B=>u(G(V({},a),{include_files:B.target.checked}))}),label:"Include Application Files"}),e.jsx(Be,{control:e.jsx(Ae,{checked:a.include_uploads,onChange:B=>u(G(V({},a),{include_uploads:B.target.checked}))}),label:"Include User Uploads"}),e.jsx(Be,{control:e.jsx(Ae,{checked:a.compression,onChange:B=>u(G(V({},a),{compression:B.target.checked}))}),label:"Enable Compression"})]}),e.jsx(ks,{}),e.jsx(t,{variant:"subtitle2",children:"Notifications"}),e.jsxs(Q,{direction:{xs:"column",md:"row"},spacing:2,children:[e.jsx(Be,{control:e.jsx(Ae,{checked:a.email_notifications,onChange:B=>u(G(V({},a),{email_notifications:B.target.checked}))}),label:"Email Notifications"}),a.email_notifications&&e.jsx(Ne,{sx:{flex:1},type:"email",label:"Notification Email",value:a.notification_email,onChange:B=>u(G(V({},a),{notification_email:B.target.value})),helperText:"Email address to receive backup notifications"})]}),e.jsx(Ne,{fullWidth:!0,label:"Backup Location",value:a.backup_location,onChange:B=>u(G(V({},a),{backup_location:B.target.value})),helperText:"Server path where backup files are stored"}),e.jsx(o,{sx:{pt:2},children:e.jsx(_,{variant:"contained",onClick:A,disabled:b,startIcon:b?e.jsx(Oe,{size:20}):e.jsx(wt,{}),children:b?"Saving...":"Save Settings"})})]})]})})}),e.jsx(M,{item:!0,xs:12,lg:6,children:e.jsx(ut,{children:e.jsxs(de,{children:[e.jsxs(Q,{direction:"row",alignItems:"center",spacing:2,sx:{mb:3},children:[e.jsx(er,{color:"primary"}),e.jsx(t,{variant:"h6",children:"Manual Backup"})]}),e.jsxs(Q,{spacing:2,children:[e.jsx(_,{variant:"contained",size:"large",onClick:()=>L(),disabled:S,startIcon:S?e.jsx(Oe,{size:20}):e.jsx(er,{}),fullWidth:!0,children:S?"Creating Full Backup...":"Create Full Backup"}),e.jsx(_,{variant:"outlined",onClick:()=>L(),disabled:S,startIcon:e.jsx(Sn,{}),fullWidth:!0,children:"Database Only"}),e.jsx(_,{variant:"outlined",onClick:()=>L(),disabled:S,startIcon:e.jsx(At,{}),fullWidth:!0,children:"Files Only"}),e.jsx(ue,{severity:"info",sx:{mt:2},children:e.jsx(t,{variant:"body2",children:"Full backups include database, application files, and user uploads. Large backups may take several minutes to complete."})})]})]})})})]}),n===1&&e.jsx(M,{container:!0,spacing:3,children:e.jsx(M,{item:!0,xs:12,children:e.jsx(ut,{children:e.jsxs(de,{children:[e.jsxs(Q,{direction:"row",alignItems:"center",justifyContent:"space-between",sx:{mb:2},children:[e.jsxs(Q,{direction:"row",alignItems:"center",spacing:2,children:[e.jsx(Ut,{color:"primary"}),e.jsx(t,{variant:"h6",children:"Your Backup Files"})]}),e.jsx(_,{variant:"outlined",startIcon:e.jsx(js,{}),onClick:te,size:"small",children:"Refresh"})]}),m?e.jsx(o,{display:"flex",justifyContent:"center",p:3,children:e.jsx(Oe,{})}):l.length===0?e.jsx(ue,{severity:"info",children:"No backup files found. Create your first backup using the manual backup options in the Backup Settings tab."}):e.jsx(xs,{children:l.map(B=>e.jsxs(Ze,{divider:!0,children:[e.jsx(es,{primary:e.jsxs(Q,{direction:"row",alignItems:"center",spacing:1,children:[e.jsx(t,{variant:"body1",children:B.filename}),e.jsx(H,{label:B.type,size:"small",color:$(B.type)})]}),secondary:e.jsxs(Q,{direction:"row",spacing:2,children:[e.jsxs(t,{variant:"caption",children:["Size: ",Ce(B.size)]}),e.jsxs(t,{variant:"caption",children:["Created: ",le(B.created_at)]})]})}),e.jsx(Rn,{children:e.jsxs(Q,{direction:"row",spacing:1,children:[e.jsx(ye,{title:"Download Backup",children:e.jsx(be,{onClick:()=>X(B.id),disabled:B.status!=="completed",children:e.jsx(Pr,{})})}),e.jsx(ye,{title:"Delete Backup",children:e.jsx(be,{onClick:()=>{j(B.id),y(!0)},color:"error",children:e.jsx(St,{})})})]})})]},B.id))})]})})})})]})}),e.jsxs(as,{open:p,onClose:()=>y(!1),children:[e.jsx(os,{children:"Confirm Delete"}),e.jsx(is,{children:e.jsx(t,{children:"Are you sure you want to delete this backup? This action cannot be undone."})}),e.jsxs(ls,{children:[e.jsx(_,{onClick:()=>y(!1),children:"Cancel"}),e.jsx(_,{onClick:()=>C&&Se(),color:"error",variant:"contained",children:"Delete"})]})]})]})},li=({open:s,onClose:n,onImagesExtracted:r,type:a})=>{const[u,l]=i.useState(null),[h,m]=i.useState([]),[v,b]=i.useState(!1),[D,S]=i.useState(null),[g,T]=i.useState({rows:3,cols:3}),O=i.useRef(null),p=i.useRef(null),y=I=>{var X;const A=(X=I.target.files)==null?void 0:X[0];if(!A)return;if(m([]),S(null),!["image/jpeg","image/png","image/gif"].includes(A.type)){S("Only JPG, PNG, or GIF files are allowed");return}const L=URL.createObjectURL(A);l(L)},C=()=>{if(!u){S("Please upload an image first");return}b(!0),S(null);const I=new Image;I.onload=()=>{try{const A=O.current;if(!A)throw new Error("Canvas not available");const L=A.getContext("2d");if(!L)throw new Error("Could not get canvas context");const X=I.width/g.cols,Se=I.height/g.rows,Ce=a==="profile"?200:300,le=a==="banner"?1200:Ce,$=a==="banner"?300:Ce,f=[];let J=1;for(let ve=0;ve<g.rows;ve++)for(let B=0;B<g.cols;B++){A.width=le,A.height=$;const ae=B*X,_e=ve*Se;L.drawImage(I,ae,_e,X,Se,0,0,le,$),A.toBlob(R=>{if(R){const Z=URL.createObjectURL(R),ce=`${a}_${J}`;f.push({id:J,blob:R,url:Z,name:ce}),f.length===g.rows*g.cols&&(f.sort((me,ge)=>me.id-ge.id),m(f),b(!1))}},"image/png"),J++}}catch(A){S(A instanceof Error?A.message:"An unknown error occurred"),b(!1)}},I.onerror=()=>{S("Failed to load the uploaded image"),b(!1)},I.src=u},j=I=>{const A=document.createElement("a");A.href=I.url,A.download=`${I.name}.png`,document.body.appendChild(A),A.click(),document.body.removeChild(A)},U=()=>{h.forEach((I,A)=>{setTimeout(()=>{j(I)},A*100)})},q=()=>E(void 0,null,function*(){try{const I=[];for(const L of h){const X=yield w(L.blob);I.push({name:L.name,data:X})}const A=yield fetch("/api/admin/global-images/save-extracted",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({images:I,type:a})});if(A.ok){const L=yield A.json();console.log("âœ… Extracted images saved successfully:",L),r(h,a),n()}else{let L="Failed to save extracted images";try{L=(yield A.json()).error||L}catch(X){L=A.statusText||L}throw new Error(L)}}catch(I){console.error("Error saving extracted images:",I),S(I instanceof Error?I.message:"Failed to save extracted images")}}),w=I=>new Promise((A,L)=>{const X=new FileReader;X.onload=()=>{typeof X.result=="string"?A(X.result):L(new Error("Failed to convert blob to base64"))},X.onerror=()=>L(new Error("Failed to read blob")),X.readAsDataURL(I)}),z=()=>{l(null),m([]),S(null),b(!1),n()},te=()=>[{rows:2,cols:2,label:"2x2 Grid (4 images)"},{rows:2,cols:3,label:"2x3 Grid (6 images)"},{rows:3,cols:2,label:"3x2 Grid (6 images)"},{rows:3,cols:3,label:"3x3 Grid (9 images)"},{rows:3,cols:4,label:"3x4 Grid (12 images)"},{rows:4,cols:3,label:"4x3 Grid (12 images)"},{rows:4,cols:4,label:"4x4 Grid (16 images)"}];return e.jsxs(as,{open:s,onClose:z,maxWidth:"lg",fullWidth:!0,PaperProps:{sx:{maxHeight:"90vh",overflow:"hidden"}},children:[e.jsxs(os,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsxs(o,{sx:{display:"flex",alignItems:"center",gap:1},children:[e.jsx(Jt,{size:24}),e.jsxs(t,{variant:"h6",children:["Extract & Save ",a==="profile"?"Profile":"Banner"," Images from Grid"]})]}),e.jsx(be,{onClick:z,children:e.jsx(Cn,{size:20})})]}),e.jsx(is,{sx:{overflow:"auto"},children:e.jsxs(Q,{spacing:3,sx:{py:2},children:[e.jsxs(ue,{severity:"info",children:["Upload a grid image to extract individual ",a," images. The system will automatically split the image into a grid and save each section as a separate file in the ",a," directory."]}),D&&e.jsx(ue,{severity:"error",children:D}),e.jsx(pe,{variant:"outlined",children:e.jsxs(de,{children:[e.jsx(t,{variant:"h6",gutterBottom:!0,children:"Grid Size"}),e.jsx(t,{variant:"body2",color:"text.secondary",sx:{mb:2},children:"Select the grid layout of your image:"}),e.jsx(M,{container:!0,spacing:1,children:te().map(I=>e.jsx(M,{item:!0,children:e.jsx(H,{label:I.label,onClick:()=>T({rows:I.rows,cols:I.cols}),color:g.rows===I.rows&&g.cols===I.cols?"primary":"default",variant:g.rows===I.rows&&g.cols===I.cols?"filled":"outlined",sx:{cursor:"pointer"}})},`${I.rows}x${I.cols}`))})]})}),e.jsx(pe,{variant:"outlined",children:e.jsxs(de,{sx:{textAlign:"center"},children:[e.jsx(t,{variant:"h6",gutterBottom:!0,children:"Upload Grid Image"}),e.jsx("input",{ref:p,type:"file",accept:"image/*",style:{display:"none"},onChange:y}),e.jsx(_,{variant:"contained",startIcon:e.jsx(st,{size:18}),onClick:()=>{var I;return(I=p.current)==null?void 0:I.click()},size:"large",sx:{mb:2},children:"Choose Grid Image"}),u&&e.jsx(o,{sx:{mt:2},children:e.jsx("img",{src:u,alt:"Source Grid",style:{maxWidth:"100%",maxHeight:"300px",border:"1px solid #e0e0e0",borderRadius:"4px"}})})]})}),u&&e.jsx(o,{sx:{textAlign:"center"},children:e.jsx(_,{variant:"contained",onClick:C,disabled:v,startIcon:v?e.jsx(Oe,{size:20}):e.jsx(Jt,{size:18}),size:"large",children:v?"Extracting...":`Extract ${g.rows*g.cols} Images`})}),h.length>0&&e.jsx(pe,{variant:"outlined",children:e.jsxs(de,{children:[e.jsxs(o,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:2},children:[e.jsxs(t,{variant:"h6",children:["Extracted Images (",h.length,")"]}),e.jsx(_,{variant:"outlined",startIcon:e.jsx(An,{size:18}),onClick:U,size:"small",children:"Download All"})]}),e.jsx(M,{container:!0,spacing:2,children:h.map(I=>e.jsx(M,{item:!0,xs:6,sm:4,md:3,children:e.jsx(pe,{variant:"outlined",sx:{textAlign:"center"},children:e.jsxs(de,{children:[e.jsx("img",{src:I.url,alt:`Extracted ${I.id}`,style:{width:"100%",height:"auto",maxHeight:"120px",objectFit:"cover",borderRadius:"4px"}}),e.jsx(t,{variant:"caption",display:"block",sx:{mt:1},children:I.name}),e.jsx(_,{size:"small",onClick:()=>j(I),sx:{mt:1},children:"Download"})]})})},I.id))})]})}),e.jsx("canvas",{ref:O,style:{display:"none"}})]})}),e.jsxs(ls,{children:[e.jsx(_,{onClick:z,children:"Cancel"}),h.length>0&&e.jsxs(_,{onClick:q,variant:"contained",startIcon:e.jsx(Qt,{size:18}),children:["Use ",h.length," Images"]})]})]})},ci=()=>{const{isSuperAdmin:s}=It(),[n,r]=i.useState([]),[a,u]=i.useState(!1),[l,h]=i.useState(null),[m,v]=i.useState(!1),[b,D]=i.useState("avatar"),[S,g]=i.useState(!1),[T,O]=i.useState(null),[p,y]=i.useState(""),[C,j]=i.useState(!1),[U,q]=i.useState("profile"),[w,z]=i.useState(!1),[te,I]=i.useState(""),[A,L]=i.useState("content"),[X,Se]=i.useState("all"),[Ce,le]=i.useState([]),[$,f]=i.useState(!1),[J,ve]=i.useState({path:"",contentType:"avatar",enabled:!0,description:""}),[B,ae]=i.useState(null);i.useEffect(()=>{s()&&(_e(),R())},[s]);const _e=()=>E(void 0,null,function*(){u(!0),h(null);try{const k=yield Zs.globalImages.getAll(),ee=Array.isArray(k)?k:[];r(ee)}catch(k){h(k.message||"Failed to load global images"),r([])}finally{u(!1)}}),R=()=>E(void 0,null,function*(){var k,ee;try{const oe=(yield(ee=(k=Zs.globalImages).getDirectories)==null?void 0:ee.call(k))||[];le(Array.isArray(oe)?oe:[])}catch(oe){console.error("Failed to load directories:",oe),le([])}}),Z=k=>{var oe;const ee=(oe=k.target.files)==null?void 0:oe[0];if(ee){const Pe={avatar:["image/jpeg","image/png","image/gif","image/webp"],banner:["image/jpeg","image/png","image/gif","image/webp"],profile:["image/jpeg","image/png","image/gif","image/webp"],gif:["image/gif"],emoji:["image/png","image/gif","image/svg+xml","image/webp"],all:["image/jpeg","image/png","image/gif","image/webp","image/svg+xml"]},Te=Pe[b]||Pe.all;if(!Te.includes(ee.type)){h(`Invalid file type for ${b}. Allowed: ${Te.join(", ")}`);return}const Ts=b==="gif"?10*1024*1024:5*1024*1024;if(ee.size>Ts){h(`File size must be less than ${Ts/1024/1024}MB`);return}O(ee),y(ee.name.replace(/\.[^/.]+$/,"")),h(null)}},ce=()=>E(void 0,null,function*(){if(!T||!p.trim()){h("Please select a file and enter a name");return}g(!0),h(null);try{const k=new FormData;k.append("image",T),k.append("name",p),k.append("type",b==="all"?"avatar":b);const ee=yield Zs.globalImages.upload(k);if(ee.success)r(oe=>Array.isArray(oe)?[...oe,ee.data.image]:[ee.data.image]),v(!1),O(null),y(""),D("profile");else throw new Error(ee.message||"Upload failed")}catch(k){h(k.message||"Failed to upload image"),console.error("Error uploading image:",k)}finally{g(!1)}}),me=k=>E(void 0,null,function*(){const ee=k.source==="user"?"auto-detected":"global";if(confirm(`Are you sure you want to delete this ${ee} image?`))try{if((yield Zs.globalImages.update(Number(k.id),{action:"delete"})).success)r(Pe=>Array.isArray(Pe)?Pe.filter(Te=>Te.id!==k.id):[]);else throw new Error("Failed to delete image")}catch(oe){h(oe.message||"Failed to delete image"),console.error("Error deleting image:",oe)}}),ge=k=>{const ee={avatar:"Recommended: 200x200 pixels, JPG, PNG, GIF, or WebP files",banner:"Recommended: 1200x300 pixels, JPG, PNG, GIF, or WebP files",profile:"Recommended: 200x200 pixels, JPG, PNG, or GIF files",gif:"Animated GIF files, up to 10MB",emoji:"PNG, GIF, SVG, or WebP files, typically 32x32 to 128x128 pixels",all:"Various image formats supported"};return ee[k]||ee.avatar},ts=()=>E(void 0,null,function*(){var k,ee;if(!J.path.trim()){h("Please enter a directory path");return}try{const oe=yield(ee=(k=Zs.globalImages).addDirectory)==null?void 0:ee.call(k,J);if(oe!=null&&oe.success)yield R(),f(!1),ve({path:"",contentType:"avatar",enabled:!0,description:""}),I("Directory added successfully"),z(!0);else throw new Error((oe==null?void 0:oe.message)||"Failed to add directory")}catch(oe){h(oe.message||"Failed to add directory")}}),Xe=k=>E(void 0,null,function*(){var ee,oe,Pe;ae(k.path);try{const Te=yield(oe=(ee=Zs.globalImages).scanDirectory)==null?void 0:oe.call(ee,k.path);if(Te!=null&&Te.success)yield _e(),yield R(),I(`Scanned ${((Pe=Te.data)==null?void 0:Pe.count)||0} files from directory`),z(!0);else throw new Error((Te==null?void 0:Te.message)||"Failed to scan directory")}catch(Te){h(Te.message||"Failed to scan directory")}finally{ae(null)}}),Ge=k=>E(void 0,null,function*(){var ee,oe;if(confirm(`Are you sure you want to remove the directory "${k.path}"?`))try{const Pe=yield(oe=(ee=Zs.globalImages).deleteDirectory)==null?void 0:oe.call(ee,k.path);if(Pe!=null&&Pe.success)yield R(),I("Directory removed successfully"),z(!0);else throw new Error((Pe==null?void 0:Pe.message)||"Failed to remove directory")}catch(Pe){h(Pe.message||"Failed to remove directory")}}),Ke=k=>E(void 0,null,function*(){var ee,oe;try{const Pe=G(V({},k),{enabled:!k.enabled}),Te=yield(oe=(ee=Zs.globalImages).updateDirectory)==null?void 0:oe.call(ee,k.path,Pe);if(Te!=null&&Te.success)yield R();else throw new Error((Te==null?void 0:Te.message)||"Failed to update directory")}catch(Pe){h(Pe.message||"Failed to update directory")}}),ns=k=>{switch(k){case"avatar":case"profile":return e.jsx(Bo,{size:20});case"emoji":return e.jsx(za,{size:20});default:return e.jsx(Qt,{size:20})}},Ve=X==="all"?n:n.filter(k=>k.type===X),Y=(k,ee)=>E(void 0,null,function*(){g(!0),h(null);try{yield _e(),I(`Successfully extracted and saved ${k.length} ${ee} images`),z(!0)}catch(oe){h(oe.message||"Failed to refresh images list")}finally{g(!1)}});return s()?e.jsxs(o,{children:[e.jsx(t,{variant:"h6",gutterBottom:!0,children:"Global Content Management"}),e.jsx(ue,{severity:"info",sx:{mb:3},children:"Manage publicly available content including avatars, banners, GIFs, and emojis. You can upload individual files, specify directories for automatic scanning, or extract images from grids. All content is made available to users for their profiles and communications."}),e.jsxs(ot,{value:A,onChange:(k,ee)=>L(ee),sx:{mb:3,borderBottom:1,borderColor:"divider"},children:[e.jsx(ze,{label:"Content Library",value:"content"}),e.jsx(ze,{label:"Directory Management",value:"directories"})]}),l&&e.jsx(ue,{severity:"error",sx:{mb:3},action:e.jsx(_,{color:"inherit",size:"small",onClick:()=>{h(null),A==="content"?_e():R()},children:"Dismiss"}),children:l}),A==="content"&&e.jsx(e.Fragment,{children:e.jsxs(Q,{direction:"row",spacing:2,sx:{mb:3},flexWrap:"wrap",children:[e.jsxs(hs,{size:"small",sx:{minWidth:150},children:[e.jsx(ps,{children:"Filter by Type"}),e.jsxs(gs,{value:X,label:"Filter by Type",onChange:k=>Se(k.target.value),startAdornment:e.jsx(Aa,{size:16,style:{marginRight:8}}),children:[e.jsx(xe,{value:"all",children:"All Types"}),e.jsx(xe,{value:"avatar",children:"Avatars"}),e.jsx(xe,{value:"banner",children:"Banners"}),e.jsx(xe,{value:"profile",children:"Profiles"}),e.jsx(xe,{value:"gif",children:"GIFs"}),e.jsx(xe,{value:"emoji",children:"Emojis"})]})]}),e.jsx(_,{variant:"contained",startIcon:e.jsx(st,{}),onClick:()=>{D("avatar"),v(!0)},children:"Upload Avatar"}),e.jsx(_,{variant:"contained",startIcon:e.jsx(st,{}),onClick:()=>{D("banner"),v(!0)},children:"Upload Banner"}),e.jsx(_,{variant:"contained",startIcon:e.jsx(st,{}),onClick:()=>{D("gif"),v(!0)},children:"Upload GIF"}),e.jsx(_,{variant:"contained",startIcon:e.jsx(st,{}),onClick:()=>{D("emoji"),v(!0)},children:"Upload Emoji"})]})}),A==="directories"&&e.jsxs(e.Fragment,{children:[e.jsxs(Q,{direction:"row",spacing:2,sx:{mb:3},children:[e.jsx(_,{variant:"contained",startIcon:e.jsx(dn,{}),onClick:()=>f(!0),children:"Add Content Directory"}),e.jsx(_,{variant:"outlined",startIcon:e.jsx(gn,{}),onClick:R,children:"Refresh Directories"})]}),e.jsxs(M,{container:!0,spacing:2,sx:{mb:3},children:[Ce.map(k=>e.jsx(M,{item:!0,xs:12,md:6,children:e.jsx(pe,{variant:"outlined",children:e.jsx(de,{children:e.jsxs(Q,{spacing:2,children:[e.jsxs(o,{display:"flex",alignItems:"center",justifyContent:"space-between",children:[e.jsxs(o,{display:"flex",alignItems:"center",gap:1,children:[e.jsx(tr,{size:20}),e.jsx(t,{variant:"h6",noWrap:!0,sx:{flex:1},children:k.path})]}),e.jsx(H,{label:k.enabled?"Enabled":"Disabled",color:k.enabled?"success":"default",size:"small",onClick:()=>Ke(k)})]}),e.jsxs(o,{children:[e.jsx(H,{label:k.contentType,size:"small",color:"primary",sx:{mr:1}}),k.fileCount!==void 0&&e.jsx(H,{label:`${k.fileCount} files`,size:"small",variant:"outlined"})]}),k.description&&e.jsx(t,{variant:"body2",color:"text.secondary",children:k.description}),k.lastScanned&&e.jsxs(t,{variant:"body2",color:"text.secondary",children:["Last scanned: ",new Date(k.lastScanned).toLocaleString()]}),e.jsxs(Q,{direction:"row",spacing:1,children:[e.jsx(_,{size:"small",variant:"outlined",startIcon:B===k.path?e.jsx(Oe,{size:16}):e.jsx(gn,{size:16}),onClick:()=>Xe(k),disabled:B===k.path||!k.enabled,children:"Scan Directory"}),e.jsx(_,{size:"small",variant:"outlined",color:"error",startIcon:e.jsx(nr,{size:16}),onClick:()=>Ge(k),children:"Remove"})]})]})})})},k.path)),Ce.length===0&&e.jsx(M,{item:!0,xs:12,children:e.jsx(pe,{variant:"outlined",children:e.jsx(de,{children:e.jsxs(o,{display:"flex",flexDirection:"column",alignItems:"center",py:4,children:[e.jsx(tr,{size:48,style:{color:"#ccc",marginBottom:16}}),e.jsx(t,{variant:"h6",color:"text.secondary",gutterBottom:!0,children:"No Directories Configured"}),e.jsx(t,{variant:"body2",color:"text.secondary",textAlign:"center",sx:{mb:2},children:"Add directories containing publicly usable content (avatars, banners, GIFs, emojis) for automatic scanning."}),e.jsx(_,{variant:"contained",startIcon:e.jsx(dn,{}),onClick:()=>f(!0),children:"Add Directory"})]})})})})]})]}),e.jsxs(Q,{direction:"row",spacing:2,sx:{mb:3},children:[e.jsx(_,{variant:"outlined",startIcon:e.jsx(Jt,{}),onClick:()=>{q("profile"),j(!0)},children:"Extract & Save Profile Images from Grid"}),e.jsx(_,{variant:"outlined",startIcon:e.jsx(Jt,{}),onClick:()=>{q("banner"),j(!0)},children:"Extract & Save Banner Images from Grid"})]}),A==="content"&&e.jsx(e.Fragment,{children:a?e.jsxs(o,{display:"flex",justifyContent:"center",alignItems:"center",py:4,children:[e.jsx(Oe,{}),e.jsx(t,{variant:"body2",sx:{ml:2},children:"Loading content..."})]}):e.jsxs(M,{container:!0,spacing:3,children:[Array.isArray(Ve)&&Ve.map(k=>e.jsx(M,{item:!0,xs:12,sm:6,md:4,children:e.jsx(pe,{variant:"outlined",children:e.jsxs(de,{children:[e.jsxs(o,{display:"flex",alignItems:"center",mb:2,children:[ns(k.type),e.jsx(t,{variant:"h6",noWrap:!0,sx:{ml:1},children:k.name})]}),k.directory&&e.jsx(H,{label:`From: ${k.directory}`,size:"small",color:"info",variant:"outlined",sx:{mb:1}}),e.jsx(o,{sx:{width:"100%",height:k.type==="profile"?120:80,backgroundImage:`url(${k.url})`,backgroundSize:"cover",backgroundPosition:"center",borderRadius:1,mb:2,border:"1px solid #e0e0e0"}}),e.jsxs(Q,{spacing:1,children:[e.jsxs(o,{sx:{display:"flex",gap:1,flexWrap:"wrap"},children:[e.jsx(H,{label:k.type==="profile"?"Profile":"Banner",size:"small",color:k.type==="profile"?"primary":"secondary"}),e.jsx(H,{label:k.source==="user"?"Auto-Detected":"Global",size:"small",color:k.source==="user"?"warning":"success",variant:"outlined"})]}),e.jsxs(t,{variant:"body2",color:"text.secondary",children:["Size: ",k.size]}),e.jsxs(t,{variant:"body2",color:"text.secondary",children:["Uploaded: ",new Date(k.uploadedAt).toLocaleDateString()]}),e.jsxs(t,{variant:"body2",color:"text.secondary",children:["By: ",k.uploadedBy]})]}),e.jsxs(Q,{direction:"row",spacing:1,sx:{mt:2},children:[e.jsx(ye,{title:"Preview",children:e.jsx(be,{size:"small",onClick:()=>window.open(k.url,"_blank"),children:e.jsx(zt,{size:16})})}),e.jsx(ye,{title:"Download",children:e.jsx(be,{size:"small",onClick:()=>window.open(k.url,"_blank"),children:e.jsx(An,{size:16})})}),e.jsx(ye,{title:"Delete",children:e.jsx(be,{size:"small",color:"error",onClick:()=>me(k),children:e.jsx(nr,{size:16})})})]})]})})},k.id)),Array.isArray(Ve)&&Ve.length===0&&e.jsx(M,{item:!0,xs:12,children:e.jsx(pe,{variant:"outlined",children:e.jsx(de,{children:e.jsxs(o,{display:"flex",flexDirection:"column",alignItems:"center",py:4,children:[e.jsx(Qt,{size:48,style:{color:"#ccc",marginBottom:16}}),e.jsx(t,{variant:"h6",color:"text.secondary",gutterBottom:!0,children:X==="all"?"No Content Available":`No ${X} content`}),e.jsx(t,{variant:"body2",color:"text.secondary",textAlign:"center",sx:{mb:2},children:X==="all"?"Upload content or configure directories to make assets available to all users.":`Upload ${X} content or scan directories to add ${X} files.`}),e.jsxs(_,{variant:"contained",startIcon:e.jsx(st,{}),onClick:()=>{D(X==="all"?"avatar":X),v(!0)},children:["Upload ",X==="all"?"Content":X.charAt(0).toUpperCase()+X.slice(1)]})]})})})})]})}),e.jsxs(as,{open:m,onClose:()=>v(!1),maxWidth:"sm",fullWidth:!0,children:[e.jsxs(os,{children:["Upload ",b.charAt(0).toUpperCase()+b.slice(1)," Content"]}),e.jsx(is,{children:e.jsxs(Q,{spacing:3,sx:{mt:1},children:[e.jsxs(ue,{severity:"info",children:["Requirements: ",ge(b)]}),e.jsx(Ne,{label:"Content Name",value:p,onChange:k=>y(k.target.value),fullWidth:!0,placeholder:`Enter a name for this ${b}`}),e.jsxs(o,{children:[e.jsx("input",{accept:b==="gif"?"image/gif":b==="emoji"?"image/png,image/gif,image/svg+xml,image/webp":"image/jpeg,image/png,image/gif,image/webp",style:{display:"none"},id:"global-content-upload",type:"file",onChange:Z}),e.jsx("label",{htmlFor:"global-content-upload",children:e.jsx(_,{variant:"outlined",component:"span",startIcon:e.jsx(st,{}),fullWidth:!0,children:"Select File"})}),T&&e.jsxs(t,{variant:"body2",sx:{mt:1},children:["Selected: ",T.name," (",(T.size/1024/1024).toFixed(2)," MB)"]})]}),l&&e.jsx(ue,{severity:"error",children:l})]})}),e.jsxs(ls,{children:[e.jsx(_,{onClick:()=>{v(!1),O(null),y(""),h(null)},children:"Cancel"}),e.jsx(_,{onClick:ce,variant:"contained",disabled:!T||!p.trim()||S,startIcon:S?e.jsx(Oe,{size:16}):e.jsx(st,{}),children:S?"Uploading...":"Upload"})]})]}),e.jsxs(as,{open:$,onClose:()=>{f(!1),ve({path:"",contentType:"avatar",enabled:!0,description:""}),h(null)},maxWidth:"sm",fullWidth:!0,children:[e.jsx(os,{children:"Add Content Directory"}),e.jsx(is,{children:e.jsxs(Q,{spacing:3,sx:{mt:1},children:[e.jsx(ue,{severity:"info",children:"Specify a directory path on the server that contains publicly usable content. The system will scan this directory and make all valid files available to users."}),e.jsx(Ne,{label:"Directory Path",value:J.path,onChange:k=>ve(G(V({},J),{path:k.target.value})),fullWidth:!0,placeholder:"/path/to/content/directory",required:!0,helperText:"Absolute path to the directory on the server"}),e.jsxs(hs,{fullWidth:!0,children:[e.jsx(ps,{children:"Content Type"}),e.jsxs(gs,{value:J.contentType,label:"Content Type",onChange:k=>ve(G(V({},J),{contentType:k.target.value})),children:[e.jsx(xe,{value:"avatar",children:"Avatars"}),e.jsx(xe,{value:"banner",children:"Banners"}),e.jsx(xe,{value:"profile",children:"Profile Images"}),e.jsx(xe,{value:"gif",children:"GIFs"}),e.jsx(xe,{value:"emoji",children:"Emojis"})]})]}),e.jsx(Ne,{label:"Description (Optional)",value:J.description||"",onChange:k=>ve(G(V({},J),{description:k.target.value})),fullWidth:!0,multiline:!0,rows:2,placeholder:"Brief description of this directory's contents"}),l&&e.jsx(ue,{severity:"error",children:l})]})}),e.jsxs(ls,{children:[e.jsx(_,{onClick:()=>{f(!1),ve({path:"",contentType:"avatar",enabled:!0,description:""}),h(null)},children:"Cancel"}),e.jsx(_,{onClick:ts,variant:"contained",disabled:!J.path.trim(),startIcon:e.jsx(dn,{}),children:"Add Directory"})]})]}),e.jsx(li,{open:C,onClose:()=>j(!1),onImagesExtracted:Y,type:U}),e.jsx(wn,{open:w,autoHideDuration:12e3,onClose:()=>z(!1),anchorOrigin:{vertical:"center",horizontal:"center"},sx:{position:"fixed",top:"50% !important",left:"50% !important",transform:"translate(-50%, -50%) !important",zIndex:1e4,"& .MuiSnackbar-root":{position:"fixed",top:"50% !important",left:"50% !important",transform:"translate(-50%, -50%) !important"}},children:e.jsx(ue,{severity:"success",onClose:()=>z(!1),sx:{minWidth:"400px",maxWidth:"600px",fontSize:"1.1rem",padding:"16px 20px","& .MuiAlert-message":{fontSize:"1.1rem",fontWeight:500},"& .MuiAlert-icon":{fontSize:"28px"}},children:te})})]}):e.jsx(ue,{severity:"error",children:"Access denied. Only super administrators can manage global content."})},di=()=>{const{user:s}=It(),[n,r]=i.useState([]),[a,u]=i.useState(null),[l,h]=i.useState(!1),[m,v]=i.useState(null),[b,D]=i.useState(!0),[S,g]=i.useState({open:!1,service:"",action:""});i.useEffect(()=>{T();const j=setInterval(()=>{b&&T()},5e3);return()=>clearInterval(j)},[b]);const T=()=>E(void 0,null,function*(){try{h(!0),v(null),r([{name:"api",displayName:"API Server",status:"running",pid:12345,uptime:"2d 5h 30m",cpu:15.5,memory:512,description:"Main API server",category:"core",restartable:!0},{name:"database",displayName:"Database",status:"running",pid:12346,uptime:"5d 12h 15m",cpu:8.2,memory:1024,description:"PostgreSQL database",category:"database",restartable:!0}]),u({overall:"healthy",servicesUp:2,servicesTotal:2,lastUpdate:new Date().toISOString()})}catch(j){v(j.message||"Failed to load services")}finally{h(!1)}}),O=(j,U)=>E(void 0,null,function*(){try{h(!0),yield T()}catch(q){v(q.message||`Failed to ${U} service`)}finally{h(!1),g({open:!1,service:"",action:""})}}),p=j=>{switch(j){case"running":return e.jsx(Ba,{size:20,color:"green"});case"stopped":return e.jsx(Cn,{size:20,color:"red"});case"error":return e.jsx(kr,{size:20,color:"red"});default:return e.jsx(Ea,{size:20,color:"gray"})}},y=j=>{switch(j){case"running":return"success";case"stopped":return"error";case"error":return"error";default:return"default"}},C=j=>{switch(j){case"healthy":return"success";case"warning":return"warning";case"critical":return"error";default:return"default"}};return e.jsxs(o,{children:[m&&e.jsx(ue,{severity:"error",sx:{mb:2},onClose:()=>v(null),children:m}),a&&e.jsx(ut,{sx:{mb:3},children:e.jsxs(de,{children:[e.jsxs(Q,{direction:"row",alignItems:"center",justifyContent:"space-between",sx:{mb:2},children:[e.jsx(t,{variant:"h6",children:"System Health"}),e.jsxs(Q,{direction:"row",spacing:2,alignItems:"center",children:[e.jsx(Be,{control:e.jsx(Ae,{checked:b,onChange:j=>D(j.target.checked)}),label:"Auto Refresh"}),e.jsx(_,{variant:"outlined",startIcon:e.jsx(RefreshIcon,{}),onClick:T,disabled:l,size:"small",children:"Refresh"})]})]}),e.jsxs(M,{container:!0,spacing:3,children:[e.jsx(M,{item:!0,xs:12,md:4,children:e.jsxs(o,{children:[e.jsx(t,{variant:"body2",color:"textSecondary",children:"Overall Status"}),e.jsx(H,{label:a.overall.toUpperCase(),color:C(a.overall),sx:{mt:1}})]})}),e.jsx(M,{item:!0,xs:12,md:4,children:e.jsxs(o,{children:[e.jsx(t,{variant:"body2",color:"textSecondary",children:"Services Running"}),e.jsxs(t,{variant:"h6",children:[a.servicesUp," / ",a.servicesTotal]}),e.jsx(Ms,{variant:"determinate",value:a.servicesUp/a.servicesTotal*100,sx:{mt:1}})]})}),e.jsx(M,{item:!0,xs:12,md:4,children:e.jsxs(o,{children:[e.jsx(t,{variant:"body2",color:"textSecondary",children:"Last Update"}),e.jsx(t,{variant:"body2",children:new Date(a.lastUpdate).toLocaleString()})]})})]})]})}),e.jsx(ut,{children:e.jsxs(de,{children:[e.jsx(t,{variant:"h6",gutterBottom:!0,children:"Services"}),l&&n.length===0?e.jsx(o,{display:"flex",justifyContent:"center",p:3,children:e.jsx(Oe,{})}):e.jsx(ht,{children:e.jsxs(mt,{children:[e.jsx(xt,{children:e.jsxs(vs,{children:[e.jsx(W,{children:"Service"}),e.jsx(W,{children:"Status"}),e.jsx(W,{children:"Category"}),e.jsx(W,{children:"PID"}),e.jsx(W,{children:"Uptime"}),e.jsx(W,{children:"CPU %"}),e.jsx(W,{children:"Memory (MB)"}),e.jsx(W,{align:"right",children:"Actions"})]})}),e.jsx(pt,{children:n.map(j=>e.jsxs(vs,{children:[e.jsx(W,{children:e.jsxs(Q,{direction:"row",alignItems:"center",spacing:1,children:[p(j.status),e.jsxs(o,{children:[e.jsx(t,{variant:"body2",fontWeight:"medium",children:j.displayName}),e.jsx(t,{variant:"caption",color:"textSecondary",children:j.description})]})]})}),e.jsx(W,{children:e.jsx(H,{label:j.status,color:y(j.status),size:"small"})}),e.jsx(W,{children:e.jsx(H,{label:j.category,size:"small",variant:"outlined"})}),e.jsx(W,{children:j.pid||"-"}),e.jsx(W,{children:j.uptime||"-"}),e.jsx(W,{children:j.cpu?`${j.cpu.toFixed(1)}%`:"-"}),e.jsx(W,{children:j.memory||"-"}),e.jsx(W,{align:"right",children:e.jsx(Q,{direction:"row",spacing:1,justifyContent:"flex-end",children:j.restartable&&e.jsxs(e.Fragment,{children:[j.status==="stopped"&&e.jsx(ye,{title:"Start Service",children:e.jsx(be,{size:"small",color:"success",onClick:()=>{g({open:!0,service:j.name,action:"start"})},children:e.jsx(Oa,{size:18})})}),j.status==="running"&&e.jsxs(e.Fragment,{children:[e.jsx(ye,{title:"Restart Service",children:e.jsx(be,{size:"small",color:"primary",onClick:()=>{g({open:!0,service:j.name,action:"restart"})},children:e.jsx(Ho,{size:18})})}),e.jsx(ye,{title:"Stop Service",children:e.jsx(be,{size:"small",color:"error",onClick:()=>{g({open:!0,service:j.name,action:"stop"})},children:e.jsx(Wo,{size:18})})})]})]})})})]},j.name))})]})})]})}),e.jsxs(as,{open:S.open,onClose:()=>g({open:!1,service:"",action:""}),children:[e.jsx(os,{children:"Confirm Service Action"}),e.jsx(is,{children:e.jsxs(t,{children:["Are you sure you want to ",S.action,' the service "',S.service,'"?']})}),e.jsxs(ls,{children:[e.jsx(_,{onClick:()=>g({open:!1,service:"",action:""}),children:"Cancel"}),e.jsx(_,{onClick:()=>O(S.service,S.action),color:"primary",variant:"contained",children:"Confirm"})]})]})]})},ui=s=>{var n,r,a,u,l,h,m,v;const b=Ks(),D=Mr(),g=((n=s.ampm)!=null?n:b.is12HourCycleInCurrentLocale())?b.formats.keyboardDateTime12h:b.formats.keyboardDateTime24h;return re({},s,{disablePast:(r=s.disablePast)!=null?r:!1,disableFuture:(a=s.disableFuture)!=null?a:!1,format:(u=s.format)!=null?u:g,disableIgnoringDatePartForTimeValidation:!!(s.minDateTime||s.maxDateTime),minDate:Kt(b,(l=s.minDateTime)!=null?l:s.minDate,D.minDate),maxDate:Kt(b,(h=s.maxDateTime)!=null?h:s.maxDate,D.maxDate),minTime:(m=s.minDateTime)!=null?m:s.minTime,maxTime:(v=s.maxDateTime)!=null?v:s.maxTime})},hi=({props:s,inputRef:n})=>{const r=ui(s),{forwardedProps:a,internalProps:u}=Na(r,"date-time");return Ua({inputRef:n,forwardedProps:a,internalProps:u,valueManager:jt,fieldValueManager:Wa,validator:Vn,valueType:"date-time"})},mi=["components","componentsProps","slots","slotProps","InputProps","inputProps"],xi=["inputRef"],pi=["ref","onPaste","onKeyDown","inputMode","readOnly","clearable","onClear"],Vr=i.forwardRef(function(n,r){var a,u,l;const h=Is({props:n,name:"MuiDateTimeField"}),{components:m,componentsProps:v,slots:b,slotProps:D,InputProps:S,inputProps:g}=h,T=Ss(h,mi),O=h,p=(a=(u=b==null?void 0:b.textField)!=null?u:m==null?void 0:m.TextField)!=null?a:Ne,y=$r({elementType:p,externalSlotProps:(l=D==null?void 0:D.textField)!=null?l:v==null?void 0:v.textField,externalForwardedProps:T,ownerState:O}),{inputRef:C}=y,j=Ss(y,xi);j.inputProps=re({},g,j.inputProps),j.InputProps=re({},S,j.InputProps);const U=hi({props:j,inputRef:C}),{ref:q,onPaste:w,onKeyDown:z,inputMode:te,readOnly:I,clearable:A,onClear:L}=U,X=Ss(U,pi),{InputProps:Se,fieldProps:Ce}=Va({onClear:L,clearable:A,fieldProps:X,InputProps:X.InputProps,slots:b,slotProps:D,components:m,componentsProps:v});return e.jsx(p,re({ref:r},Ce,{InputProps:re({},Se,{readOnly:I}),inputProps:re({},X.inputProps,{inputMode:te,onPaste:w,onKeyDown:z,ref:q})}))});function gi(s){return Ns("MuiDateTimePickerTabs",s)}Ls("MuiDateTimePickerTabs",["root"]);const ji=s=>Wt(s)?"date":"time",fi=s=>s==="date"?"day":"hours",yi=s=>{const{classes:n}=s;return As({root:["root"]},gi,n)},bi=We(ot,{name:"MuiDateTimePickerTabs",slot:"Root",overridesResolver:(s,n)=>n.root})(({theme:s})=>({boxShadow:`0 -1px 0 0 inset ${(s.vars||s).palette.divider}`,"&:last-child":{boxShadow:`0 1px 0 0 inset ${(s.vars||s).palette.divider}`,[`& .${Ca.indicator}`]:{bottom:"auto",top:0}}})),vi=function(n){const r=Is({props:n,name:"MuiDateTimePickerTabs"}),{dateIcon:a=e.jsx(Ha,{}),onViewChange:u,timeIcon:l=e.jsx(qa,{}),view:h,hidden:m=typeof window=="undefined"||window.innerHeight<667,className:v,sx:b}=r,D=it(),S=yi(r),g=(T,O)=>{u(fi(O))};return m?null:e.jsxs(bi,{ownerState:r,variant:"fullWidth",value:ji(h),onChange:g,className:_s(v,S.root),sx:b,children:[e.jsx(ze,{value:"date","aria-label":D.dateTableLabel,icon:e.jsx(i.Fragment,{children:a})}),e.jsx(ze,{value:"time","aria-label":D.timeTableLabel,icon:e.jsx(i.Fragment,{children:l})})]})};function Ci(s){return Ns("MuiDateTimePickerToolbar",s)}const mn=Ls("MuiDateTimePickerToolbar",["root","dateContainer","timeContainer","timeDigitsContainer","separator","timeLabelReverse","ampmSelection","ampmLandscape","ampmLabel"]),wi=["ampm","ampmInClock","value","onChange","view","isLandscape","onViewChange","toolbarFormat","toolbarPlaceholder","views","disabled","readOnly","toolbarVariant"],Si=s=>{const{classes:n,theme:r,isLandscape:a}=s,u={root:["root"],dateContainer:["dateContainer"],timeContainer:["timeContainer",r.direction==="rtl"&&"timeLabelReverse"],timeDigitsContainer:["timeDigitsContainer",r.direction==="rtl"&&"timeLabelReverse"],separator:["separator"],ampmSelection:["ampmSelection",a&&"ampmLandscape"],ampmLabel:["ampmLabel"]};return As(u,Ci,n)},Hr=We(Ga,{name:"MuiDateTimePickerToolbar",slot:"Root",overridesResolver:(s,n)=>n.root})(({theme:s,ownerState:n})=>({paddingLeft:n.toolbarVariant==="desktop"&&!n.isLandscape?24:16,paddingRight:n.toolbarVariant==="desktop"&&!n.isLandscape?0:16,borderBottom:n.toolbarVariant==="desktop"?`1px solid ${(s.vars||s).palette.divider}`:void 0,borderRight:n.toolbarVariant==="desktop"&&n.isLandscape?`1px solid ${(s.vars||s).palette.divider}`:void 0,justifyContent:"space-around",position:"relative"}));Hr.propTypes={as:x.elementType,classes:x.object,className:x.string,isLandscape:x.bool.isRequired,isMobileKeyboardViewOpen:x.bool,landscapeDirection:x.oneOf(["column","row"]),ownerState:x.object.isRequired,sx:x.oneOfType([x.arrayOf(x.oneOfType([x.func,x.object,x.bool])),x.func,x.object]),toggleMobileKeyboardView:x.func,toolbarTitle:x.node,viewType:x.oneOf(["date","time"])};const ki=We("div",{name:"MuiDateTimePickerToolbar",slot:"DateContainer",overridesResolver:(s,n)=>n.dateContainer})({display:"flex",flexDirection:"column",alignItems:"flex-start"}),qr=We("div",{name:"MuiDateTimePickerToolbar",slot:"TimeContainer",overridesResolver:(s,n)=>n.timeContainer})(({theme:s,ownerState:n})=>{const r=n.isLandscape&&n.toolbarVariant!=="desktop"?"column":"row";return re({display:"flex",flexDirection:r},n.toolbarVariant==="desktop"&&re({},!n.isLandscape&&{gap:9,marginRight:4,alignSelf:"flex-end"}),s.direction==="rtl"&&{flexDirection:`${r}-reverse`})}),Ii=We("div",{name:"MuiDateTimePickerToolbar",slot:"TimeDigitsContainer",overridesResolver:(s,n)=>n.timeDigitsContainer})(({theme:s,ownerState:n})=>re({display:"flex"},n.toolbarVariant==="desktop"&&{gap:1.5},s.direction==="rtl"&&{flexDirection:"row-reverse"}));qr.propTypes={as:x.elementType,ownerState:x.object.isRequired,sx:x.oneOfType([x.arrayOf(x.oneOfType([x.func,x.object,x.bool])),x.func,x.object])};const br=We(Wr,{name:"MuiDateTimePickerToolbar",slot:"Separator",overridesResolver:(s,n)=>n.separator})(({ownerState:s})=>({margin:s.toolbarVariant==="desktop"?0:"0 4px 0 2px",cursor:"default"})),Ti=We("div",{name:"MuiDateTimePickerToolbar",slot:"AmPmSelection",overridesResolver:(s,n)=>[{[`.${mn.ampmLabel}`]:n.ampmLabel},{[`&.${mn.ampmLandscape}`]:n.ampmLandscape},n.ampmSelection]})(({ownerState:s})=>re({display:"flex",flexDirection:"column",marginRight:"auto",marginLeft:12},s.isLandscape&&{margin:"4px 0 auto",flexDirection:"row",justifyContent:"space-around",width:"100%"},{[`& .${mn.ampmLabel}`]:{fontSize:17}}));function Di(s){const n=Is({props:s,name:"MuiDateTimePickerToolbar"}),{ampm:r,ampmInClock:a,value:u,onChange:l,view:h,isLandscape:m,onViewChange:v,toolbarFormat:b,toolbarPlaceholder:D="â€“â€“",views:S,disabled:g,readOnly:T,toolbarVariant:O="mobile"}=n,p=Ss(n,wi),y=n,C=Ks(),{meridiemMode:j,handleMeridiemChange:U}=zn(u,r,l),q=!!(r&&!a),w=O==="desktop",z=it(),te=fa(),I=Si(re({},y,{theme:te})),A=X=>r?C.format(X,"hours12h"):C.format(X,"hours24h"),L=i.useMemo(()=>u?b?C.formatByString(u,b):C.format(u,"shortDate"):D,[u,b,D,C]);return e.jsxs(Hr,re({toolbarTitle:z.dateTimePickerToolbarTitle,isLandscape:m,className:I.root},p,{ownerState:y,children:[e.jsxs(ki,{className:I.dateContainer,ownerState:y,children:[S.includes("year")&&e.jsx(et,{tabIndex:-1,variant:"subtitle1",onClick:()=>v("year"),selected:h==="year",value:u?C.format(u,"year"):"â€“"}),S.includes("day")&&e.jsx(et,{tabIndex:-1,variant:w?"h5":"h4",onClick:()=>v("day"),selected:h==="day",value:L})]}),e.jsxs(qr,{className:I.timeContainer,ownerState:y,children:[e.jsxs(Ii,{className:I.timeDigitsContainer,ownerState:y,children:[S.includes("hours")&&e.jsx(et,{variant:w?"h5":"h3",width:w&&!m?$t:void 0,onClick:()=>v("hours"),selected:h==="hours",value:u?A(u):"--"}),S.includes("minutes")&&e.jsxs(i.Fragment,{children:[e.jsx(br,{variant:w?"h5":"h3",value:":",className:I.separator,ownerState:y}),e.jsx(et,{variant:w?"h5":"h3",width:w&&!m?$t:void 0,onClick:()=>v("minutes"),selected:h==="minutes",value:u?C.format(u,"minutes"):"--"})]}),S.includes("seconds")&&e.jsxs(i.Fragment,{children:[e.jsx(br,{variant:w?"h5":"h3",value:":",className:I.separator,ownerState:y}),e.jsx(et,{variant:w?"h5":"h3",width:w&&!m?$t:void 0,onClick:()=>v("seconds"),selected:h==="seconds",value:u?C.format(u,"seconds"):"--"})]})]}),q&&!w&&e.jsxs(Ti,{className:I.ampmSelection,ownerState:y,children:[e.jsx(et,{variant:"subtitle2",selected:j==="am",typographyClassName:I.ampmLabel,value:Js(C,"am"),onClick:T?void 0:()=>U("am"),disabled:g}),e.jsx(et,{variant:"subtitle2",selected:j==="pm",typographyClassName:I.ampmLabel,value:Js(C,"pm"),onClick:T?void 0:()=>U("pm"),disabled:g})]}),r&&w&&e.jsx(et,{variant:"h5",onClick:()=>v("meridiem"),selected:h==="meridiem",value:u&&j?Js(C,j):"--",width:$t})]})]}))}function Gr(s,n){var r,a,u,l,h,m,v,b,D,S,g;const T=Ks(),O=Mr(),p=Is({props:s,name:n}),y=(r=p.ampm)!=null?r:T.is12HourCycleInCurrentLocale(),C=i.useMemo(()=>{var q;return((q=p.localeText)==null?void 0:q.toolbarTitle)==null?p.localeText:re({},p.localeText,{dateTimePickerToolbarTitle:p.localeText.toolbarTitle})},[p.localeText]),j=(a=p.slots)!=null?a:Fr(p.components),U=(u=p.slotProps)!=null?u:p.componentsProps;return re({},p,Ja({views:p.views,openTo:p.openTo,defaultViews:["year","day","hours","minutes"],defaultOpenTo:"day"}),{ampm:y,localeText:C,orientation:(l=p.orientation)!=null?l:"portrait",disableIgnoringDatePartForTimeValidation:(h=p.disableIgnoringDatePartForTimeValidation)!=null?h:!!(p.minDateTime||p.maxDateTime||p.disablePast||p.disableFuture),disableFuture:(m=p.disableFuture)!=null?m:!1,disablePast:(v=p.disablePast)!=null?v:!1,minDate:Kt(T,(b=p.minDateTime)!=null?b:p.minDate,O.minDate),maxDate:Kt(T,(D=p.maxDateTime)!=null?D:p.maxDate,O.maxDate),minTime:(S=p.minDateTime)!=null?S:p.minTime,maxTime:(g=p.maxDateTime)!=null?g:p.maxTime,slots:re({toolbar:Di,tabs:vi},j),slotProps:re({},U,{toolbar:re({ampm:y},U==null?void 0:U.toolbar)})})}function Pi(s){return Ns("MuiMultiSectionDigitalClock",s)}Ls("MuiMultiSectionDigitalClock",["root"]);function Mi(s){return Ns("MuiMultiSectionDigitalClockSection",s)}const $i=Ls("MuiMultiSectionDigitalClockSection",["root","item"]),Fi=["autoFocus","onChange","className","disabled","readOnly","items","active","slots","slotProps","skipDisabled"],Ri=s=>{const{classes:n}=s;return As({root:["root"],item:["item"]},Mi,n)},Ai=We(Ir,{name:"MuiMultiSectionDigitalClockSection",slot:"Root",overridesResolver:(s,n)=>n.root})(({theme:s,ownerState:n})=>({maxHeight:Ar,width:56,padding:0,overflow:"hidden","@media (prefers-reduced-motion: no-preference)":{scrollBehavior:n.alreadyRendered?"smooth":"auto"},"@media (pointer: fine)":{"&:hover":{overflowY:"auto"}},"@media (pointer: none), (pointer: coarse)":{overflowY:"auto"},"&:not(:first-of-type)":{borderLeft:`1px solid ${(s.vars||s).palette.divider}`},"&:after":{display:"block",content:'""',height:"calc(100% - 40px - 6px)"}})),zi=We(xe,{name:"MuiMultiSectionDigitalClockSection",slot:"Item",overridesResolver:(s,n)=>n.item})(({theme:s})=>({padding:8,margin:"2px 4px",width:$t,justifyContent:"center","&:first-of-type":{marginTop:4},"&:hover":{backgroundColor:s.vars?`rgba(${s.vars.palette.primary.mainChannel} / ${s.vars.palette.action.hoverOpacity})`:qt(s.palette.primary.main,s.palette.action.hoverOpacity)},"&.Mui-selected":{backgroundColor:(s.vars||s).palette.primary.main,color:(s.vars||s).palette.primary.contrastText,"&:focus-visible, &:hover":{backgroundColor:(s.vars||s).palette.primary.dark}},"&.Mui-focusVisible":{backgroundColor:s.vars?`rgba(${s.vars.palette.primary.mainChannel} / ${s.vars.palette.action.focusOpacity})`:qt(s.palette.primary.main,s.palette.action.focusOpacity)}})),Oi=i.forwardRef(function(n,r){var a;const u=i.useRef(null),l=Rr(r,u),h=i.useRef(null),m=Is({props:n,name:"MuiMultiSectionDigitalClockSection"}),{autoFocus:v,onChange:b,className:D,disabled:S,readOnly:g,items:T,active:O,slots:p,slotProps:y,skipDisabled:C}=m,j=Ss(m,Fi),U=i.useMemo(()=>re({},m,{alreadyRendered:!!u.current}),[m]),q=Ri(U),w=(a=p==null?void 0:p.digitalClockSectionItem)!=null?a:zi;return i.useEffect(()=>{if(u.current===null)return;const z=u.current.querySelector('[role="option"][aria-selected="true"]');if(O&&v&&z&&z.focus(),!z||h.current===z)return;h.current=z;const te=z.offsetTop;u.current.scrollTop=te-4}),e.jsx(Ai,re({ref:l,className:_s(q.root,D),ownerState:U,autoFocusItem:v&&O,role:"listbox"},j,{children:T.map(z=>{var te,I;if(C&&(te=z.isDisabled)!=null&&te.call(z,z.value))return null;const A=z.isSelected(z.value);return e.jsx(w,re({onClick:()=>!g&&b(z.value),selected:A,disabled:S||((I=z.isDisabled)==null?void 0:I.call(z,z.value)),disableRipple:g,role:"option","aria-disabled":g,"aria-label":z.ariaLabel,"aria-selected":A,className:q.item},y==null?void 0:y.digitalClockSectionItem,{children:z.label}),z.label)})}))}),Ei=({now:s,value:n,utils:r,ampm:a,isDisabled:u,resolveAriaLabel:l,timeStep:h})=>{const m=n?r.getHours(n):null,v=[],b=S=>m===null?!1:a?S===12?m===12||m===0:m===S||m-12===S:m===S,D=a?11:23;for(let S=0;S<=D;S+=h){let g=r.format(r.setHours(s,S),a?"hours12h":"hours24h");const T=l(parseInt(g,10).toString());g=r.formatNumber(g),v.push({value:S,label:g,isSelected:b,isDisabled:u,ariaLabel:T})}return v},vr=({value:s,utils:n,isDisabled:r,timeStep:a,resolveLabel:u,resolveAriaLabel:l,hasValue:h=!0})=>{const m=v=>s===null?!1:h&&s===v;return[...Array.from({length:Math.ceil(60/a)},(v,b)=>{const D=a*b;return{value:D,label:n.formatNumber(u(D)),isDisabled:r,isSelected:m,ariaLabel:l(D.toString())}})]},Hn=({value:s,referenceDate:n,utils:r,props:a,timezone:u})=>{const l=i.useMemo(()=>jt.getInitialReferenceValue({value:s,utils:r,props:a,referenceDate:n,granularity:Ka.day,timezone:u,getTodayDate:()=>Qa(r,u,"date")}),[]);return s!=null?s:l},Bi=["ampm","timeSteps","autoFocus","components","componentsProps","slots","slotProps","value","defaultValue","referenceDate","disableIgnoringDatePartForTimeValidation","maxTime","minTime","disableFuture","disablePast","minutesStep","shouldDisableClock","shouldDisableTime","onChange","view","views","openTo","onViewChange","focusedView","onFocusedViewChange","className","disabled","readOnly","skipDisabled","timezone"],_i=s=>{const{classes:n}=s;return As({root:["root"]},Pi,n)},Li=We(_n,{name:"MuiMultiSectionDigitalClock",slot:"Root",overridesResolver:(s,n)=>n.root})(({theme:s})=>({display:"flex",flexDirection:"row",width:"100%",borderBottom:`1px solid ${(s.vars||s).palette.divider}`})),Ni=i.forwardRef(function(n,r){const a=Ks(),u=Is({props:n,name:"MuiMultiSectionDigitalClock"}),{ampm:l=a.is12HourCycleInCurrentLocale(),timeSteps:h,autoFocus:m,components:v,componentsProps:b,slots:D,slotProps:S,value:g,defaultValue:T,referenceDate:O,disableIgnoringDatePartForTimeValidation:p=!1,maxTime:y,minTime:C,disableFuture:j,disablePast:U,minutesStep:q=1,shouldDisableClock:w,shouldDisableTime:z,onChange:te,view:I,views:A=["hours","minutes"],openTo:L,onViewChange:X,focusedView:Se,onFocusedViewChange:Ce,className:le,disabled:$,readOnly:f,skipDisabled:J=!1,timezone:ve}=u,B=Ss(u,Bi),{value:ae,handleValueChange:_e,timezone:R}=On({name:"MultiSectionDigitalClock",timezone:ve,value:g,defaultValue:T,onChange:te,valueManager:jt}),Z=it(),ce=En(R),me=i.useMemo(()=>re({hours:1,minutes:5,seconds:5},h),[h]),ge=Hn({value:ae,referenceDate:O,utils:a,props:u,timezone:R}),ts=Yt((ie,ne,fe)=>_e(ie,ne,fe)),Xe=i.useMemo(()=>!l||!A.includes("hours")||A.includes("meridiem")?A:[...A,"meridiem"],[l,A]),{view:Ge,setValueAndGoToNextView:Ke,focusedView:ns}=Bn({view:I,views:Xe,openTo:L,onViewChange:X,onChange:ts,focusedView:Se,onFocusedViewChange:Ce}),Ve=Yt(ie=>{Ke(ie,"finish","meridiem")}),{meridiemMode:Y,handleMeridiemChange:k}=zn(ge,l,Ve,"finish"),ee=i.useCallback((ie,ne)=>{const fe=rn(p,a),ms=ne==="hours"||ne==="minutes"&&Xe.includes("seconds"),Ds=({start:d,end:P})=>!(C&&fe(C,P)||y&&fe(d,y)||j&&fe(d,ce)||U&&fe(ce,ms?P:d)),Cs=(d,P=1)=>{if(d%P!==0||w!=null&&w(d,ne))return!1;if(z)switch(ne){case"hours":return!z(a.setHours(ge,d),"hours");case"minutes":return!z(a.setMinutes(ge,d),"minutes");case"seconds":return!z(a.setSeconds(ge,d),"seconds");default:return!1}return!0};switch(ne){case"hours":{const d=Xt(ie,Y,l),P=a.setHours(ge,d),se=a.setSeconds(a.setMinutes(P,0),0),K=a.setSeconds(a.setMinutes(P,59),59);return!Ds({start:se,end:K})||!Cs(d)}case"minutes":{const d=a.setMinutes(ge,ie),P=a.setSeconds(d,0),se=a.setSeconds(d,59);return!Ds({start:P,end:se})||!Cs(ie,q)}case"seconds":{const d=a.setSeconds(ge,ie);return!Ds({start:d,end:d})||!Cs(ie)}default:throw new Error("not supported")}},[l,ge,p,y,Y,C,q,w,z,a,j,U,ce,Xe]),oe=i.useCallback(ie=>{switch(ie){case"hours":return{onChange:ne=>{const fe=Xt(ne,Y,l);Ke(a.setHours(ge,fe),"finish","hours")},items:Ei({now:ce,value:ae,ampm:l,utils:a,isDisabled:ne=>$||ee(ne,"hours"),timeStep:me.hours,resolveAriaLabel:Z.hoursClockNumberText})};case"minutes":return{onChange:ne=>{Ke(a.setMinutes(ge,ne),"finish","minutes")},items:vr({value:a.getMinutes(ge),utils:a,isDisabled:ne=>$||ee(ne,"minutes"),resolveLabel:ne=>a.format(a.setMinutes(ce,ne),"minutes"),timeStep:me.minutes,hasValue:!!ae,resolveAriaLabel:Z.minutesClockNumberText})};case"seconds":return{onChange:ne=>{Ke(a.setSeconds(ge,ne),"finish","seconds")},items:vr({value:a.getSeconds(ge),utils:a,isDisabled:ne=>$||ee(ne,"seconds"),resolveLabel:ne=>a.format(a.setSeconds(ce,ne),"seconds"),timeStep:me.seconds,hasValue:!!ae,resolveAriaLabel:Z.secondsClockNumberText})};case"meridiem":{const ne=Js(a,"am"),fe=Js(a,"pm");return{onChange:k,items:[{value:"am",label:ne,isSelected:()=>!!ae&&Y==="am",ariaLabel:ne},{value:"pm",label:fe,isSelected:()=>!!ae&&Y==="pm",ariaLabel:fe}]}}default:throw new Error(`Unknown view: ${ie} found.`)}},[ce,ae,l,a,me.hours,me.minutes,me.seconds,Z.hoursClockNumberText,Z.minutesClockNumberText,Z.secondsClockNumberText,Y,Ke,ge,$,ee,k]),Pe=i.useMemo(()=>Xe.reduce((ie,ne)=>re({},ie,{[ne]:oe(ne)}),{}),[Xe,oe]),Te=u,Ts=_i(Te);return e.jsx(Li,re({ref:r,className:_s(Ts.root,le),ownerState:Te,role:"group"},B,{children:Object.entries(Pe).map(([ie,ne])=>e.jsx(Oi,{items:ne.items,onChange:ne.onChange,active:Ge===ie,autoFocus:m!=null?m:ns===ie,disabled:$,readOnly:f,slots:D!=null?D:v,slotProps:S!=null?S:b,skipDisabled:J,"aria-label":Z.selectViewText(ie)},ie))}))}),Ui=We("div")({display:"flex",margin:"0 auto"});function Wi(s){return Ns("MuiTimeClock",s)}Ls("MuiTimeClock",["root","arrowSwitcher"]);const kt=220,Es=36,Et={x:kt/2,y:kt/2},Jr={x:Et.x,y:0},Vi=Jr.x-Et.x,Hi=Jr.y-Et.y,qi=s=>s*(180/Math.PI),Qr=(s,n,r)=>{const a=n-Et.x,u=r-Et.y,l=Math.atan2(Vi,Hi)-Math.atan2(a,u);let h=qi(l);h=Math.round(h/s)*s,h%=360;const m=Math.floor(h/s)||0,v=cn(a,2)+cn(u,2),b=Math.sqrt(v);return{value:m,distance:b}},Gi=(s,n,r=1)=>{const a=r*6;let{value:u}=Qr(a,s,n);return u=u*r%60,u},Ji=(s,n,r)=>{const{value:a,distance:u}=Qr(30,s,n);let l=a||12;return r?l%=12:u<kt/2-Es&&(l+=12,l%=24),l};function Qi(s){return Ns("MuiClockPointer",s)}Ls("MuiClockPointer",["root","thumb"]);const Ki=["className","hasSelected","isInner","type","viewValue"],Yi=s=>{const{classes:n}=s;return As({root:["root"],thumb:["thumb"]},Qi,n)},Xi=We("div",{name:"MuiClockPointer",slot:"Root",overridesResolver:(s,n)=>n.root})(({theme:s,ownerState:n})=>re({width:2,backgroundColor:(s.vars||s).palette.primary.main,position:"absolute",left:"calc(50% - 1px)",bottom:"50%",transformOrigin:"center bottom 0px"},n.shouldAnimate&&{transition:s.transitions.create(["transform","height"])})),Zi=We("div",{name:"MuiClockPointer",slot:"Thumb",overridesResolver:(s,n)=>n.thumb})(({theme:s,ownerState:n})=>re({width:4,height:4,backgroundColor:(s.vars||s).palette.primary.contrastText,borderRadius:"50%",position:"absolute",top:-21,left:`calc(50% - ${Es/2}px)`,border:`${(Es-4)/2}px solid ${(s.vars||s).palette.primary.main}`,boxSizing:"content-box"},n.hasSelected&&{backgroundColor:(s.vars||s).palette.primary.main}));function el(s){const n=Is({props:s,name:"MuiClockPointer"}),{className:r,isInner:a,type:u,viewValue:l}=n,h=Ss(n,Ki),m=i.useRef(u);i.useEffect(()=>{m.current=u},[u]);const v=re({},n,{shouldAnimate:m.current!==u}),b=Yi(v),D=()=>{let g=360/(u==="hours"?12:60)*l;return u==="hours"&&l>12&&(g-=360),{height:Math.round((a?.26:.4)*kt),transform:`rotateZ(${g}deg)`}};return e.jsx(Xi,re({style:D(),className:_s(r,b.root),ownerState:v},h,{children:e.jsx(Zi,{ownerState:v,className:b.thumb})}))}function sl(s){return Ns("MuiClock",s)}Ls("MuiClock",["root","clock","wrapper","squareMask","pin","amButton","pmButton","meridiemText"]);const tl=s=>{const{classes:n}=s;return As({root:["root"],clock:["clock"],wrapper:["wrapper"],squareMask:["squareMask"],pin:["pin"],amButton:["amButton"],pmButton:["pmButton"],meridiemText:["meridiemText"]},sl,n)},nl=We("div",{name:"MuiClock",slot:"Root",overridesResolver:(s,n)=>n.root})(({theme:s})=>({display:"flex",justifyContent:"center",alignItems:"center",margin:s.spacing(2)})),rl=We("div",{name:"MuiClock",slot:"Clock",overridesResolver:(s,n)=>n.clock})({backgroundColor:"rgba(0,0,0,.07)",borderRadius:"50%",height:220,width:220,flexShrink:0,position:"relative",pointerEvents:"none"}),al=We("div",{name:"MuiClock",slot:"Wrapper",overridesResolver:(s,n)=>n.wrapper})({"&:focus":{outline:"none"}}),ol=We("div",{name:"MuiClock",slot:"SquareMask",overridesResolver:(s,n)=>n.squareMask})(({ownerState:s})=>re({width:"100%",height:"100%",position:"absolute",pointerEvents:"auto",outline:0,touchAction:"none",userSelect:"none"},s.disabled?{}:{"@media (pointer: fine)":{cursor:"pointer",borderRadius:"50%"},"&:active":{cursor:"move"}})),il=We("div",{name:"MuiClock",slot:"Pin",overridesResolver:(s,n)=>n.pin})(({theme:s})=>({width:6,height:6,borderRadius:"50%",backgroundColor:(s.vars||s).palette.primary.main,position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)"})),ll=We(be,{name:"MuiClock",slot:"AmButton",overridesResolver:(s,n)=>n.amButton})(({theme:s,ownerState:n})=>re({zIndex:1,position:"absolute",bottom:8,left:8,paddingLeft:4,paddingRight:4,width:Es},n.meridiemMode==="am"&&{backgroundColor:(s.vars||s).palette.primary.main,color:(s.vars||s).palette.primary.contrastText,"&:hover":{backgroundColor:(s.vars||s).palette.primary.light}})),cl=We(be,{name:"MuiClock",slot:"PmButton",overridesResolver:(s,n)=>n.pmButton})(({theme:s,ownerState:n})=>re({zIndex:1,position:"absolute",bottom:8,right:8,paddingLeft:4,paddingRight:4,width:Es},n.meridiemMode==="pm"&&{backgroundColor:(s.vars||s).palette.primary.main,color:(s.vars||s).palette.primary.contrastText,"&:hover":{backgroundColor:(s.vars||s).palette.primary.light}})),Cr=We(t,{name:"MuiClock",slot:"meridiemText",overridesResolver:(s,n)=>n.meridiemText})({overflow:"hidden",whiteSpace:"nowrap",textOverflow:"ellipsis"});function dl(s){const n=Is({props:s,name:"MuiClock"}),{ampm:r,ampmInClock:a,autoFocus:u,children:l,value:h,handleMeridiemChange:m,isTimeDisabled:v,meridiemMode:b,minutesStep:D=1,onChange:S,selectedId:g,type:T,viewValue:O,disabled:p,readOnly:y,className:C}=n,j=n,U=Ks(),q=it(),w=i.useRef(!1),z=tl(j),te=v(O,T),I=!r&&T==="hours"&&(O<1||O>12),A=(B,ae)=>{p||y||v(B,T)||S(B,ae)},L=(B,ae)=>{let{offsetX:_e,offsetY:R}=B;if(_e===void 0){const ce=B.target.getBoundingClientRect();_e=B.changedTouches[0].clientX-ce.left,R=B.changedTouches[0].clientY-ce.top}const Z=T==="seconds"||T==="minutes"?Gi(_e,R,D):Ji(_e,R,!!r);A(Z,ae)},X=B=>{w.current=!0,L(B,"shallow")},Se=B=>{w.current&&(L(B,"finish"),w.current=!1)},Ce=B=>{B.buttons>0&&L(B.nativeEvent,"shallow")},le=B=>{w.current&&(w.current=!1),L(B.nativeEvent,"finish")},$=i.useMemo(()=>T==="hours"?!0:O%5===0,[T,O]),f=T==="minutes"?D:1,J=i.useRef(null);Ya(()=>{u&&J.current.focus()},[u]);const ve=B=>{if(!w.current)switch(B.key){case"Home":A(0,"partial"),B.preventDefault();break;case"End":A(T==="minutes"?59:23,"partial"),B.preventDefault();break;case"ArrowUp":A(O+f,"partial"),B.preventDefault();break;case"ArrowDown":A(O-f,"partial"),B.preventDefault();break}};return e.jsxs(nl,{className:_s(C,z.root),children:[e.jsxs(rl,{className:z.clock,children:[e.jsx(ol,{onTouchMove:X,onTouchEnd:Se,onMouseUp:le,onMouseMove:Ce,ownerState:{disabled:p},className:z.squareMask}),!te&&e.jsxs(i.Fragment,{children:[e.jsx(il,{className:z.pin}),h!=null&&e.jsx(el,{type:T,viewValue:O,isInner:I,hasSelected:$})]}),e.jsx(al,{"aria-activedescendant":g,"aria-label":q.clockLabelText(T,h,U),ref:J,role:"listbox",onKeyDown:ve,tabIndex:0,className:z.wrapper,children:l})]}),r&&a&&e.jsxs(i.Fragment,{children:[e.jsx(ll,{onClick:y?void 0:()=>m("am"),disabled:p||b===null,ownerState:j,className:z.amButton,title:Js(U,"am"),children:e.jsx(Cr,{variant:"caption",className:z.meridiemText,children:Js(U,"am")})}),e.jsx(cl,{disabled:p||b===null,onClick:y?void 0:()=>m("pm"),ownerState:j,className:z.pmButton,title:Js(U,"pm"),children:e.jsx(Cr,{variant:"caption",className:z.meridiemText,children:Js(U,"pm")})})]})]})}function ul(s){return Ns("MuiClockNumber",s)}const Nt=Ls("MuiClockNumber",["root","selected","disabled"]),hl=["className","disabled","index","inner","label","selected"],ml=s=>{const{classes:n,selected:r,disabled:a}=s;return As({root:["root",r&&"selected",a&&"disabled"]},ul,n)},xl=We("span",{name:"MuiClockNumber",slot:"Root",overridesResolver:(s,n)=>[n.root,{[`&.${Nt.disabled}`]:n.disabled},{[`&.${Nt.selected}`]:n.selected}]})(({theme:s,ownerState:n})=>re({height:Es,width:Es,position:"absolute",left:`calc((100% - ${Es}px) / 2)`,display:"inline-flex",justifyContent:"center",alignItems:"center",borderRadius:"50%",color:(s.vars||s).palette.text.primary,fontFamily:s.typography.fontFamily,"&:focused":{backgroundColor:(s.vars||s).palette.background.paper},[`&.${Nt.selected}`]:{color:(s.vars||s).palette.primary.contrastText},[`&.${Nt.disabled}`]:{pointerEvents:"none",color:(s.vars||s).palette.text.disabled}},n.inner&&re({},s.typography.body2,{color:(s.vars||s).palette.text.secondary})));function Kr(s){const n=Is({props:s,name:"MuiClockNumber"}),{className:r,disabled:a,index:u,inner:l,label:h,selected:m}=n,v=Ss(n,hl),b=n,D=ml(b),S=u%12/12*Math.PI*2-Math.PI/2,g=(kt-Es-2)/2*(l?.65:1),T=Math.round(Math.cos(S)*g),O=Math.round(Math.sin(S)*g);return e.jsx(xl,re({className:_s(r,D.root),"aria-disabled":a?!0:void 0,"aria-selected":m?!0:void 0,role:"option",style:{transform:`translate(${T}px, ${O+(kt-Es)/2}px`},ownerState:b},v,{children:h}))}const pl=({ampm:s,value:n,getClockNumberText:r,isDisabled:a,selectedId:u,utils:l})=>{const h=n?l.getHours(n):null,m=[],v=s?1:0,b=s?12:23,D=S=>h===null?!1:s?S===12?h===12||h===0:h===S||h-12===S:h===S;for(let S=v;S<=b;S+=1){let g=S.toString();S===0&&(g="00");const T=!s&&(S===0||S>12);g=l.formatNumber(g);const O=D(S);m.push(e.jsx(Kr,{id:O?u:void 0,index:S,inner:T,selected:O,disabled:a(S),label:g,"aria-label":r(g)},S))}return m},wr=({utils:s,value:n,isDisabled:r,getClockNumberText:a,selectedId:u})=>{const l=s.formatNumber;return[[5,l("05")],[10,l("10")],[15,l("15")],[20,l("20")],[25,l("25")],[30,l("30")],[35,l("35")],[40,l("40")],[45,l("45")],[50,l("50")],[55,l("55")],[0,l("00")]].map(([h,m],v)=>{const b=h===n;return e.jsx(Kr,{label:m,id:b?u:void 0,index:v+1,inner:!1,disabled:r(h),selected:b,"aria-label":a(m)},h)})},gl=["ampm","ampmInClock","autoFocus","components","componentsProps","slots","slotProps","value","defaultValue","referenceDate","disableIgnoringDatePartForTimeValidation","maxTime","minTime","disableFuture","disablePast","minutesStep","shouldDisableClock","shouldDisableTime","showViewSwitcher","onChange","view","views","openTo","onViewChange","focusedView","onFocusedViewChange","className","disabled","readOnly","timezone"],jl=s=>{const{classes:n}=s;return As({root:["root"],arrowSwitcher:["arrowSwitcher"]},Wi,n)},fl=We(_n,{name:"MuiTimeClock",slot:"Root",overridesResolver:(s,n)=>n.root})({display:"flex",flexDirection:"column",position:"relative"}),yl=We(Za,{name:"MuiTimeClock",slot:"ArrowSwitcher",overridesResolver:(s,n)=>n.arrowSwitcher})({position:"absolute",right:12,top:15}),bl=["hours","minutes"],vl=i.forwardRef(function(n,r){const a=Ks(),u=Is({props:n,name:"MuiTimeClock"}),{ampm:l=a.is12HourCycleInCurrentLocale(),ampmInClock:h=!1,autoFocus:m,components:v,componentsProps:b,slots:D,slotProps:S,value:g,defaultValue:T,referenceDate:O,disableIgnoringDatePartForTimeValidation:p=!1,maxTime:y,minTime:C,disableFuture:j,disablePast:U,minutesStep:q=1,shouldDisableClock:w,shouldDisableTime:z,showViewSwitcher:te,onChange:I,view:A,views:L=bl,openTo:X,onViewChange:Se,focusedView:Ce,onFocusedViewChange:le,className:$,disabled:f,readOnly:J,timezone:ve}=u,B=Ss(u,gl),ae=D!=null?D:Fr(v),_e=S!=null?S:b,{value:R,handleValueChange:Z,timezone:ce}=On({name:"TimeClock",timezone:ve,value:g,defaultValue:T,onChange:I,valueManager:jt}),me=Hn({value:R,referenceDate:O,utils:a,props:u,timezone:ce}),ge=it(),ts=En(ce),{view:Xe,setView:Ge,previousView:Ke,nextView:ns,setValueAndGoToNextView:Ve}=Bn({view:A,views:L,openTo:X,onViewChange:Se,onChange:Z,focusedView:Ce,onFocusedViewChange:le}),{meridiemMode:Y,handleMeridiemChange:k}=zn(me,l,Ve),ee=i.useCallback((ie,ne)=>{const fe=rn(p,a),ms=ne==="hours"||ne==="minutes"&&L.includes("seconds"),Ds=({start:d,end:P})=>!(C&&fe(C,P)||y&&fe(d,y)||j&&fe(d,ts)||U&&fe(ts,ms?P:d)),Cs=(d,P=1)=>{if(d%P!==0||w!=null&&w(d,ne))return!1;if(z)switch(ne){case"hours":return!z(a.setHours(me,d),"hours");case"minutes":return!z(a.setMinutes(me,d),"minutes");case"seconds":return!z(a.setSeconds(me,d),"seconds");default:return!1}return!0};switch(ne){case"hours":{const d=Xt(ie,Y,l),P=a.setHours(me,d),se=a.setSeconds(a.setMinutes(P,0),0),K=a.setSeconds(a.setMinutes(P,59),59);return!Ds({start:se,end:K})||!Cs(d)}case"minutes":{const d=a.setMinutes(me,ie),P=a.setSeconds(d,0),se=a.setSeconds(d,59);return!Ds({start:P,end:se})||!Cs(ie,q)}case"seconds":{const d=a.setSeconds(me,ie);return!Ds({start:d,end:d})||!Cs(ie)}default:throw new Error("not supported")}},[l,me,p,y,Y,C,q,w,z,a,j,U,ts,L]),oe=Xa(),Pe=i.useMemo(()=>{switch(Xe){case"hours":return{onChange:(ne,fe)=>{const ms=Xt(ne,Y,l);Ve(a.setHours(me,ms),fe)},viewValue:a.getHours(me),children:pl({value:R,utils:a,ampm:l,getClockNumberText:ge.hoursClockNumberText,isDisabled:ne=>f||ee(ne,"hours"),selectedId:oe})};case"minutes":{const ie=a.getMinutes(me);return{viewValue:ie,onChange:(fe,ms)=>{Ve(a.setMinutes(me,fe),ms)},children:wr({utils:a,value:ie,getClockNumberText:ge.minutesClockNumberText,isDisabled:fe=>f||ee(fe,"minutes"),selectedId:oe})}}case"seconds":{const ie=a.getSeconds(me);return{viewValue:ie,onChange:(fe,ms)=>{Ve(a.setSeconds(me,fe),ms)},children:wr({utils:a,value:ie,getClockNumberText:ge.secondsClockNumberText,isDisabled:fe=>f||ee(fe,"seconds"),selectedId:oe})}}default:throw new Error("You must provide the type for ClockView")}},[Xe,a,R,l,ge.hoursClockNumberText,ge.minutesClockNumberText,ge.secondsClockNumberText,Y,Ve,me,ee,oe,f]),Te=u,Ts=jl(Te);return e.jsxs(fl,re({ref:r,className:_s(Ts.root,$),ownerState:Te},B,{children:[e.jsx(dl,re({autoFocus:m!=null?m:!!Ce,ampmInClock:h&&L.includes("hours"),value:R,type:Xe,ampm:l,minutesStep:q,isTimeDisabled:ee,meridiemMode:Y,handleMeridiemChange:k,selectedId:oe,disabled:f,readOnly:J},Pe)),te&&e.jsx(yl,{className:Ts.arrowSwitcher,slots:ae,slotProps:_e,onGoToPrevious:()=>Ge(Ke),isPreviousDisabled:!Ke,previousLabel:ge.openPreviousView,onGoToNext:()=>Ge(ns),isNextDisabled:!ns,nextLabel:ge.openNextView,ownerState:Te})]}))});function Cl(s){return Ns("MuiDigitalClock",s)}const wl=Ls("MuiDigitalClock",["root","list","item"]),Sl=["ampm","timeStep","autoFocus","components","componentsProps","slots","slotProps","value","defaultValue","referenceDate","disableIgnoringDatePartForTimeValidation","maxTime","minTime","disableFuture","disablePast","minutesStep","shouldDisableClock","shouldDisableTime","onChange","view","openTo","onViewChange","focusedView","onFocusedViewChange","className","disabled","readOnly","views","skipDisabled","timezone"],kl=s=>{const{classes:n}=s;return As({root:["root"],list:["list"],item:["item"]},Cl,n)},Il=We(_n,{name:"MuiDigitalClock",slot:"Root",overridesResolver:(s,n)=>n.root})(({ownerState:s})=>({overflowY:"auto",width:"100%","@media (prefers-reduced-motion: no-preference)":{scrollBehavior:s.alreadyRendered?"smooth":"auto"},maxHeight:Ar})),Tl=We(Ir,{name:"MuiDigitalClock",slot:"List",overridesResolver:(s,n)=>n.list})({padding:0}),Dl=We(xe,{name:"MuiDigitalClock",slot:"Item",overridesResolver:(s,n)=>n.item})(({theme:s})=>({padding:"8px 16px",margin:"2px 4px","&:first-of-type":{marginTop:4},"&:hover":{backgroundColor:s.vars?`rgba(${s.vars.palette.primary.mainChannel} / ${s.vars.palette.action.hoverOpacity})`:qt(s.palette.primary.main,s.palette.action.hoverOpacity)},"&.Mui-selected":{backgroundColor:(s.vars||s).palette.primary.main,color:(s.vars||s).palette.primary.contrastText,"&:focus-visible, &:hover":{backgroundColor:(s.vars||s).palette.primary.dark}},"&.Mui-focusVisible":{backgroundColor:s.vars?`rgba(${s.vars.palette.primary.mainChannel} / ${s.vars.palette.action.focusOpacity})`:qt(s.palette.primary.main,s.palette.action.focusOpacity)}})),Pl=i.forwardRef(function(n,r){var a,u,l;const h=Ks(),m=i.useRef(null),v=Rr(r,m),b=Is({props:n,name:"MuiDigitalClock"}),{ampm:D=h.is12HourCycleInCurrentLocale(),timeStep:S=30,autoFocus:g,components:T,componentsProps:O,slots:p,slotProps:y,value:C,defaultValue:j,referenceDate:U,disableIgnoringDatePartForTimeValidation:q=!1,maxTime:w,minTime:z,disableFuture:te,disablePast:I,minutesStep:A=1,shouldDisableClock:L,shouldDisableTime:X,onChange:Se,view:Ce,openTo:le,onViewChange:$,focusedView:f,onFocusedViewChange:J,className:ve,disabled:B,readOnly:ae,views:_e=["hours"],skipDisabled:R=!1,timezone:Z}=b,ce=Ss(b,Sl),{value:me,handleValueChange:ge,timezone:ts}=On({name:"DigitalClock",timezone:Z,value:C,defaultValue:j,onChange:Se,valueManager:jt}),Xe=it(),Ge=En(ts),Ke=i.useMemo(()=>re({},b,{alreadyRendered:!!m.current}),[b]),ns=kl(Ke),Ve=(a=(u=p==null?void 0:p.digitalClockItem)!=null?u:T==null?void 0:T.DigitalClockItem)!=null?a:Dl,Y=$r({elementType:Ve,externalSlotProps:(l=y==null?void 0:y.digitalClockItem)!=null?l:O==null?void 0:O.digitalClockItem,ownerState:{},className:ns.item}),k=Hn({value:me,referenceDate:U,utils:h,props:b,timezone:ts}),ee=Yt(ie=>ge(ie,"finish","hours")),{setValueAndGoToNextView:oe}=Bn({view:Ce,views:_e,openTo:le,onViewChange:$,onChange:ee,focusedView:f,onFocusedViewChange:J}),Pe=Yt(ie=>{oe(ie,"finish")});i.useEffect(()=>{if(m.current===null)return;const ie=m.current.querySelector('[role="listbox"] [role="option"][aria-selected="true"]');if(!ie)return;const ne=ie.offsetTop;m.current.scrollTop=ne-4});const Te=i.useCallback(ie=>{const ne=rn(q,h),fe=()=>!(z&&ne(z,ie)||w&&ne(ie,w)||te&&ne(ie,Ge)||I&&ne(Ge,ie)),ms=()=>h.getMinutes(ie)%A!==0||L!=null&&L(h.toJsDate(ie).getTime(),"hours")?!1:X?!X(ie,"hours"):!0;return!fe()||!ms()},[q,h,z,w,te,Ge,I,A,L,X]),Ts=i.useMemo(()=>{const ie=h.startOfDay(k);return[ie,...Array.from({length:Math.ceil(24*60/S)-1},(ne,fe)=>h.addMinutes(ie,S*(fe+1)))]},[k,S,h]);return e.jsx(Il,re({ref:v,className:_s(ns.root,ve),ownerState:Ke},ce,{children:e.jsx(Tl,{autoFocusItem:g||!!f,role:"listbox","aria-label":Xe.timePickerToolbarTitle,className:ns.list,children:Ts.map(ie=>{if(R&&Te(ie))return null;const ne=h.isEqual(ie,me);return e.jsx(Ve,re({onClick:()=>!ae&&Pe(ie),selected:ne,disabled:B||Te(ie),disableRipple:ae,role:"option","aria-disabled":ae,"aria-selected":ne},Y,{children:h.format(ie,D?"fullTime12h":"fullTime24h")}),h.toISO(ie))})})}))}),xn=({view:s,onViewChange:n,focusedView:r,onFocusedViewChange:a,views:u,value:l,defaultValue:h,referenceDate:m,onChange:v,className:b,classes:D,disableFuture:S,disablePast:g,minTime:T,maxTime:O,shouldDisableTime:p,shouldDisableClock:y,minutesStep:C,ampm:j,ampmInClock:U,components:q,componentsProps:w,slots:z,slotProps:te,readOnly:I,disabled:A,sx:L,autoFocus:X,showViewSwitcher:Se,disableIgnoringDatePartForTimeValidation:Ce,timezone:le})=>e.jsx(vl,{view:s,onViewChange:n,focusedView:r&&Ot(r)?r:null,onFocusedViewChange:a,views:u.filter(Ot),value:l,defaultValue:h,referenceDate:m,onChange:v,className:b,classes:D,disableFuture:S,disablePast:g,minTime:T,maxTime:O,shouldDisableTime:p,shouldDisableClock:y,minutesStep:C,ampm:j,ampmInClock:U,components:q,componentsProps:w,slots:z,slotProps:te,readOnly:I,disabled:A,sx:L,autoFocus:X,showViewSwitcher:Se,disableIgnoringDatePartForTimeValidation:Ce,timezone:le}),Ml=({view:s,onViewChange:n,focusedView:r,onFocusedViewChange:a,views:u,value:l,defaultValue:h,referenceDate:m,onChange:v,className:b,classes:D,disableFuture:S,disablePast:g,minTime:T,maxTime:O,shouldDisableTime:p,shouldDisableClock:y,minutesStep:C,ampm:j,components:U,componentsProps:q,slots:w,slotProps:z,readOnly:te,disabled:I,sx:A,autoFocus:L,disableIgnoringDatePartForTimeValidation:X,timeSteps:Se,skipDisabled:Ce,timezone:le})=>e.jsx(Pl,{view:s,onViewChange:n,focusedView:r,onFocusedViewChange:a,views:u.filter(Ot),value:l,defaultValue:h,referenceDate:m,onChange:v,className:b,classes:D,disableFuture:S,disablePast:g,minTime:T,maxTime:O,shouldDisableTime:p,shouldDisableClock:y,minutesStep:C,ampm:j,components:U,componentsProps:q,slots:w,slotProps:z,readOnly:te,disabled:I,sx:A,autoFocus:L,disableIgnoringDatePartForTimeValidation:X,timeStep:Se==null?void 0:Se.minutes,skipDisabled:Ce,timezone:le}),$l=({view:s,onViewChange:n,focusedView:r,onFocusedViewChange:a,views:u,value:l,defaultValue:h,referenceDate:m,onChange:v,className:b,classes:D,disableFuture:S,disablePast:g,minTime:T,maxTime:O,shouldDisableTime:p,shouldDisableClock:y,minutesStep:C,ampm:j,components:U,componentsProps:q,slots:w,slotProps:z,readOnly:te,disabled:I,sx:A,autoFocus:L,disableIgnoringDatePartForTimeValidation:X,timeSteps:Se,skipDisabled:Ce,timezone:le})=>e.jsx(Ni,{view:s,onViewChange:n,focusedView:r,onFocusedViewChange:a,views:u.filter(Ot),value:l,defaultValue:h,referenceDate:m,onChange:v,className:b,classes:D,disableFuture:S,disablePast:g,minTime:T,maxTime:O,shouldDisableTime:p,shouldDisableClock:y,minutesStep:C,ampm:j,components:U,componentsProps:q,slots:w,slotProps:z,readOnly:te,disabled:I,sx:A,autoFocus:L,disableIgnoringDatePartForTimeValidation:X,timeSteps:Se,skipDisabled:Ce,timezone:le}),dt=({view:s,onViewChange:n,views:r,focusedView:a,onFocusedViewChange:u,value:l,defaultValue:h,referenceDate:m,onChange:v,className:b,classes:D,disableFuture:S,disablePast:g,minDate:T,minTime:O,maxDate:p,maxTime:y,shouldDisableDate:C,shouldDisableMonth:j,shouldDisableYear:U,shouldDisableTime:q,shouldDisableClock:w,reduceAnimations:z,minutesStep:te,ampm:I,onMonthChange:A,monthsPerRow:L,onYearChange:X,yearsPerRow:Se,defaultCalendarMonth:Ce,components:le,componentsProps:$,slots:f,slotProps:J,loading:ve,renderLoading:B,disableHighlightToday:ae,readOnly:_e,disabled:R,showDaysOutsideCurrentMonth:Z,dayOfWeekFormatter:ce,sx:me,autoFocus:ge,fixedWeekNumber:ts,displayWeekNumber:Xe,timezone:Ge,disableIgnoringDatePartForTimeValidation:Ke,timeSteps:ns,skipDisabled:Ve,timeViewsCount:Y,shouldRenderTimeInASingleColumn:k})=>{var ee,oe;const Pe=!!((ee=Ln((oe=J==null?void 0:J.actionBar)!=null?oe:$==null?void 0:$.actionBar,{}))!=null&&(ee=ee.actions)!=null&&ee.length),Te={view:tt(s)?s:"hours",onViewChange:n,focusedView:a&&tt(a)?a:null,onFocusedViewChange:u,views:r.filter(tt),value:l,defaultValue:h,referenceDate:m,onChange:v,className:b,classes:D,disableFuture:S,disablePast:g,minTime:O,maxTime:y,shouldDisableTime:q,shouldDisableClock:w,minutesStep:te,ampm:I,components:le,componentsProps:$,slots:f,slotProps:J,readOnly:_e,disabled:R,autoFocus:ge,disableIgnoringDatePartForTimeValidation:Ke,timeSteps:ns,skipDisabled:Ve,timezone:Ge};return e.jsxs(i.Fragment,{children:[e.jsxs(Ui,{children:[e.jsx(eo,{view:Wt(s)?s:"day",onViewChange:n,views:r.filter(Wt),focusedView:a&&Wt(a)?a:null,onFocusedViewChange:u,value:l,defaultValue:h,referenceDate:m,onChange:v,className:b,classes:D,disableFuture:S,disablePast:g,minDate:T,maxDate:p,shouldDisableDate:C,shouldDisableMonth:j,shouldDisableYear:U,reduceAnimations:z,onMonthChange:A,monthsPerRow:L,onYearChange:X,yearsPerRow:Se,defaultCalendarMonth:Ce,components:le,componentsProps:$,slots:f,slotProps:J,loading:ve,renderLoading:B,disableHighlightToday:ae,readOnly:_e,disabled:R,showDaysOutsideCurrentMonth:Z,dayOfWeekFormatter:ce,sx:me,autoFocus:ge,fixedWeekNumber:ts,displayWeekNumber:Xe,timezone:Ge}),Y>0&&e.jsxs(i.Fragment,{children:[e.jsx(ks,{orientation:"vertical"}),k?Ml(re({},Te,{view:"hours",views:["hours"],focusedView:a&&tt(a)?"hours":null,sx:re({width:"auto",[`&.${wl.root}`]:{maxHeight:so}},Array.isArray(me)?me:[me])})):$l(re({},Te,{view:tt(s)?s:"hours",views:r.filter(tt),focusedView:a&&tt(a)?a:null,sx:re({borderBottom:0,width:"auto",[`.${$i.root}`]:{maxHeight:"100%"}},Array.isArray(me)?me:[me])}))]})]}),Pe&&e.jsx(ks,{})]})},Fl=["views","format"],Yr=(s,n)=>{let{views:r,format:a}=n,u=Ss(n,Fl);if(a)return a;const l=[],h=[];if(r.forEach(b=>{Ot(b)?h.push(b):l.push(b)}),h.length===0)return rr(s,re({views:l},u),!1);if(l.length===0)return ar(s,re({views:h},u));const m=ar(s,re({views:h},u));return`${rr(s,re({views:l},u),!1)} ${m}`},Rl=(s,n,r)=>r?n.filter(a=>!tt(a)||a==="hours"):s?[...n,"meridiem"]:n,Al=(s,n)=>{var r,a;return 24*60/(((r=s.hours)!=null?r:1)*((a=s.minutes)!=null?a:5))<=n};function zl({thresholdToRenderTimeInASingleColumn:s,ampm:n,timeSteps:r,views:a}){const u=s!=null?s:24,l=re({hours:1,minutes:5,seconds:5},r),h=Al(l,u);return{thresholdToRenderTimeInASingleColumn:u,timeSteps:l,shouldRenderTimeInASingleColumn:h,views:Rl(n,a,h)}}const Xr=i.forwardRef(function(n,r){var a,u,l,h,m,v,b;const D=it(),S=Ks(),g=Gr(n,"MuiDesktopDateTimePicker"),{shouldRenderTimeInASingleColumn:T,thresholdToRenderTimeInASingleColumn:O,views:p,timeSteps:y}=zl(g),C=!g.viewRenderers||Object.keys(g.viewRenderers).length===0,j=C?{day:dt,month:dt,year:dt,hours:dt,minutes:dt,seconds:dt,meridiem:dt}:re({day:vt,month:vt,year:vt,hours:null,minutes:null,seconds:null,meridiem:null},g.viewRenderers),U=(a=g.ampmInClock)!=null?a:!0,q=C?["accept"]:[],w=re({},g,{viewRenderers:j,format:Yr(S,g),views:p,yearsPerRow:(u=g.yearsPerRow)!=null?u:4,ampmInClock:U,timeSteps:y,thresholdToRenderTimeInASingleColumn:O,shouldRenderTimeInASingleColumn:T,slots:re({field:Vr,openPickerIcon:to},g.slots),slotProps:re({},g.slotProps,{field:te=>{var I;return re({},Ln((I=g.slotProps)==null?void 0:I.field,te),zr(g),{ref:r})},toolbar:re({hidden:!0,ampmInClock:U,toolbarVariant:C?"desktop":"mobile"},(l=g.slotProps)==null?void 0:l.toolbar),tabs:re({hidden:!0},(h=g.slotProps)==null?void 0:h.tabs),actionBar:re({actions:q},(m=g.slotProps)==null?void 0:m.actionBar)})}),{renderPicker:z}=no({props:w,valueManager:jt,valueType:"date-time",getOpenDialogAriaText:(v=(b=w.localeText)==null?void 0:b.openDatePickerDialogue)!=null?v:D.openDatePickerDialogue,validator:Vn});return z()});Xr.propTypes={ampm:x.bool,ampmInClock:x.bool,autoFocus:x.bool,className:x.string,closeOnSelect:x.bool,components:x.object,componentsProps:x.object,dayOfWeekFormatter:x.func,defaultCalendarMonth:x.any,defaultValue:x.any,disabled:x.bool,disableFuture:x.bool,disableHighlightToday:x.bool,disableIgnoringDatePartForTimeValidation:x.bool,disableOpenPicker:x.bool,disablePast:x.bool,displayWeekNumber:x.bool,fixedWeekNumber:x.number,format:x.string,formatDensity:x.oneOf(["dense","spacious"]),inputRef:Or,label:x.node,loading:x.bool,localeText:x.object,maxDate:x.any,maxDateTime:x.any,maxTime:x.any,minDate:x.any,minDateTime:x.any,minTime:x.any,minutesStep:x.number,monthsPerRow:x.oneOf([3,4]),name:x.string,onAccept:x.func,onChange:x.func,onClose:x.func,onError:x.func,onMonthChange:x.func,onOpen:x.func,onSelectedSectionsChange:x.func,onViewChange:x.func,onYearChange:x.func,open:x.bool,openTo:x.oneOf(["day","hours","meridiem","minutes","month","seconds","year"]),orientation:x.oneOf(["landscape","portrait"]),readOnly:x.bool,reduceAnimations:x.bool,referenceDate:x.any,renderLoading:x.func,selectedSections:x.oneOfType([x.oneOf(["all","day","hours","meridiem","minutes","month","seconds","weekDay","year"]),x.number,x.shape({endIndex:x.number.isRequired,startIndex:x.number.isRequired})]),shouldDisableClock:x.func,shouldDisableDate:x.func,shouldDisableMonth:x.func,shouldDisableTime:x.func,shouldDisableYear:x.func,showDaysOutsideCurrentMonth:x.bool,skipDisabled:x.bool,slotProps:x.object,slots:x.object,sx:x.oneOfType([x.arrayOf(x.oneOfType([x.func,x.object,x.bool])),x.func,x.object]),thresholdToRenderTimeInASingleColumn:x.number,timeSteps:x.shape({hours:x.number,minutes:x.number,seconds:x.number}),timezone:x.string,value:x.any,view:x.oneOf(["day","hours","meridiem","minutes","month","seconds","year"]),viewRenderers:x.shape({day:x.func,hours:x.func,meridiem:x.func,minutes:x.func,month:x.func,seconds:x.func,year:x.func}),views:x.arrayOf(x.oneOf(["day","hours","minutes","month","seconds","year"]).isRequired),yearsPerRow:x.oneOf([3,4])};const Zr=i.forwardRef(function(n,r){var a,u,l,h,m;const v=it(),b=Ks(),D=Gr(n,"MuiMobileDateTimePicker"),S=re({day:vt,month:vt,year:vt,hours:xn,minutes:xn,seconds:xn},D.viewRenderers),g=(a=D.ampmInClock)!=null?a:!1,T=re({},D,{viewRenderers:S,format:Yr(b,D),ampmInClock:g,slots:re({field:Vr},D.slots),slotProps:re({},D.slotProps,{field:p=>{var y;return re({},Ln((y=D.slotProps)==null?void 0:y.field,p),zr(D),{ref:r})},toolbar:re({hidden:!1,ampmInClock:g},(u=D.slotProps)==null?void 0:u.toolbar),tabs:re({hidden:!1},(l=D.slotProps)==null?void 0:l.tabs)})}),{renderPicker:O}=ro({props:T,valueManager:jt,valueType:"date-time",getOpenDialogAriaText:(h=(m=T.localeText)==null?void 0:m.openDatePickerDialogue)!=null?h:v.openDatePickerDialogue,validator:Vn});return O()});Zr.propTypes={ampm:x.bool,ampmInClock:x.bool,autoFocus:x.bool,className:x.string,closeOnSelect:x.bool,components:x.object,componentsProps:x.object,dayOfWeekFormatter:x.func,defaultCalendarMonth:x.any,defaultValue:x.any,disabled:x.bool,disableFuture:x.bool,disableHighlightToday:x.bool,disableIgnoringDatePartForTimeValidation:x.bool,disableOpenPicker:x.bool,disablePast:x.bool,displayWeekNumber:x.bool,fixedWeekNumber:x.number,format:x.string,formatDensity:x.oneOf(["dense","spacious"]),inputRef:Or,label:x.node,loading:x.bool,localeText:x.object,maxDate:x.any,maxDateTime:x.any,maxTime:x.any,minDate:x.any,minDateTime:x.any,minTime:x.any,minutesStep:x.number,monthsPerRow:x.oneOf([3,4]),name:x.string,onAccept:x.func,onChange:x.func,onClose:x.func,onError:x.func,onMonthChange:x.func,onOpen:x.func,onSelectedSectionsChange:x.func,onViewChange:x.func,onYearChange:x.func,open:x.bool,openTo:x.oneOf(["day","hours","minutes","month","seconds","year"]),orientation:x.oneOf(["landscape","portrait"]),readOnly:x.bool,reduceAnimations:x.bool,referenceDate:x.any,renderLoading:x.func,selectedSections:x.oneOfType([x.oneOf(["all","day","hours","meridiem","minutes","month","seconds","weekDay","year"]),x.number,x.shape({endIndex:x.number.isRequired,startIndex:x.number.isRequired})]),shouldDisableClock:x.func,shouldDisableDate:x.func,shouldDisableMonth:x.func,shouldDisableTime:x.func,shouldDisableYear:x.func,showDaysOutsideCurrentMonth:x.bool,slotProps:x.object,slots:x.object,sx:x.oneOfType([x.arrayOf(x.oneOfType([x.func,x.object,x.bool])),x.func,x.object]),timezone:x.string,value:x.any,view:x.oneOf(["day","hours","minutes","month","seconds","year"]),viewRenderers:x.shape({day:x.func,hours:x.func,minutes:x.func,month:x.func,seconds:x.func,year:x.func}),views:x.arrayOf(x.oneOf(["day","hours","minutes","month","seconds","year"]).isRequired),yearsPerRow:x.oneOf([3,4])};const Ol=["desktopModeMediaQuery"],El=i.forwardRef(function(n,r){const a=Is({props:n,name:"MuiDateTimePicker"}),{desktopModeMediaQuery:u=ao}=a,l=Ss(a,Ol);return lo(u,{defaultMatches:!0})?e.jsx(Xr,re({ref:r},l)):e.jsx(Zr,re({ref:r},l))}),Bl=()=>{var le,$;const[s,n]=i.useState(0),[r,a]=i.useState([]),[u,l]=i.useState([]),[h,m]=i.useState([]),[v,b]=i.useState(!1),[D,S]=i.useState(null),[g,T]=i.useState(null),[O,p]=i.useState(!1),[y,C]=i.useState(!1),[j,U]=i.useState(null),[q,w]=i.useState({title:"",message:"",priority:"normal",scheduled_at:null,target_audience:"all",icon:"ðŸ“¢",action_url:"",action_text:"",is_draft:!1});i.useEffect(()=>{te(),I(),z()},[]);const z=()=>E(void 0,null,function*(){try{const f=yield fetch("/api/admin/roles",{credentials:"include"});if(f.ok){const J=yield f.json();m(J.roles||[])}}catch(f){console.error("Failed to load system roles:",f)}}),te=()=>E(void 0,null,function*(){try{b(!0);const f=yield fetch("/api/admin/notifications/types",{credentials:"include"});if(f.ok){const J=yield f.json();a(J.types||[])}}catch(f){S("Failed to load notification types")}finally{b(!1)}}),I=()=>E(void 0,null,function*(){try{const f=yield fetch("/api/admin/notifications/queue",{credentials:"include"});if(f.ok){const J=yield f.json();l(J.queue||[])}}catch(f){console.error("Failed to load notification queue:",f)}}),A=(f,J)=>E(void 0,null,function*(){try{if((yield fetch(`/api/admin/notifications/types/${f}/toggle`,{method:"PUT",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({enabled:J})})).ok)a(B=>B.map(ae=>ae.id===f?G(V({},ae),{default_enabled:J}):ae)),T(`Notification type ${J?"enabled":"disabled"} system-wide`);else throw new Error("Failed to update notification type")}catch(ve){S("Failed to update notification type")}}),L=()=>E(void 0,null,function*(){try{b(!0);const f=yield fetch("/api/admin/notifications/custom",{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify(q)});if(f.ok){const J=yield f.json();T(`Custom notification ${q.is_draft?"saved as draft":"scheduled"} successfully`),p(!1),w({title:"",message:"",priority:"normal",scheduled_at:null,target_audience:"all",icon:"ðŸ“¢",action_url:"",action_text:"",is_draft:!1}),I()}else throw new Error("Failed to create notification")}catch(f){S("Failed to create custom notification")}finally{b(!1)}}),X=f=>{switch(f){case"system":return"âš™ï¸";case"security":return"ðŸ”’";case"backup":return"ðŸ’¾";case"billing":return"ðŸ’³";case"user":return"ðŸ‘¤";case"admin":return"ðŸ‘‘";case"certificates":return"ðŸ“œ";case"reminders":return"â°";default:return"ðŸ“¢"}},Se=f=>{switch(f){case"urgent":return"error";case"high":return"warning";case"normal":return"primary";case"low":return"default";default:return"default"}},Ce=r.reduce((f,J)=>(f[J.category]||(f[J.category]=[]),f[J.category].push(J),f),{});return e.jsx(oo,{dateAdapter:io,children:e.jsxs(o,{children:[D&&e.jsx(ue,{severity:"error",sx:{mb:3},onClose:()=>S(null),children:D}),g&&e.jsx(ue,{severity:"success",sx:{mb:3},onClose:()=>T(null),children:g}),e.jsx(o,{sx:{borderBottom:1,borderColor:"divider",mb:3},children:e.jsxs(ot,{value:s,onChange:(f,J)=>n(J),children:[e.jsx(ze,{icon:e.jsx(Gt,{}),label:"System-wide Settings"}),e.jsx(ze,{icon:e.jsx(or,{}),label:"Custom Notifications"}),e.jsx(ze,{icon:e.jsx(Vt,{}),label:"Notification Queue"})]})}),s===0&&e.jsxs(o,{children:[e.jsxs(o,{display:"flex",justifyContent:"between",alignItems:"center",mb:3,children:[e.jsx(t,{variant:"h6",children:"System-wide Notification Types"}),e.jsx(t,{variant:"body2",color:"text.secondary",children:"Control which notification types are enabled for all users"})]}),v?e.jsx(o,{display:"flex",justifyContent:"center",py:4,children:e.jsx(Oe,{})}):e.jsx(Q,{spacing:2,children:Object.entries(Ce).map(([f,J])=>e.jsxs(Hs,{defaultExpanded:!0,children:[e.jsx(qs,{expandIcon:e.jsx(Er,{}),children:e.jsxs(o,{display:"flex",alignItems:"center",children:[e.jsx(t,{sx:{mr:1},children:X(f)}),e.jsx(t,{variant:"h6",sx:{textTransform:"capitalize"},children:f}),e.jsx(H,{label:`${J.filter(ve=>ve.default_enabled).length}/${J.length} enabled`,size:"small",sx:{ml:2}})]})}),e.jsx(Gs,{children:e.jsx(M,{container:!0,spacing:2,children:J.map(ve=>e.jsx(M,{item:!0,xs:12,md:6,children:e.jsx(pe,{variant:"outlined",children:e.jsx(de,{children:e.jsxs(o,{display:"flex",justifyContent:"between",alignItems:"flex-start",children:[e.jsxs(o,{flex:1,children:[e.jsx(t,{variant:"subtitle1",fontWeight:600,children:ve.name.replace(/_/g," ").replace(/\b\w/g,B=>B.toUpperCase())}),e.jsx(t,{variant:"body2",color:"text.secondary",children:ve.description})]}),e.jsx(Be,{control:e.jsx(Ae,{checked:ve.default_enabled,onChange:B=>A(ve.id,B.target.checked),size:"small"}),label:"",sx:{ml:1}})]})})})},ve.id))})})]},f))})]}),s===1&&e.jsxs(o,{children:[e.jsxs(o,{display:"flex",justifyContent:"between",alignItems:"center",mb:3,children:[e.jsx(t,{variant:"h6",children:"Create Custom Notifications"}),e.jsx(_,{variant:"contained",startIcon:e.jsx(or,{}),onClick:()=>p(!0),children:"Create Notification"})]}),e.jsx(ue,{severity:"info",sx:{mb:3},children:"Create custom notifications that will be sent to all users or specific groups. You can schedule them for future delivery or send immediately."}),e.jsxs(M,{container:!0,spacing:3,children:[e.jsx(M,{item:!0,xs:12,md:4,children:e.jsx(pe,{children:e.jsxs(de,{children:[e.jsxs(o,{display:"flex",alignItems:"center",mb:2,children:[e.jsx(Zt,{style:{marginRight:8}}),e.jsx(t,{variant:"h6",children:"Broadcast to All"})]}),e.jsx(t,{variant:"body2",color:"text.secondary",mb:2,children:"Send notifications to all registered users in the system."}),e.jsx(_,{variant:"outlined",fullWidth:!0,onClick:()=>{w(f=>G(V({},f),{target_audience:"all"})),p(!0)},children:"Create Broadcast"})]})})}),e.jsx(M,{item:!0,xs:12,md:4,children:e.jsx(pe,{children:e.jsxs(de,{children:[e.jsxs(o,{display:"flex",alignItems:"center",mb:2,children:[e.jsx(Br,{style:{marginRight:8}}),e.jsx(t,{variant:"h6",children:"Admin Alert"})]}),e.jsx(t,{variant:"body2",color:"text.secondary",mb:2,children:"Send important notifications to administrators only (admin + super_admin)."}),e.jsx(_,{variant:"outlined",fullWidth:!0,onClick:()=>{w(f=>G(V({},f),{target_audience:"admins"})),p(!0)},children:"Create Admin Alert"})]})})}),e.jsx(M,{item:!0,xs:12,md:4,children:e.jsx(pe,{children:e.jsxs(de,{children:[e.jsxs(o,{display:"flex",alignItems:"center",mb:2,children:[e.jsx(Vt,{style:{marginRight:8}}),e.jsx(t,{variant:"h6",children:"Scheduled Message"})]}),e.jsx(t,{variant:"body2",color:"text.secondary",mb:2,children:"Schedule notifications for future delivery at specific times."}),e.jsx(_,{variant:"outlined",fullWidth:!0,onClick:()=>{w(f=>G(V({},f),{scheduled_at:new Date(Date.now()+24*60*60*1e3)})),p(!0)},children:"Schedule Message"})]})})})]})]}),s===2&&e.jsxs(o,{children:[e.jsxs(o,{display:"flex",justifyContent:"between",alignItems:"center",mb:3,children:[e.jsx(t,{variant:"h6",children:"Notification Queue & History"}),e.jsx(_,{variant:"outlined",startIcon:e.jsx(zt,{}),onClick:()=>C(!0),children:"View Details"})]}),e.jsx(ht,{component:De,children:e.jsxs(mt,{children:[e.jsx(xt,{children:e.jsxs(vs,{children:[e.jsx(W,{children:"Title"}),e.jsx(W,{children:"Audience"}),e.jsx(W,{children:"Priority"}),e.jsx(W,{children:"Scheduled"}),e.jsx(W,{children:"Status"}),e.jsx(W,{children:"Recipients"}),e.jsx(W,{align:"right",children:"Actions"})]})}),e.jsx(pt,{children:u.length===0?e.jsx(vs,{children:e.jsx(W,{colSpan:7,align:"center",sx:{py:4},children:e.jsx(t,{variant:"body2",color:"text.secondary",children:"No notifications in queue"})})}):u.map(f=>{var J,ve;return e.jsxs(vs,{children:[e.jsxs(W,{children:[e.jsx(t,{variant:"subtitle2",children:f.title}),e.jsx(t,{variant:"body2",color:"text.secondary",children:f.message&&f.message.length>50?f.message.slice(0,50)+"...":f.message||"No message"}),f.created_by&&e.jsxs(t,{variant:"caption",color:"text.secondary",sx:{fontStyle:"italic"},children:["by ",f.created_by]})]}),e.jsx(W,{children:e.jsx(H,{label:(J=f.target_audience)!=null&&J.startsWith("role:")?h&&h.length>0&&((ve=h.find(B=>B.name===f.target_audience.replace("role:","")))==null?void 0:ve.description)||f.target_audience:f.target_audience==="admins"?"Administrators":f.target_audience==="users"?"Regular Users":f.target_audience==="all"?"All Users":f.target_audience,size:"small",variant:"outlined"})}),e.jsx(W,{children:e.jsx(H,{label:f.priority,size:"small",color:Se(f.priority)})}),e.jsx(W,{children:f.scheduled_at?new Date(f.scheduled_at).toLocaleString():f.created_at?new Date(f.created_at).toLocaleString():"N/A"}),e.jsx(W,{children:e.jsx(H,{label:f.status,size:"small",color:f.status==="sent"?"success":f.status==="failed"?"error":f.status==="draft"?"warning":"default"})}),e.jsx(W,{children:e.jsx(ye,{title:`Sent: ${f.total_sent||f.target_user_count||0} | Read: ${f.read_count||0} | Dismissed: ${f.dismissed_count||0}`,children:e.jsx(en,{badgeContent:f.total_sent||f.target_user_count||0,color:"primary",children:e.jsx(Zt,{size:20})})})}),e.jsxs(W,{align:"right",children:[e.jsx(ye,{title:"View Details",children:e.jsx(be,{size:"small",children:e.jsx(zt,{})})}),f.status==="pending"&&e.jsx(ye,{title:"Cancel",children:e.jsx(be,{size:"small",color:"error",children:e.jsx(Cn,{})})})]})]},f.id)})})]})})]}),e.jsxs(as,{open:O,onClose:()=>p(!1),maxWidth:"md",fullWidth:!0,children:[e.jsx(os,{children:"Create Custom Notification"}),e.jsx(is,{children:e.jsxs(Q,{spacing:3,sx:{mt:1},children:[e.jsx(Ne,{fullWidth:!0,label:"Notification Title",value:q.title,onChange:f=>w(J=>G(V({},J),{title:f.target.value})),placeholder:"Enter a clear, descriptive title"}),e.jsx(Ne,{fullWidth:!0,multiline:!0,rows:4,label:"Message",value:q.message,onChange:f=>w(J=>G(V({},J),{message:f.target.value})),placeholder:"Write your notification message here..."}),e.jsxs(M,{container:!0,spacing:2,children:[e.jsx(M,{item:!0,xs:12,md:6,children:e.jsxs(hs,{fullWidth:!0,children:[e.jsx(ps,{children:"Priority"}),e.jsxs(gs,{value:q.priority,label:"Priority",onChange:f=>w(J=>G(V({},J),{priority:f.target.value})),children:[e.jsx(xe,{value:"low",children:"Low"}),e.jsx(xe,{value:"normal",children:"Normal"}),e.jsx(xe,{value:"high",children:"High"}),e.jsx(xe,{value:"urgent",children:"Urgent"})]})]})}),e.jsx(M,{item:!0,xs:12,md:6,children:e.jsxs(hs,{fullWidth:!0,children:[e.jsx(ps,{children:"Target Audience"}),e.jsxs(gs,{value:q.target_audience,label:"Target Audience",onChange:f=>w(J=>G(V({},J),{target_audience:f.target.value})),children:[e.jsx(xe,{value:"all",children:"All Users"}),e.jsx(xe,{value:"admins",children:"Administrators (admin + super_admin)"}),e.jsx(xe,{value:"users",children:"Regular Users (non-admin)"}),e.jsx(xe,{disabled:!0,children:e.jsx("em",{children:"--- By Role ---"})}),h.map(f=>e.jsxs(xe,{value:`role:${f.name}`,children:[f.description," (",f.name,")"]},f.id)),e.jsx(xe,{value:"church_specific",children:"Specific Church"})]})]})})]}),e.jsx(El,{label:"Schedule Delivery (Optional)",value:q.scheduled_at,onChange:f=>w(J=>G(V({},J),{scheduled_at:f})),slotProps:{textField:{fullWidth:!0,helperText:"Leave empty to send immediately"}}}),e.jsxs(M,{container:!0,spacing:2,children:[e.jsx(M,{item:!0,xs:12,md:6,children:e.jsx(Ne,{fullWidth:!0,label:"Icon (Optional)",value:q.icon,onChange:f=>w(J=>G(V({},J),{icon:f.target.value})),placeholder:"ðŸ“¢, ðŸ””, âš ï¸, etc."})}),e.jsx(M,{item:!0,xs:12,md:6,children:e.jsx(Ne,{fullWidth:!0,label:"Action Text (Optional)",value:q.action_text,onChange:f=>w(J=>G(V({},J),{action_text:f.target.value})),placeholder:"View Details, Learn More, etc."})})]}),e.jsx(Ne,{fullWidth:!0,label:"Action URL (Optional)",value:q.action_url,onChange:f=>w(J=>G(V({},J),{action_url:f.target.value})),placeholder:"/some-page, https://example.com, etc."})]})}),e.jsxs(ls,{children:[e.jsx(_,{onClick:()=>p(!1),children:"Cancel"}),e.jsx(_,{variant:"outlined",onClick:()=>{w(f=>G(V({},f),{is_draft:!0})),L()},disabled:!q.title||!q.message,children:"Save as Draft"}),e.jsx(_,{variant:"contained",onClick:()=>{w(f=>G(V({},f),{is_draft:!1})),L()},disabled:!q.title||!q.message,startIcon:q.scheduled_at?e.jsx(Vt,{}):e.jsx(co,{}),children:q.scheduled_at?"Schedule":"Send Now"})]})]}),e.jsxs(as,{open:y,onClose:()=>C(!1),maxWidth:"md",fullWidth:!0,children:[e.jsx(os,{children:"Notification Details"}),e.jsx(is,{children:j?e.jsxs(Q,{spacing:2,sx:{mt:1},children:[e.jsxs(o,{children:[e.jsx(t,{variant:"subtitle2",color:"text.secondary",children:"Title"}),e.jsx(t,{variant:"h6",children:j.title})]}),e.jsxs(o,{children:[e.jsx(t,{variant:"subtitle2",color:"text.secondary",children:"Message"}),e.jsx(t,{variant:"body1",children:j.message})]}),e.jsxs(M,{container:!0,spacing:2,children:[e.jsxs(M,{item:!0,xs:6,children:[e.jsx(t,{variant:"subtitle2",color:"text.secondary",children:"Priority"}),e.jsx(H,{label:j.priority,size:"small",color:Se(j.priority)})]}),e.jsxs(M,{item:!0,xs:6,children:[e.jsx(t,{variant:"subtitle2",color:"text.secondary",children:"Status"}),e.jsx(H,{label:j.status,size:"small",color:j.status==="sent"?"success":j.status==="failed"?"error":j.status==="draft"?"warning":"default"})]}),e.jsxs(M,{item:!0,xs:6,children:[e.jsx(t,{variant:"subtitle2",color:"text.secondary",children:"Target Audience"}),e.jsx(H,{label:(le=j.target_audience)!=null&&le.startsWith("role:")?h&&h.length>0&&(($=h.find(f=>f.name===j.target_audience.replace("role:","")))==null?void 0:$.description)||j.target_audience:j.target_audience==="admins"?"Administrators":j.target_audience==="users"?"Regular Users":j.target_audience==="all"?"All Users":j.target_audience,size:"small",variant:"outlined"})]}),e.jsxs(M,{item:!0,xs:6,children:[e.jsx(t,{variant:"subtitle2",color:"text.secondary",children:"Notification Type"}),e.jsx(t,{variant:"body2",children:j.notification_type||"N/A"})]})]}),e.jsx(ks,{}),e.jsxs(M,{container:!0,spacing:2,children:[e.jsxs(M,{item:!0,xs:6,children:[e.jsx(t,{variant:"subtitle2",color:"text.secondary",children:"Total Sent"}),e.jsx(t,{variant:"h6",children:j.total_sent||j.target_user_count||0})]}),e.jsxs(M,{item:!0,xs:6,children:[e.jsx(t,{variant:"subtitle2",color:"text.secondary",children:"Read Count"}),e.jsx(t,{variant:"h6",children:j.read_count||0})]}),e.jsxs(M,{item:!0,xs:6,children:[e.jsx(t,{variant:"subtitle2",color:"text.secondary",children:"Dismissed Count"}),e.jsx(t,{variant:"h6",children:j.dismissed_count||0})]}),e.jsxs(M,{item:!0,xs:6,children:[e.jsx(t,{variant:"subtitle2",color:"text.secondary",children:"Created By"}),e.jsx(t,{variant:"body2",children:j.created_by||"System"})]})]}),e.jsx(ks,{}),e.jsxs(o,{children:[e.jsx(t,{variant:"subtitle2",color:"text.secondary",children:"Created At"}),e.jsx(t,{variant:"body2",children:j.created_at?new Date(j.created_at).toLocaleString():"N/A"})]}),j.scheduled_at&&e.jsxs(o,{children:[e.jsx(t,{variant:"subtitle2",color:"text.secondary",children:"Scheduled At"}),e.jsx(t,{variant:"body2",children:new Date(j.scheduled_at).toLocaleString()})]})]}):e.jsx(t,{children:"No notification selected"})}),e.jsx(ls,{children:e.jsx(_,{onClick:()=>C(!1),children:"Close"})})]})]})})},_l=({files:s,selectedFile:n,onFileSelect:r,onFileExecute:a,onFileDelete:u,onQuestionnairePreview:l,isExecuting:h,settings:m={}})=>{const[v,b]=fn.useState(""),D=p=>{switch(p){case"markdown":case"text":return e.jsx(Ct,{});case"javascript":return e.jsx(Fn,{});case"sql":return e.jsx(at,{});case"shell":return e.jsx(ds,{});case"python":return e.jsx(ds,{});case"html":return e.jsx($n,{});case"css":return e.jsx(Mn,{});case"json":return e.jsx(Pn,{});case"xml":return e.jsx(ds,{});case"image":return e.jsx(Dn,{});case"video":return e.jsx(Tn,{});case"audio":return e.jsx(In,{});case"archive":return e.jsx(Rt,{});case"pdf":return e.jsx(kn,{});default:return e.jsx(ds,{})}},S=p=>{const y={markdown:"primary",javascript:"secondary",sql:"info",shell:"warning",python:"success",html:"error",css:"info",json:"secondary",xml:"warning",text:"default",image:"success",video:"error",audio:"info",archive:"warning",pdf:"error",other:"default"};return e.jsx(H,{label:p.toUpperCase(),size:"small",color:y[p]||"default",variant:"outlined"})},g=s.filter(p=>p.name.toLowerCase().includes(v.toLowerCase())||p.type.toLowerCase().includes(v.toLowerCase())),T=p=>{if(p===0)return"0 Bytes";const y=1024,C=["Bytes","KB","MB","GB"],j=Math.floor(Math.log(p)/Math.log(y));return parseFloat((p/Math.pow(y,j)).toFixed(1))+" "+C[j]},O=p=>new Intl.DateTimeFormat("en-US",{month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}).format(p);return s.length===0?e.jsxs(De,{sx:{height:"100%",display:"flex",flexDirection:"column"},children:[e.jsx(o,{sx:{p:2,borderBottom:1,borderColor:"divider"},children:e.jsx(t,{variant:"h6",children:"Files"})}),e.jsx(o,{sx:{flex:1,display:"flex",alignItems:"center",justifyContent:"center",p:3},children:e.jsxs(Q,{spacing:2,alignItems:"center",children:[e.jsx(Sn,{sx:{fontSize:48,color:"grey.400"}}),e.jsx(t,{variant:"body1",color:"text.secondary",textAlign:"center",children:"No files uploaded yet"}),e.jsx(t,{variant:"body2",color:"text.secondary",textAlign:"center",children:"Use the Import tab to upload files"})]})})]}):e.jsxs(De,{sx:{height:"100%",display:"flex",flexDirection:"column"},children:[e.jsx(o,{sx:{p:2,borderBottom:1,borderColor:"divider"},children:e.jsxs(Q,{spacing:2,children:[e.jsxs(t,{variant:"h6",children:["Files (",s.length,")"]}),e.jsx(Ne,{size:"small",placeholder:"Search files...",value:v,onChange:p=>b(p.target.value),InputProps:{startAdornment:e.jsx(sn,{position:"start",children:e.jsx(Nn,{})})},fullWidth:!0})]})}),e.jsx(xs,{sx:{flex:1,overflow:"auto",p:0},children:g.map((p,y)=>e.jsxs(fn.Fragment,{children:[e.jsx(Ze,{disablePadding:!0,children:e.jsxs(uo,{selected:(n==null?void 0:n.id)===p.id,onClick:()=>r(p),sx:{"&.Mui-selected":{backgroundColor:"primary.light","&:hover":{backgroundColor:"primary.light"}}},children:[e.jsx(Qs,{children:D(p.type)}),e.jsx(es,{primary:e.jsxs(o,{sx:{display:"flex",alignItems:"center",gap:1},children:[e.jsx(t,{variant:"body2",noWrap:!0,sx:{flex:1},children:p.name}),S(p.type)]}),secondary:e.jsxs(Q,{direction:"row",spacing:1,alignItems:"center",children:[e.jsx(t,{variant:"caption",color:"text.secondary",children:T(p.size)}),e.jsx(t,{variant:"caption",color:"text.secondary",children:"â€¢"}),e.jsx(t,{variant:"caption",color:"text.secondary",children:O(p.uploadedAt)})]})}),e.jsxs(o,{sx:{display:"flex",alignItems:"center",gap:.5},children:[p.isQuestionnaire&&l&&e.jsx(ye,{title:"Preview Questionnaire",children:e.jsx(be,{size:"small",onClick:C=>{C.stopPropagation(),l(p)},color:"secondary",children:e.jsx(nt,{fontSize:"small"})})}),e.jsx(ye,{title:"Execute",children:e.jsx(be,{size:"small",onClick:C=>{C.stopPropagation(),a(p)},disabled:h,color:"primary",children:e.jsx(gt,{fontSize:"small"})})}),e.jsx(ye,{title:"Delete",children:e.jsx(be,{size:"small",onClick:C=>{C.stopPropagation(),u(p.id)},color:"error",children:e.jsx(St,{fontSize:"small"})})})]})]})}),y<g.length-1&&e.jsx(ks,{})]},p.id))}),g.length===0&&v&&e.jsx(o,{sx:{flex:1,display:"flex",alignItems:"center",justifyContent:"center",p:3},children:e.jsxs(t,{variant:"body2",color:"text.secondary",children:['No files match "',v,'"']})})]})},Ll=({file:s,onExecute:n,isExecuting:r,settings:a={}})=>{const u=p=>{switch(p){case"markdown":case"text":return e.jsx(Ct,{});case"javascript":return e.jsx(Fn,{});case"sql":return e.jsx(at,{});case"shell":return e.jsx(ds,{});case"python":return e.jsx(ds,{});case"html":return e.jsx($n,{});case"css":return e.jsx(Mn,{});case"json":return e.jsx(Pn,{});case"xml":return e.jsx(ds,{});case"image":return e.jsx(Dn,{});case"video":return e.jsx(Tn,{});case"audio":return e.jsx(In,{});case"archive":return e.jsx(Rt,{});case"pdf":return e.jsx(kn,{});default:return e.jsx(ds,{})}},l=p=>{const y={markdown:"primary",javascript:"secondary",sql:"info",shell:"warning",python:"success",html:"error",css:"info",json:"secondary",xml:"warning",text:"default",image:"success",video:"error",audio:"info",archive:"warning",pdf:"error",other:"default"};return e.jsx(H,{label:p.toUpperCase(),size:"small",color:y[p]||"default",variant:"outlined"})},h=p=>{if(p===0)return"0 Bytes";const y=1024,C=["Bytes","KB","MB","GB"],j=Math.floor(Math.log(p)/Math.log(y));return parseFloat((p/Math.pow(y,j)).toFixed(1))+" "+C[j]},m=p=>new Intl.DateTimeFormat("en-US",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"}).format(p),v=()=>E(void 0,null,function*(){if(s)try{yield navigator.clipboard.writeText(s.content)}catch(p){console.error("Failed to copy to clipboard:",p)}}),b=()=>{if(s){const p=new Blob([s.content],{type:"text/plain"}),y=URL.createObjectURL(p),C=document.createElement("a");C.href=y,C.download=s.name,document.body.appendChild(C),C.click(),document.body.removeChild(C),URL.revokeObjectURL(y)}},D=p=>e.jsx(o,{sx:{"& h1":{fontSize:"2rem",fontWeight:"bold",mb:2},"& h2":{fontSize:"1.5rem",fontWeight:"bold",mb:1.5},"& h3":{fontSize:"1.25rem",fontWeight:"bold",mb:1},"& p":{mb:1},"& code":{backgroundColor:"grey.100",padding:"2px 4px",borderRadius:"4px",fontFamily:"monospace"},"& pre":{backgroundColor:"grey.100",padding:2,borderRadius:"4px",overflow:"auto",fontFamily:"monospace"},"& ul, & ol":{pl:2},"& li":{mb:.5}},children:p.split(`
`).map((y,C)=>y.startsWith("# ")?e.jsx(t,{variant:"h4",component:"h1",children:y.substring(2)},C):y.startsWith("## ")?e.jsx(t,{variant:"h5",component:"h2",children:y.substring(3)},C):y.startsWith("### ")?e.jsx(t,{variant:"h6",component:"h3",children:y.substring(4)},C):y.startsWith("```")?e.jsx(o,{component:"pre",sx:{backgroundColor:"grey.100",p:2,borderRadius:1},children:y.substring(3)},C):y.startsWith("- ")?e.jsxs(t,{component:"li",children:["â€¢ ",y.substring(2)]},C):y.trim()===""?e.jsx(o,{sx:{height:8}},C):e.jsx(t,{paragraph:!0,children:y},C))}),S=p=>{try{const y=JSON.parse(p),C=a.autoExpandJson?JSON.stringify(y,null,2):JSON.stringify(y);return e.jsx(o,{component:"pre",sx:{backgroundColor:a.darkModeConsole?"#1e1e1e":"grey.50",color:a.darkModeConsole?"#ffffff":"text.primary",p:2,borderRadius:1,overflow:"auto",fontFamily:"monospace",fontSize:"0.875rem",whiteSpace:a.lineWrapInPreview?"pre-wrap":"pre"},children:C})}catch(y){return e.jsx(ue,{severity:"error",children:"Invalid JSON format"})}},g=(p,y)=>{const C=a.darkModeConsole!==!1,j=a.enableSyntaxHighlighting!==!1;return e.jsx(o,{component:"pre",sx:{backgroundColor:C?"#1e1e1e":"#f8f9fa",color:C?"#ffffff":"#212529",p:2,borderRadius:1,overflow:"auto",fontFamily:"monospace",fontSize:"0.875rem",whiteSpace:a.lineWrapInPreview?"pre-wrap":"pre",border:C?"1px solid #404040":"1px solid #dee2e6","& .keyword":{color:C?"#569cd6":"#d73a49"},"& .string":{color:C?"#ce9178":"#032f62"},"& .comment":{color:C?"#6a9955":"#6a737d"},"& .number":{color:C?"#b5cea8":"#005cc5"},"& .function":{color:C?"#dcdcaa":"#6f42c1"},"& .operator":{color:C?"#d4d4d4":"#d73a49"}},children:j?T(p,y):p})},T=(p,y)=>{if(!a.enableSyntaxHighlighting)return p;let C=p;return(y==="javascript"||y==="typescript")&&(C=C.replace(/\b(const|let|var|function|return|if|else|for|while|class|import|export|default|async|await)\b/g,'<span class="keyword">$1</span>').replace(/\b(console|log|error|warn|info)\b/g,'<span class="function">$1</span>').replace(/"([^"]*)"/g,'<span class="string">"$1"</span>').replace(/'([^']*)'/g,`<span class="string">'$1'</span>`).replace(/\/\/.*$/gm,'<span class="comment">$&</span>').replace(/\/\*[\s\S]*?\*\//g,'<span class="comment">$&</span>').replace(/\b(\d+)\b/g,'<span class="number">$1</span>')),y==="sql"&&(C=C.replace(/\b(SELECT|FROM|WHERE|INSERT|UPDATE|DELETE|CREATE|DROP|TABLE|INDEX|PRIMARY|FOREIGN|KEY|JOIN|LEFT|RIGHT|INNER|OUTER|GROUP|BY|ORDER|HAVING|UNION|ALL|DISTINCT|COUNT|SUM|AVG|MAX|MIN)\b/gi,'<span class="keyword">$1</span>').replace(/"([^"]*)"/g,'<span class="string">"$1"</span>').replace(/'([^']*)'/g,`<span class="string">'$1'</span>`).replace(/--.*$/gm,'<span class="comment">$&</span>').replace(/\b(\d+)\b/g,'<span class="number">$1</span>')),y==="python"&&(C=C.replace(/\b(def|class|import|from|as|if|elif|else|for|while|try|except|finally|with|return|yield|True|False|None)\b/g,'<span class="keyword">$1</span>').replace(/\b(print|len|range|str|int|float|list|dict|set)\b/g,'<span class="function">$1</span>').replace(/("""[\s\S]*?""")/g,'<span class="comment">$1</span>').replace(/('''[\s\S]*?''')/g,'<span class="comment">$1</span>').replace(/#.*$/gm,'<span class="comment">$&</span>').replace(/("([^"]*)")/g,'<span class="string">$1</span>').replace(/('([^']*)')/g,'<span class="string">$1</span>').replace(/\b(\d+)\b/g,'<span class="number">$1</span>')),C},O=()=>{if(!s)return null;const p=s.size/1024;if(a.maxPreviewFileSize&&p>a.maxPreviewFileSize)return e.jsx(ue,{severity:"warning",children:e.jsxs(t,{variant:"body2",children:["File is too large to preview (",p.toFixed(1)," KB). Maximum preview size is ",a.maxPreviewFileSize," KB."]})});const y=a.defaultPreviewMode||"auto";let C=s.type;switch(y==="raw"?C="text":y==="markdown"&&s.type==="text"?C="markdown":y==="code"&&["text","markdown"].includes(s.type)&&(C="javascript"),C){case"markdown":return D(s.content);case"json":return S(s.content);case"javascript":case"typescript":return g(s.content,"javascript");case"sql":return g(s.content,"sql");case"shell":return g(s.content,"bash");case"python":return g(s.content,"python");case"html":return g(s.content,"html");case"css":return g(s.content,"css");case"xml":return g(s.content,"xml");case"text":default:return e.jsx(o,{component:"pre",sx:{backgroundColor:a.darkModeConsole?"#1e1e1e":"grey.50",color:a.darkModeConsole?"#ffffff":"text.primary",p:2,borderRadius:1,overflow:"auto",fontFamily:"monospace",fontSize:"0.875rem",whiteSpace:a.lineWrapInPreview?"pre-wrap":"pre",border:a.darkModeConsole?"1px solid #404040":"1px solid #dee2e6"},children:s.content})}};return s?e.jsxs(De,{sx:{height:"100%",display:"flex",flexDirection:"column"},children:[e.jsx(o,{sx:{p:2,borderBottom:1,borderColor:"divider"},children:e.jsxs(Q,{direction:"row",justifyContent:"space-between",alignItems:"center",children:[e.jsxs(Q,{direction:"row",spacing:2,alignItems:"center",children:[u(s.type),e.jsxs(o,{children:[e.jsx(t,{variant:"h6",noWrap:!0,children:s.name}),e.jsxs(Q,{direction:"row",spacing:1,alignItems:"center",children:[l(s.type),e.jsx(t,{variant:"caption",color:"text.secondary",children:h(s.size)}),e.jsx(t,{variant:"caption",color:"text.secondary",children:"â€¢"}),e.jsx(t,{variant:"caption",color:"text.secondary",children:m(s.uploadedAt)})]})]})]}),e.jsxs(Q,{direction:"row",spacing:1,children:[e.jsx(ye,{title:"Execute",children:e.jsx(be,{onClick:()=>n(s),disabled:r,color:"primary",size:"small",children:e.jsx(gt,{})})}),e.jsx(ye,{title:"Copy to clipboard",children:e.jsx(be,{onClick:v,size:"small",children:e.jsx(ho,{})})}),e.jsx(ye,{title:"Download",children:e.jsx(be,{onClick:b,size:"small",children:e.jsx(xo,{})})})]})]})}),e.jsx(o,{sx:{flex:1,overflow:"auto",p:2},children:O()})]}):e.jsx(De,{sx:{height:"100%",display:"flex",flexDirection:"column"},children:e.jsx(o,{sx:{flex:1,display:"flex",alignItems:"center",justifyContent:"center",p:3},children:e.jsxs(Q,{spacing:2,alignItems:"center",children:[e.jsx(Os,{sx:{fontSize:48,color:"grey.400"}}),e.jsx(t,{variant:"h6",color:"text.secondary",textAlign:"center",children:"No file selected"}),e.jsx(t,{variant:"body2",color:"text.secondary",textAlign:"center",children:"Select a file from the list to view its contents"})]})})})},vn={defaultPreviewMode:"auto",autoExpandJson:!0,enableSyntaxHighlighting:!0,maxPreviewFileSize:1024,defaultScriptEngine:"node",executionTimeout:30,dryRunMode:!1,autoSaveConsoleOutput:!0,darkModeConsole:!0,lineWrapInPreview:!1,showHiddenFiles:!1,autoScrollConsole:!0,forwardToOMAIMemory:!0,tagForAgentReflection:!1,enableOMAIRecommendations:!0,useSecureStorage:!0,retryOnMountFailure:!0,autoProcessOnUpload:!1},Nl=({settings:s,onSettingsChange:n,onSave:r,onReset:a})=>{const[u,l]=i.useState(!1),[h,m]=i.useState(!1),[v,b]=i.useState(!1),[D,S]=i.useState(null),[g,T]=i.useState(null),[O,p]=i.useState(0),y=(w,z)=>{const te=G(V({},s),{[w]:z});n(te),l(!0)},C=()=>{r(),l(!1)},j=()=>{a(),l(!1)},U=()=>E(void 0,null,function*(){m(!0),p(0),S(null);try{const z=yield(yield fetch("/api/bigbook/process-all",{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({useSecureStorage:s.useSecureStorage,retryOnFailure:s.retryOnMountFailure})})).json();S(z),p(100)}catch(w){console.error("File processing error:",w),S({success:!1,processedFiles:[],failedFiles:[],secureStorage:{mounted:!1,mountPath:"",retryCount:0},summary:{totalFiles:0,processedCount:0,failedCount:0,startTime:new Date().toISOString()}})}finally{m(!1)}}),q=()=>E(void 0,null,function*(){b(!0),T(null);try{const z=yield(yield fetch("/api/bigbook/test-secure-mount",{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include"})).json();T(z.testResult)}catch(w){console.error("Mount test error:",w),T({mountPath:"/mnt/bigbook_secure",accessible:!1,writable:!1,error:w.message,testTime:new Date().toISOString()})}finally{b(!1)}});return e.jsx(o,{sx:{p:3,maxWidth:800,mx:"auto"},children:e.jsxs(Q,{spacing:3,children:[e.jsxs(o,{children:[e.jsxs(t,{variant:"h4",component:"h1",gutterBottom:!0,sx:{display:"flex",alignItems:"center",gap:1},children:[e.jsx(wt,{}),"Big Book Console Settings"]}),e.jsx(t,{variant:"body1",color:"text.secondary",children:"Configure file viewer, execution, UI behavior, and OMAI integration preferences"})]}),u&&e.jsx(ue,{severity:"info",action:e.jsxs(Q,{direction:"row",spacing:1,children:[e.jsx(_,{size:"small",onClick:j,children:"Reset"}),e.jsx(_,{size:"small",variant:"contained",onClick:C,children:"Save Changes"})]}),children:"You have unsaved changes. Save them to apply the new settings."}),e.jsxs(Hs,{defaultExpanded:!0,children:[e.jsx(qs,{expandIcon:e.jsx(rt,{}),children:e.jsxs(Q,{direction:"row",spacing:1,alignItems:"center",children:[e.jsx(Os,{}),e.jsx(t,{variant:"h6",children:"File Viewer Settings"})]})}),e.jsx(Gs,{children:e.jsxs(Q,{spacing:3,children:[e.jsxs(hs,{fullWidth:!0,children:[e.jsx(ps,{children:"Default Preview Mode"}),e.jsxs(gs,{value:s.defaultPreviewMode,onChange:w=>y("defaultPreviewMode",w.target.value),label:"Default Preview Mode",children:[e.jsx(xe,{value:"auto",children:"Auto (Detect from file type)"}),e.jsx(xe,{value:"raw",children:"Raw Text"}),e.jsx(xe,{value:"markdown",children:"Markdown"}),e.jsx(xe,{value:"code",children:"Code (with syntax highlighting)"})]})]}),e.jsx(Be,{control:e.jsx(Ae,{checked:s.autoExpandJson,onChange:w=>y("autoExpandJson",w.target.checked)}),label:"Auto-expand JSON files"}),e.jsx(Be,{control:e.jsx(Ae,{checked:s.enableSyntaxHighlighting,onChange:w=>y("enableSyntaxHighlighting",w.target.checked)}),label:"Enable syntax highlighting"}),e.jsx(Ne,{fullWidth:!0,type:"number",label:"Max Preview File Size",value:s.maxPreviewFileSize,onChange:w=>y("maxPreviewFileSize",parseInt(w.target.value)),InputProps:{endAdornment:e.jsx(sn,{position:"end",children:"KB"})},helperText:"Files larger than this will show truncated content"})]})})]}),e.jsxs(Hs,{children:[e.jsx(qs,{expandIcon:e.jsx(rt,{}),children:e.jsxs(Q,{direction:"row",spacing:1,alignItems:"center",children:[e.jsx(gt,{}),e.jsx(t,{variant:"h6",children:"Execution Settings"})]})}),e.jsx(Gs,{children:e.jsxs(Q,{spacing:3,children:[e.jsxs(hs,{fullWidth:!0,children:[e.jsx(ps,{children:"Default Script Engine"}),e.jsxs(gs,{value:s.defaultScriptEngine,onChange:w=>y("defaultScriptEngine",w.target.value),label:"Default Script Engine",children:[e.jsx(xe,{value:"node",children:"Node.js"}),e.jsx(xe,{value:"python",children:"Python"}),e.jsx(xe,{value:"sh",children:"Shell (Bash)"}),e.jsx(xe,{value:"sql",children:"SQL"})]})]}),e.jsx(Ne,{fullWidth:!0,type:"number",label:"Execution Timeout",value:s.executionTimeout,onChange:w=>y("executionTimeout",parseInt(w.target.value)),InputProps:{endAdornment:e.jsx(sn,{position:"end",children:"seconds"})},helperText:"Maximum time to wait for script execution"}),e.jsx(Be,{control:e.jsx(Ae,{checked:s.dryRunMode,onChange:w=>y("dryRunMode",w.target.checked)}),label:"Dry Run Mode (disable actual script effects)"}),e.jsx(Be,{control:e.jsx(Ae,{checked:s.autoSaveConsoleOutput,onChange:w=>y("autoSaveConsoleOutput",w.target.checked)}),label:"Auto-save console output"})]})})]}),e.jsxs(Hs,{children:[e.jsx(qs,{expandIcon:e.jsx(rt,{}),children:e.jsxs(Q,{direction:"row",spacing:1,alignItems:"center",children:[e.jsx(po,{}),e.jsx(t,{variant:"h6",children:"UI Behavior"})]})}),e.jsx(Gs,{children:e.jsxs(Q,{spacing:3,children:[e.jsx(Be,{control:e.jsx(Ae,{checked:s.darkModeConsole,onChange:w=>y("darkModeConsole",w.target.checked)}),label:"Dark mode console"}),e.jsx(Be,{control:e.jsx(Ae,{checked:s.lineWrapInPreview,onChange:w=>y("lineWrapInPreview",w.target.checked)}),label:"Line wrap in preview"}),e.jsx(Be,{control:e.jsx(Ae,{checked:s.showHiddenFiles,onChange:w=>y("showHiddenFiles",w.target.checked)}),label:"Show hidden files"}),e.jsx(Be,{control:e.jsx(Ae,{checked:s.autoScrollConsole,onChange:w=>y("autoScrollConsole",w.target.checked)}),label:"Auto-scroll console to bottom"})]})})]}),e.jsxs(Hs,{children:[e.jsx(qs,{expandIcon:e.jsx(rt,{}),children:e.jsxs(Q,{direction:"row",spacing:1,alignItems:"center",children:[e.jsx(nt,{}),e.jsx(t,{variant:"h6",children:"OMAI Integration"})]})}),e.jsx(Gs,{children:e.jsxs(Q,{spacing:3,children:[e.jsx(Be,{control:e.jsx(Ae,{checked:s.forwardToOMAIMemory,onChange:w=>y("forwardToOMAIMemory",w.target.checked)}),label:"Forward executed files to OMAI memory"}),e.jsx(Be,{control:e.jsx(Ae,{checked:s.tagForAgentReflection,onChange:w=>y("tagForAgentReflection",w.target.checked)}),label:"Tag uploaded files for agent reflection"}),e.jsx(Be,{control:e.jsx(Ae,{checked:s.enableOMAIRecommendations,onChange:w=>y("enableOMAIRecommendations",w.target.checked)}),label:"Enable OMAI recommendations after execution"}),e.jsx(ue,{severity:"info",children:e.jsx(t,{variant:"body2",children:"OMAI integration allows the AI agent to learn from your file operations and provide intelligent suggestions."})})]})})]}),e.jsxs(Hs,{children:[e.jsx(qs,{expandIcon:e.jsx(rt,{}),children:e.jsxs(Q,{direction:"row",spacing:1,alignItems:"center",children:[e.jsx(Sn,{}),e.jsx(t,{variant:"h6",children:"ðŸ“‚ File Processing"})]})}),e.jsx(Gs,{children:e.jsxs(Q,{spacing:3,children:[e.jsxs(o,{children:[e.jsx(t,{variant:"subtitle1",gutterBottom:!0,sx:{fontWeight:"bold"},children:"Batch Processing"}),e.jsxs(Q,{direction:"row",spacing:2,sx:{mb:2},children:[e.jsx(_,{variant:"contained",startIcon:h?e.jsx(Oe,{size:16}):e.jsx(wa,{}),onClick:U,disabled:h,color:"primary",children:h?"Processing...":"Process All Files"}),e.jsx(ye,{title:"Test if secure storage mount is accessible and writable",children:e.jsx(_,{variant:"outlined",startIcon:v?e.jsx(Oe,{size:16}):e.jsx(tn,{}),onClick:q,disabled:v,color:"secondary",children:v?"Testing...":"Test Secure Mount"})})]}),h&&e.jsxs(o,{sx:{width:"100%",mb:2},children:[e.jsx(Ms,{variant:"indeterminate"}),e.jsx(t,{variant:"body2",color:"text.secondary",sx:{mt:1},children:"Processing files... This may take a few minutes."})]})]}),e.jsxs(o,{children:[e.jsx(t,{variant:"subtitle1",gutterBottom:!0,sx:{fontWeight:"bold"},children:"Storage Configuration"}),e.jsxs(Q,{spacing:2,children:[e.jsx(Be,{control:e.jsx(Ae,{checked:s.useSecureStorage,onChange:w=>y("useSecureStorage",w.target.checked)}),label:e.jsxs(o,{sx:{display:"flex",alignItems:"center",gap:1},children:[e.jsx(an,{fontSize:"small"}),e.jsx("span",{children:"Use Secure Storage (eCryptfs)"})]})}),e.jsx(Be,{control:e.jsx(Ae,{checked:s.retryOnMountFailure,onChange:w=>y("retryOnMountFailure",w.target.checked)}),label:"Retry on mount failure (up to 3 attempts)"}),e.jsx(Be,{control:e.jsx(Ae,{checked:s.autoProcessOnUpload,onChange:w=>y("autoProcessOnUpload",w.target.checked)}),label:"Auto-process files on upload"})]})]}),g&&e.jsxs(ue,{severity:g.accessible&&g.writable?"success":"error",sx:{mt:2},children:[e.jsx(t,{variant:"subtitle2",gutterBottom:!0,children:"Secure Mount Test Results"}),e.jsxs(Q,{spacing:1,children:[e.jsxs(t,{variant:"body2",children:["Path: ",e.jsx("code",{children:g.mountPath})]}),e.jsxs(t,{variant:"body2",children:["Accessible: ",g.accessible?"âœ… Yes":"âŒ No"]}),e.jsxs(t,{variant:"body2",children:["Writable: ",g.writable?"âœ… Yes":"âŒ No"]}),g.error&&e.jsxs(t,{variant:"body2",color:"error",children:["Error: ",g.error]}),e.jsxs(t,{variant:"caption",color:"text.secondary",children:["Tested at: ",new Date(g.testTime).toLocaleString()]})]})]}),D&&e.jsxs(ue,{severity:D.success?"success":"error",sx:{mt:2},children:[e.jsx(t,{variant:"subtitle2",gutterBottom:!0,children:"Processing Results"}),e.jsxs(Q,{spacing:1,children:[e.jsxs(t,{variant:"body2",children:["Total Files: ",D.summary.totalFiles]}),e.jsxs(t,{variant:"body2",children:["âœ… Processed: ",D.summary.processedCount]}),e.jsxs(t,{variant:"body2",children:["âŒ Failed: ",D.summary.failedCount]}),e.jsxs(t,{variant:"body2",children:["ðŸ”’ Secure Storage: ",D.secureStorage.mounted?"âœ… Mounted":"âŒ Not Available"]}),D.summary.durationMs&&e.jsxs(t,{variant:"body2",children:["Duration: ",(D.summary.durationMs/1e3).toFixed(2),"s"]})]})]}),D&&(D.processedFiles.length>0||D.failedFiles.length>0)&&e.jsxs(o,{children:[e.jsx(t,{variant:"subtitle1",gutterBottom:!0,sx:{fontWeight:"bold"},children:"Processing Log"}),e.jsx(De,{sx:{maxHeight:300,overflow:"auto",bgcolor:"#f5f5f5"},children:e.jsxs(xs,{dense:!0,children:[D.processedFiles.map((w,z)=>e.jsxs(Ze,{children:[e.jsx(Qs,{children:e.jsx(H,{label:"âœ“",size:"small",sx:{bgcolor:"#4caf50",color:"white",fontWeight:"bold"}})}),e.jsx(es,{primary:w.fileName,secondary:`${(w.size/1024).toFixed(1)} KB ${w.securelyStored?"â€¢ Stored securely":""}`,primaryTypographyProps:{fontFamily:"monospace",fontSize:"0.875rem"}})]},`success-${z}`)),D.failedFiles.map((w,z)=>e.jsxs(Ze,{children:[e.jsx(Qs,{children:e.jsx(H,{label:"âœ—",size:"small",sx:{bgcolor:"#f44336",color:"white",fontWeight:"bold"}})}),e.jsx(es,{primary:w.fileName,secondary:`Error: ${w.error}`,primaryTypographyProps:{fontFamily:"monospace",fontSize:"0.875rem"},secondaryTypographyProps:{color:"error"}})]},`failed-${z}`))]})})]}),e.jsx(ue,{severity:"info",children:e.jsx(t,{variant:"body2",children:"File processing converts uploaded .md files into the Big Book knowledge base. Enable secure storage for encrypted file storage using eCryptfs mounting."})})]})})]}),e.jsx(De,{sx:{p:2},children:e.jsxs(Q,{direction:"row",spacing:2,justifyContent:"flex-end",children:[e.jsx(_,{variant:"outlined",startIcon:e.jsx(js,{}),onClick:j,children:"Reset to Defaults"}),e.jsx(_,{variant:"contained",startIcon:e.jsx(Tr,{}),onClick:C,disabled:!u,children:"Save Settings"})]})})]})})},Ul=({files:s,consoleOutput:n,isExecuting:r,onFileSelect:a,onFileExecute:u,onFileDelete:l,onQuestionnairePreview:h,onClearConsole:m,selectedFile:v})=>{const[b,D]=i.useState(!1),[S,g]=i.useState("files"),[T,O]=i.useState(vn),p=()=>{D(!b)},y=U=>{O(U)},C=()=>{localStorage.setItem("bigbook-console-settings",JSON.stringify(T))},j=()=>{O(vn)};return e.jsxs(o,{sx:{height:"100vh",display:"flex",flexDirection:"column"},children:[e.jsx(o,{sx:{p:2,borderBottom:1,borderColor:"divider",backgroundColor:"background.paper"},children:e.jsxs(Q,{direction:"row",justifyContent:"space-between",alignItems:"center",children:[e.jsxs(o,{children:[e.jsx(t,{variant:"h5",component:"h1",children:"Big Book Console"}),e.jsx(t,{variant:"body2",color:"text.secondary",children:"File explorer and execution console"})]}),e.jsxs(Q,{direction:"row",spacing:1,children:[e.jsx(ye,{title:"Toggle Console",children:e.jsx(be,{onClick:p,color:"primary",children:e.jsx(nn,{})})}),b&&e.jsx(ye,{title:"Clear Console",children:e.jsx(be,{onClick:m,color:"error",children:e.jsx(lr,{})})}),e.jsx(ye,{title:"Refresh",children:e.jsx(be,{color:"primary",children:e.jsx(js,{})})}),e.jsx(ye,{title:"Settings",children:e.jsx(be,{onClick:()=>g(S==="files"?"settings":"files"),color:S==="settings"?"secondary":"primary",children:e.jsx(wt,{})})})]})]})}),e.jsxs(o,{sx:{flex:1,display:"flex",flexDirection:"column",overflow:"hidden"},children:[S==="files"?e.jsxs(o,{sx:{flex:1,display:"flex",overflow:"hidden"},children:[e.jsx(o,{sx:{width:"30%",minWidth:300,borderRight:1,borderColor:"divider"},children:e.jsx(_l,{files:s,selectedFile:v,onFileSelect:a,onFileExecute:u,onFileDelete:l,onQuestionnairePreview:h,isExecuting:r,settings:T})}),e.jsx(o,{sx:{flex:1},children:e.jsx(Ll,{file:v,onExecute:u,isExecuting:r,settings:T})})]}):e.jsx(o,{sx:{flex:1,overflow:"auto"},children:e.jsx(Nl,{settings:T,onSettingsChange:y,onSave:C,onReset:j})}),e.jsx(ya,{in:b,children:e.jsxs(o,{sx:{height:300,borderTop:1,borderColor:"divider"},children:[e.jsxs(o,{sx:{p:2,borderBottom:1,borderColor:"divider",backgroundColor:"grey.50",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsxs(t,{variant:"h6",sx:{display:"flex",alignItems:"center",gap:1},children:[e.jsx(nn,{fontSize:"small"}),"Console Output"]}),e.jsxs(Q,{direction:"row",spacing:1,children:[e.jsxs(t,{variant:"caption",color:"text.secondary",children:[n.length," messages"]}),e.jsx(_,{size:"small",startIcon:e.jsx(lr,{}),onClick:m,variant:"outlined",children:"Clear"})]})]}),e.jsx(o,{sx:{height:250,overflow:"auto",p:2,backgroundColor:T.darkModeConsole?"#1e1e1e":"#f8f9fa",color:T.darkModeConsole?"#ffffff":"#212529",fontFamily:"monospace",fontSize:"0.875rem"},children:n.length===0?e.jsx(o,{sx:{display:"flex",alignItems:"center",justifyContent:"center",height:"100%"},children:e.jsx(t,{color:"grey.500",textAlign:"center",children:"No console output yet. Execute files to see results."})}):n.map(U=>e.jsxs(o,{sx:{mb:1},children:[e.jsxs(t,{component:"span",sx:{color:U.type==="error"?"#ff6b6b":U.type==="success"?"#51cf66":U.type==="warning"?"#ffd43b":U.type==="command"?"#74c0fc":"#ffffff",fontWeight:U.type==="command"?"bold":"normal"},children:["[",formatTimeOnly(U.timestamp),"] ",U.message]}),U.details&&e.jsx(t,{component:"div",sx:{color:"#adb5bd",ml:2,mt:.5,whiteSpace:"pre-wrap"},children:U.details})]},U.id))})]})})]}),e.jsxs(o,{sx:{p:1,borderTop:1,borderColor:"divider",backgroundColor:"grey.50",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsxs(Q,{direction:"row",spacing:2,alignItems:"center",children:[e.jsxs(t,{variant:"caption",color:"text.secondary",children:[s.length," files loaded"]}),v&&e.jsxs(e.Fragment,{children:[e.jsx(t,{variant:"caption",color:"text.secondary",children:"â€¢"}),e.jsxs(t,{variant:"caption",color:"text.secondary",children:["Selected: ",v.name]})]})]}),e.jsxs(Q,{direction:"row",spacing:1,alignItems:"center",children:[r&&e.jsx(ue,{severity:"info",sx:{py:0,px:1},children:"Executing..."}),e.jsxs(t,{variant:"caption",color:"text.secondary",children:[n.length," console messages"]})]})]})]})},Wl=()=>{const[s,n]=i.useState(null),[r,a]=i.useState([]),[u,l]=i.useState(!1),[h,m]=i.useState(""),v=()=>E(void 0,null,function*(){l(!0),m("");try{const j=yield(yield fetch("/api/bigbook/storage/status")).json();j.success?n(j.status):m(j.error||"Failed to load storage status")}catch(C){m(C instanceof Error?C.message:"Failed to load storage status")}finally{l(!1)}}),b=()=>E(void 0,null,function*(){if(s!=null&&s.isMounted){l(!0),m("");try{const j=yield(yield fetch("/api/bigbook/storage/files")).json();j.success?a(j.files):m(j.error||"Failed to load files")}catch(C){m(C instanceof Error?C.message:"Failed to load files")}finally{l(!1)}}}),D=()=>E(void 0,null,function*(){l(!0),m("");try{const j=yield(yield fetch("/api/bigbook/storage/mount",{method:"POST"})).json();j.success?(yield v(),yield b()):m(j.error||"Failed to mount volume")}catch(C){m(C instanceof Error?C.message:"Failed to mount volume")}finally{l(!1)}}),S=()=>E(void 0,null,function*(){l(!0),m("");try{const j=yield(yield fetch("/api/bigbook/storage/unmount",{method:"POST"})).json();j.success?(yield v(),a([])):m(j.error||"Failed to unmount volume")}catch(C){m(C instanceof Error?C.message:"Failed to unmount volume")}finally{l(!1)}}),g=()=>E(void 0,null,function*(){if(window.confirm("Are you sure you want to rotate the encryption key? This will require remounting the volume.")){l(!0),m("");try{const j=yield(yield fetch("/api/bigbook/storage/rotate-key",{method:"POST"})).json();j.success?(yield v(),yield b()):m(j.error||"Failed to rotate key")}catch(C){m(C instanceof Error?C.message:"Failed to rotate key")}finally{l(!1)}}});i.useEffect(()=>{v()},[]),i.useEffect(()=>{s!=null&&s.isMounted&&b()},[s==null?void 0:s.isMounted]);const T=C=>{if(C===0)return"0 Bytes";const j=1024,U=["Bytes","KB","MB","GB"],q=Math.floor(Math.log(C)/Math.log(j));return parseFloat((C/Math.pow(j,q)).toFixed(2))+" "+U[q]},O=()=>s?s.error?e.jsx(Un,{}):s.isMounted?e.jsx(tn,{}):e.jsx(Lr,{}):e.jsx(_r,{}),p=()=>s?s.error?"error":s.isMounted?"success":"warning":"default",y=()=>s?s.error?"Error":s.isMounted?"Mounted":"Not Mounted":"Unknown";return e.jsxs(o,{sx:{p:3},children:[e.jsxs(t,{variant:"h4",gutterBottom:!0,children:[e.jsx(at,{sx:{mr:1,verticalAlign:"middle"}}),"Encrypted Storage Management"]}),h&&e.jsx(ue,{severity:"error",sx:{mb:2},children:h}),e.jsx(pe,{sx:{mb:3},children:e.jsxs(de,{children:[e.jsxs(o,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between",mb:2},children:[e.jsx(t,{variant:"h6",children:"Storage Status"}),e.jsx(o,{children:e.jsx(ye,{title:"Refresh Status",children:e.jsx(be,{onClick:v,disabled:u,children:e.jsx(js,{})})})})]}),u?e.jsxs(o,{sx:{display:"flex",alignItems:"center",justifyContent:"center",py:2},children:[e.jsx(Oe,{size:24,sx:{mr:1}}),e.jsx(t,{children:"Loading..."})]}):s?e.jsxs(Q,{spacing:2,children:[e.jsxs(o,{sx:{display:"flex",alignItems:"center",gap:1},children:[e.jsx(H,{icon:O(),label:y(),color:p(),variant:"outlined"}),s.isMounted&&e.jsx(H,{icon:e.jsx(cr,{}),label:"Unlocked",color:"success",variant:"outlined"})]}),e.jsxs(o,{sx:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:2},children:[e.jsxs(o,{children:[e.jsx(t,{variant:"body2",color:"text.secondary",children:"Mount Path"}),e.jsx(t,{variant:"body1",fontFamily:"monospace",children:s.mountPath})]}),e.jsxs(o,{children:[e.jsx(t,{variant:"body2",color:"text.secondary",children:"Source Path"}),e.jsx(t,{variant:"body1",fontFamily:"monospace",children:s.sourcePath})]}),e.jsxs(o,{children:[e.jsx(t,{variant:"body2",color:"text.secondary",children:"File Count"}),e.jsx(t,{variant:"body1",children:s.fileCount})]}),e.jsxs(o,{children:[e.jsx(t,{variant:"body2",color:"text.secondary",children:"Total Size"}),e.jsx(t,{variant:"body1",children:T(s.totalSize)})]})]}),e.jsx(ks,{}),e.jsxs(o,{sx:{display:"flex",gap:1},children:[s.isMounted?e.jsx(_,{variant:"outlined",startIcon:e.jsx(go,{}),onClick:S,disabled:u,children:"Unmount Volume"}):e.jsx(_,{variant:"contained",startIcon:e.jsx(cr,{}),onClick:D,disabled:u,children:"Mount Volume"}),e.jsx(_,{variant:"outlined",startIcon:e.jsx(Sa,{}),onClick:g,disabled:u||!s.isMounted,children:"Rotate Key"})]})]}):e.jsx(t,{color:"text.secondary",children:"No status available"})]})}),(s==null?void 0:s.isMounted)&&e.jsx(pe,{children:e.jsxs(de,{children:[e.jsxs(o,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between",mb:2},children:[e.jsxs(t,{variant:"h6",children:["Stored Files (",r.length,")"]}),e.jsx(ye,{title:"Refresh Files",children:e.jsx(be,{onClick:b,disabled:u,children:e.jsx(js,{})})})]}),u?e.jsxs(o,{sx:{display:"flex",alignItems:"center",justifyContent:"center",py:2},children:[e.jsx(Oe,{size:24,sx:{mr:1}}),e.jsx(t,{children:"Loading files..."})]}):r.length>0?e.jsx(xs,{children:r.map(C=>e.jsxs(Ze,{divider:!0,children:[e.jsx(Qs,{children:e.jsx(at,{})}),e.jsx(es,{primary:C.originalName,secondary:e.jsxs(o,{children:[e.jsxs(t,{variant:"body2",color:"text.secondary",children:["ID: ",C.fileId]}),e.jsxs(t,{variant:"body2",color:"text.secondary",children:["Size: ",T(C.size)," | Created: ",new Date(C.createdAt).toLocaleString()]}),e.jsx(t,{variant:"body2",color:"text.secondary",fontFamily:"monospace",fontSize:"0.75rem",children:C.relativePath})]})}),e.jsx(Rn,{children:e.jsxs(Q,{direction:"row",spacing:1,children:[e.jsx(ye,{title:"Download",children:e.jsx(be,{size:"small",children:e.jsx(Pr,{})})}),e.jsx(ye,{title:"Delete",children:e.jsx(be,{size:"small",color:"error",children:e.jsx(St,{})})})]})})]},C.fileId))}):e.jsx(t,{color:"text.secondary",textAlign:"center",py:2,children:"No files stored in encrypted storage"})]})}),e.jsx(pe,{sx:{mt:3},children:e.jsxs(de,{children:[e.jsxs(t,{variant:"h6",gutterBottom:!0,children:[e.jsx(an,{sx:{mr:1,verticalAlign:"middle"}}),"Security Information"]}),e.jsxs(Q,{spacing:1,children:[e.jsx(t,{variant:"body2",children:"â€¢ Files are encrypted using eCryptFS with AES-256 encryption"}),e.jsx(t,{variant:"body2",children:"â€¢ Encryption keys are stored securely and never exposed in plaintext"}),e.jsx(t,{variant:"body2",children:"â€¢ Files are only accessible through the Big Book Viewer interface"}),e.jsx(t,{variant:"body2",children:"â€¢ Direct filesystem access is blocked via restrictive permissions"}),e.jsx(t,{variant:"body2",children:"â€¢ Volume auto-locks when unmounted or service stops"})]})]})})]})},Vl=({open:s,onClose:n,file:r,onSubmit:a})=>{var q;const[u,l]=i.useState(!1),[h,m]=i.useState(""),[v,b]=i.useState({}),[D,S]=i.useState(!1),[g,T]=i.useState(""),O=i.useRef(null),p=w=>{const z=[],te=[{pattern:/eval\s*\(/,message:"eval() calls are not allowed"},{pattern:/Function\s*\(/,message:"Function constructor is not allowed"},{pattern:/innerHTML\s*=/,message:"innerHTML is not allowed"},{pattern:/dangerouslySetInnerHTML/,message:"dangerouslySetInnerHTML is not allowed"},{pattern:/document\.write/,message:"document.write is not allowed"},{pattern:/window\./,message:"Direct window access is restricted"},{pattern:/fetch\s*\(/,message:"fetch calls should be validated"},{pattern:/XMLHttpRequest/,message:"XMLHttpRequest is not allowed"}];for(const{pattern:I,message:A}of te)I.test(w)&&z.push(A);return{isValid:z.length===0,issues:z}},y=w=>`
      (function() {
        'use strict';
        
        // Restricted globals
        const window = undefined;
        const document = undefined;
        const global = undefined;
        const process = undefined;
        const require = undefined;
        const module = undefined;
        const exports = undefined;
        
        // Safe React context
        const React = {
          useState: parent.React.useState,
          useEffect: parent.React.useEffect,
          useCallback: parent.React.useCallback,
          useMemo: parent.React.useMemo,
          createElement: parent.React.createElement,
          Fragment: parent.React.Fragment
        };
        
        // Safe UI components (limited subset)
        const { 
          Box, 
          Typography, 
          Button, 
          TextField, 
          Radio, 
          RadioGroup, 
          FormControl, 
          FormLabel, 
          FormControlLabel,
          Checkbox,
          Select,
          MenuItem,
          Slider,
          Stack,
          Card,
          CardContent
        } = parent.MUI;
        
        // Response handler
        const handleResponse = (questionId, answer) => {
          parent.postMessage({
            type: 'QUESTIONNAIRE_RESPONSE',
            data: { questionId, answer }
          }, '*');
        };
        
        // Component code
        ${w.replace(/import\s+.*?from\s+['"][^'"]*?['"];?/g,"").replace(/export\s+default\s+/,"").replace(/export\s+/,"")}
        
        // Render the component
        try {
          const component = typeof Questionnaire === 'function' 
            ? React.createElement(Questionnaire, { onResponse: handleResponse })
            : React.createElement('div', {}, 'Invalid questionnaire component');
          
          parent.ReactDOM.render(component, document.getElementById('questionnaire-root'));
        } catch (error) {
          parent.postMessage({
            type: 'QUESTIONNAIRE_ERROR',
            data: { message: error.message }
          }, '*');
        }
      })();
    `,C=()=>{if(!r||!r.isQuestionnaire||!r.content){T("Invalid questionnaire file");return}const w=p(r.content);if(!w.isValid){T(`Security validation failed: ${w.issues.join(", ")}`);return}l(!0),T("");try{const te=`
        <!DOCTYPE html>
        <html>
        <head>
          <meta charset="utf-8">
          <title>Questionnaire Preview</title>
          <style>
            body { 
              font-family: 'Roboto', sans-serif; 
              margin: 16px; 
              background: #fafafa;
            }
            #questionnaire-root { 
              max-width: 800px; 
              margin: 0 auto; 
              background: white;
              border-radius: 8px;
              padding: 24px;
              box-shadow: 0 2px 8px rgba(0,0,0,0.1);
            }
          </style>
          <script crossorigin src="https://unpkg.com/react@18/umd/react.development.js"><\/script>
          <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"><\/script>
          <script crossorigin src="https://unpkg.com/@mui/material@latest/umd/material-ui.development.js"><\/script>
        </head>
        <body>
          <div id="questionnaire-root">
            <div style="text-align: center; padding: 40px;">
              <div style="font-size: 18px; color: #666;">Loading questionnaire...</div>
            </div>
          </div>
          <script>
            // Set up communication
            window.addEventListener('message', function(event) {
              if (event.data.type === 'QUESTIONNAIRE_RESPONSE') {
                parent.postMessage(event.data, '*');
              } else if (event.data.type === 'QUESTIONNAIRE_ERROR') {
                parent.postMessage(event.data, '*');
              }
            });
            
            // Make React and MUI available
            window.React = React;
            window.ReactDOM = ReactDOM;
            window.MUI = MaterialUI;
            
            // Execute sandboxed component
            ${y(r.content)}
          <\/script>
        </body>
        </html>
      `;if(O.current){const I=O.current;I.srcdoc=te}l(!1)}catch(z){T(`Failed to render component: ${z instanceof Error?z.message:"Unknown error"}`),l(!1)}};i.useEffect(()=>{const w=z=>{if(z.data.type==="QUESTIONNAIRE_RESPONSE"){const{questionId:te,answer:I}=z.data.data;b(A=>G(V({},A),{[te]:{answer:I,timestamp:new Date}}))}else z.data.type==="QUESTIONNAIRE_ERROR"&&T(z.data.data.message)};return window.addEventListener("message",w),()=>window.removeEventListener("message",w)},[]),i.useEffect(()=>{s&&r&&r.isQuestionnaire&&C()},[s,r]);const j=()=>E(void 0,null,function*(){if(r!=null&&r.questionnaireMetadata){S(!0);try{const w={questionnaireId:r.questionnaireMetadata.id,responses:Object.entries(v).map(([z,te])=>({questionId:z,answer:te.answer,timestamp:te.timestamp})),ageGroup:r.questionnaireMetadata.ageGroup,questionnaireTitle:r.questionnaireMetadata.title,progressPercent:Object.keys(v).length>0?100:0,isCompleted:!0};yield a(w),n()}catch(w){m(w instanceof Error?w.message:"Submission failed")}S(!1)}}),U=Object.keys(v).length;return e.jsxs(as,{open:s,onClose:n,maxWidth:"lg",fullWidth:!0,PaperProps:{sx:{height:"90vh",display:"flex",flexDirection:"column"}},children:[e.jsxs(os,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[e.jsxs(o,{sx:{display:"flex",alignItems:"center",gap:1},children:[e.jsx(nt,{color:"primary"}),e.jsx(t,{variant:"h6",children:((q=r==null?void 0:r.questionnaireMetadata)==null?void 0:q.title)||"Questionnaire Preview"})]}),e.jsx(be,{onClick:n,size:"small",children:e.jsx(jo,{})})]}),e.jsxs(is,{sx:{flex:1,display:"flex",flexDirection:"column",p:0},children:[(r==null?void 0:r.questionnaireMetadata)&&e.jsx(pe,{sx:{m:2,mb:1},variant:"outlined",children:e.jsxs(de,{sx:{py:2},children:[e.jsxs(Q,{direction:"row",spacing:2,alignItems:"center",flexWrap:"wrap",children:[e.jsx(H,{icon:e.jsx(ka,{}),label:r.questionnaireMetadata.ageGroup,size:"small",color:"primary"}),e.jsx(H,{icon:e.jsx(Ia,{}),label:`${r.questionnaireMetadata.estimatedDuration} min`,size:"small",color:"secondary"}),e.jsx(H,{icon:e.jsx(an,{}),label:"Sandboxed",size:"small",color:"success"}),e.jsxs(t,{variant:"body2",color:"text.secondary",children:["v",r.questionnaireMetadata.version," by ",r.questionnaireMetadata.author]})]}),r.questionnaireMetadata.description&&e.jsx(t,{variant:"body2",sx:{mt:1},children:r.questionnaireMetadata.description})]})}),(h||g)&&e.jsx(ue,{severity:"error",sx:{m:2},children:h||g}),u&&e.jsx(o,{sx:{display:"flex",justifyContent:"center",alignItems:"center",flex:1},children:e.jsxs(Q,{alignItems:"center",spacing:2,children:[e.jsx(Oe,{}),e.jsx(t,{children:"Loading questionnaire..."})]})}),!u&&!h&&!g&&e.jsx(o,{sx:{flex:1,border:1,borderColor:"divider",m:2,borderRadius:1},children:e.jsx("iframe",{ref:O,style:{width:"100%",height:"100%",border:"none",borderRadius:"4px"},sandbox:"allow-scripts allow-same-origin",title:"Questionnaire Preview"})}),U>0&&e.jsx(pe,{sx:{m:2,mt:0},variant:"outlined",children:e.jsxs(de,{sx:{py:2},children:[e.jsxs(t,{variant:"subtitle2",gutterBottom:!0,children:["Responses Collected: ",U]}),e.jsx(o,{sx:{maxHeight:100,overflow:"auto"},children:Object.entries(v).map(([w,z])=>e.jsxs(t,{variant:"body2",color:"text.secondary",children:[w,": ",JSON.stringify(z.answer).substring(0,50),"..."]},w))})]})})]}),e.jsxs(ls,{sx:{p:2,borderTop:1,borderColor:"divider"},children:[e.jsx(_,{onClick:n,disabled:D,children:"Cancel"}),e.jsx(_,{onClick:j,variant:"contained",disabled:U===0||D,startIcon:D?e.jsx(Oe,{size:16}):e.jsx(mo,{}),children:D?"Submitting...":"Submit Responses"})]})]})},Hl=()=>{var ts,Xe,Ge,Ke,ns,Ve;const[s,n]=i.useState(null),[r,a]=i.useState(null),[u,l]=i.useState(null),[h,m]=i.useState(!1),[v,b]=i.useState(!1),[D,S]=i.useState(null),[g,T]=i.useState([]),[O,p]=i.useState(null),[y,C]=i.useState(""),[j,U]=i.useState(!1),[q,w]=i.useState(!1),[z,te]=i.useState(24),[I,A]=i.useState(!1),[L,X]=i.useState(null),[Se,Ce]=i.useState(!1);i.useEffect(()=>{le(),$(),f(),R()},[]);const le=()=>E(void 0,null,function*(){try{const k=yield(yield fetch("/api/bigbook/omai/status")).json();k.success&&n(k.status)}catch(Y){console.error("Failed to load OMAI status:",Y)}}),$=()=>E(void 0,null,function*(){try{const k=yield(yield fetch("/api/bigbook/omai/summary")).json();k.success&&k.summary&&a(k.summary)}catch(Y){console.error("Failed to load discovery summary:",Y)}}),f=()=>E(void 0,null,function*(){try{const k=yield(yield fetch("/api/bigbook/omai/index")).json();k.success&&k.index&&l(k.index)}catch(Y){console.error("Failed to load Big Book index:",Y)}}),J=()=>E(void 0,null,function*(){m(!0);try{(yield(yield fetch("/api/bigbook/omai/initialize",{method:"POST"})).json()).success&&(yield le())}catch(Y){console.error("Failed to initialize OMAI:",Y)}finally{m(!1)}}),ve=()=>E(void 0,null,function*(){b(!0);try{if((yield(yield fetch("/api/bigbook/omai/discover",{method:"POST"})).json()).success){const ee=setInterval(()=>E(void 0,null,function*(){yield le(),yield $(),yield f()}),5e3);setTimeout(()=>{clearInterval(ee),b(!1)},3e5)}}catch(Y){console.error("Failed to start discovery:",Y),b(!1)}}),B=Y=>E(void 0,null,function*(){try{const k=Y.toLowerCase().replace(/[^a-z0-9]/g,"_"),oe=yield(yield fetch(`/api/bigbook/omai/category/${k}`)).json();oe.success&&(T(oe.files),S(Y))}catch(k){console.error("Failed to load category files:",k)}}),ae=Y=>E(void 0,null,function*(){try{const[k,ee]=yield Promise.all([fetch(`/api/bigbook/omai/file/${Y}`),fetch(`/api/bigbook/omai/file/${Y}/content`)]),oe=yield k.json(),Pe=yield ee.json();oe.success&&Pe.success&&(p(oe.file),C(Pe.content),U(!0))}catch(k){console.error("Failed to load file details:",k)}}),_e=()=>E(void 0,null,function*(){try{(yield(yield fetch("/api/bigbook/omai/schedule",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({intervalHours:z})})).json()).success&&(w(!1),yield le())}catch(Y){console.error("Failed to schedule discovery:",Y)}}),R=()=>E(void 0,null,function*(){try{const k=yield(yield fetch("/api/omai/learning-status")).json();k.success&&X(k)}catch(Y){console.error("Failed to load learning status:",Y)}}),Z=()=>E(void 0,null,function*(){A(!0);try{const k=yield(yield fetch("/api/omai/learn-now",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({forceRefresh:!0})})).json();k.success?(Ce(!0),yield R()):console.error("Learning refresh failed:",k.error)}catch(Y){console.error("Failed to refresh learning:",Y)}finally{A(!1)}}),ce=Y=>{if(Y===0)return"0 Bytes";const k=1024,ee=["Bytes","KB","MB","GB"],oe=Math.floor(Math.log(Y)/Math.log(k));return parseFloat((Y/Math.pow(k,oe)).toFixed(2))+" "+ee[oe]},me=Y=>{switch(Y){case"ready":return"success";case"not_initialized":return"warning";case"error":return"error";default:return"default"}},ge=Y=>Y.includes("DevOps")?e.jsx(ds,{}):Y.includes("Documentation")?e.jsx(Ct,{}):Y.includes("Backend")?e.jsx(ds,{}):Y.includes("Frontend")?e.jsx(ds,{}):e.jsx(At,{});return e.jsxs(o,{sx:{p:3},children:[e.jsx(pe,{sx:{mb:3},children:e.jsxs(de,{children:[e.jsxs(o,{display:"flex",justifyContent:"space-between",alignItems:"center",mb:2,children:[e.jsxs(t,{variant:"h5",component:"h2",children:[e.jsx(Ft,{sx:{mr:1,verticalAlign:"middle"}}),"OMAI Path Discovery"]}),e.jsxs(o,{children:[e.jsx(_,{variant:"outlined",startIcon:e.jsx(js,{}),onClick:le,sx:{mr:1},children:"Refresh"}),e.jsx(_,{variant:"contained",color:"secondary",startIcon:I?e.jsx(Oe,{size:16}):e.jsx(Ft,{}),onClick:Z,disabled:I,sx:{mr:1},children:I?"Learning...":"Refresh Learning"}),e.jsx(_,{variant:"contained",startIcon:e.jsx(fo,{}),onClick:()=>w(!0),children:"Schedule"})]})]}),s&&e.jsx(ue,{severity:me(s.status),sx:{mb:2},children:e.jsxs(t,{variant:"body2",children:[e.jsx("strong",{children:"Status:"})," ",s.status,s.message&&` - ${s.message}`,s.totalFiles&&` | ${s.totalFiles} files indexed`,s.lastDiscovery&&` | Last discovery: ${new Date(s.lastDiscovery).toLocaleString()}`]})}),e.jsxs(o,{display:"flex",gap:2,children:[(s==null?void 0:s.status)==="not_initialized"&&e.jsx(_,{variant:"contained",startIcon:e.jsx(gt,{}),onClick:J,disabled:h,children:h?e.jsx(Oe,{size:20}):"Initialize OMAI"}),(s==null?void 0:s.status)==="ready"&&e.jsx(_,{variant:"contained",startIcon:v?e.jsx(Oe,{size:20}):e.jsx(Nn,{}),onClick:ve,disabled:v,children:v?"Discovering...":"Start Discovery"})]})]})}),r&&e.jsx(pe,{sx:{mb:3},children:e.jsxs(de,{children:[e.jsxs(t,{variant:"h6",gutterBottom:!0,children:[e.jsx(Nr,{sx:{mr:1,verticalAlign:"middle"}}),"Discovery Summary"]}),e.jsxs(M,{container:!0,spacing:3,children:[e.jsx(M,{item:!0,xs:12,sm:6,md:3,children:e.jsxs(De,{sx:{p:2,textAlign:"center"},children:[e.jsx(t,{variant:"h4",color:"primary",children:r.totalFiles}),e.jsx(t,{variant:"body2",color:"text.secondary",children:"Total Files"})]})}),e.jsx(M,{item:!0,xs:12,sm:6,md:3,children:e.jsxs(De,{sx:{p:2,textAlign:"center"},children:[e.jsx(t,{variant:"h4",color:"success.main",children:Object.keys(r.categories).length}),e.jsx(t,{variant:"body2",color:"text.secondary",children:"Categories"})]})}),e.jsx(M,{item:!0,xs:12,sm:6,md:3,children:e.jsxs(De,{sx:{p:2,textAlign:"center"},children:[e.jsx(t,{variant:"h4",color:"info.main",children:ce(r.totalSize)}),e.jsx(t,{variant:"body2",color:"text.secondary",children:"Total Size"})]})}),e.jsx(M,{item:!0,xs:12,sm:6,md:3,children:e.jsxs(De,{sx:{p:2,textAlign:"center"},children:[e.jsx(t,{variant:"h4",color:"warning.main",children:ce(r.averageFileSize)}),e.jsx(t,{variant:"body2",color:"text.secondary",children:"Avg File Size"})]})})]}),e.jsxs(o,{mt:3,children:[e.jsx(t,{variant:"subtitle1",gutterBottom:!0,children:"Top Categories"}),e.jsx(M,{container:!0,spacing:1,children:r.topCategories.slice(0,6).map((Y,k)=>e.jsx(M,{item:!0,children:e.jsx(H,{label:`${Y.category}: ${Y.count}`,variant:"outlined",size:"small",clickable:!0,onClick:()=>B(Y.category)})},k))})]})]})}),u&&e.jsx(pe,{children:e.jsxs(de,{children:[e.jsxs(t,{variant:"h6",gutterBottom:!0,children:[e.jsx(At,{sx:{mr:1,verticalAlign:"middle"}}),"File Index - ",u.totalFiles," Files"]}),e.jsx(o,{mb:2,children:Object.entries(u.categories).map(([Y,k])=>e.jsxs(Hs,{children:[e.jsx(qs,{expandIcon:e.jsx(rt,{}),children:e.jsxs(o,{display:"flex",alignItems:"center",width:"100%",children:[ge(Y),e.jsx(t,{sx:{ml:1,flex:1},children:Y}),e.jsx(en,{badgeContent:k.count,color:"primary",sx:{mr:2}})]})}),e.jsxs(Gs,{children:[e.jsx(ht,{children:e.jsxs(mt,{size:"small",children:[e.jsx(xt,{children:e.jsxs(vs,{children:[e.jsx(W,{children:"Name"}),e.jsx(W,{children:"Type"}),e.jsx(W,{children:"Size"}),e.jsx(W,{children:"Modified"}),e.jsx(W,{children:"Actions"})]})}),e.jsx(pt,{children:k.files.slice(0,10).map(ee=>e.jsxs(vs,{children:[e.jsx(W,{children:e.jsx(t,{variant:"body2",noWrap:!0,children:ee.name})}),e.jsx(W,{children:e.jsx(H,{label:ee.type,size:"small",variant:"outlined"})}),e.jsx(W,{children:ce(ee.size)}),e.jsx(W,{children:new Date(ee.modified).toLocaleDateString()}),e.jsx(W,{children:e.jsx(be,{size:"small",onClick:()=>ae(ee.id),children:e.jsx(Os,{})})})]},ee.id))})]})}),k.files.length>10&&e.jsxs(t,{variant:"caption",sx:{mt:1,display:"block"},children:["Showing 10 of ",k.files.length," files"]})]})]},Y))})]})}),e.jsxs(as,{open:j,onClose:()=>U(!1),maxWidth:"lg",fullWidth:!0,children:[e.jsxs(os,{children:[O==null?void 0:O.name,(O==null?void 0:O.metadata.security.hasSecurityIssues)&&e.jsx(H,{icon:e.jsx(an,{}),label:"Security Redacted",color:"warning",size:"small",sx:{ml:2}})]}),e.jsx(is,{children:O&&e.jsxs(o,{children:[e.jsxs(M,{container:!0,spacing:2,mb:3,children:[e.jsxs(M,{item:!0,xs:12,sm:6,children:[e.jsx(t,{variant:"subtitle2",children:"Classification"}),e.jsx(t,{variant:"body2",children:O.classification.type}),e.jsx(t,{variant:"body2",color:"text.secondary",children:O.classification.category})]}),e.jsxs(M,{item:!0,xs:12,sm:6,children:[e.jsx(t,{variant:"subtitle2",children:"File Stats"}),e.jsxs(t,{variant:"body2",children:[O.metadata.fileStats.lines," lines, "," ",O.metadata.fileStats.words," words, "," ",ce(O.size)]})]})]}),e.jsx(t,{variant:"subtitle2",gutterBottom:!0,children:"Content Preview"}),e.jsx(Ne,{multiline:!0,rows:20,fullWidth:!0,variant:"outlined",value:y,InputProps:{readOnly:!0,sx:{fontFamily:"monospace",fontSize:"0.875rem"}}})]})}),e.jsx(ls,{children:e.jsx(_,{onClick:()=>U(!1),children:"Close"})})]}),e.jsxs(as,{open:Se,onClose:()=>Ce(!1),maxWidth:"md",fullWidth:!0,children:[e.jsxs(os,{children:[e.jsx(Ft,{sx:{mr:1,verticalAlign:"middle"}}),"OMAI Learning Refresh Complete"]}),e.jsx(is,{children:L&&e.jsxs(o,{children:[e.jsx(ue,{severity:"success",sx:{mb:2},children:"Learning refresh completed successfully! OMAI has updated its knowledge base."}),e.jsxs(M,{container:!0,spacing:2,children:[e.jsxs(M,{item:!0,xs:12,sm:6,children:[e.jsx(t,{variant:"subtitle2",gutterBottom:!0,children:"Learning Status"}),e.jsxs(t,{variant:"body2",children:["Active: ",(ts=L.learning)!=null&&ts.isActive?"Yes":"No"]}),e.jsxs(t,{variant:"body2",children:["Last Run: ",(Xe=L.learning)!=null&&Xe.lastRun?new Date(L.learning.lastRun).toLocaleString():"Never"]}),e.jsxs(t,{variant:"body2",children:["Files Processed: ",((Ge=L.learning)==null?void 0:Ge.totalFilesProcessed)||0]}),e.jsxs(t,{variant:"body2",children:["Memory Cache: ",((Ke=L.learning)==null?void 0:Ke.memoryCacheSize)||0," entries"]})]}),e.jsxs(M,{item:!0,xs:12,sm:6,children:[e.jsx(t,{variant:"subtitle2",gutterBottom:!0,children:"Learning Sources"}),e.jsx(xs,{dense:!0,children:L.sources&&Object.entries(L.sources).map(([Y,k])=>e.jsx(Ze,{divider:!0,children:e.jsx(es,{primary:k.path,secondary:`${k.type} (${k.priority} priority)`})},Y))})]})]}),e.jsxs(o,{mt:2,children:[e.jsx(t,{variant:"subtitle2",gutterBottom:!0,children:"Registered OMAI Agents"}),e.jsx(o,{children:(Ve=(ns=L.agents)==null?void 0:ns.registered)==null?void 0:Ve.map(Y=>e.jsx(H,{label:Y,size:"small",sx:{mr:1,mb:1}},Y))})]})]})}),e.jsx(ls,{children:e.jsx(_,{onClick:()=>Ce(!1),children:"Close"})})]}),e.jsxs(as,{open:q,onClose:()=>w(!1),children:[e.jsx(os,{children:"Schedule Discovery"}),e.jsx(is,{children:e.jsx(Ne,{autoFocus:!0,margin:"dense",label:"Interval (hours)",type:"number",fullWidth:!0,variant:"outlined",value:z,onChange:Y=>te(parseInt(Y.target.value)||24),helperText:"How often should OMAI scan for new/changed files?"})}),e.jsxs(ls,{children:[e.jsx(_,{onClick:()=>w(!1),children:"Cancel"}),e.jsx(_,{onClick:_e,variant:"contained",children:"Schedule"})]})]})]})},ql=({open:s,onClose:n,file:r,onInstallComplete:a,onConsoleMessage:u})=>{const[l,h]=i.useState(0),[m,v]=i.useState(null),[b,D]=i.useState(!1),[S,g]=i.useState({targetDirectory:"src/components/",installMissingPackages:!0,registerInRegistry:!0,openPreview:!0,overwriteExisting:!1,bigBookAutoInstall:!1}),[T,O]=i.useState(null),[p,y]=i.useState(["src/components/","src/components/admin/","src/components/shared/","src/components/custom/","src/pages/","src/views/","src/addons/"]),C=["Parse & Validate","Configure Installation","Install Component"];i.useEffect(()=>{s&&r&&l===0&&j()},[s,r,l]);const j=()=>E(void 0,null,function*(){var I;if(r){D(!0),u("info",`ðŸ” Parsing .tsx file: ${r.name}`);try{const A=yield r.text(),L=yield fetch("/api/bigbook/parse-tsx-component",{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({fileName:r.name,content:A})});if(L.status===401||L.status===403){u("error","ðŸ” Authentication required: Please log in as super_admin or editor to use Big Book auto-install");return}if(!L.ok){u("error",`âŒ Server error: HTTP ${L.status} - ${L.statusText}`);return}const X=yield L.json();X.success?(v(X.componentInfo),u("success",`âœ… Component parsed successfully: ${X.componentInfo.componentName}`),X.componentInfo.warnings.length>0&&X.componentInfo.warnings.forEach(Se=>{u("warning",`âš ï¸ ${Se}`)}),h(1)):(u("error",`âŒ Failed to parse component: ${X.error}`),(I=X.errors)==null||I.forEach(Se=>{u("error",`âŒ ${Se}`)}))}catch(A){u("error",`âŒ Parse error: ${A instanceof Error?A.message:"Unknown error"}`)}finally{D(!1)}}}),U=()=>E(void 0,null,function*(){if(m){D(!0),h(2),u("info",`ðŸš€ Installing component: ${m.componentName}`);try{const I=S.bigBookAutoInstall?"/api/bigbook/install-bigbook-component":"/api/bigbook/install-tsx-component";u("info",S.bigBookAutoInstall?"ðŸ“š Installing as Big Book custom component with auto-menu integration...":"ðŸ§© Installing as standard TSX component...");const L=yield(yield fetch(I,{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({componentInfo:m,installOptions:S})})).json();L.success?(O(L),u("success","ðŸŽ‰ Component installed successfully!"),u("info",`ðŸ“ Location: ${L.installedPath}`),L.packagesInstalled&&L.packagesInstalled.length>0&&u("success",`ðŸ“¦ Packages installed: ${L.packagesInstalled.join(", ")}`),L.registryUpdated&&u("success","ðŸ“ Component registered in registry"),L.menuUpdated&&u("success","ðŸ§© Component added to Big Book sidebar menu"),S.openPreview&&L.previewUrl&&u("info",`ðŸ”— Preview available at: ${L.previewUrl}`),a(L)):u("error",`âŒ Installation failed: ${L.error}`)}catch(I){u("error",`âŒ Installation error: ${I instanceof Error?I.message:"Unknown error"}`)}finally{D(!1)}}}),q=()=>E(void 0,null,function*(){if(T){D(!0),u("info",`ðŸ—‘ï¸ Removing component: ${m==null?void 0:m.componentName}`);try{const I=S.bigBookAutoInstall?"/api/bigbook/remove-bigbook-component":"/api/bigbook/remove-tsx-component",L=yield(yield fetch(I,{method:"DELETE",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({installationResult:T})})).json();L.success?(u("success","âœ… Component removed successfully"),O(null),h(1)):u("error",`âŒ Removal failed: ${L.error}`)}catch(I){u("error",`âŒ Removal error: ${I instanceof Error?I.message:"Unknown error"}`)}finally{D(!1)}}}),w=()=>e.jsx(o,{sx:{mt:2},children:b?e.jsxs(o,{display:"flex",alignItems:"center",justifyContent:"center",py:4,children:[e.jsx(Oe,{sx:{mr:2}}),e.jsx(t,{children:"Parsing component file..."})]}):m?e.jsxs(o,{children:[e.jsxs(ue,{severity:m.isValid?"success":"error",sx:{mb:2},children:[e.jsx(t,{variant:"h6",children:m.isValid?"Valid React Component":"Invalid Component"}),e.jsxs(t,{variant:"body2",children:[m.componentName," (",m.size," bytes)"]})]}),e.jsxs(M,{container:!0,spacing:2,children:[e.jsx(M,{item:!0,xs:12,md:6,children:e.jsx(pe,{children:e.jsxs(de,{children:[e.jsxs(t,{variant:"h6",gutterBottom:!0,children:[e.jsx(ds,{sx:{mr:1,verticalAlign:"middle"}}),"Component Details"]}),e.jsxs(xs,{dense:!0,children:[e.jsx(Ze,{children:e.jsx(es,{primary:"Component Name",secondary:m.componentName})}),e.jsx(Ze,{children:e.jsx(es,{primary:"Export Type",secondary:m.isDefaultExport?"Default Export":"Named Export"})}),e.jsx(Ze,{children:e.jsx(es,{primary:"Uses JSX",secondary:m.hasJSX?"Yes":"No"})}),e.jsx(Ze,{children:e.jsx(es,{primary:"Uses Hooks",secondary:m.hasHooks?"Yes":"No"})})]})]})})}),e.jsx(M,{item:!0,xs:12,md:6,children:e.jsx(pe,{children:e.jsxs(de,{children:[e.jsxs(t,{variant:"h6",gutterBottom:!0,children:[e.jsx(Ut,{sx:{mr:1,verticalAlign:"middle"}}),"Dependencies"]}),m.imports.length>0?e.jsxs(o,{sx:{mb:2},children:[e.jsx(t,{variant:"subtitle2",gutterBottom:!0,children:"Imports:"}),m.imports.map((I,A)=>e.jsx(H,{label:I,size:"small",sx:{mr:.5,mb:.5}},A))]}):null,m.missingPackages.length>0?e.jsxs(o,{children:[e.jsx(t,{variant:"subtitle2",gutterBottom:!0,color:"warning.main",children:"Missing Packages:"}),m.missingPackages.map((I,A)=>e.jsx(H,{label:I,size:"small",color:"warning",sx:{mr:.5,mb:.5}},A))]}):e.jsx(t,{variant:"body2",color:"success.main",children:"All dependencies available"})]})})})]}),(m.errors.length>0||m.warnings.length>0)&&e.jsxs(Hs,{sx:{mt:2},children:[e.jsx(qs,{expandIcon:e.jsx(rt,{}),children:e.jsxs(t,{children:["Issues (",m.errors.length," errors, ",m.warnings.length," warnings)"]})}),e.jsxs(Gs,{children:[m.errors.map((I,A)=>e.jsx(ue,{severity:"error",sx:{mb:1},children:I},A)),m.warnings.map((I,A)=>e.jsx(ue,{severity:"warning",sx:{mb:1},children:I},A))]})]})]}):e.jsx(ue,{severity:"info",children:"Drop a .tsx file to begin parsing..."})}),z=()=>e.jsxs(o,{sx:{mt:2},children:[e.jsx(t,{variant:"h6",gutterBottom:!0,children:"Installation Configuration"}),e.jsxs(M,{container:!0,spacing:3,children:[e.jsx(M,{item:!0,xs:12,children:e.jsx(De,{sx:{p:2,mb:2,bgcolor:"primary.50",border:"1px solid",borderColor:"primary.200"},children:e.jsx(Be,{control:e.jsx(Ae,{checked:S.bigBookAutoInstall,onChange:I=>{const A=I.target.checked;g(L=>G(V({},L),{bigBookAutoInstall:A,targetDirectory:A?"src/components/bigbook/custom":"src/components/",registerInRegistry:!0}))},color:"primary"}),label:e.jsxs(o,{children:[e.jsx(t,{variant:"subtitle1",fontWeight:600,color:"primary.main",children:"ðŸš€ Big Book Auto-Install Mode"}),e.jsx(t,{variant:"body2",color:"text.secondary",children:"Install as Big Book custom component with automatic menu integration and routing"})]})})})}),e.jsx(M,{item:!0,xs:12,children:e.jsxs(hs,{fullWidth:!0,children:[e.jsx(Dr,{children:"Target Directory"}),e.jsx(Ne,{select:!0,value:S.targetDirectory,onChange:I=>g(A=>G(V({},A),{targetDirectory:I.target.value})),SelectProps:{native:!0},sx:{mt:1},disabled:S.bigBookAutoInstall,helperText:S.bigBookAutoInstall?"Directory is automatically set for Big Book components":"Choose where to install the component",children:p.map(I=>e.jsx("option",{value:I,children:I},I))})]})}),e.jsx(M,{item:!0,xs:12,children:e.jsxs(De,{sx:{p:2},children:[e.jsx(t,{variant:"subtitle1",gutterBottom:!0,children:"Installation Options"}),e.jsx(Be,{control:e.jsx(Ae,{checked:S.installMissingPackages,onChange:I=>g(A=>G(V({},A),{installMissingPackages:I.target.checked}))}),label:e.jsxs(o,{children:[e.jsx(t,{variant:"body2",children:"Install Missing NPM Packages"}),e.jsx(t,{variant:"caption",color:"text.secondary",children:"Automatically install any missing dependencies"})]})}),e.jsx(Be,{control:e.jsx(Ae,{checked:S.registerInRegistry,onChange:I=>g(A=>G(V({},A),{registerInRegistry:I.target.checked}))}),label:e.jsxs(o,{children:[e.jsx(t,{variant:"body2",children:"Register in Component Registry"}),e.jsx(t,{variant:"caption",color:"text.secondary",children:"Add component to the system registry for discovery"})]})}),e.jsx(Be,{control:e.jsx(Ae,{checked:S.openPreview,onChange:I=>g(A=>G(V({},A),{openPreview:I.target.checked}))}),label:e.jsxs(o,{children:[e.jsx(t,{variant:"body2",children:"Open Component Preview"}),e.jsx(t,{variant:"caption",color:"text.secondary",children:"Launch component preview after installation"})]})}),e.jsx(Be,{control:e.jsx(Ae,{checked:S.overwriteExisting,onChange:I=>g(A=>G(V({},A),{overwriteExisting:I.target.checked}))}),label:e.jsxs(o,{children:[e.jsx(t,{variant:"body2",children:"Overwrite Existing Files"}),e.jsx(t,{variant:"caption",color:"text.secondary",children:"Replace files if they already exist"})]})})]})})]})]}),te=()=>{var I;return e.jsx(o,{sx:{mt:2},children:b?e.jsxs(o,{display:"flex",alignItems:"center",justifyContent:"center",py:4,children:[e.jsx(Oe,{sx:{mr:2}}),e.jsx(t,{children:"Installing component..."})]}):T?e.jsxs(o,{children:[e.jsxs(ue,{severity:"success",sx:{mb:2},children:[e.jsx(t,{variant:"h6",children:"Component Installed Successfully!"}),e.jsxs(t,{variant:"body2",children:[m==null?void 0:m.componentName," has been installed to ",T.installedPath]})]}),e.jsxs(M,{container:!0,spacing:2,children:[e.jsx(M,{item:!0,xs:12,md:6,children:e.jsx(pe,{children:e.jsxs(de,{children:[e.jsx(t,{variant:"h6",gutterBottom:!0,children:"Installation Summary"}),e.jsxs(xs,{dense:!0,children:[e.jsxs(Ze,{children:[e.jsx(Qs,{children:e.jsx(At,{})}),e.jsx(es,{primary:"Installed to",secondary:T.installedPath})]}),((I=T.packagesInstalled)==null?void 0:I.length)>0&&e.jsxs(Ze,{children:[e.jsx(Qs,{children:e.jsx(Ut,{})}),e.jsx(es,{primary:"Packages Installed",secondary:T.packagesInstalled.join(", ")})]}),T.registryUpdated&&e.jsxs(Ze,{children:[e.jsx(Qs,{children:e.jsx(at,{})}),e.jsx(es,{primary:"Registry Updated",secondary:"Component added to registry"})]})]})]})})}),e.jsx(M,{item:!0,xs:12,md:6,children:e.jsx(pe,{children:e.jsxs(de,{children:[e.jsx(t,{variant:"h6",gutterBottom:!0,children:"Quick Actions"}),e.jsxs(o,{sx:{display:"flex",flexDirection:"column",gap:1},children:[T.previewUrl&&e.jsx(_,{variant:"outlined",startIcon:e.jsx(Os,{}),onClick:()=>window.open(T.previewUrl,"_blank"),children:"View Component Preview"}),e.jsx(_,{variant:"outlined",color:"error",startIcon:e.jsx(Un,{}),onClick:q,disabled:b,children:"Remove Component"})]})]})})})]})]}):e.jsx(ue,{severity:"info",children:"Ready to install component..."})})};return e.jsxs(as,{open:s,onClose:n,maxWidth:"md",fullWidth:!0,children:[e.jsx(os,{children:e.jsxs(o,{display:"flex",alignItems:"center",children:[e.jsx(Ht,{sx:{mr:1}}),"TSX Component Installation"]})}),e.jsxs(is,{children:[e.jsx(yo,{activeStep:l,sx:{mb:3},children:C.map(I=>e.jsx(bo,{children:e.jsx(vo,{children:I})},I))}),l===0&&w(),l===1&&z(),l===2&&te()]}),e.jsxs(ls,{children:[e.jsx(_,{onClick:n,children:T?"Close":"Cancel"}),l>0&&!T&&e.jsx(_,{onClick:()=>h(l-1),children:"Previous"}),l===0&&!m&&e.jsx(_,{variant:"contained",onClick:j,disabled:b||!r,startIcon:b?e.jsx(Oe,{size:20}):e.jsx(ds,{}),children:"Parse Component"}),l===0&&(m==null?void 0:m.isValid)&&e.jsx(_,{variant:"contained",onClick:()=>h(1),children:"Next: Configure"}),l===1&&m&&e.jsx(_,{variant:"contained",onClick:()=>h(2),disabled:!m.isValid,children:"Next: Install Component"}),l===2&&(m==null?void 0:m.isValid)&&!T&&e.jsx(_,{variant:"contained",onClick:U,disabled:b,startIcon:b?e.jsx(Oe,{size:20}):e.jsx(Ut,{}),color:"primary",children:"Install Component"})]})]})};class Gl extends i.Component{constructor(n){super(n),this.state={hasError:!1}}static getDerivedStateFromError(n){return{hasError:!0}}componentDidCatch(n,r){console.error("ErrorBoundary caught an error:",n,r)}render(){return this.state.hasError?this.props.fallback:this.props.children}}const Jl=({componentName:s,onBack:n,onError:r})=>{const[a,u]=i.useState(!0),[l,h]=i.useState(null),[m,v]=i.useState(null),[b,D]=i.useState(null);i.useEffect(()=>{S()},[s]);const S=()=>E(void 0,null,function*(){u(!0),h(null);try{const T=yield fetch("/api/bigbook/custom-components-registry",{credentials:"include"});if(!T.ok)throw new Error("Failed to load custom components registry");const p=(yield T.json()).components[s];if(!p)throw new Error(`Component "${s}" not found in registry`);v(p);try{const y=p.path.replace("src/","../");console.log(`ðŸ“¦ Importing component from: ${y}`);const C=yield import(y);let j;if(p.isDefaultExport?j=C.default:j=C[p.name],!j)throw new Error(`Component "${s}" not found in module`);console.log("ðŸŽ‰ Component imported successfully"),D(()=>j)}catch(y){throw console.error("Component import error:",y),new Error(`Failed to load component: ${y instanceof Error?y.message:"Unknown error"}`)}}catch(T){const O=T instanceof Error?T.message:"Unknown error occurred";h(O),r==null||r(O)}finally{u(!1)}}),g=()=>{S()};return a?e.jsxs(o,{display:"flex",justifyContent:"center",alignItems:"center",minHeight:300,flexDirection:"column",gap:2,children:[e.jsx(Oe,{}),e.jsxs(t,{variant:"body2",color:"text.secondary",children:["Loading custom component: ",s]})]}):l?e.jsxs(o,{sx:{p:3},children:[e.jsxs(o,{display:"flex",alignItems:"center",gap:1,mb:2,children:[e.jsx(be,{onClick:n,size:"small",children:e.jsx(Yn,{})}),e.jsx(t,{variant:"h6",children:"Custom Component Error"})]}),e.jsxs(ue,{severity:"error",sx:{mb:2},action:e.jsx(ye,{title:"Retry loading component",children:e.jsx(be,{color:"inherit",size:"small",onClick:g,children:e.jsx(js,{fontSize:"inherit"})})}),children:[e.jsxs(t,{variant:"subtitle2",gutterBottom:!0,children:["Failed to load component: ",s]}),e.jsx(t,{variant:"body2",children:l})]}),e.jsx(t,{variant:"body2",color:"text.secondary",children:"This usually happens when:"}),e.jsxs(o,{component:"ul",sx:{mt:1,mb:2},children:[e.jsx("li",{children:"The component file was moved or deleted"}),e.jsx("li",{children:"There are syntax errors in the component"}),e.jsx("li",{children:"Required dependencies are missing"}),e.jsx("li",{children:"The component export doesn't match the registry"})]})]}):e.jsxs(o,{sx:{height:"100%",display:"flex",flexDirection:"column"},children:[e.jsxs(De,{sx:{p:2,mb:2},children:[e.jsxs(o,{display:"flex",alignItems:"center",justifyContent:"space-between",children:[e.jsxs(o,{display:"flex",alignItems:"center",gap:1,children:[e.jsx(be,{onClick:n,size:"small",children:e.jsx(Yn,{})}),e.jsxs(Co,{children:[e.jsx(wo,{color:"inherit",href:"#",onClick:T=>{T.preventDefault(),n()},sx:{cursor:"pointer"},children:"Big Book"}),e.jsx(t,{color:"text.primary",children:"Custom Components"}),e.jsx(t,{color:"text.primary",fontWeight:600,children:(m==null?void 0:m.displayName)||s})]})]}),e.jsx(o,{display:"flex",alignItems:"center",gap:1,children:e.jsx(ye,{title:"Refresh component",children:e.jsx(be,{onClick:g,size:"small",children:e.jsx(js,{})})})})]}),(m==null?void 0:m.description)&&e.jsx(t,{variant:"body2",color:"text.secondary",sx:{mt:1},children:m.description})]}),e.jsx(De,{sx:{flex:1,p:2,overflow:"auto"},children:e.jsx(i.Suspense,{fallback:e.jsx(o,{display:"flex",justifyContent:"center",alignItems:"center",minHeight:200,children:e.jsx(Oe,{})}),children:b?e.jsx(Gl,{fallback:e.jsxs(ue,{severity:"error",sx:{mt:2},children:[e.jsx(t,{variant:"subtitle2",gutterBottom:!0,children:"Component Runtime Error"}),e.jsxs(t,{variant:"body2",children:['The component "',s,'" encountered an error during rendering. Check the browser console for more details.']})]}),children:e.jsx(b,{})}):e.jsx(ue,{severity:"warning",children:e.jsxs(t,{variant:"body2",children:['Component "',s,'" loaded but is not renderable.']})})})})]})},Ql=()=>{const[s,n]=i.useState([]),[r,a]=i.useState(!1),[u,l]=i.useState(null),[h,m]=i.useState({}),[v,b]=i.useState(1),[D,S]=i.useState(1),[g,T]=i.useState(null),[O,p]=i.useState(!1),[y,C]=i.useState("create"),[j,U]=i.useState({title:"",content:"",category:"",priority:"medium",tags:[],access_level:"private",expires_at:""}),q=["learning","user_preference","system","analytics","tasks","knowledge"],w=["low","medium","high","critical"],z=["private","shared","public"];i.useEffect(()=>{te()},[h,v]);const te=()=>E(void 0,null,function*(){a(!0),l(null);try{console.log("Loading OMAI memories...",{filters:h,page:v}),yield new Promise(f=>setTimeout(f,500)),n([{id:"1",title:"User prefers dark mode",content:"The user consistently chooses dark mode themes and mentions preference for low-light interfaces.",category:"user_preference",priority:"medium",tags:["ui","theme","accessibility"],access_level:"private",usage_count:15,last_accessed_at:"2025-01-29T10:30:00Z",is_active:!0,created_at:"2025-01-20T09:00:00Z",updated_at:"2025-01-29T10:30:00Z"},{id:"2",title:"Church management workflow insights",content:"User frequently manages multiple churches and prefers bulk operations for administrative tasks.",category:"learning",priority:"high",tags:["workflow","admin","churches"],access_level:"shared",usage_count:8,last_accessed_at:"2025-01-28T14:20:00Z",is_active:!0,created_at:"2025-01-15T11:00:00Z",updated_at:"2025-01-28T14:20:00Z"},{id:"3",title:"OMAI training progress checkpoint",content:"Completed Phase 1 foundation training with 85% accuracy on site understanding tasks.",category:"system",priority:"high",tags:["training","checkpoint","progress"],access_level:"private",usage_count:3,is_active:!0,created_at:"2025-01-25T16:45:00Z",updated_at:"2025-01-25T16:45:00Z"}]),S(1)}catch($){l($ instanceof Error?$.message:"Failed to load memories")}finally{a(!1)}}),I=()=>{U({title:"",content:"",category:"",priority:"medium",tags:[],access_level:"private",expires_at:""}),C("create"),p(!0)},A=$=>{U({title:$.title,content:$.content,category:$.category,priority:$.priority,tags:$.tags,access_level:$.access_level,expires_at:$.expires_at||""}),T($),C("edit"),p(!0)},L=$=>{T($),C("view"),p(!0)},X=()=>E(void 0,null,function*(){try{console.log("Saving memory:",j),yield new Promise($=>setTimeout($,500)),p(!1),te()}catch($){l($ instanceof Error?$.message:"Failed to save memory")}}),Se=$=>E(void 0,null,function*(){if(confirm("Are you sure you want to delete this memory?"))try{console.log("Deleting memory:",$),yield new Promise(f=>setTimeout(f,500)),te()}catch(f){l(f instanceof Error?f.message:"Failed to delete memory")}}),Ce=$=>{switch($){case"critical":return"error";case"high":return"warning";case"medium":return"info";case"low":return"default";default:return"default"}},le=$=>{switch($){case"public":return"ðŸŒ";case"shared":return"ðŸ‘¥";case"private":return"ðŸ”’";default:return"ðŸ“„"}};return e.jsxs(o,{sx:{p:3},children:[e.jsxs(o,{display:"flex",justifyContent:"space-between",alignItems:"center",mb:3,children:[e.jsxs(o,{children:[e.jsxs(t,{variant:"h5",component:"h2",gutterBottom:!0,children:[e.jsx(yn,{sx:{mr:1,verticalAlign:"middle"}}),"OMAI Memory Management"]}),e.jsx(t,{variant:"body2",color:"text.secondary",children:"Store and manage OMAI's learning memories, preferences, and knowledge"})]}),e.jsxs(Q,{direction:"row",spacing:2,children:[e.jsx(_,{variant:"outlined",startIcon:e.jsx(js,{}),onClick:te,disabled:r,children:"Refresh"}),e.jsx(_,{variant:"contained",startIcon:e.jsx(Xn,{}),onClick:I,children:"Add Memory"})]})]}),e.jsx(pe,{sx:{mb:3},children:e.jsxs(de,{children:[e.jsxs(t,{variant:"h6",gutterBottom:!0,children:[e.jsx(ko,{sx:{mr:1,verticalAlign:"middle"}}),"Filters"]}),e.jsxs(M,{container:!0,spacing:2,children:[e.jsx(M,{item:!0,xs:12,md:3,children:e.jsx(Ne,{fullWidth:!0,label:"Search",placeholder:"Search memories...",value:h.search||"",onChange:$=>m(G(V({},h),{search:$.target.value})),InputProps:{startAdornment:e.jsx(Nn,{sx:{mr:1,color:"text.secondary"}})}})}),e.jsx(M,{item:!0,xs:12,md:3,children:e.jsxs(hs,{fullWidth:!0,children:[e.jsx(ps,{children:"Category"}),e.jsxs(gs,{value:h.category||"",label:"Category",onChange:$=>m(G(V({},h),{category:$.target.value})),children:[e.jsx(xe,{value:"",children:"All Categories"}),q.map($=>e.jsx(xe,{value:$,children:$},$))]})]})}),e.jsx(M,{item:!0,xs:12,md:3,children:e.jsxs(hs,{fullWidth:!0,children:[e.jsx(ps,{children:"Priority"}),e.jsxs(gs,{value:h.priority||"",label:"Priority",onChange:$=>m(G(V({},h),{priority:$.target.value})),children:[e.jsx(xe,{value:"",children:"All Priorities"}),w.map($=>e.jsx(xe,{value:$,children:$},$))]})]})}),e.jsx(M,{item:!0,xs:12,md:3,children:e.jsxs(hs,{fullWidth:!0,children:[e.jsx(ps,{children:"Status"}),e.jsxs(gs,{value:h.is_active===void 0?"":h.is_active?"active":"inactive",label:"Status",onChange:$=>m(G(V({},h),{is_active:$.target.value===""?void 0:$.target.value==="active"})),children:[e.jsx(xe,{value:"",children:"All"}),e.jsx(xe,{value:"active",children:"Active"}),e.jsx(xe,{value:"inactive",children:"Inactive"})]})]})})]})]})}),u&&e.jsx(ue,{severity:"error",sx:{mb:2},onClose:()=>l(null),children:u}),r?e.jsxs(o,{display:"flex",justifyContent:"center",alignItems:"center",minHeight:"300px",children:[e.jsx(Oe,{}),e.jsx(t,{variant:"body1",sx:{ml:2},children:"Loading memories..."})]}):e.jsxs(e.Fragment,{children:[e.jsx(M,{container:!0,spacing:2,children:s.map($=>e.jsx(M,{item:!0,xs:12,md:6,lg:4,children:e.jsx(pe,{children:e.jsxs(de,{children:[e.jsxs(o,{display:"flex",justifyContent:"space-between",alignItems:"flex-start",mb:2,children:[e.jsx(t,{variant:"h6",component:"h3",noWrap:!0,sx:{flex:1,mr:1},children:$.title}),e.jsxs(o,{display:"flex",gap:.5,children:[e.jsx(ye,{title:"View Memory",children:e.jsx(be,{size:"small",onClick:()=>L($),children:e.jsx(Os,{})})}),e.jsx(ye,{title:"Edit Memory",children:e.jsx(be,{size:"small",onClick:()=>A($),children:e.jsx(Io,{})})}),e.jsx(ye,{title:"Delete Memory",children:e.jsx(be,{size:"small",onClick:()=>Se($.id),children:e.jsx(St,{})})})]})]}),e.jsx(t,{variant:"body2",color:"text.secondary",sx:{mb:2},children:$.content.length>100?`${$.content.substring(0,100)}...`:$.content}),e.jsxs(o,{display:"flex",flexWrap:"wrap",gap:1,mb:2,children:[e.jsx(H,{label:$.category,size:"small",icon:e.jsx(At,{}),variant:"outlined"}),e.jsx(H,{label:$.priority,size:"small",color:Ce($.priority)}),e.jsx(H,{label:`${le($.access_level)} ${$.access_level}`,size:"small",variant:"outlined"})]}),e.jsx(o,{display:"flex",flexWrap:"wrap",gap:.5,mb:2,children:$.tags.map(f=>e.jsx(H,{label:f,size:"small",icon:e.jsx(Ta,{}),variant:"outlined"},f))}),e.jsxs(o,{display:"flex",justifyContent:"space-between",alignItems:"center",children:[e.jsxs(t,{variant:"caption",color:"text.secondary",children:["Used ",$.usage_count," times"]}),e.jsx(t,{variant:"caption",color:"text.secondary",children:new Date($.created_at).toLocaleDateString()})]})]})})},$.id))}),s.length===0&&!r&&e.jsxs(o,{textAlign:"center",py:6,children:[e.jsx(yn,{sx:{fontSize:64,color:"text.secondary",mb:2}}),e.jsx(t,{variant:"h6",color:"text.secondary",gutterBottom:!0,children:"No memories found"}),e.jsx(t,{variant:"body2",color:"text.secondary",sx:{mb:3},children:"Start by creating your first OMAI memory to help the system learn and remember important information."}),e.jsx(_,{variant:"contained",startIcon:e.jsx(Xn,{}),onClick:I,children:"Create First Memory"})]}),D>1&&e.jsx(o,{display:"flex",justifyContent:"center",mt:3,children:e.jsx(Wn,{count:D,page:v,onChange:($,f)=>b(f),color:"primary"})})]}),e.jsxs(as,{open:O,onClose:()=>p(!1),maxWidth:"md",fullWidth:!0,children:[e.jsxs(os,{children:[y==="create"&&"Create New Memory",y==="edit"&&"Edit Memory",y==="view"&&"Memory Details"]}),e.jsx(is,{children:y==="view"&&g?e.jsxs(o,{children:[e.jsx(t,{variant:"h6",gutterBottom:!0,children:g.title}),e.jsx(t,{variant:"body1",paragraph:!0,children:g.content}),e.jsx(ks,{sx:{my:2}}),e.jsxs(M,{container:!0,spacing:2,children:[e.jsxs(M,{item:!0,xs:6,children:[e.jsx(t,{variant:"subtitle2",children:"Category"}),e.jsx(t,{variant:"body2",children:g.category})]}),e.jsxs(M,{item:!0,xs:6,children:[e.jsx(t,{variant:"subtitle2",children:"Priority"}),e.jsx(t,{variant:"body2",children:g.priority})]}),e.jsxs(M,{item:!0,xs:6,children:[e.jsx(t,{variant:"subtitle2",children:"Access Level"}),e.jsx(t,{variant:"body2",children:g.access_level})]}),e.jsxs(M,{item:!0,xs:6,children:[e.jsx(t,{variant:"subtitle2",children:"Usage Count"}),e.jsx(t,{variant:"body2",children:g.usage_count})]})]}),e.jsxs(o,{mt:2,children:[e.jsx(t,{variant:"subtitle2",children:"Tags"}),e.jsx(o,{display:"flex",flexWrap:"wrap",gap:1,mt:1,children:g.tags.map($=>e.jsx(H,{label:$,size:"small"},$))})]})]}):e.jsxs(Q,{spacing:3,sx:{mt:2},children:[e.jsx(Ne,{fullWidth:!0,label:"Title",value:j.title,onChange:$=>U(G(V({},j),{title:$.target.value})),disabled:y==="view"}),e.jsx(Ne,{fullWidth:!0,label:"Content",multiline:!0,rows:4,value:j.content,onChange:$=>U(G(V({},j),{content:$.target.value})),disabled:y==="view"}),e.jsxs(M,{container:!0,spacing:2,children:[e.jsx(M,{item:!0,xs:6,children:e.jsxs(hs,{fullWidth:!0,children:[e.jsx(ps,{children:"Category"}),e.jsx(gs,{value:j.category,label:"Category",onChange:$=>U(G(V({},j),{category:$.target.value})),disabled:y==="view",children:q.map($=>e.jsx(xe,{value:$,children:$},$))})]})}),e.jsx(M,{item:!0,xs:6,children:e.jsxs(hs,{fullWidth:!0,children:[e.jsx(ps,{children:"Priority"}),e.jsx(gs,{value:j.priority,label:"Priority",onChange:$=>U(G(V({},j),{priority:$.target.value})),disabled:y==="view",children:w.map($=>e.jsx(xe,{value:$,children:$},$))})]})})]}),e.jsxs(hs,{fullWidth:!0,children:[e.jsx(ps,{children:"Access Level"}),e.jsx(gs,{value:j.access_level,label:"Access Level",onChange:$=>U(G(V({},j),{access_level:$.target.value})),disabled:y==="view",children:z.map($=>e.jsx(xe,{value:$,children:$},$))})]}),e.jsx(Ne,{fullWidth:!0,label:"Tags (comma-separated)",value:j.tags.join(", "),onChange:$=>U(G(V({},j),{tags:$.target.value.split(",").map(f=>f.trim()).filter(Boolean)})),disabled:y==="view",helperText:"Enter tags separated by commas"})]})}),e.jsxs(ls,{children:[e.jsx(_,{onClick:()=>p(!1),children:y==="view"?"Close":"Cancel"}),y!=="view"&&e.jsx(_,{variant:"contained",onClick:X,children:y==="create"?"Create":"Save"})]})]})]})},Kl=()=>{const[s,n]=i.useState(0),[r,a]=i.useState([]),[u,l]=i.useState([]),[h,m]=i.useState(!1),[v,b]=i.useState(null),[D,S]=i.useState(!1),[g,T]=i.useState({databaseUser:"root",databasePassword:"",useSudo:!0,sudoPassword:"",defaultDatabase:"omai_db",scriptTimeout:3e4,maxFileSize:10485760}),[O,p]=i.useState(vn),[y,C]=i.useState(!1),[j,U]=i.useState(null),[q,w]=i.useState(null),[z,te]=i.useState(!1),[I,A]=i.useState(null),[L,X]=i.useState(!1),[Se,Ce]=i.useState(null),[le,$]=i.useState(null),[f,J]=i.useState(!1),[ve,B]=i.useState(null),[ae,_e]=i.useState(null),[R,Z]=i.useState([]),[ce,me]=i.useState(null),[ge,ts]=i.useState(null),[Xe,Ge]=i.useState(!1),[Ke,ns]=i.useState("foundation"),[Ve,Y]=i.useState(!1),[k,ee]=i.useState(null),[oe,Pe]=i.useState([]),[Te,Ts]=i.useState([]),[ie,ne]=i.useState(!1),[fe,ms]=i.useState(null),[Ds,Cs]=i.useState(!1),d=i.useRef(null),P=i.useRef(null),se=i.useCallback(()=>{P.current&&(P.current.scrollTop=P.current.scrollHeight)},[]);fn.useEffect(()=>{se()},[u,se]),i.useEffect(()=>{K(),he(),je(),$s(),rs(),zs()},[]);const K=()=>E(void 0,null,function*(){try{const N=yield(yield fetch("/api/omai/learning-progress")).json();N.success&&_e(N.progress)}catch(c){console.error("Failed to load learning progress:",c)}}),he=()=>E(void 0,null,function*(){try{const N=yield(yield fetch("/api/omai/training-sessions")).json();N.success&&Z(N.sessions)}catch(c){console.error("Failed to load training sessions:",c)}}),je=()=>E(void 0,null,function*(){try{const N=yield(yield fetch("/api/omai/knowledge-metrics")).json();N.success&&me(N.metrics)}catch(c){console.error("Failed to load knowledge metrics:",c)}}),Ee=c=>E(void 0,null,function*(){Y(!0);try{const ke=yield(yield fetch("/api/omai/start-training",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({phase:c})})).json();if(ke.success){ts(ke.session),Ge(!1);const Me=setInterval(()=>{he(),K()},5e3);setTimeout(()=>clearInterval(Me),30*60*1e3)}}catch(N){console.error("Failed to start training session:",N)}finally{Y(!1)}}),Ye=()=>E(void 0,null,function*(){if(ge)try{(yield(yield fetch(`/api/omai/stop-training/${ge.id}`,{method:"POST"})).json()).success&&(ts(null),he())}catch(c){console.error("Failed to stop training session:",c)}}),cs=()=>E(void 0,null,function*(){Y(!0);try{yield Promise.all([K(),he(),je(),$s(),rs()])}finally{Y(!1)}}),$s=()=>E(void 0,null,function*(){try{const N=yield(yield fetch("/api/omai/ethics-progress")).json();N.success&&ee(N.progress)}catch(c){console.error("Failed to load ethics progress:",c)}}),rs=()=>E(void 0,null,function*(){try{const N=yield(yield fetch("/api/omai/ethical-foundations")).json();N.success&&Pe(N.foundations)}catch(c){console.error("Failed to load ethical foundations:",c)}}),zs=()=>E(void 0,null,function*(){try{const N=yield(yield fetch("/api/omai/omlearn-surveys")).json();N.success&&Ts(N.surveys)}catch(c){console.error("Failed to load OMLearn surveys:",c)}});i.useEffect(()=>{s===5&&fs(),s===6&&Us()},[s]);const fs=()=>E(void 0,null,function*(){te(!0),A(null);try{const c=yield fetch("/api/bigbook/registries",{credentials:"include"});if(!c.ok)throw new Error(`HTTP ${c.status}: ${c.statusText}`);const N=yield c.json();if(N.success)w(N.registries);else throw new Error(N.error||"Failed to load registries")}catch(c){A(c instanceof Error?c.message:"Unknown error"),F("error",`Failed to load registries: ${c instanceof Error?c.message:"Unknown error"}`)}finally{te(!1)}}),Us=()=>E(void 0,null,function*(){J(!0);try{const c=yield fetch("/api/bigbook/custom-components-registry",{credentials:"include"});if(c.ok){const N=yield c.json();$(N),F("success",`Loaded ${Object.keys(N.components||{}).length} custom components`)}else throw new Error("Failed to load custom components")}catch(c){console.error("Error loading custom components:",c),F("error",`Failed to load custom components: ${c instanceof Error?c.message:"Unknown error"}`)}finally{J(!1)}}),ft=c=>E(void 0,null,function*(){if(window.confirm(`Are you sure you want to remove the component "${c.displayName||c.name}"? This action cannot be undone.`)){F("info",`ðŸ—‘ï¸ Removing custom component: ${c.name}`);try{const N={componentName:c.name,installedPath:c.path,route:c.route,displayName:c.displayName,registryUpdated:!0,menuUpdated:!0},Me=yield(yield fetch("/api/bigbook/remove-bigbook-component",{method:"DELETE",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({installationResult:N})})).json();if(Me.success)F("success",`âœ… Component "${c.name}" removed successfully`),Me.menuUpdated&&F("success","ðŸ§© Component removed from Big Book sidebar menu"),yield Us(),ve===c.name&&B(null);else throw new Error(Me.error||"Failed to remove component")}catch(N){F("error",`âŒ Failed to remove component: ${N instanceof Error?N.message:"Unknown error"}`)}}}),Fs=(c,N,ke)=>E(void 0,null,function*(){try{const Me=yield fetch(`/api/bigbook/toggle-item/${c}/${N}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({enabled:ke}),credentials:"include"});if(!Me.ok)throw new Error(`HTTP ${Me.status}: ${Me.statusText}`);const Ie=yield Me.json();if(Ie.success)w(Ue=>G(V({},Ue),{[c]:G(V({},Ue[c]),{items:G(V({},Ue[c].items),{[N]:Ie.item})})})),F("success",`Item ${ke?"enabled":"disabled"}: ${Ie.item.name||Ie.item.displayName||N}`);else throw new Error(Ie.error||"Failed to toggle item")}catch(Me){F("error",`Failed to toggle item: ${Me instanceof Error?Me.message:"Unknown error"}`)}}),F=(c,N,ke)=>{const Me={id:Date.now().toString(),timestamp:new Date,type:c,content:N,source:c==="command"?"User":"System"};l(Ie=>[...Ie,Me])},lt=i.useCallback(c=>E(void 0,null,function*(){var ke,Me,Ie,Ue,ws,He;c.preventDefault();const N=Array.from(c.dataTransfer.files);for(const we of N)try{const qe=((ke=we.name.split(".").pop())==null?void 0:ke.toLowerCase())||"";if(qe==="zip"&&(we.name.toLowerCase().includes("parish-map")||we.name.toLowerCase().includes("parishmap")||we.name.toLowerCase()==="_workspace_dist_parish-map.zip")){F("info",`ðŸ—ºï¸ Parish Map zip detected: ${we.name}. Starting auto-installation...`);try{const Le=new FormData;Le.append("parishMapZip",we);const $e=yield(yield fetch("/api/bigbook/upload-parish-map",{method:"POST",body:Le,credentials:"include"})).json();$e.success?(F("success","ðŸŽ‰ Parish Map installed successfully!"),F("info",`ðŸ“ Component: ${$e.addon.displayName}`),F("info",`ðŸ”— Available at: orthodoxmetrics.com${$e.addon.route}`),F("info","ðŸ“ Updated Big Book Components Index"),F("success",'ðŸ§© Added to sidebar navigation under "Components" section'),F("info","ðŸ”„ Refresh the page to see the new menu item in the sidebar"),setTimeout(()=>{F("info",`Click here to visit: ${window.location.origin}${$e.addon.route}`)},1e3)):F("error",`âŒ Parish Map installation failed: ${$e.error}`)}catch(Le){F("error",`âŒ Parish Map installation error: ${Le instanceof Error?Le.message:"Unknown error"}`)}continue}if(qe==="tsx"){F("info",`ðŸ§© TSX Component detected: ${we.name}. Opening installation wizard...`),Ce(we),X(!0);continue}if(![".zip",".js",".json",".md",".sh"].includes(`.${qe}`)){const Le=new FileReader;Le.onload=us=>E(void 0,null,function*(){var Ws,Tt,Dt,Pt;const $e=(Ws=us.target)==null?void 0:Ws.result,Je=Xs(qe),Fe={id:Date.now().toString()+Math.random(),name:we.name,type:Je,content:$e,size:we.size,uploaded:new Date,processed:!1,status:"pending"};a(ys=>[...ys,Fe]),F("info",`Uploading to encrypted storage: ${we.name} (${Je})`);try{const ss=yield(yield fetch("/api/bigbook/upload",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({fileName:we.name,content:$e,fileType:Je})})).json();if(ss.success){a(Rs=>Rs.map(ct=>ct.id===Fe.id?G(V({},ct),{status:"completed",result:{success:!0,output:"File uploaded successfully"}}):ct));const bs=ss.isQuestionnaire?`questionnaire (${((Tt=ss.questionnaireMetadata)==null?void 0:Tt.title)||"Unknown"})`:"file";F("success",`${bs} uploaded to encrypted storage: ${we.name}`),ss.isQuestionnaire&&F("info",`Questionnaire detected: ${((Dt=ss.questionnaireMetadata)==null?void 0:Dt.ageGroup)||"Unknown age group"} - ${((Pt=ss.questionnaireMetadata)==null?void 0:Pt.estimatedDuration)||0} minutes`)}else a(bs=>bs.map(Rs=>Rs.id===Fe.id?G(V({},Rs),{status:"error",result:{success:!1,error:ss.error}}):Rs)),F("error",`Upload failed: ${we.name} - ${ss.error}`)}catch(ys){a(ss=>ss.map(bs=>bs.id===Fe.id?G(V({},bs),{status:"error",result:{success:!1,error:ys instanceof Error?ys.message:"Unknown error"}}):bs)),F("error",`Upload error: ${we.name} - ${ys instanceof Error?ys.message:"Unknown error"}`)}}),Le.readAsText(we);continue}const on={zip:"ðŸ“¦",js:"âš¡",json:"âš™ï¸",md:"ðŸ“",sh:"ðŸ”§"}[qe]||"ðŸ“„";F("info",`${on} Processing ${qe.toUpperCase()} file: ${we.name}`);try{const Le=new FormData;Le.append("file",we);const us=qe==="md"||qe==="js";us&&Le.append("notifyOMAI","true"),F("info","ðŸ”„ Sending to centralized ingestion system...");const $e=yield fetch("/api/bigbook/ingest-file",{method:"POST",body:Le,credentials:"include"});if(F("info",`ðŸ“¡ Response status: ${$e.status} ${$e.statusText}`),!$e.ok){const Fe=yield $e.text();F("error",`âŒ HTTP Error ${$e.status}: ${Fe}`),$e.status===401&&(F("error","ðŸ” Authentication failed. Please refresh page and try again."),F("info","ðŸ’¡ Tip: Make sure you're logged in as super_admin"));continue}const Je=yield $e.json();if(Je.success){const{result:Fe}=Je;switch(F("success",`âœ… ${Fe.message}`),F("info",`ðŸ“‚ Type: ${Fe.type}/${Fe.category}`),Fe.type){case"addon":F("info",`ðŸ§© Component available at: ${((Me=Fe.item)==null?void 0:Me.route)||"N/A"}`),(Ie=Fe.item)!=null&&Ie.enabled?F("success","âœ… Component enabled and ready to use"):F("warning","âš ï¸ Component requires manual enable in registry");break;case"doc":F("info",`ðŸ“– Document: ${((Ue=Fe.item)==null?void 0:Ue.title)||((ws=Fe.item)==null?void 0:ws.name)}`),(He=Fe.item)!=null&&He.webPath&&F("info",`ðŸ”— Web path: ${Fe.item.webPath}`);break;case"script":F("info","ðŸ”§ Script stored and made executable"),F("warning","âš ï¸ Script requires manual enable for security");break;case"config":F("info","âš™ï¸ Configuration active and available");break;case"data":F("info","ðŸ’¾ Data archived for manual processing");break}if(Je.registries){const Ws=Object.keys(Je.registries);F("info",`ðŸ“Š Updated registries: ${Ws.join(", ")}`)}us&&F("info","ðŸ§  OMAI notified for learning")}else F("error",`âŒ Ingestion failed: ${Je.error}`),Je.debug&&F("info",`ðŸ” Debug info: ${JSON.stringify(Je.debug)}`)}catch(Le){F("error",`âŒ Ingestion error: ${Le instanceof Error?Le.message:"Unknown error"}`)}}catch(qe){F("error",`File processing error: ${we.name} - ${qe instanceof Error?qe.message:"Unknown error"}`)}}),[]),Ys=c=>{c.preventDefault()},Re=c=>E(void 0,null,function*(){var ke,Me,Ie,Ue,ws,He;const N=Array.from(c.target.files||[]);for(const we of N)try{const qe=((ke=we.name.split(".").pop())==null?void 0:ke.toLowerCase())||"";if(qe==="zip"&&(we.name.toLowerCase().includes("parish-map")||we.name.toLowerCase().includes("parishmap")||we.name.toLowerCase()==="_workspace_dist_parish-map.zip")){F("info",`ðŸ—ºï¸ Parish Map zip selected: ${we.name}. Starting auto-installation...`);try{const Le=new FormData;Le.append("parishMapZip",we),F("info","ðŸ”„ Sending request to /api/bigbook/upload-parish-map...");const us=yield fetch("/api/bigbook/upload-parish-map",{method:"POST",body:Le,credentials:"include",headers:{}});if(F("info",`ðŸ“¡ Response status: ${us.status} ${us.statusText}`),!us.ok){const Je=yield us.text();F("error",`âŒ HTTP Error ${us.status}: ${Je}`),us.status===401&&(F("error","ðŸ” Authentication failed. Please refresh page and try again."),F("info","ðŸ’¡ Tip: Make sure you're logged in as super_admin"));return}const $e=yield us.json();$e.success?(F("success","ðŸŽ‰ Parish Map installed successfully!"),F("info",`ðŸ“ Component: ${$e.addon.displayName}`),F("info",`ðŸ”— Available at: orthodoxmetrics.com${$e.addon.route}`),F("info","ðŸ“ Updated Big Book Components Index"),F("success",'ðŸ§© Added to sidebar navigation under "Components" section'),F("info","ðŸ”„ Refresh the page to see the new menu item in the sidebar"),setTimeout(()=>{F("info",`Click here to visit: ${window.location.origin}${$e.addon.route}`)},1e3)):(F("error",`âŒ Parish Map installation failed: ${$e.error}`),$e.debug&&F("info",`ðŸ” Debug info: ${JSON.stringify($e.debug)}`))}catch(Le){F("error",`âŒ Parish Map installation error: ${Le instanceof Error?Le.message:"Unknown error"}`),console.error("Parish Map upload error:",Le)}continue}if(qe==="tsx"){F("info",`ðŸ§© TSX Component detected: ${we.name}. Opening installation wizard...`),Ce(we),X(!0);continue}if(![".zip",".js",".json",".md",".sh"].includes(`.${qe}`)){const Le=new FileReader;Le.onload=us=>E(void 0,null,function*(){var Ws,Tt,Dt,Pt;const $e=(Ws=us.target)==null?void 0:Ws.result,Je=Xs(qe),Fe={id:Date.now().toString()+Math.random(),name:we.name,type:Je,content:$e,size:we.size,uploaded:new Date,processed:!1,status:"pending"};a(ys=>[...ys,Fe]),F("info",`Uploading to encrypted storage: ${we.name} (${Je})`);try{const ss=yield(yield fetch("/api/bigbook/upload",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({fileName:we.name,content:$e,fileType:Je})})).json();if(ss.success){a(Rs=>Rs.map(ct=>ct.id===Fe.id?G(V({},ct),{status:"completed",result:{success:!0,output:"File uploaded successfully"}}):ct));const bs=ss.isQuestionnaire?`questionnaire (${((Tt=ss.questionnaireMetadata)==null?void 0:Tt.title)||"Unknown"})`:"file";F("success",`${bs} uploaded to encrypted storage: ${we.name}`),ss.isQuestionnaire&&F("info",`Questionnaire detected: ${((Dt=ss.questionnaireMetadata)==null?void 0:Dt.ageGroup)||"Unknown age group"} - ${((Pt=ss.questionnaireMetadata)==null?void 0:Pt.estimatedDuration)||0} minutes`)}else a(bs=>bs.map(Rs=>Rs.id===Fe.id?G(V({},Rs),{status:"error",result:{success:!1,error:ss.error}}):Rs)),F("error",`Upload failed: ${we.name} - ${ss.error}`)}catch(ys){a(ss=>ss.map(bs=>bs.id===Fe.id?G(V({},bs),{status:"error",result:{success:!1,error:ys instanceof Error?ys.message:"Unknown error"}}):bs)),F("error",`Upload error: ${we.name} - ${ys instanceof Error?ys.message:"Unknown error"}`)}}),Le.readAsText(we);continue}const on={zip:"ðŸ“¦",js:"âš¡",json:"âš™ï¸",md:"ðŸ“",sh:"ðŸ”§"}[qe]||"ðŸ“„";F("info",`${on} Processing ${qe.toUpperCase()} file: ${we.name}`);try{const Le=new FormData;Le.append("file",we);const us=qe==="md"||qe==="js";us&&Le.append("notifyOMAI","true"),F("info","ðŸ”„ Sending to centralized ingestion system...");const $e=yield fetch("/api/bigbook/ingest-file",{method:"POST",body:Le,credentials:"include"});if(F("info",`ðŸ“¡ Response status: ${$e.status} ${$e.statusText}`),!$e.ok){const Fe=yield $e.text();F("error",`âŒ HTTP Error ${$e.status}: ${Fe}`),$e.status===401&&(F("error","ðŸ” Authentication failed. Please refresh page and try again."),F("info","ðŸ’¡ Tip: Make sure you're logged in as super_admin"));continue}const Je=yield $e.json();if(Je.success){const{result:Fe}=Je;switch(F("success",`âœ… ${Fe.message}`),F("info",`ðŸ“‚ Type: ${Fe.type}/${Fe.category}`),Fe.type){case"addon":F("info",`ðŸ§© Component available at: ${((Me=Fe.item)==null?void 0:Me.route)||"N/A"}`),(Ie=Fe.item)!=null&&Ie.enabled?F("success","âœ… Component enabled and ready to use"):F("warning","âš ï¸ Component requires manual enable in registry");break;case"doc":F("info",`ðŸ“– Document: ${((Ue=Fe.item)==null?void 0:Ue.title)||((ws=Fe.item)==null?void 0:ws.name)}`),(He=Fe.item)!=null&&He.webPath&&F("info",`ðŸ”— Web path: ${Fe.item.webPath}`);break;case"script":F("info","ðŸ”§ Script stored and made executable"),F("warning","âš ï¸ Script requires manual enable for security");break;case"config":F("info","âš™ï¸ Configuration active and available");break;case"data":F("info","ðŸ’¾ Data archived for manual processing");break}if(Je.registries){const Ws=Object.keys(Je.registries);F("info",`ðŸ“Š Updated registries: ${Ws.join(", ")}`)}us&&F("info","ðŸ§  OMAI notified for learning")}else F("error",`âŒ Ingestion failed: ${Je.error}`),Je.debug&&F("info",`ðŸ” Debug info: ${JSON.stringify(Je.debug)}`)}catch(Le){F("error",`âŒ Ingestion error: ${Le instanceof Error?Le.message:"Unknown error"}`)}}catch(qe){F("error",`File processing error: ${we.name} - ${qe instanceof Error?qe.message:"Unknown error"}`)}}),Xs=c=>{switch(c){case"sql":return"sql";case"md":case"markdown":return"markdown";case"js":case"jsx":case"ts":case"tsx":return"javascript";case"sh":case"bash":case"zsh":return"shell";case"py":case"python":return"python";case"html":case"htm":return"html";case"css":case"scss":case"sass":return"css";case"json":return"json";case"xml":return"xml";case"txt":case"log":return"text";case"jpg":case"jpeg":case"png":case"gif":case"svg":case"webp":return"image";case"mp4":case"avi":case"mov":case"wmv":return"video";case"mp3":case"wav":case"ogg":return"audio";case"zip":case"tar":case"gz":case"rar":return"archive";case"pdf":return"pdf";default:return"other"}},yt=c=>E(void 0,null,function*(){m(!0),F("command",`Executing: ${c.name}`);try{let N=c.content;if(c.encryptedPath)try{const Ue=yield(yield fetch(`/api/bigbook/storage/file/${c.id}?encryptedPath=${encodeURIComponent(c.encryptedPath)}`)).json();if(Ue.success)N=Ue.content;else throw new Error(`Failed to retrieve file from encrypted storage: ${Ue.error}`)}catch(Ie){F("error",`Failed to retrieve file from encrypted storage: ${c.name}`,Ie instanceof Error?Ie.message:"Unknown error"),m(!1);return}const Me=yield(yield fetch("/api/bigbook/execute",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({fileId:c.id,fileName:c.name,content:N,type:c.type,settings:g})})).json();Me.success?F("success",`Execution completed: ${c.name}`,Me.output):F("error",`Execution failed: ${c.name}`,Me.error)}catch(N){F("error",`Execution error: ${c.name}`,N instanceof Error?N.message:"Unknown error")}finally{m(!1)}}),Bt=c=>E(void 0,null,function*(){const N=r.find(ke=>ke.id===c);if(N!=null&&N.encryptedPath)try{const Me=yield(yield fetch(`/api/bigbook/storage/file/${c}?encryptedPath=${encodeURIComponent(N.encryptedPath)}`,{method:"DELETE"})).json();Me.success?(a(Ie=>Ie.filter(Ue=>Ue.id!==c)),F("success",`File removed from encrypted storage: ${N.name}`)):F("error",`Failed to remove file from encrypted storage: ${N.name} - ${Me.error}`)}catch(ke){F("error",`Error removing file from encrypted storage: ${N.name} - ${ke instanceof Error?ke.message:"Unknown error"}`)}else a(ke=>ke.filter(Me=>Me.id!==c)),F("info","File removed from list")}),qn=()=>{l([])},sa=()=>E(void 0,null,function*(){try{(yield fetch("/api/bigbook/settings",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(g)})).ok?(F("success","Settings saved successfully"),S(!1)):F("error","Failed to save settings")}catch(c){F("error","Error saving settings")}}),ta=c=>{var N;if(!c.isQuestionnaire){F("warning","File is not a questionnaire");return}U(c),C(!0),F("info",`Opening questionnaire preview: ${((N=c.questionnaireMetadata)==null?void 0:N.title)||c.name}`)},na=c=>E(void 0,null,function*(){try{F("info",`Submitting questionnaire responses: ${c.questionnaireTitle}`);const ke=yield(yield fetch("/api/bigbook/submit-response",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(c)})).json();ke.success?F("success",`Questionnaire submitted successfully (${ke.action}): ${c.questionnaireTitle}`,`Response ID: ${ke.responseId}
Responses: ${c.responses.length} answers`):F("error",`Failed to submit questionnaire: ${ke.error}`)}catch(N){F("error",`Error submitting questionnaire: ${N instanceof Error?N.message:"Unknown error"}`)}}),ra=c=>{switch(c){case"sql":return e.jsx(at,{});case"markdown":return e.jsx(hn,{});case"javascript":return e.jsx(Fn,{});case"shell":return e.jsx(ds,{});case"python":return e.jsx(ds,{});case"html":return e.jsx($n,{});case"css":return e.jsx(Mn,{});case"json":return e.jsx(Pn,{});case"xml":return e.jsx(ds,{});case"text":return e.jsx(Ra,{});case"image":return e.jsx(Dn,{});case"video":return e.jsx(Tn,{});case"audio":return e.jsx(In,{});case"archive":return e.jsx(Rt,{});case"pdf":return e.jsx(kn,{});case"script":return e.jsx(ds,{});default:return e.jsx(Ct,{})}},aa=c=>{switch(c){case"sql":return e.jsx(H,{label:"SQL",size:"small",color:"primary"});case"markdown":return e.jsx(H,{label:"Markdown",size:"small",color:"info"});case"javascript":return e.jsx(H,{label:"JavaScript",size:"small",color:"warning"});case"shell":return e.jsx(H,{label:"Shell",size:"small",color:"success"});case"python":return e.jsx(H,{label:"Python",size:"small",color:"secondary"});case"html":return e.jsx(H,{label:"HTML",size:"small",color:"error"});case"css":return e.jsx(H,{label:"CSS",size:"small",color:"info"});case"json":return e.jsx(H,{label:"JSON",size:"small",color:"warning"});case"xml":return e.jsx(H,{label:"XML",size:"small",color:"secondary"});case"text":return e.jsx(H,{label:"Text",size:"small",color:"default"});case"image":return e.jsx(H,{label:"Image",size:"small",color:"success"});case"video":return e.jsx(H,{label:"Video",size:"small",color:"error"});case"audio":return e.jsx(H,{label:"Audio",size:"small",color:"info"});case"archive":return e.jsx(H,{label:"Archive",size:"small",color:"warning"});case"pdf":return e.jsx(H,{label:"PDF",size:"small",color:"error"});case"script":return e.jsx(H,{label:"Script",size:"small",color:"secondary"});default:return e.jsx(H,{label:"Other",size:"small",color:"default"})}},oa=(c,N)=>{n(N)},ia=()=>e.jsx(o,{children:e.jsx(pe,{sx:{mb:3},children:e.jsxs(de,{children:[e.jsxs(o,{display:"flex",justifyContent:"space-between",alignItems:"center",mb:2,children:[e.jsxs(t,{variant:"h5",component:"h2",children:[e.jsx(nt,{sx:{mr:1,verticalAlign:"middle"}}),"OMAI Learning Dashboard"]}),e.jsxs(o,{children:[e.jsx(_,{variant:"outlined",startIcon:Ve?e.jsx(Oe,{size:16}):e.jsx(js,{}),onClick:cs,disabled:Ve,sx:{mr:1},children:"Refresh"}),e.jsx(_,{variant:"contained",startIcon:e.jsx(un,{}),onClick:()=>Ge(!0),disabled:!!ge,children:"Start Training"})]})]}),ae&&e.jsxs(M,{container:!0,spacing:3,children:[e.jsx(M,{item:!0,xs:12,md:3,children:e.jsxs(De,{sx:{p:2,textAlign:"center"},children:[e.jsxs(t,{variant:"h4",color:"primary",children:[Math.round(ae.overallProgress),"%"]}),e.jsx(t,{variant:"body2",color:"text.secondary",children:"Overall Progress"}),e.jsx(Ms,{variant:"determinate",value:ae.overallProgress,sx:{mt:1}})]})}),e.jsx(M,{item:!0,xs:12,md:3,children:e.jsxs(De,{sx:{p:2,textAlign:"center"},children:[e.jsx(t,{variant:"h4",color:"success.main",children:ae.knowledgePoints}),e.jsx(t,{variant:"body2",color:"text.secondary",children:"Knowledge Points"})]})}),e.jsx(M,{item:!0,xs:12,md:3,children:e.jsxs(De,{sx:{p:2,textAlign:"center"},children:[e.jsx(t,{variant:"h4",color:"info.main",children:ae.memoriesCreated}),e.jsx(t,{variant:"body2",color:"text.secondary",children:"Memories Created"})]})}),e.jsx(M,{item:!0,xs:12,md:3,children:e.jsxs(De,{sx:{p:2,textAlign:"center"},children:[e.jsx(t,{variant:"h4",color:"warning.main",children:ae.filesProcessed}),e.jsx(t,{variant:"body2",color:"text.secondary",children:"Files Processed"})]})})]}),ae&&e.jsxs(o,{mt:3,children:[e.jsx(t,{variant:"h6",gutterBottom:!0,children:"Current Learning Phase"}),e.jsxs(ue,{severity:"info",sx:{mb:2},children:[e.jsx(t,{variant:"subtitle1",children:e.jsx("strong",{children:ae.currentPhase})}),e.jsxs(t,{variant:"body2",children:[ae.completedSessions," of ",ae.totalSessions," sessions completed"]}),e.jsxs(t,{variant:"body2",color:"text.secondary",children:["Last Activity: ",ae.lastActivity]})]})]}),ge&&e.jsxs(o,{mt:3,children:[e.jsx(t,{variant:"h6",gutterBottom:!0,children:"Active Training Session"}),e.jsxs(De,{sx:{p:2,border:2,borderColor:"primary.main"},children:[e.jsxs(o,{display:"flex",justifyContent:"space-between",alignItems:"center",mb:2,children:[e.jsxs(o,{children:[e.jsx(t,{variant:"subtitle1",color:"primary",children:ge.name}),e.jsxs(t,{variant:"body2",color:"text.secondary",children:["Phase: ",ge.phase]})]}),e.jsx(_,{variant:"outlined",color:"error",startIcon:e.jsx(Da,{}),onClick:Ye,size:"small",children:"Stop"})]}),e.jsx(Ms,{variant:"determinate",value:ge.progress,sx:{mb:1}}),e.jsxs(t,{variant:"body2",align:"center",children:[ge.progress,"% Complete"]})]})]})]})})}),la=()=>e.jsxs(o,{children:[e.jsx(pe,{sx:{mb:3},children:e.jsxs(de,{children:[e.jsxs(t,{variant:"h6",gutterBottom:!0,children:[e.jsx(Do,{sx:{mr:1,verticalAlign:"middle"}}),"Training Sessions"]}),R.length===0?e.jsx(ue,{severity:"info",children:"No training sessions found. Start your first training session to begin OMAI's learning journey."}):e.jsx(ht,{children:e.jsxs(mt,{children:[e.jsx(xt,{children:e.jsxs(vs,{children:[e.jsx(W,{children:"Session Name"}),e.jsx(W,{children:"Phase"}),e.jsx(W,{children:"Status"}),e.jsx(W,{children:"Progress"}),e.jsx(W,{children:"Duration"}),e.jsx(W,{children:"Results"}),e.jsx(W,{children:"Actions"})]})}),e.jsx(pt,{children:R.map(c=>e.jsxs(vs,{children:[e.jsx(W,{children:c.name}),e.jsx(W,{children:e.jsx(H,{label:c.phase,size:"small",variant:"outlined"})}),e.jsx(W,{children:e.jsx(H,{label:c.status,color:c.status==="completed"?"success":c.status==="running"?"primary":c.status==="failed"?"error":"default",size:"small"})}),e.jsx(W,{children:e.jsxs(o,{display:"flex",alignItems:"center",children:[e.jsx(Ms,{variant:"determinate",value:c.progress,sx:{width:100,mr:1}}),e.jsxs(t,{variant:"body2",children:[c.progress,"%"]})]})}),e.jsx(W,{children:c.duration?`${Math.round(c.duration/60)} min`:"-"}),e.jsx(W,{children:c.results&&e.jsx(ye,{title:`Files: ${c.results.filesProcessed}, Memories: ${c.results.memoriesCreated}, Knowledge: ${c.results.knowledgeExtracted}`,children:e.jsx(H,{label:`${c.results.filesProcessed} files`,size:"small",variant:"outlined"})})}),e.jsx(W,{children:e.jsx(be,{size:"small",children:e.jsx(Os,{})})})]},c.id))})]})})]})}),e.jsx(pe,{children:e.jsxs(de,{children:[e.jsx(t,{variant:"h6",gutterBottom:!0,children:"Training Phases"}),e.jsx(M,{container:!0,spacing:2,children:[{id:"foundation",name:"Foundation Knowledge",description:"Basic system understanding and file structure analysis",icon:e.jsx(ds,{})},{id:"functional",name:"Functional Understanding",description:"API patterns, component relationships, and data flow",icon:e.jsx(dr,{})},{id:"operational",name:"Operational Intelligence",description:"Deployment, monitoring, and performance patterns",icon:e.jsx(So,{})},{id:"resolution",name:"Issue Resolution",description:"Problem-solving patterns and error handling",icon:e.jsx(Pa,{})},{id:"predictive",name:"Predictive Capabilities",description:"Proactive maintenance and optimization",icon:e.jsx(ir,{})}].map(c=>e.jsx(M,{item:!0,xs:12,md:6,lg:4,children:e.jsxs(De,{sx:{p:2,cursor:"pointer","&:hover":{elevation:4}},onClick:()=>{ns(c.id),Ge(!0)},children:[e.jsxs(o,{display:"flex",alignItems:"center",mb:1,children:[c.icon,e.jsx(t,{variant:"subtitle1",sx:{ml:1},children:c.name})]}),e.jsx(t,{variant:"body2",color:"text.secondary",children:c.description})]})},c.id))})]})})]}),ca=()=>e.jsx(o,{children:ce&&e.jsxs(e.Fragment,{children:[e.jsx(pe,{sx:{mb:3},children:e.jsxs(de,{children:[e.jsxs(t,{variant:"h6",gutterBottom:!0,children:[e.jsx(Nr,{sx:{mr:1,verticalAlign:"middle"}}),"Knowledge Analytics"]}),e.jsxs(M,{container:!0,spacing:3,children:[e.jsx(M,{item:!0,xs:12,md:4,children:e.jsxs(De,{sx:{p:2,textAlign:"center"},children:[e.jsx(t,{variant:"h4",color:"primary",children:ce.totalMemories}),e.jsx(t,{variant:"body2",color:"text.secondary",children:"Total Memories"})]})}),e.jsx(M,{item:!0,xs:12,md:4,children:e.jsxs(De,{sx:{p:2,textAlign:"center"},children:[e.jsx(t,{variant:"h4",color:"success.main",children:ce.learningVelocity.memoriesPerWeek}),e.jsx(t,{variant:"body2",color:"text.secondary",children:"Memories/Week"})]})}),e.jsx(M,{item:!0,xs:12,md:4,children:e.jsxs(De,{sx:{p:2,textAlign:"center"},children:[e.jsxs(t,{variant:"h4",color:"info.main",children:[Math.round(ce.learningVelocity.knowledgeGrowthRate*100),"%"]}),e.jsx(t,{variant:"body2",color:"text.secondary",children:"Growth Rate"})]})})]})]})}),e.jsxs(M,{container:!0,spacing:3,sx:{mb:3},children:[e.jsx(M,{item:!0,xs:12,md:6,children:e.jsx(pe,{children:e.jsxs(de,{children:[e.jsx(t,{variant:"h6",gutterBottom:!0,children:"Knowledge Categories"}),e.jsx(xs,{children:Object.entries(ce.categoriesDistribution).map(([c,N])=>e.jsxs(Ze,{children:[e.jsx(es,{primary:c}),e.jsx(H,{label:N,size:"small"})]},c))})]})})}),e.jsx(M,{item:!0,xs:12,md:6,children:e.jsx(pe,{children:e.jsxs(de,{children:[e.jsx(t,{variant:"h6",gutterBottom:!0,children:"Priority Distribution"}),e.jsx(xs,{children:Object.entries(ce.priorityDistribution).map(([c,N])=>e.jsxs(Ze,{children:[e.jsx(es,{primary:c}),e.jsx(H,{label:N,size:"small",color:c==="critical"?"error":c==="high"?"warning":c==="medium"?"info":"default"})]},c))})]})})})]}),e.jsx(pe,{children:e.jsxs(de,{children:[e.jsx(t,{variant:"h6",gutterBottom:!0,children:"Usage Patterns"}),e.jsxs(M,{container:!0,spacing:3,children:[e.jsxs(M,{item:!0,xs:12,md:4,children:[e.jsx(t,{variant:"subtitle1",gutterBottom:!0,children:"Most Used Memories"}),e.jsx(xs,{dense:!0,children:ce.usagePatterns.mostUsed.map((c,N)=>e.jsx(Ze,{children:e.jsx(es,{primary:c.title,secondary:`Used ${c.count} times`})},N))})]}),e.jsxs(M,{item:!0,xs:12,md:4,children:[e.jsx(t,{variant:"subtitle1",gutterBottom:!0,children:"Recently Accessed"}),e.jsx(xs,{dense:!0,children:ce.usagePatterns.recentlyAccessed.map((c,N)=>e.jsx(Ze,{children:e.jsx(es,{primary:c.title,secondary:new Date(c.lastAccessed).toLocaleString()})},N))})]}),e.jsxs(M,{item:!0,xs:12,md:4,children:[e.jsx(t,{variant:"subtitle1",gutterBottom:!0,children:"Trending Memories"}),e.jsx(xs,{dense:!0,children:ce.usagePatterns.trending.map((c,N)=>e.jsx(Ze,{children:e.jsx(es,{primary:c.title,secondary:e.jsxs(o,{display:"flex",alignItems:"center",children:[e.jsx(ir,{sx:{fontSize:16,mr:.5}}),c.trend>0?"+":"",c.trend,"%"]})})},N))})]})]})]})})]})}),da=()=>e.jsxs(o,{children:[e.jsx(pe,{sx:{mb:3},children:e.jsxs(de,{children:[e.jsxs(o,{display:"flex",justifyContent:"space-between",alignItems:"center",mb:2,children:[e.jsxs(t,{variant:"h5",component:"h2",children:[e.jsx(nt,{sx:{mr:1,verticalAlign:"middle"}}),"OMAI Ethics & Reasoning Foundation"]}),e.jsxs(o,{children:[e.jsx(_,{variant:"outlined",startIcon:ie?e.jsx(Oe,{size:16}):e.jsx(js,{}),onClick:cs,disabled:ie,sx:{mr:1},children:"Refresh"}),e.jsx(_,{variant:"contained",startIcon:e.jsx(Ma,{}),onClick:()=>window.open("/omlearn","_blank"),children:"Open OMLearn"})]})]}),k&&e.jsxs(M,{container:!0,spacing:3,children:[e.jsx(M,{item:!0,xs:12,md:3,children:e.jsxs(De,{sx:{p:2,textAlign:"center"},children:[e.jsxs(t,{variant:"h4",color:"primary",children:[k.completedSurveys,"/",k.totalSurveys]}),e.jsx(t,{variant:"body2",color:"text.secondary",children:"Surveys Completed"}),e.jsx(Ms,{variant:"determinate",value:k.completedSurveys/k.totalSurveys*100,sx:{mt:1}})]})}),e.jsx(M,{item:!0,xs:12,md:3,children:e.jsxs(De,{sx:{p:2,textAlign:"center"},children:[e.jsx(t,{variant:"h4",color:"success.main",children:k.ethicalFoundationsCount}),e.jsx(t,{variant:"body2",color:"text.secondary",children:"Ethical Foundations"})]})}),e.jsx(M,{item:!0,xs:12,md:3,children:e.jsxs(De,{sx:{p:2,textAlign:"center"},children:[e.jsxs(t,{variant:"h4",color:"info.main",children:[Math.round(k.moralComplexityScore),"%"]}),e.jsx(t,{variant:"body2",color:"text.secondary",children:"Moral Complexity"})]})}),e.jsx(M,{item:!0,xs:12,md:3,children:e.jsxs(De,{sx:{p:2,textAlign:"center"},children:[e.jsx(t,{variant:"h4",color:"warning.main",children:k.reasoningMaturityLevel}),e.jsx(t,{variant:"body2",color:"text.secondary",children:"Reasoning Level"})]})})]}),e.jsxs(o,{mt:3,children:[e.jsx(t,{variant:"h6",gutterBottom:!0,children:"OMLearn Survey Progress"}),Te.length>0?e.jsx(M,{container:!0,spacing:2,children:Te.map(c=>e.jsx(M,{item:!0,xs:12,md:6,children:e.jsxs(De,{sx:{p:2},children:[e.jsxs(o,{display:"flex",justifyContent:"space-between",alignItems:"start",mb:1,children:[e.jsx(t,{variant:"subtitle1",children:c.title}),e.jsx(H,{label:c.status.replace("_"," "),color:c.status==="completed"?"success":c.status==="in_progress"?"primary":"default",size:"small"})]}),e.jsxs(t,{variant:"body2",color:"text.secondary",gutterBottom:!0,children:[c.ageRange," â€¢ ",c.focus]}),e.jsxs(o,{display:"flex",alignItems:"center",mb:1,children:[e.jsx(Ms,{variant:"determinate",value:c.completedQuestions/c.totalQuestions*100,sx:{width:"100%",mr:1}}),e.jsxs(t,{variant:"body2",children:[c.completedQuestions,"/",c.totalQuestions]})]})]})},c.id))}):e.jsx(ue,{severity:"info",children:"No OMLearn surveys found. Complete OMLearn assessments to establish OMAI's ethical foundation."})]})]})}),e.jsx(pe,{sx:{mb:3},children:e.jsxs(de,{children:[e.jsxs(t,{variant:"h6",gutterBottom:!0,children:[e.jsx($a,{sx:{mr:1,verticalAlign:"middle"}}),"Ethical Foundations"]}),oe.length>0?e.jsx(M,{container:!0,spacing:2,children:oe.slice(0,6).map(c=>e.jsx(M,{item:!0,xs:12,md:6,lg:4,children:e.jsxs(De,{sx:{p:2,cursor:"pointer","&:hover":{elevation:4}},onClick:()=>{ms(c),Cs(!0)},children:[e.jsxs(o,{display:"flex",justifyContent:"between",alignItems:"start",mb:1,children:[e.jsx(t,{variant:"subtitle2",sx:{flexGrow:1,mr:1},children:c.question.length>80?`${c.question.substring(0,80)}...`:c.question}),e.jsx(H,{label:c.gradeGroup,size:"small",variant:"outlined"})]}),e.jsx(t,{variant:"body2",color:"text.secondary",sx:{display:"-webkit-box",WebkitLineClamp:2,WebkitBoxOrient:"vertical",overflow:"hidden",mb:1},children:c.userResponse}),e.jsxs(o,{display:"flex",justifyContent:"between",alignItems:"center",children:[e.jsx(H,{label:c.category.replace("_"," "),size:"small",color:c.category==="moral_development"?"primary":c.category==="ethical_thinking"?"success":c.category==="reasoning_patterns"?"info":"default"}),e.jsxs(t,{variant:"caption",color:"text.secondary",children:["Weight: ",c.weight]})]})]})},c.id))}):e.jsx(ue,{severity:"warning",children:"No ethical foundations established yet. Complete OMLearn surveys to build OMAI's moral reasoning framework."}),oe.length>6&&e.jsx(o,{textAlign:"center",mt:2,children:e.jsxs(t,{variant:"body2",color:"text.secondary",children:["Showing 6 of ",oe.length," ethical foundations"]})})]})}),e.jsx(pe,{children:e.jsxs(de,{children:[e.jsxs(t,{variant:"h6",gutterBottom:!0,children:[e.jsx(Fa,{sx:{mr:1,verticalAlign:"middle"}}),"Moral Reasoning Categories"]}),e.jsx(M,{container:!0,spacing:3,children:[{category:"moral_development",name:"Moral Development",description:"Basic moral concepts and value formation",icon:"ðŸŒ±",color:"primary"},{category:"ethical_thinking",name:"Ethical Thinking",description:"Applied ethics and moral decision-making",icon:"ðŸ¤”",color:"success"},{category:"reasoning_patterns",name:"Reasoning Patterns",description:"Logical structures and thought processes",icon:"ðŸ§©",color:"info"},{category:"philosophical_concepts",name:"Philosophical Concepts",description:"Abstract moral and philosophical understanding",icon:"ðŸŽ­",color:"secondary"}].map(c=>{const N=oe.filter(ke=>ke.category===c.category);return e.jsx(M,{item:!0,xs:12,md:6,children:e.jsxs(De,{sx:{p:2,textAlign:"center"},children:[e.jsx(t,{variant:"h2",sx:{mb:1},children:c.icon}),e.jsx(t,{variant:"h6",color:`${c.color}.main`,gutterBottom:!0,children:c.name}),e.jsx(t,{variant:"body2",color:"text.secondary",gutterBottom:!0,children:c.description}),e.jsx(t,{variant:"h4",color:`${c.color}.main`,children:N.length}),e.jsx(t,{variant:"caption",color:"text.secondary",children:"foundations established"})]})},c.category)})})]})})]});return e.jsxs(o,{sx:{p:3},children:[e.jsxs(Q,{direction:"row",justifyContent:"space-between",alignItems:"center",sx:{mb:3},children:[e.jsxs(o,{children:[e.jsxs(t,{variant:"h4",component:"h1",gutterBottom:!0,children:[e.jsx(Ft,{sx:{mr:1,verticalAlign:"middle"}}),"OMAI Learning Hub"]}),e.jsx(t,{variant:"body1",color:"text.secondary",children:"Comprehensive OMAI learning, memory management, and progress tracking"})]}),e.jsx(_,{variant:"outlined",startIcon:e.jsx(wt,{}),onClick:()=>S(!D),children:"Settings"})]}),e.jsxs(De,{sx:{width:"100%"},children:[e.jsxs(ot,{value:s,onChange:oa,sx:{borderBottom:1,borderColor:"divider"},children:[e.jsx(ze,{label:"Learning Dashboard",icon:e.jsx(nt,{}),iconPosition:"start"}),e.jsx(ze,{label:"Training Pathways",icon:e.jsx(un,{}),iconPosition:"start"}),e.jsx(ze,{label:"Memory Management",icon:e.jsx(yn,{}),iconPosition:"start"}),e.jsx(ze,{label:"Knowledge Analytics",icon:e.jsx(dr,{}),iconPosition:"start"}),e.jsx(ze,{label:"Ethics & Reasoning",icon:e.jsx(nt,{}),iconPosition:"start"}),e.jsx(ze,{label:"OMAI Discovery",icon:e.jsx(Ft,{}),iconPosition:"start"}),e.jsx(ze,{label:"Imports & Scripts"}),e.jsx(ze,{label:"File Console"}),e.jsx(ze,{label:"Console"}),e.jsx(ze,{label:"Encrypted Storage"}),e.jsx(ze,{label:"Registry Management"}),e.jsx(ze,{label:"Custom Components"})]}),e.jsxs(o,{sx:{p:3},children:[s===0&&ia(),s===1&&la(),s===2&&e.jsx(Ql,{}),s===3&&ca(),s===4&&da(),s===5&&e.jsx(Hl,{}),s===6&&e.jsxs(Q,{spacing:3,children:[D&&e.jsx(pe,{children:e.jsxs(de,{children:[e.jsxs(t,{variant:"h6",gutterBottom:!0,sx:{display:"flex",alignItems:"center",gap:1},children:[e.jsx(wt,{}),"Big Book Settings"]}),e.jsxs(Q,{spacing:3,children:[e.jsxs(o,{sx:{display:"flex",gap:2,flexWrap:"wrap"},children:[e.jsx(Ne,{sx:{flex:1,minWidth:250},label:"Database User",value:g.databaseUser,onChange:c=>T(N=>G(V({},N),{databaseUser:c.target.value})),placeholder:"root"}),e.jsx(Ne,{sx:{flex:1,minWidth:250},type:"password",label:"Database Password",value:g.databasePassword,onChange:c=>T(N=>G(V({},N),{databasePassword:c.target.value})),placeholder:"Enter database password"})]}),e.jsxs(o,{sx:{display:"flex",gap:2,flexWrap:"wrap"},children:[e.jsx(Ne,{sx:{flex:1,minWidth:250},label:"Default Database",value:g.defaultDatabase,onChange:c=>T(N=>G(V({},N),{defaultDatabase:c.target.value})),placeholder:"omai_db"}),e.jsx(Ne,{sx:{flex:1,minWidth:250},type:"number",label:"Script Timeout (ms)",value:g.scriptTimeout,onChange:c=>T(N=>G(V({},N),{scriptTimeout:parseInt(c.target.value)}))})]}),e.jsx(Be,{control:e.jsx(Ae,{checked:g.useSudo,onChange:c=>T(N=>G(V({},N),{useSudo:c.target.checked}))}),label:"Use Sudo for Script Execution"}),g.useSudo&&e.jsx(Ne,{fullWidth:!0,type:"password",label:"Sudo Password",value:g.sudoPassword,onChange:c=>T(N=>G(V({},N),{sudoPassword:c.target.value})),placeholder:"Enter sudo password"}),e.jsx(_,{variant:"contained",startIcon:e.jsx(Tr,{}),onClick:sa,children:"Save Settings"})]})]})}),e.jsx(pe,{children:e.jsxs(de,{children:[e.jsx(t,{variant:"h6",gutterBottom:!0,children:"File Upload"}),e.jsxs(o,{sx:{border:"2px dashed",borderColor:"grey.300",borderRadius:2,p:4,textAlign:"center",cursor:"pointer","&:hover":{borderColor:"primary.main",backgroundColor:"action.hover"}},onDrop:lt,onDragOver:Ys,onClick:()=>{var c;return(c=d.current)==null?void 0:c.click()},children:[e.jsx(To,{sx:{fontSize:48,color:"grey.500",mb:2}}),e.jsx(t,{variant:"h6",gutterBottom:!0,children:"Drop files here or click to upload"}),e.jsx(t,{variant:"body2",color:"text.secondary",children:"Supports all file types: .md, .js, .sh, .py, .sql, .html, .css, .json, .xml, .txt, .pdf, images, videos, audio, archives (max 10MB)"}),e.jsx(t,{variant:"body2",color:"primary.main",sx:{mt:1,fontWeight:"bold"},children:"ðŸ—ºï¸ Special: Drop Parish Map .zip files for auto-installation!"}),e.jsx("input",{ref:d,type:"file",multiple:!0,accept:".md,.js,.jsx,.ts,.tsx,.sh,.bash,.py,.sql,.html,.htm,.css,.scss,.sass,.json,.xml,.txt,.log,.pdf,.jpg,.jpeg,.png,.gif,.svg,.webp,.mp4,.avi,.mov,.wmv,.mp3,.wav,.ogg,.zip,.tar,.gz,.rar",onChange:Re,style:{display:"none"}})]})]})}),r.length>0&&e.jsx(pe,{children:e.jsxs(de,{children:[e.jsx(t,{variant:"h6",gutterBottom:!0,children:"Uploaded Files"}),e.jsx(xs,{children:r.map(c=>e.jsxs(Ze,{divider:!0,children:[e.jsx(Qs,{children:ra(c.type)}),e.jsx(es,{primary:c.name,secondary:`${(c.size/1024).toFixed(1)} KB â€¢ ${c.uploaded.toLocaleString()}`}),e.jsxs(o,{sx:{display:"flex",alignItems:"center",gap:1},children:[aa(c.type),e.jsx(ye,{title:"Execute",children:e.jsx(be,{onClick:()=>yt(c),disabled:h,color:"primary",children:e.jsx(gt,{})})}),e.jsx(ye,{title:"Remove",children:e.jsx(be,{onClick:()=>Bt(c.id),color:"error",children:e.jsx(St,{})})})]})]},c.id))})]})})]}),s===7&&e.jsx(Ul,{files:r,consoleOutput:u,isExecuting:h,onFileSelect:b,onFileExecute:yt,onFileDelete:Bt,onQuestionnairePreview:ta,onClearConsole:qn,selectedFile:v}),s===8&&e.jsxs(o,{children:[e.jsxs(Q,{direction:"row",justifyContent:"space-between",alignItems:"center",sx:{mb:2},children:[e.jsx(t,{variant:"h6",children:"Console Output"}),e.jsx(_,{variant:"outlined",startIcon:e.jsx(js,{}),onClick:qn,size:"small",children:"Clear Console"})]}),e.jsx(De,{ref:P,sx:{height:400,overflow:"auto",p:2,backgroundColor:"#1e1e1e",color:"#ffffff",fontFamily:"monospace",fontSize:"0.875rem"},children:u.length===0?e.jsx(t,{color:"grey.500",textAlign:"center",children:"No console output yet. Upload and execute files to see results."}):u.map(c=>e.jsxs(o,{sx:{mb:1},children:[e.jsxs(t,{component:"span",sx:{color:c.type==="error"?"#ff6b6b":c.type==="success"?"#51cf66":c.type==="warning"?"#ffd43b":c.type==="command"?"#74c0fc":"#ffffff",fontWeight:c.type==="command"?"bold":"normal"},children:["[",c.timestamp.toLocaleTimeString(),"] ",c.content]}),c.source&&e.jsxs(t,{variant:"caption",color:"text.secondary",sx:{ml:2},children:["(",c.source,")"]})]},c.id))})]}),s===9&&e.jsx(Wl,{}),s===10&&e.jsx(ha,{}),s===11&&e.jsx(ua,{})]})]}),e.jsx(Vl,{open:y,onClose:()=>{C(!1),U(null)},file:j,onSubmit:na}),e.jsx(ql,{open:L,onClose:()=>{X(!1),Ce(null)},file:Se,onInstallComplete:c=>{F("success",`Component installation completed: ${c.componentName}`),c.previewUrl&&F("info",`Preview available at: ${c.previewUrl}`)},onConsoleMessage:F}),e.jsxs(as,{open:Xe,onClose:()=>Ge(!1),maxWidth:"sm",fullWidth:!0,children:[e.jsxs(os,{children:[e.jsx(un,{sx:{mr:1,verticalAlign:"middle"}}),"Start OMAI Training Session"]}),e.jsxs(is,{children:[e.jsx(t,{variant:"body1",paragraph:!0,children:"Select a training phase to begin OMAI's learning session. Each phase builds upon previous knowledge."}),e.jsxs(hs,{fullWidth:!0,children:[e.jsx(Dr,{children:"Training Phase"}),e.jsx(o,{mt:1,children:[{id:"foundation",name:"Foundation Knowledge",icon:"ðŸ—ï¸"},{id:"functional",name:"Functional Understanding",icon:"âš™ï¸"},{id:"operational",name:"Operational Intelligence",icon:"ðŸ”§"},{id:"resolution",name:"Issue Resolution",icon:"ðŸ› ï¸"},{id:"predictive",name:"Predictive Capabilities",icon:"ðŸ”®"}].map(c=>e.jsx(De,{sx:{p:2,mb:1,cursor:"pointer",border:Ke===c.id?2:1,borderColor:Ke===c.id?"primary.main":"divider"},onClick:()=>ns(c.id),children:e.jsxs(t,{variant:"subtitle1",children:[c.icon," ",c.name]})},c.id))})]})]}),e.jsxs(ls,{children:[e.jsx(_,{onClick:()=>Ge(!1),children:"Cancel"}),e.jsx(_,{onClick:()=>Ee(Ke),variant:"contained",disabled:Ve,startIcon:Ve?e.jsx(Oe,{size:16}):e.jsx(gt,{}),children:Ve?"Starting...":"Start Training"})]})]}),e.jsxs(as,{open:Ds,onClose:()=>Cs(!1),maxWidth:"md",fullWidth:!0,children:[e.jsx(os,{children:fe&&e.jsxs(e.Fragment,{children:[e.jsx(nt,{sx:{mr:1,verticalAlign:"middle"}}),"Ethical Foundation Details",e.jsx(H,{label:fe.gradeGroup,size:"small",sx:{ml:2}})]})}),e.jsx(is,{children:fe&&e.jsxs(o,{children:[e.jsx(t,{variant:"h6",gutterBottom:!0,color:"primary",children:"Question"}),e.jsx(t,{variant:"body1",paragraph:!0,children:fe.question}),e.jsx(t,{variant:"h6",gutterBottom:!0,color:"primary",children:"Your Response"}),e.jsx(t,{variant:"body1",paragraph:!0,children:fe.userResponse}),e.jsx(t,{variant:"h6",gutterBottom:!0,color:"primary",children:"Reasoning"}),e.jsx(t,{variant:"body1",paragraph:!0,children:fe.reasoning}),e.jsx(ks,{sx:{my:2}}),e.jsxs(M,{container:!0,spacing:2,children:[e.jsxs(M,{item:!0,xs:6,children:[e.jsx(t,{variant:"subtitle2",color:"primary",children:"Category"}),e.jsx(t,{variant:"body2",children:fe.category.replace("_"," ")})]}),e.jsxs(M,{item:!0,xs:6,children:[e.jsx(t,{variant:"subtitle2",color:"primary",children:"Weight"}),e.jsx(t,{variant:"body2",children:fe.weight})]}),e.jsxs(M,{item:!0,xs:6,children:[e.jsx(t,{variant:"subtitle2",color:"primary",children:"Confidence"}),e.jsxs(t,{variant:"body2",children:[fe.confidence,"%"]})]}),e.jsxs(M,{item:!0,xs:6,children:[e.jsx(t,{variant:"subtitle2",color:"primary",children:"Created"}),e.jsx(t,{variant:"body2",children:new Date(fe.createdAt).toLocaleString()})]})]}),fe.appliedContexts.length>0&&e.jsxs(e.Fragment,{children:[e.jsx(ks,{sx:{my:2}}),e.jsx(t,{variant:"subtitle2",color:"primary",gutterBottom:!0,children:"Applied Contexts"}),e.jsx(o,{display:"flex",flexWrap:"wrap",gap:1,children:fe.appliedContexts.map((c,N)=>e.jsx(H,{label:c,size:"small",variant:"outlined"},N))})]}),fe.lastReferenced&&e.jsxs(e.Fragment,{children:[e.jsx(ks,{sx:{my:2}}),e.jsx(t,{variant:"subtitle2",color:"primary",children:"Last Referenced"}),e.jsx(t,{variant:"body2",children:new Date(fe.lastReferenced).toLocaleString()})]})]})}),e.jsx(ls,{children:e.jsx(_,{onClick:()=>Cs(!1),children:"Close"})})]})]})};class Yl{constructor(){Kn(this,"baseUrl","/api/components")}getComponents(){return E(this,arguments,function*(n={}){var l;const r=new URLSearchParams;n.search&&r.append("search",n.search),n.category&&r.append("category",n.category),(l=n.tags)!=null&&l.length&&r.append("tags",n.tags.join(",")),n.isActive!==void 0&&r.append("isActive",n.isActive.toString()),n.isSystem!==void 0&&r.append("isSystem",n.isSystem.toString()),n.author&&r.append("author",n.author),n.page&&r.append("page",n.page.toString()),n.limit&&r.append("limit",n.limit.toString()),n.sortBy&&r.append("sortBy",n.sortBy),n.sortOrder&&r.append("sortOrder",n.sortOrder);const a=r.toString(),u=a?`${this.baseUrl}?${a}`:this.baseUrl;return Qe(u)})}getComponent(n){return E(this,null,function*(){return Qe(`${this.baseUrl}/${n}`)})}createComponent(n){return E(this,null,function*(){return Qe(`${this.baseUrl}`,{method:"POST",body:JSON.stringify(n)})})}updateComponent(n,r){return E(this,null,function*(){return Qe(`${this.baseUrl}/${n}`,{method:"PUT",body:JSON.stringify(r)})})}deleteComponent(n){return E(this,null,function*(){return Qe(`${this.baseUrl}/${n}`,{method:"DELETE"})})}toggleComponentStatus(n,r){return E(this,null,function*(){return Qe(`${this.baseUrl}/${n}/status`,{method:"PATCH",body:JSON.stringify({isActive:r})})})}getCategories(){return E(this,null,function*(){return Qe(`${this.baseUrl}/categories`)})}createCategory(n){return E(this,null,function*(){return Qe(`${this.baseUrl}/categories`,{method:"POST",body:JSON.stringify(n)})})}updateCategory(n,r){return E(this,null,function*(){return Qe(`${this.baseUrl}/categories/${n}`,{method:"PUT",body:JSON.stringify(r)})})}deleteCategory(n){return E(this,null,function*(){return Qe(`${this.baseUrl}/categories/${n}`,{method:"DELETE"})})}getComponentUsage(n){return E(this,null,function*(){const r=n?`${this.baseUrl}/usage/${n}`:`${this.baseUrl}/usage`;return Qe(r)})}getComponentDependencies(n){return E(this,null,function*(){return Qe(`${this.baseUrl}/${n}/dependencies`)})}installDependencies(n){return E(this,null,function*(){return Qe(`${this.baseUrl}/${n}/dependencies/install`,{method:"POST"})})}getBundles(){return E(this,null,function*(){return Qe(`${this.baseUrl}/bundles`)})}createBundle(n){return E(this,null,function*(){return Qe(`${this.baseUrl}/bundles`,{method:"POST",body:JSON.stringify(n)})})}updateBundle(n,r){return E(this,null,function*(){return Qe(`${this.baseUrl}/bundles/${n}`,{method:"PUT",body:JSON.stringify(r)})})}deleteBundle(n){return E(this,null,function*(){return Qe(`${this.baseUrl}/bundles/${n}`,{method:"DELETE"})})}scanComponents(){return E(this,null,function*(){return Qe(`${this.baseUrl}/scan`,{method:"POST"})})}getComponentSource(n){return E(this,null,function*(){return Qe(`${this.baseUrl}/${n}/source`)})}updateComponentSource(n,r){return E(this,null,function*(){return Qe(`${this.baseUrl}/${n}/source`,{method:"PUT",body:JSON.stringify({content:r})})})}validateComponent(n){return E(this,null,function*(){return Qe(`${this.baseUrl}/${n}/validate`)})}getComponentPreview(a){return E(this,arguments,function*(n,r={}){return Qe(`${this.baseUrl}/${n}/preview`,{method:"POST",body:JSON.stringify({props:r})})})}exportComponent(n,r="json"){return E(this,null,function*(){return Qe(`${this.baseUrl}/${n}/export?format=${r}`)})}importComponent(n){return E(this,null,function*(){const r=new FormData;return r.append("file",n),Qe(`${this.baseUrl}/import`,{method:"POST",body:r})})}getComponentAnalytics(n="month"){return E(this,null,function*(){return Qe(`${this.baseUrl}/analytics?period=${n}`)})}}const bt=new Yl,ea=[{pattern:/Error: Service temporarily unavailable/i,level:["error"],severity:"degraded",description:"Service availability issues detected"},{pattern:/Warning: Performance degraded/i,level:["warn","error"],severity:"degraded",description:"Performance degradation detected"},{pattern:/Connection timeout|Database connection failed|Service crashed|Critical error/i,level:["error"],severity:"failed",description:"Critical system failures detected"},{pattern:/Memory leak|Out of memory|Disk space|Storage full/i,level:["error","warn"],severity:"degraded",description:"Resource constraints detected"}],Xl=(s,n=24)=>{if(!s||!Array.isArray(s)||s.length===0)return"healthy";const r=new Date(Date.now()-n*60*60*1e3),a=s.filter(v=>new Date(v.timestamp)>=r),u=a.length>0?a:s.slice(-20);let l="healthy";const h=[];for(const v of u)for(const b of ea){if(!b.level.includes(v.level))continue;(typeof b.pattern=="string"?v.message.includes(b.pattern):b.pattern.test(v.message))&&(h.push(`${b.description} (${v.timestamp})`),(b.severity==="failed"||b.severity==="degraded"&&l==="healthy")&&(l=b.severity))}const m=u.filter(v=>v.level==="error").length;return m>=10&&l==="degraded"&&(l="failed",h.push(`High error frequency detected (${m} errors)`)),l!=="healthy"&&console.log(`Health detection for component: ${l}`,{analyzedLogs:u.length,recentLogs:a.length,detectedIssues:h,worstStatus:l}),l},Zl=(s,n=24)=>{if(!s||!Array.isArray(s)||s.length===0)return[];const r=new Date(Date.now()-n*60*60*1e3),a=s.filter(h=>new Date(h.timestamp)>=r),u=a.length>0?a:s.slice(-20),l=[];for(const h of u)for(const m of ea){if(!m.level.includes(h.level))continue;if(typeof m.pattern=="string"?h.message.includes(m.pattern):m.pattern.test(h.message)){const b=new Date(Date.now()-new Date(h.timestamp).getTime()),D=Math.floor(b.getTime()/(1e3*60*60));l.push(`${m.description} (${D}h ago)`)}}return[...new Set(l)]},ec=()=>{var fe,ms,Ds,Cs;const{isSuperAdmin:s,hasRole:n}=It(),[r,a]=i.useState(null),[u,l]=i.useState(!0),[h,m]=i.useState(null),[v,b]=i.useState({page:1,limit:20,category:"all",status:"all",usageStatus:"all",search:"",enabled:"all"}),[D,S]=i.useState(""),[g,T]=i.useState("all"),[O,p]=i.useState(!1),[y,C]=i.useState([]),[j,U]=i.useState(""),[q,w]=i.useState({open:!1,component:null,newState:!1}),[z,te]=i.useState({}),[I,A]=i.useState(!1),[L,X]=i.useState(""),[Se,Ce]=i.useState("success"),[le,$]=i.useState({open:!1,component:null,result:null}),f=(d,P="success")=>{X(d),Ce(P),A(!0)},J=s||n("admin");i.useEffect(()=>{console.log("ComponentManager mounted"),ae()},[]);const ve=d=>E(void 0,null,function*(){try{if(console.log("Starting health analysis for components..."),!d||!d.components||!Array.isArray(d.components))return console.warn("Invalid components data structure, skipping health analysis:",d),d;const P=d.components.map(je=>E(void 0,null,function*(){try{const Ye=(yield bt.getLogs(je.id)).logs||[],cs=Xl(Ye),$s=Zl(Ye),rs=G(V({},je),{health:cs,healthIssues:$s.length>0?$s:je.healthIssues,lastHealthCheck:new Date().toISOString()});return cs!==je.health&&console.log(`Health updated for ${je.name}: ${je.health} â†’ ${cs}`,{issues:$s,analyzedLogs:Ye.length}),rs}catch(Ee){return console.warn(`Failed to analyze health for ${je.name}:`,Ee),G(V({},je),{lastHealthCheck:new Date().toISOString()})}})),se=yield Promise.all(P),K=G(V({},d.meta),{categoryBreakdown:B(se),usageStats:G(V({},d.meta.usageStats),{healthyComponents:se.filter(je=>je.health==="healthy").length,degradedComponents:se.filter(je=>je.health==="degraded").length,failedComponents:se.filter(je=>je.health==="failed").length})}),he=se.filter(je=>{const Ee=d.components.find(Ye=>Ye.id===je.id);return Ee&&Ee.health!==je.health});return console.log(`Health analysis completed. Updated ${se.length} components.`,{totalAnalyzed:se.length,healthChanges:he.length,changedComponents:he.map(je=>{var Ee,Ye;return{name:je.name,oldHealth:(Ee=d.components.find(cs=>cs.id===je.id))==null?void 0:Ee.health,newHealth:je.health,issues:((Ye=je.healthIssues)==null?void 0:Ye.length)||0}})}),{components:se,meta:K}}catch(P){return console.error("Health analysis failed, using original data:",P),d}}),B=d=>{const P={};return Array.isArray(d)?(d.forEach(se=>{const K=se.category||"Uncategorized";P[K]||(P[K]={total:0,healthy:0,degraded:0,failed:0,enabled:0,disabled:0,active:0,inactive:0,unused:0}),P[K].total++,P[K][se.health]++,P[K][se.enabled?"enabled":"disabled"]++,P[K][se.usageStatus]++}),P):(console.warn("calculateCategoryBreakdown: components is not an array:",d),P)},ae=d=>E(void 0,null,function*(){var P;try{l(!0),m(null);const se=d?V(V({},v),d):v;b(se);const K=yield bt.getAll(se);console.log("Components fetched:",K);const he=yield ve(K);a(he);const je=he.components.filter(cs=>cs.lastHealthCheck&&new Date(cs.lastHealthCheck).getTime()>Date.now()-6e4).length,Ee=`Loaded ${K.components.length} components (page ${K.meta.page} of ${K.meta.totalPages})`,Ye=je>0?` â€¢ Health analyzed for ${je} components`:"";f(`${Ee}${Ye}`,"success")}catch(se){console.error("Error fetching components:",se);let K="Unable to load component data from backend.";se.response?se.response.status===401||se.response.status===403?K="You do not have permission to access component data. Please contact your administrator.":se.response.status===404?K="Component management API endpoint not found. Please contact support.":se.response.status>=500?K="Server error occurred while loading components. Please try again later or contact support.":K=((P=se.response.data)==null?void 0:P.message)||`API Error (${se.response.status}): Unable to load components.`:se.request?K="Network error: Unable to connect to the component management API. Please check your connection.":K=se.message||"Unknown error occurred while loading components.",m(K),a(null),f("Failed to load components from backend API. Please check the API status or contact support.","error")}finally{l(!1)}}),_e=d=>{const P=!d.enabled;w({open:!0,component:d,newState:P})},R=()=>E(void 0,null,function*(){var se,K;const{component:d,newState:P}=q;if(d)try{te(he=>G(V({},he),{[d.id]:!0})),yield bt.toggle(d.id,P),a(he=>he?G(V({},he),{components:he.components.map(je=>je.id===d.id?G(V({},je),{enabled:P,lastUpdated:new Date().toISOString()}):je)}):null),f(`Component "${d.name}" has been ${P?"enabled":"disabled"}.`,"success"),console.log(`Component ${d.name} toggled to ${P?"enabled":"disabled"}`)}catch(he){console.error("Error toggling component:",he);const je=((K=(se=he.response)==null?void 0:se.data)==null?void 0:K.message)||he.message||"Failed to toggle component";m(je),f(`Failed to ${P?"enable":"disable"} "${d.name}": ${je}`,"error")}finally{te(he=>G(V({},he),{[d.id]:!1})),w({open:!1,component:null,newState:!1})}}),Z=d=>E(void 0,null,function*(){var P,se;try{te(he=>G(V({},he),{[d.id]:!0}));const K=yield bt.getLogs(d.id,100);C(K.logs),U(d.name),p(!0),f(`Loaded ${K.logs.length} log entries for "${d.name}"`,"info"),console.log(`Logs for ${d.name}:`,K.logs)}catch(K){console.error("Error fetching logs:",K);const he=((se=(P=K.response)==null?void 0:P.data)==null?void 0:se.message)||K.message||"Failed to fetch logs";f(`Failed to load logs for "${d.name}": ${he}`,"error")}finally{te(K=>G(V({},K),{[d.id]:!1}))}}),ce=d=>E(void 0,null,function*(){var P,se;try{te(Ee=>G(V({},Ee),{[d.id]:!0}));const K=yield bt.runTest(d.id);K!=null&&K.health&&a(Ee=>Ee?G(V({},Ee),{components:Ee.components.map(Ye=>Ye.id===d.id?G(V({},Ye),{health:K.health,lastUpdated:new Date().toISOString()}):Ye)}):null),$({open:!0,component:d,result:K});const he=(K==null?void 0:K.status)||"unknown",je=he==="pass"?"success":he==="fail"?"error":"warning";f(`Test ${he} for "${d.name}"`,je),console.log(`Test completed for component: ${d.name}`,K)}catch(K){console.error("Error running test:",K);const he=((se=(P=K.response)==null?void 0:P.data)==null?void 0:se.message)||K.message||"Test failed to execute";f(`Failed to run test for "${d.name}": ${he}`,"error")}finally{te(K=>G(V({},K),{[d.id]:!1}))}}),me=()=>E(void 0,null,function*(){try{l(!0);const d=(Array.isArray(r==null?void 0:r.components)?r.components:[]).filter(rs=>rs.health==="degraded");if(d.length===0){f("No degraded components found to export","info");return}f(`Gathering logs for ${d.length} degraded components...`,"info");let P=`DEGRADED COMPONENTS LOG REPORT
`;P+=`Generated: ${new Date().toLocaleString()}
`,P+=`Total degraded components: ${d.length}

`,P+=`${"=".repeat(60)}

`;const se=d.map(rs=>E(void 0,null,function*(){try{const zs=yield bt.getLogs(rs.id);return{component:rs,logs:zs.logs||[],success:!0}}catch(zs){return console.error(`Failed to fetch logs for ${rs.name}:`,zs),{component:rs,logs:[],success:!1,error:zs}}})),K=yield Promise.all(se);K.forEach((rs,zs)=>{var F,lt;const{component:fs,logs:Us,success:ft,error:Fs}=rs;if(P+=`Component: ${fs.name}
`,P+=`Health Status: ${fs.health.toUpperCase()}
`,P+=`Category: ${fs.category||"Uncategorized"}
`,P+=`Last Updated: ${fs.lastUpdated?new Date(fs.lastUpdated).toLocaleString():"Unknown"}
`,fs.healthIssues&&fs.healthIssues.length>0&&(P+=`Issues: ${fs.healthIssues.join(", ")}
`),P+=`${"-".repeat(30)}
`,!ft)P+=`[ERROR] Failed to retrieve logs: ${((lt=(F=Fs==null?void 0:Fs.response)==null?void 0:F.data)==null?void 0:lt.message)||(Fs==null?void 0:Fs.message)||"Unknown error"}
`;else if(Us.length===0)P+=`[INFO] No logs available for this component
`;else{const Ys=Us.sort((Xs,yt)=>new Date(yt.timestamp).getTime()-new Date(Xs.timestamp).getTime());Ys.slice(0,20).forEach(Xs=>{const yt=new Date(Xs.timestamp).toLocaleString(),Bt=Xs.level.toUpperCase();P+=`[${Bt}] ${yt} - ${Xs.message}
`}),Ys.length>20&&(P+=`... and ${Ys.length-20} more log entries
`)}P+=`
${"*".repeat(28)}

`}),P+=`EXPORT SUMMARY
`,P+=`${"-".repeat(15)}
`,P+=`Total components processed: ${K.length}
`,P+=`Successful log retrievals: ${K.filter(rs=>rs.success).length}
`,P+=`Failed log retrievals: ${K.filter(rs=>!rs.success).length}
`,P+=`Export completed: ${new Date().toLocaleString()}
`;const he=new Blob([P],{type:"text/plain;charset=utf-8"}),je=URL.createObjectURL(he),Ee=document.createElement("a");Ee.href=je;const Ye=new Date().toISOString().replace(/[:.]/g,"-").split("T"),cs=Ye[0],$s=Ye[1].split(".")[0];Ee.download=`degraded-components-log-report-${cs}-${$s}.txt`,document.body.appendChild(Ee),Ee.click(),document.body.removeChild(Ee),URL.revokeObjectURL(je),f(`Successfully exported logs for ${d.length} degraded components`,"success")}catch(d){console.error("Error exporting degraded component logs:",d),f(`Failed to export logs: ${d.message||"Unknown error"}`,"error")}finally{l(!1)}}),ge=d=>{switch(d){case"healthy":return{color:"success",icon:xr,bgColor:"#e8f5e8"};case"degraded":return{color:"warning",icon:kr,bgColor:"#fff8e1"};case"failed":return{color:"error",icon:pr,bgColor:"#ffebee"};default:return{color:"default",icon:Ur,bgColor:"#f5f5f5"}}},ts=d=>{if(!d)return"Unknown";const P=new Date(d);return P.toLocaleDateString()+" "+P.toLocaleTimeString()},Xe=d=>{switch(d){case"error":return"error";case"warn":return"warning";case"info":return"info";case"debug":return"default";default:return"default"}},Ge=d=>{const{health:P,healthIssues:se,lastHealthCheck:K}=d;let he="";switch(P){case"healthy":he="This component is running normally and all checks are passing";break;case"degraded":he="This component is experiencing issues but is still partially functional";break;case"failed":he="This component has critical issues and may not be functioning properly";break;default:he="Component health status unknown"}let je="";P!=="healthy"&&se&&se.length>0&&(je=`

Detected Issues:
â€¢ ${se.join(`
â€¢ `)}`);let Ee="";if(K){const Ye=new Date(K),cs=Math.round((Date.now()-Ye.getTime())/(1e3*60));Ee=`

Last health check: ${cs<1?"Just now":`${cs}m ago`}`}return`${he}${je}${Ee}`},Ke=d=>!!(d.healthIssues&&d.healthIssues.length>0&&d.lastHealthCheck&&d.health!=="healthy"),ns=d=>d.enabled?{"&:hover":{boxShadow:3,transform:"translateY(-2px)"}}:{opacity:.5,filter:"grayscale(0.7)",cursor:"not-allowed","&:hover":{boxShadow:1,transform:"none"}},Ve=(d,P)=>P?d?"Click to disable this component across the system":"Click to enable this component across the system":"You need admin permissions to enable or disable components",Y=d=>{if(!d)return"Never used";const P=new Date,se=new Date(d),K=P.getTime()-se.getTime(),he=Math.floor(K/(1e3*60)),je=Math.floor(K/(1e3*60*60)),Ee=Math.floor(K/(1e3*60*60*24));return he<1?"Just now":he<60?`${he}m ago`:je<24?`${je}h ago`:Ee<30?`${Ee}d ago`:se.toLocaleDateString()},k=(d,P)=>{const se={active:{color:"#4caf50",bgColor:"#e8f5e8",icon:"ðŸŸ¢",label:"Active"},inactive:{color:"#ff9800",bgColor:"#fff3e0",icon:"ðŸŸ¡",label:"Inactive"},unused:{color:"#9e9e9e",bgColor:"#f5f5f5",icon:"âšª",label:"Unused"}},K=se[d]||se.unused;return e.jsx(H,{size:"small",label:e.jsxs(o,{display:"flex",alignItems:"center",gap:.5,children:[e.jsx("span",{children:K.icon}),e.jsx("span",{children:K.label})]}),sx:{backgroundColor:K.bgColor,color:K.color,fontWeight:500,fontSize:"0.75rem"}})},ee=()=>{if(!(r!=null&&r.components)||!Array.isArray(r.components))return[];const d=new Set(r.components.map(P=>P.category));return Array.from(d).sort()},oe=d=>{T(d),ae({category:d==="all"?"all":d,page:1})},Pe=(d,P)=>{ae({page:P})},Te=i.useMemo(()=>{let d;return P=>{clearTimeout(d),d=setTimeout(()=>{b(se=>G(V({},se),{search:P,page:1})),ae({search:P,page:1})},500)}},[ae]),Ts=i.useCallback(d=>{const P=d.target.value;S(P),Te(P)},[Te]),ie=(d,P)=>{ae({[d]:P,page:1})},ne=()=>{var K,he,je,Ee,Ye,cs,$s,rs,zs,fs,Us,ft,Fs,F,lt,Ys;const d=Array.isArray(r==null?void 0:r.components)?r.components:[],P=r==null?void 0:r.meta;return P!=null&&P.categoryBreakdown||P!=null&&P.usageStats?{total:P.total||0,healthy:((he=(K=P.usageStats)==null?void 0:K.healthBreakdown)==null?void 0:he.healthy)||d.filter(Re=>Re.health==="healthy").length,degraded:((Ee=(je=P.usageStats)==null?void 0:je.healthBreakdown)==null?void 0:Ee.degraded)||d.filter(Re=>Re.health==="degraded").length,failed:((cs=(Ye=P.usageStats)==null?void 0:Ye.healthBreakdown)==null?void 0:cs.failed)||d.filter(Re=>Re.health==="failed").length,active:((rs=($s=P.usageStats)==null?void 0:$s.usageBreakdown)==null?void 0:rs.active)||d.filter(Re=>Re.usageStatus==="active").length,inactive:((fs=(zs=P.usageStats)==null?void 0:zs.usageBreakdown)==null?void 0:fs.inactive)||d.filter(Re=>Re.usageStatus==="inactive").length,unused:((ft=(Us=P.usageStats)==null?void 0:Us.usageBreakdown)==null?void 0:ft.unused)||d.filter(Re=>Re.usageStatus==="unused").length,enabled:((F=(Fs=P.usageStats)==null?void 0:Fs.statusBreakdown)==null?void 0:F.enabled)||d.filter(Re=>Re.enabled).length,disabled:((Ys=(lt=P.usageStats)==null?void 0:lt.statusBreakdown)==null?void 0:Ys.disabled)||d.filter(Re=>!Re.enabled).length}:{total:(P==null?void 0:P.total)||d.length,healthy:d.filter(Re=>Re.health==="healthy").length,degraded:d.filter(Re=>Re.health==="degraded").length,failed:d.filter(Re=>Re.health==="failed").length,active:d.filter(Re=>Re.usageStatus==="active").length,inactive:d.filter(Re=>Re.usageStatus==="inactive").length,unused:d.filter(Re=>Re.usageStatus==="unused").length,enabled:d.filter(Re=>Re.enabled).length,disabled:d.filter(Re=>!Re.enabled).length}};return u?e.jsxs(o,{display:"flex",flexDirection:"column",alignItems:"center",py:4,children:[e.jsx(Oe,{size:40}),e.jsx(t,{variant:"body2",sx:{mt:2},children:"Loading system components..."})]}):e.jsxs(o,{children:[e.jsxs(o,{display:"flex",alignItems:"center",justifyContent:"space-between",mb:3,children:[e.jsx(t,{variant:"h6",children:"System Components"}),e.jsxs(Q,{direction:"row",spacing:1,children:[J&&e.jsx(ye,{title:"Export diagnostic logs for all components with degraded health status",arrow:!0,children:e.jsx("span",{children:e.jsxs(_,{variant:"outlined",startIcon:e.jsx(An,{size:16}),onClick:me,size:"small",color:"warning",disabled:u||(Array.isArray(r==null?void 0:r.components)?r.components:[]).filter(d=>d.health==="degraded").length===0,children:["Export Degraded Logs",(r==null?void 0:r.components)&&e.jsx(H,{size:"small",label:(Array.isArray(r==null?void 0:r.components)?r.components:[]).filter(d=>d.health==="degraded").length,sx:{ml:1,fontSize:"0.7rem",height:"18px"},color:"warning"})]})})}),e.jsx(_,{variant:"outlined",startIcon:e.jsx(gn,{size:16}),onClick:ae,size:"small",children:"Refresh"})]})]}),h&&e.jsx(ue,{severity:"error",sx:{mb:3},action:e.jsx(_,{color:"inherit",size:"small",onClick:ae,children:"Retry"}),children:h}),J?e.jsxs(ue,{severity:"success",sx:{mb:3},children:[e.jsx("strong",{children:"System Status:"})," Component management system is fully operational with live backend integration. All features are connected to the production API:",e.jsx("br",{}),e.jsx("code",{children:"âœ… GET /api/admin/components"})," â€¢",e.jsx("code",{children:"âœ… PATCH /api/admin/components/:id"})," â€¢",e.jsx("code",{children:"âœ… GET /api/admin/components/:id/logs"})," â€¢",e.jsx("code",{children:"âœ… POST /api/admin/components/:id/test"})]}):e.jsx(ue,{severity:"warning",sx:{mb:3},children:"You need administrator privileges to manage components. Contact your system administrator for access."}),e.jsxs(De,{elevation:1,sx:{mb:3,p:2},children:[e.jsx(t,{variant:"subtitle1",sx:{mb:2,fontWeight:600},children:"Filter by Category"}),e.jsxs(ot,{value:g,onChange:(d,P)=>oe(P),variant:"scrollable",scrollButtons:"auto",sx:{"& .MuiTab-root":{minWidth:"auto",textTransform:"none",fontSize:"0.875rem"}},children:[e.jsx(ze,{label:e.jsx(en,{badgeContent:((fe=r==null?void 0:r.meta)==null?void 0:fe.total)||0,color:"primary",sx:{"& .MuiBadge-badge":{fontSize:"0.75rem"}},children:"All Components"}),value:"all"}),ee().map(d=>{var se,K,he;const P=((he=(K=(se=r==null?void 0:r.meta)==null?void 0:se.categoryBreakdown)==null?void 0:K[d])==null?void 0:he.total)||0;return e.jsx(ze,{label:e.jsx(en,{badgeContent:P,color:"secondary",sx:{"& .MuiBadge-badge":{fontSize:"0.75rem"}},children:d}),value:d},d)})]})]}),e.jsx(De,{elevation:1,sx:{mb:3,p:2},children:e.jsxs(Ps,{container:!0,spacing:2,alignItems:"center",children:[e.jsx(Ps,{item:!0,xs:12,md:4,children:e.jsx(Ne,{fullWidth:!0,size:"small",placeholder:"Search components...",value:D,onChange:Ts,InputProps:{startAdornment:e.jsx(sn,{position:"start",children:e.jsx(Po,{size:20})})}})}),e.jsx(Ps,{item:!0,xs:12,sm:6,md:2,children:e.jsxs(hs,{fullWidth:!0,size:"small",children:[e.jsx(ps,{children:"Health"}),e.jsxs(gs,{value:v.status||"all",label:"Health",onChange:d=>ie("status",d.target.value),children:[e.jsx(xe,{value:"all",children:"All Health"}),e.jsx(xe,{value:"healthy",children:"ðŸŸ¢ Healthy"}),e.jsx(xe,{value:"degraded",children:"ðŸŸ¡ Degraded"}),e.jsx(xe,{value:"failed",children:"ðŸ”´ Failed"})]})]})}),e.jsx(Ps,{item:!0,xs:12,sm:6,md:2,children:e.jsxs(hs,{fullWidth:!0,size:"small",children:[e.jsx(ps,{children:"Usage"}),e.jsxs(gs,{value:v.usageStatus||"all",label:"Usage",onChange:d=>ie("usageStatus",d.target.value),children:[e.jsx(xe,{value:"all",children:"All Usage"}),e.jsx(xe,{value:"active",children:"ðŸŸ¢ Active"}),e.jsx(xe,{value:"inactive",children:"ðŸŸ¡ Inactive"}),e.jsx(xe,{value:"unused",children:"âšª Unused"})]})]})}),e.jsx(Ps,{item:!0,xs:12,sm:6,md:2,children:e.jsxs(hs,{fullWidth:!0,size:"small",children:[e.jsx(ps,{children:"Status"}),e.jsxs(gs,{value:v.enabled||"all",label:"Status",onChange:d=>ie("enabled",d.target.value),children:[e.jsx(xe,{value:"all",children:"All Status"}),e.jsx(xe,{value:"true",children:"âœ… Enabled"}),e.jsx(xe,{value:"false",children:"âŒ Disabled"})]})]})}),e.jsx(Ps,{item:!0,xs:12,md:2,children:e.jsx(t,{variant:"body2",color:"text.secondary",sx:{textAlign:"right"},children:r!=null&&r.meta?e.jsxs(e.Fragment,{children:["Showing ",(r.meta.page-1)*r.meta.limit+1,"â€“",Math.min(r.meta.page*r.meta.limit,r.meta.total)," of ",r.meta.total]}):"Loading..."})})]})}),e.jsxs(De,{elevation:1,sx:{mb:3,p:2},children:[e.jsx(t,{variant:"subtitle1",sx:{mb:2,fontWeight:600},children:g==="all"?"Global Summary":`${g} Summary`}),e.jsxs(Ps,{container:!0,spacing:2,children:[e.jsx(Ps,{item:!0,xs:12,md:4,children:e.jsxs(o,{sx:{p:2,backgroundColor:"grey.50",borderRadius:1},children:[e.jsx(t,{variant:"body2",color:"text.secondary",sx:{mb:1,fontWeight:600},children:"Component Health"}),e.jsx(t,{variant:"caption",color:"text.secondary",sx:{mb:1,fontStyle:"italic",display:"block"},children:"Includes automatic log-based detection"}),e.jsxs(Q,{direction:"row",spacing:2,sx:{mb:1},children:[e.jsx(H,{size:"small",label:`${ne().healthy} Healthy`,color:"success",variant:"outlined"}),e.jsx(H,{size:"small",label:`${ne().degraded} Degraded`,color:"warning",variant:"outlined"}),e.jsx(H,{size:"small",label:`${ne().failed} Failed`,color:"error",variant:"outlined"})]}),e.jsxs(t,{variant:"h6",color:"text.primary",children:[ne().total," Total Components"]})]})}),e.jsx(Ps,{item:!0,xs:12,md:4,children:e.jsxs(o,{sx:{p:2,backgroundColor:"grey.50",borderRadius:1},children:[e.jsx(t,{variant:"body2",color:"text.secondary",sx:{mb:1,fontWeight:600},children:"Usage Activity"}),e.jsxs(Q,{direction:"row",spacing:2,sx:{mb:1},children:[e.jsx(H,{size:"small",label:`${ne().active} Active`,sx:{backgroundColor:"#e8f5e8",color:"#4caf50"}}),e.jsx(H,{size:"small",label:`${ne().inactive} Inactive`,sx:{backgroundColor:"#fff3e0",color:"#ff9800"}}),e.jsx(H,{size:"small",label:`${ne().unused} Unused`,sx:{backgroundColor:"#f5f5f5",color:"#9e9e9e"}})]}),e.jsx(t,{variant:"body2",color:"text.secondary",children:"Last 24h activity tracking"})]})}),e.jsx(Ps,{item:!0,xs:12,md:4,children:e.jsxs(o,{sx:{p:2,backgroundColor:"grey.50",borderRadius:1},children:[e.jsx(t,{variant:"body2",color:"text.secondary",sx:{mb:1,fontWeight:600},children:"Component Status"}),e.jsxs(Q,{direction:"row",spacing:2,sx:{mb:1},children:[e.jsx(H,{size:"small",label:`${ne().enabled} Enabled`,color:"success",variant:"outlined"}),e.jsx(H,{size:"small",label:`${ne().disabled} Disabled`,color:"default",variant:"outlined"})]}),e.jsx(t,{variant:"body2",color:"text.secondary",children:"System-wide component states"})]})})]})]}),e.jsx(Ps,{container:!0,spacing:3,children:(Array.isArray(r==null?void 0:r.components)?r.components:[]).map((d,P)=>{const se=ge(d.health),K=se.icon,he=z[d.id];return e.jsx(Ps,{item:!0,xs:12,md:6,lg:4,children:e.jsxs(pe,{variant:"outlined",sx:V({height:"100%",transition:"all 0.2s ease-in-out"},he?{opacity:.7}:ns(d)),children:[he&&e.jsx(Ms,{}),e.jsx(de,{children:e.jsxs(Q,{spacing:2,children:[e.jsxs(o,{display:"flex",alignItems:"center",justifyContent:"space-between",children:[e.jsxs(o,{display:"flex",alignItems:"center",children:[e.jsx(ye,{title:Ge(d),arrow:!0,children:e.jsx(Mo,{sx:{bgcolor:se.bgColor,color:`${se.color}.main`,mr:2,width:40,height:40,cursor:"help"},children:e.jsx(K,{size:20})})}),e.jsx(t,{variant:"h6",component:"h3",sx:{color:d.enabled?"text.primary":"text.disabled"},children:d.name})]}),!J&&e.jsx(ye,{title:"Admin access required",children:e.jsx(jn,{size:16,color:"#ff9800"})})]}),d.description&&e.jsx(t,{variant:"body2",color:"text.secondary",sx:{fontStyle:"italic",opacity:d.enabled?1:.6},children:d.description}),e.jsxs(o,{display:"flex",alignItems:"center",justifyContent:"space-between",sx:{py:1},children:[e.jsxs(o,{display:"flex",alignItems:"center",gap:1,children:[k(d.usageStatus||"unused",d.lastUsed),e.jsx(t,{variant:"caption",color:"text.secondary",children:d.lastUsedFormatted||Y(d.lastUsed)})]}),e.jsxs(o,{display:"flex",alignItems:"center",gap:1,children:[e.jsx(ye,{title:`Total accesses: ${d.totalAccesses||0}`,arrow:!0,children:e.jsx(H,{size:"small",icon:e.jsx(Zt,{size:14}),label:d.uniqueUsers||0,variant:"outlined",sx:{fontSize:"0.7rem"}})}),e.jsx(ye,{title:`Category: ${d.category||"Uncategorized"}`,arrow:!0,children:e.jsx(H,{size:"small",icon:e.jsx(Go,{size:14}),label:d.category||"Other",variant:"outlined",color:"secondary",sx:{fontSize:"0.7rem"}})})]})]}),e.jsxs(o,{display:"flex",alignItems:"center",justifyContent:"space-between",children:[e.jsx(ye,{title:Ve(d.enabled,J),arrow:!0,children:e.jsx(Be,{control:e.jsx(Ae,{checked:d.enabled,onChange:()=>_e(d),disabled:!J||he,color:"primary"}),label:d.enabled?"Enabled":"Disabled"})}),e.jsxs(o,{display:"flex",alignItems:"center",gap:.5,children:[e.jsx(ye,{title:Ge(d),arrow:!0,children:e.jsx(H,{label:d.health.charAt(0).toUpperCase()+d.health.slice(1),color:se.color,variant:"filled",size:"small",icon:e.jsx(K,{size:16})})}),Ke(d)&&e.jsx(ye,{title:"Health status automatically detected based on log analysis in past 24h",arrow:!0,children:e.jsx(Zn,{size:14,style:{color:"#ff9800",opacity:.7}})})]})]}),e.jsxs(t,{variant:"body2",color:"text.secondary",sx:{opacity:d.enabled?1:.6},children:["Last Updated: ",ts(d.lastUpdated)]}),e.jsxs(o,{display:"flex",justifyContent:"flex-end",gap:1,children:[e.jsx(ye,{title:d.enabled?"View recent log output from this component":"Component is disabled - enable to view logs",arrow:!0,children:e.jsx("span",{children:e.jsx(be,{size:"small",onClick:()=>Z(d),disabled:!d.enabled||he,color:"primary",sx:{opacity:d.enabled?1:.5},children:e.jsx(zt,{size:16})})})}),e.jsx(ye,{title:d.enabled?J?"Run automated self-test for this component":"Admin access required to run tests":"Component is disabled - enable to run tests",arrow:!0,children:e.jsx("span",{children:e.jsx(be,{size:"small",onClick:()=>ce(d),disabled:!d.enabled||!J||he,color:"secondary",sx:{opacity:d.enabled?1:.5},children:e.jsx(jr,{size:16})})})}),e.jsx(ye,{title:d.enabled?"Component configuration and advanced settings (Coming Soon)":"Component is disabled - enable to access settings",arrow:!0,children:e.jsx("span",{children:e.jsx(be,{size:"small",disabled:!0,sx:{opacity:d.enabled?.5:.3},children:e.jsx(Gt,{size:16})})})})]})]})})]})},d.id||P)})}),(r==null?void 0:r.meta)&&r.meta.totalPages>1&&e.jsx(o,{display:"flex",justifyContent:"center",alignItems:"center",mt:4,mb:2,children:e.jsxs(Q,{spacing:2,alignItems:"center",children:[e.jsx(Wn,{count:r.meta.totalPages,page:r.meta.page,onChange:Pe,color:"primary",size:"large",showFirstButton:!0,showLastButton:!0,siblingCount:1,boundaryCount:1}),e.jsxs(t,{variant:"body2",color:"text.secondary",children:["Page ",r.meta.page," of ",r.meta.totalPages," â€¢ Showing ",(r.meta.page-1)*r.meta.limit+1,"â€“",Math.min(r.meta.page*r.meta.limit,r.meta.total)," of ",r.meta.total," components"]})]})}),(r==null?void 0:r.components)&&r.components.length===0&&e.jsxs(o,{textAlign:"center",py:6,children:[e.jsx(bn,{size:48,style:{opacity:.3,marginBottom:"16px"}}),e.jsx(t,{variant:"h6",color:"text.secondary",gutterBottom:!0,children:"No components found"}),e.jsx(t,{variant:"body2",color:"text.secondary",children:v.search||v.category!=="all"||v.status!=="all"||v.usageStatus!=="all"||v.enabled!=="all"?"Try adjusting your search criteria or filters":"No components are currently registered in the system"})]}),e.jsxs(as,{open:q.open,onClose:()=>w({open:!1,component:null,newState:!1}),children:[e.jsx(os,{children:e.jsxs(o,{display:"flex",alignItems:"center",gap:1,children:[e.jsx(jn,{size:20}),"Confirm Component Toggle"]})}),e.jsxs(is,{children:[e.jsxs($o,{children:["Are you sure you want to ",e.jsx("strong",{children:q.newState?"enable":"disable"})," the"," ",e.jsxs("strong",{children:['"',(ms=q.component)==null?void 0:ms.name,'"']})," component?"]}),e.jsx(ue,{severity:q.newState?"info":"warning",sx:{mt:2},children:q.newState?"Enabling this component will make it available across the system.":"Disabling this component may affect system functionality and user experience."})]}),e.jsxs(ls,{children:[e.jsx(_,{onClick:()=>w({open:!1,component:null,newState:!1}),children:"Cancel"}),e.jsx(_,{onClick:R,variant:"contained",color:q.newState?"primary":"error",startIcon:q.newState?e.jsx(xr,{size:16}):e.jsx(pr,{size:16}),children:q.newState?"Enable Component":"Disable Component"})]})]}),e.jsxs(as,{open:O,onClose:()=>p(!1),maxWidth:"md",fullWidth:!0,children:[e.jsx(os,{children:e.jsxs(o,{display:"flex",alignItems:"center",gap:1,children:[e.jsx(zt,{size:20}),j," - Component Logs"]})}),e.jsx(is,{children:y.length===0?e.jsxs(o,{textAlign:"center",py:3,children:[e.jsx(Zn,{size:48,color:"#ccc"}),e.jsx(t,{variant:"h6",color:"text.secondary",mt:1,children:"No logs available"}),e.jsx(t,{variant:"body2",color:"text.secondary",children:"This component hasn't generated any log entries yet."})]}):e.jsxs(e.Fragment,{children:[e.jsxs(t,{variant:"body2",color:"text.secondary",mb:2,children:["Showing ",y.length," recent log entries"]}),e.jsx(xs,{sx:{maxHeight:400,overflow:"auto"},children:y.map((d,P)=>e.jsx(Ze,{divider:!0,children:e.jsx(es,{primary:e.jsxs(o,{display:"flex",alignItems:"center",gap:1,mb:.5,children:[e.jsx(H,{label:d.level.toUpperCase(),color:Xe(d.level),size:"small"}),e.jsx(t,{variant:"caption",color:"text.secondary",children:new Date(d.timestamp).toLocaleString()})]}),secondary:e.jsx(t,{variant:"body2",sx:{fontFamily:"monospace",mt:.5},children:d.message})})},d.id||P))})]})}),e.jsx(ls,{children:e.jsx(_,{onClick:()=>p(!1),startIcon:e.jsx(Er,{size:16}),children:"Close"})})]}),e.jsxs(as,{open:le.open,onClose:()=>$({open:!1,component:null,result:null}),maxWidth:"sm",fullWidth:!0,children:[e.jsx(os,{children:e.jsxs(o,{display:"flex",alignItems:"center",gap:1,children:[e.jsx(jr,{size:20}),"Test Results - ",(Ds=le.component)==null?void 0:Ds.name]})}),e.jsx(is,{children:le.result?e.jsxs(Q,{spacing:2,children:[e.jsxs(o,{display:"flex",alignItems:"center",gap:1,children:[e.jsx(t,{variant:"subtitle1",children:"Overall Status:"}),e.jsx(H,{label:((Cs=le.result.status)==null?void 0:Cs.toUpperCase())||"UNKNOWN",color:le.result.status==="pass"?"success":le.result.status==="fail"?"error":"warning",variant:"filled"})]}),le.result.details&&e.jsx(ue,{severity:"info",children:le.result.details}),le.result.tests&&e.jsxs(e.Fragment,{children:[e.jsx(ks,{}),e.jsx(t,{variant:"subtitle2",children:"Test Details:"}),e.jsx(xs,{dense:!0,children:le.result.tests.map((d,P)=>e.jsx(Ze,{children:e.jsx(es,{primary:e.jsxs(o,{display:"flex",alignItems:"center",gap:1,children:[e.jsx(t,{variant:"body2",children:d.name}),e.jsx(H,{label:d.status.toUpperCase(),color:d.status==="pass"?"success":d.status==="fail"?"error":"warning",size:"small"})]}),secondary:e.jsxs(t,{variant:"caption",color:"text.secondary",children:["Duration: ",d.duration,d.error&&` â€¢ Error: ${d.error}`,d.details&&` â€¢ ${d.details}`]})})},P))})]}),le.result.timestamp&&e.jsxs(t,{variant:"caption",color:"text.secondary",textAlign:"center",children:["Test completed at ",new Date(le.result.timestamp).toLocaleString()]})]}):e.jsx(t,{color:"text.secondary",children:"No test results available."})}),e.jsx(ls,{children:e.jsx(_,{onClick:()=>$({open:!1,component:null,result:null}),children:"Close"})})]}),e.jsx(wn,{open:I,autoHideDuration:6e3,onClose:()=>A(!1),anchorOrigin:{vertical:"bottom",horizontal:"right"},children:e.jsx(ue,{onClose:()=>A(!1),severity:Se,variant:"filled",sx:{width:"100%"},children:L})})]})},sc=()=>{const{user:s}=It(),[n,r]=i.useState(!0),[a,u]=i.useState(0),[l,h]=i.useState(null),[m,v]=i.useState([]),[b,D]=i.useState([]),[S,g]=i.useState(!1),[T,O]=i.useState({prodPath:"/var/www/orthodox-church-mgmt/orthodoxmetrics/prod",devPath:"/var/www/orthodmetrics/dev",dryRun:!1,skipDatabase:!1,skipFiles:!1,force:!1}),[p,y]=i.useState([]),[C,j]=i.useState(1),[U,q]=i.useState(0),[w,z]=i.useState(null),[te,I]=i.useState([]),[A,L]=i.useState({open:!1,message:"",severity:"info"}),[X,Se]=i.useState(!1),[Ce,le]=i.useState(null),$=i.useCallback(()=>E(void 0,null,function*(){try{Se(!0);const R=yield Mt.get("/api/admin/omai-spin/dashboard");if(R.data.success){const{recentSessions:Z,statistics:ce,activeOperations:me}=R.data.data;h(ce),v(Z),D(me)}}catch(R){console.error("Error loading OMAI-Spin dashboard:",R),L({open:!0,message:"Failed to load dashboard data",severity:"error"})}finally{r(!1),Se(!1)}}),[]),f=i.useCallback((R=1)=>E(void 0,null,function*(){try{const Z=yield Mt.get(`/api/admin/omai-spin/history?page=${R}&limit=10`);if(Z.data.success){const{sessions:ce,pagination:me}=Z.data.data;y(ce),q(me.totalSessions),j(R)}}catch(Z){console.error("Error loading session history:",Z)}}),[]);i.useEffect(()=>{const R=new EventSource("/api/admin/omai-spin/live-updates");return R.onmessage=Z=>{try{const ce=JSON.parse(Z.data);switch(ce.type){case"operationUpdate":D(me=>me.map(ge=>ge.sessionId===ce.data.operationId?V(V({},ge),ce.data):ge));break;case"operationComplete":case"operationError":$(),a===1&&f(C);break}}catch(ce){console.error("Error processing SSE event:",ce)}},R.onerror=Z=>{console.error("SSE connection error:",Z)},le(R),()=>{R.close()}},[$,f,a,C]),i.useEffect(()=>{$(),f()},[$,f]);const J=()=>E(void 0,null,function*(){var R,Z;try{(yield Mt.post("/api/admin/omai-spin/start",T)).data.success&&(L({open:!0,message:"OMAI-Spin operation started successfully",severity:"success"}),g(!1),$())}catch(ce){L({open:!0,message:((Z=(R=ce.response)==null?void 0:R.data)==null?void 0:Z.error)||"Failed to start operation",severity:"error"})}}),ve=R=>E(void 0,null,function*(){try{yield Mt.delete(`/api/admin/omai-spin/operation/${R}`),L({open:!0,message:"Operation cancelled",severity:"info"}),$()}catch(Z){L({open:!0,message:"Failed to cancel operation",severity:"error"})}}),B=R=>E(void 0,null,function*(){try{const Z=yield Mt.get(`/api/admin/omai-spin/session/${R}/logs`);Z.data.success&&(I(Z.data.data.logs),z(R))}catch(Z){L({open:!0,message:"Failed to load session logs",severity:"error"})}}),ae=R=>{switch(R){case"completed":return{color:"success",icon:e.jsx(tn,{}),label:"Completed"};case"failed":return{color:"error",icon:e.jsx(Un,{}),label:"Failed"};case"in_progress":case"running":return{color:"primary",icon:e.jsx(Oe,{size:16}),label:"Running"};case"cancelled":return{color:"warning",icon:e.jsx(Lr,{}),label:"Cancelled"};default:return{color:"default",icon:e.jsx(_r,{}),label:R}}},_e=R=>{if(!R)return"N/A";const Z=Math.floor(R/3600),ce=Math.floor(R%3600/60),me=R%60;return Z>0?`${Z}h ${ce}m ${me}s`:ce>0?`${ce}m ${me}s`:`${me}s`};return n?e.jsx(o,{display:"flex",justifyContent:"center",alignItems:"center",minHeight:"400px",children:e.jsx(Oe,{})}):e.jsxs(o,{children:[e.jsxs(o,{display:"flex",justifyContent:"space-between",alignItems:"center",mb:3,children:[e.jsxs(o,{children:[e.jsx(t,{variant:"h4",gutterBottom:!0,children:"OMAI-Spin Environment Mirroring"}),e.jsx(t,{variant:"body1",color:"textSecondary",children:"Safely replicate production environments for development use"})]}),e.jsxs(o,{display:"flex",gap:2,children:[e.jsx(_,{variant:"contained",color:"primary",startIcon:e.jsx(gt,{}),onClick:()=>g(!0),disabled:b.length>0,children:"Start New Operation"}),e.jsx(_,{variant:"outlined",startIcon:e.jsx(js,{}),onClick:$,disabled:X,children:"Refresh"})]})]}),b.length>0&&e.jsxs(ue,{severity:"info",sx:{mb:3},children:[e.jsx(t,{variant:"h6",children:"Active Operations"}),b.map(R=>e.jsxs(o,{mt:1,children:[e.jsxs(o,{display:"flex",justifyContent:"space-between",alignItems:"center",children:[e.jsxs(t,{variant:"body2",children:[R.currentStep," - ",R.progress,"%"]}),e.jsx(_,{size:"small",color:"error",onClick:()=>ve(R.sessionId),children:"Cancel"})]}),e.jsx(Ms,{variant:"determinate",value:R.progress,sx:{mt:1}})]},R.sessionId))]}),e.jsxs(M,{container:!0,spacing:3,mb:3,children:[e.jsx(M,{item:!0,xs:12,md:3,children:e.jsx(pe,{children:e.jsx(de,{children:e.jsxs(o,{display:"flex",alignItems:"center",children:[e.jsx(Fo,{color:"primary",sx:{mr:2}}),e.jsxs(o,{children:[e.jsx(t,{variant:"h4",children:(l==null?void 0:l.total_sessions)||0}),e.jsx(t,{variant:"body2",color:"textSecondary",children:"Total Sessions"})]})]})})})}),e.jsx(M,{item:!0,xs:12,md:3,children:e.jsx(pe,{children:e.jsx(de,{children:e.jsxs(o,{display:"flex",alignItems:"center",children:[e.jsx(tn,{color:"success",sx:{mr:2}}),e.jsxs(o,{children:[e.jsx(t,{variant:"h4",children:(l==null?void 0:l.completed_sessions)||0}),e.jsx(t,{variant:"body2",color:"textSecondary",children:"Completed"})]})]})})})}),e.jsx(M,{item:!0,xs:12,md:3,children:e.jsx(pe,{children:e.jsx(de,{children:e.jsxs(o,{display:"flex",alignItems:"center",children:[e.jsx(Xo,{color:"info",sx:{mr:2}}),e.jsxs(o,{children:[e.jsx(t,{variant:"h4",children:(l==null?void 0:l.total_files_copied)||0}),e.jsx(t,{variant:"body2",color:"textSecondary",children:"Files Copied"})]})]})})})}),e.jsx(M,{item:!0,xs:12,md:3,children:e.jsx(pe,{children:e.jsx(de,{children:e.jsxs(o,{display:"flex",alignItems:"center",children:[e.jsx(at,{color:"warning",sx:{mr:2}}),e.jsxs(o,{children:[e.jsx(t,{variant:"h4",children:_e((l==null?void 0:l.avg_duration)||0)}),e.jsx(t,{variant:"body2",color:"textSecondary",children:"Avg Duration"})]})]})})})})]}),e.jsx(o,{sx:{borderBottom:1,borderColor:"divider",mb:3},children:e.jsxs(ot,{value:a,onChange:(R,Z)=>u(Z),children:[e.jsx(ze,{label:"Recent Sessions"}),e.jsx(ze,{label:"Session History"})]})}),a===0&&e.jsx(pe,{children:e.jsxs(de,{children:[e.jsx(t,{variant:"h6",gutterBottom:!0,children:"Recent Sessions"}),e.jsx(ht,{children:e.jsxs(mt,{children:[e.jsx(xt,{children:e.jsxs(vs,{children:[e.jsx(W,{children:"Status"}),e.jsx(W,{children:"Started"}),e.jsx(W,{children:"Triggered By"}),e.jsx(W,{children:"Duration"}),e.jsx(W,{children:"Files"}),e.jsx(W,{children:"Actions"})]})}),e.jsx(pt,{children:m.map(R=>{const Z=ae(R.status);return e.jsxs(vs,{children:[e.jsx(W,{children:e.jsx(H,{icon:Z.icon,label:Z.label,color:Z.color,size:"small"})}),e.jsx(W,{children:new Date(R.timestamp).toLocaleString()}),e.jsx(W,{children:R.triggered_by}),e.jsx(W,{children:_e(R.duration_seconds)}),e.jsx(W,{children:e.jsxs(t,{variant:"body2",children:[R.total_files_copied," copied, ",R.total_files_modified," modified"]})}),e.jsx(W,{children:e.jsx(ye,{title:"View Logs",children:e.jsx(be,{size:"small",onClick:()=>B(R.id.toString()),children:e.jsx(Os,{})})})})]},R.id)})})]})})]})}),a===1&&e.jsx(pe,{children:e.jsxs(de,{children:[e.jsxs(o,{display:"flex",justifyContent:"space-between",alignItems:"center",mb:2,children:[e.jsx(t,{variant:"h6",children:"Session History"}),e.jsx(_,{variant:"outlined",size:"small",onClick:()=>f(C),children:"Refresh"})]}),e.jsx(ht,{children:e.jsxs(mt,{children:[e.jsx(xt,{children:e.jsxs(vs,{children:[e.jsx(W,{children:"Session ID"}),e.jsx(W,{children:"Status"}),e.jsx(W,{children:"Paths"}),e.jsx(W,{children:"Started"}),e.jsx(W,{children:"Duration"}),e.jsx(W,{children:"Statistics"}),e.jsx(W,{children:"Actions"})]})}),e.jsx(pt,{children:p.map(R=>{var ce;const Z=ae(R.status);return e.jsxs(vs,{children:[e.jsx(W,{children:e.jsxs(t,{variant:"body2",fontFamily:"monospace",children:[R.session_uuid.substring(0,8),"..."]})}),e.jsx(W,{children:e.jsx(H,{icon:Z.icon,label:Z.label,color:Z.color,size:"small"})}),e.jsx(W,{children:e.jsxs(t,{variant:"body2",children:[R.src_path," â†’ ",R.dest_path]})}),e.jsx(W,{children:new Date(R.timestamp).toLocaleString()}),e.jsx(W,{children:_e(R.duration_seconds)}),e.jsx(W,{children:e.jsxs(t,{variant:"body2",children:["ðŸ“ ",R.total_files_copied," copied",e.jsx("br",{}),"ðŸ—„ï¸ ",((ce=R.databases_migrated)==null?void 0:ce.length)||0," DBs"]})}),e.jsx(W,{children:e.jsx(ye,{title:"View Logs",children:e.jsx(be,{size:"small",onClick:()=>B(R.id.toString()),children:e.jsx(Os,{})})})})]},R.id)})})]})}),e.jsx(o,{display:"flex",justifyContent:"center",mt:2,children:e.jsx(Wn,{count:Math.ceil(U/10),page:C,onChange:(R,Z)=>f(Z)})})]})}),e.jsxs(as,{open:S,onClose:()=>g(!1),maxWidth:"md",fullWidth:!0,children:[e.jsx(os,{children:"Start New OMAI-Spin Operation"}),e.jsx(is,{children:e.jsxs(M,{container:!0,spacing:2,sx:{mt:1},children:[e.jsx(M,{item:!0,xs:12,children:e.jsx(Ne,{fullWidth:!0,label:"Production Path",value:T.prodPath,onChange:R=>O(Z=>G(V({},Z),{prodPath:R.target.value}))})}),e.jsx(M,{item:!0,xs:12,children:e.jsx(Ne,{fullWidth:!0,label:"Development Path",value:T.devPath,onChange:R=>O(Z=>G(V({},Z),{devPath:R.target.value}))})}),e.jsx(M,{item:!0,xs:12,children:e.jsx(Be,{control:e.jsx(Ae,{checked:T.dryRun,onChange:R=>O(Z=>G(V({},Z),{dryRun:R.target.checked}))}),label:"Dry Run (Preview only)"})}),e.jsx(M,{item:!0,xs:6,children:e.jsx(Be,{control:e.jsx(Ae,{checked:T.skipDatabase,onChange:R=>O(Z=>G(V({},Z),{skipDatabase:R.target.checked}))}),label:"Skip Database"})}),e.jsx(M,{item:!0,xs:6,children:e.jsx(Be,{control:e.jsx(Ae,{checked:T.skipFiles,onChange:R=>O(Z=>G(V({},Z),{skipFiles:R.target.checked}))}),label:"Skip Files"})}),e.jsx(M,{item:!0,xs:12,children:e.jsx(Be,{control:e.jsx(Ae,{checked:T.force,onChange:R=>O(Z=>G(V({},Z),{force:R.target.checked}))}),label:"Force (Skip confirmations)"})})]})}),e.jsxs(ls,{children:[e.jsx(_,{onClick:()=>g(!1),children:"Cancel"}),e.jsx(_,{onClick:J,variant:"contained",children:"Start Operation"})]})]}),e.jsxs(as,{open:!!w,onClose:()=>z(null),maxWidth:"lg",fullWidth:!0,children:[e.jsx(os,{children:"Session Logs"}),e.jsx(is,{children:e.jsx(o,{sx:{maxHeight:"600px",overflow:"auto"},children:te.map((R,Z)=>e.jsxs(o,{sx:{fontFamily:"monospace",fontSize:"0.875rem",mb:1,p:1,backgroundColor:R.log_level==="error"?"error.light":R.log_level==="warn"?"warning.light":"background.paper",borderRadius:1},children:[e.jsxs(t,{variant:"caption",color:"textSecondary",children:["[",new Date(R.timestamp).toLocaleTimeString(),"] [",R.log_level,"] [",R.component,"]"]}),e.jsx(t,{variant:"body2",component:"div",children:R.message})]},Z))})}),e.jsx(ls,{children:e.jsx(_,{onClick:()=>z(null),children:"Close"})})]}),e.jsx(wn,{open:A.open,autoHideDuration:6e3,onClose:()=>L(R=>G(V({},R),{open:!1})),children:e.jsx(ue,{onClose:()=>L(R=>G(V({},R),{open:!1})),severity:A.severity,children:A.message})})]})},tc="/api",nc=()=>E(void 0,null,function*(){try{const s=yield ba.get(`${tc}/admin/system/system-info`);if(s.data.success)return s.data.data;throw new Error(s.data.message||"Failed to fetch system information")}catch(s){throw console.error("Error fetching system information:",s),s}}),pn=s=>s<1024?`${s} MB`:`${(s/1024).toFixed(1)} GB`,Sr=(s,n)=>Math.round(s/n*100),rc=s=>({win32:"Windows",darwin:"macOS",linux:"Linux",freebsd:"FreeBSD",openbsd:"OpenBSD"})[s]||s,ac=s=>({x64:"x86_64",ia32:"x86",arm:"ARM",arm64:"ARM64"})[s]||s,oc=s=>s.charAt(0).toUpperCase()+s.slice(1);function Vs(s){const l=s,{children:n,value:r,index:a}=l,u=Qn(l,["children","value","index"]);return e.jsx("div",G(V({role:"tabpanel",hidden:r!==a,id:`admin-settings-tabpanel-${a}`,"aria-labelledby":`admin-settings-tab-${a}`},u),{children:r===a&&e.jsx(o,{sx:{p:3},children:n})}))}const ou=()=>{const{isSuperAdmin:s,hasRole:n,user:r}=It(),[a,u]=i.useState(0),[l,h]=i.useState(null),[m,v]=i.useState(!1),[b,D]=i.useState(null);i.useEffect(()=>{a===0&&S()},[a]);const S=()=>E(void 0,null,function*(){var O,p;v(!0),D(null);try{const y=yield nc();h(y)}catch(y){D(((p=(O=y.response)==null?void 0:O.data)==null?void 0:p.message)||y.message||"Failed to load system information"),console.error("Error fetching system info:",y)}finally{v(!1)}}),g=(O,p)=>{u(p)},T=[{to:"/",title:"Home"},{to:"/admin",title:"Admin"},{title:"Settings"}];return e.jsxs(Ro,{title:"Admin Settings",description:"Administrative settings for the Orthodox Metrics system",children:[e.jsx(Ao,{title:"Admin Settings",items:T}),e.jsxs(o,{p:3,children:[e.jsxs(o,{display:"flex",alignItems:"center",mb:3,children:[e.jsx(Gt,{size:"24",style:{marginRight:8}}),e.jsx(t,{variant:"h4",children:"Admin Settings"})]}),e.jsxs(pe,{children:[e.jsx(o,{sx:{borderBottom:1,borderColor:"divider","& .MuiTabs-root":{minHeight:"auto"},"& .MuiTabs-flexContainer":{gap:{xs:0,sm:1}},"& .MuiTab-root":{minWidth:{xs:"auto",sm:160},fontSize:{xs:"0.75rem",sm:"0.875rem"},padding:{xs:"8px 12px",sm:"12px 16px"},whiteSpace:"nowrap","& .MuiTab-iconWrapper":{fontSize:{xs:"1.1rem",sm:"1.25rem"},marginBottom:{xs:"2px",sm:"4px"}}}},children:e.jsxs(ot,{value:a,onChange:g,"aria-label":"admin settings tabs",variant:"scrollable",scrollButtons:"auto",allowScrollButtonsMobile:!0,sx:{"& .MuiTabs-scrollButtons":{"&.Mui-disabled":{opacity:.3}},"& .MuiTabs-indicator":{height:3}},children:[e.jsx(ze,{icon:e.jsx(ur,{}),label:"General",id:"admin-settings-tab-0","aria-controls":"admin-settings-tabpanel-0"}),e.jsx(ze,{icon:e.jsx(hr,{}),label:"Backup & Restore",id:"admin-settings-tab-1","aria-controls":"admin-settings-tabpanel-1"}),e.jsx(ze,{icon:e.jsx(jn,{}),label:"Security",id:"admin-settings-tab-2","aria-controls":"admin-settings-tabpanel-2"}),e.jsx(ze,{icon:e.jsx(Br,{}),label:"Notifications",id:"admin-settings-tab-3","aria-controls":"admin-settings-tabpanel-3"}),e.jsx(ze,{icon:e.jsx(Qt,{}),label:"Content",id:"admin-settings-tab-4","aria-controls":"admin-settings-tabpanel-4"}),e.jsx(ze,{icon:e.jsx(Ur,{}),label:"Services",id:"admin-settings-tab-5","aria-controls":"admin-settings-tabpanel-5"}),e.jsx(ze,{icon:e.jsx(zo,{}),label:"OM Big Book",id:"admin-settings-tab-6","aria-controls":"admin-settings-tabpanel-6"}),e.jsx(ze,{icon:e.jsx(bn,{}),label:"Components",id:"admin-settings-tab-7","aria-controls":"admin-settings-tabpanel-7"}),e.jsx(ze,{icon:e.jsx(va,{}),label:"OMAI Spin",id:"admin-settings-tab-8","aria-controls":"admin-settings-tabpanel-8"})]})}),e.jsxs(Vs,{value:a,index:0,children:[e.jsx(t,{variant:"h6",gutterBottom:!0,children:"General Settings"}),m&&e.jsxs(o,{display:"flex",justifyContent:"center",alignItems:"center",py:4,children:[e.jsx(Oe,{}),e.jsx(t,{variant:"body2",sx:{ml:2},children:"Loading system information..."})]}),b&&e.jsx(ue,{severity:"error",sx:{mb:3},action:e.jsx(_,{color:"inherit",size:"small",onClick:S,children:"Retry"}),children:b}),!m&&!b&&l&&e.jsxs(Q,{spacing:3,children:[e.jsx(pe,{variant:"outlined",children:e.jsxs(de,{children:[e.jsxs(o,{display:"flex",alignItems:"center",mb:2,children:[e.jsx(ur,{size:24,style:{marginRight:8,color:"#1976d2"}}),e.jsx(t,{variant:"h6",children:"System Information"})]}),e.jsxs(Q,{spacing:2,children:[e.jsxs(Q,{direction:{xs:"column",sm:"row"},spacing:3,children:[e.jsxs(o,{flex:1,children:[e.jsxs(o,{display:"flex",alignItems:"center",mb:1,children:[e.jsx(fr,{size:16,style:{marginRight:8}}),e.jsx(t,{variant:"body2",color:"text.secondary",children:"Node.js Version"})]}),e.jsx(t,{variant:"body1",fontWeight:500,children:l.nodeVersion})]}),e.jsxs(o,{flex:1,children:[e.jsxs(o,{display:"flex",alignItems:"center",mb:1,children:[e.jsx(Vt,{size:16,style:{marginRight:8}}),e.jsx(t,{variant:"body2",color:"text.secondary",children:"Server Uptime"})]}),e.jsx(t,{variant:"body1",fontWeight:500,children:l.uptime})]}),e.jsxs(o,{flex:1,children:[e.jsxs(o,{display:"flex",alignItems:"center",mb:1,children:[e.jsx(mr,{size:16,style:{marginRight:8}}),e.jsx(t,{variant:"body2",color:"text.secondary",children:"Hostname"})]}),e.jsx(t,{variant:"body1",fontWeight:500,children:l.hostname})]})]}),e.jsxs(Q,{direction:{xs:"column",sm:"row"},spacing:3,children:[e.jsxs(o,{flex:1,children:[e.jsxs(o,{display:"flex",alignItems:"center",mb:1,children:[e.jsx(gr,{size:16,style:{marginRight:8}}),e.jsx(t,{variant:"body2",color:"text.secondary",children:"Memory Usage"})]}),e.jsxs(t,{variant:"body1",fontWeight:500,children:[pn(l.memory)," / ",pn(l.totalMemory)]}),e.jsx(Ms,{variant:"determinate",value:Sr(l.memory,l.totalMemory),sx:{mt:1,height:6,borderRadius:1}}),e.jsxs(t,{variant:"caption",color:"text.secondary",children:[Sr(l.memory,l.totalMemory),"% used"]})]}),e.jsxs(o,{flex:1,children:[e.jsxs(o,{display:"flex",alignItems:"center",mb:1,children:[e.jsx(mr,{size:16,style:{marginRight:8}}),e.jsx(t,{variant:"body2",color:"text.secondary",children:"Platform"})]}),e.jsxs(t,{variant:"body1",fontWeight:500,children:[rc(l.platform)," (",ac(l.arch),")"]})]}),e.jsxs(o,{flex:1,children:[e.jsxs(o,{display:"flex",alignItems:"center",mb:1,children:[e.jsx(bn,{size:16,style:{marginRight:8}}),e.jsx(t,{variant:"body2",color:"text.secondary",children:"CPU Cores / Load"})]}),e.jsxs(t,{variant:"body1",fontWeight:500,children:[l.cpuCount," cores / ",l.loadAverage,"%"]})]})]})]})]})}),e.jsx(pe,{variant:"outlined",children:e.jsxs(de,{children:[e.jsxs(o,{display:"flex",alignItems:"center",mb:2,children:[e.jsx(Gt,{size:24,style:{marginRight:8,color:"#2e7d32"}}),e.jsx(t,{variant:"h6",children:"Application Settings"})]}),e.jsxs(Q,{spacing:2,children:[e.jsxs(Q,{direction:{xs:"column",sm:"row"},spacing:3,children:[e.jsxs(o,{flex:1,children:[e.jsxs(o,{display:"flex",alignItems:"center",mb:1,children:[e.jsx(hr,{size:16,style:{marginRight:8}}),e.jsx(t,{variant:"body2",color:"text.secondary",children:"Environment"})]}),e.jsx(H,{label:oc(l.env),color:l.env==="production"?"success":"warning",size:"small"})]}),e.jsxs(o,{flex:1,children:[e.jsxs(o,{display:"flex",alignItems:"center",mb:1,children:[e.jsx(fr,{size:16,style:{marginRight:8}}),e.jsx(t,{variant:"body2",color:"text.secondary",children:"OrthodoxMetrics Version"})]}),e.jsxs(t,{variant:"body1",fontWeight:500,children:["v",l.version]})]}),e.jsxs(o,{flex:1,children:[e.jsxs(o,{display:"flex",alignItems:"center",mb:1,children:[e.jsx(Oo,{size:16,style:{marginRight:8}}),e.jsx(t,{variant:"body2",color:"text.secondary",children:"Date Format"})]}),e.jsx(t,{variant:"body1",fontWeight:500,children:l.dateFormat})]})]}),e.jsxs(Q,{direction:{xs:"column",sm:"row"},spacing:3,children:[e.jsxs(o,{flex:1,children:[e.jsxs(o,{display:"flex",alignItems:"center",mb:1,children:[e.jsx(Yo,{size:16,style:{marginRight:8}}),e.jsx(t,{variant:"body2",color:"text.secondary",children:"Default Language"})]}),e.jsxs(t,{variant:"body1",fontWeight:500,children:["English (",l.language.toUpperCase(),")"]})]}),e.jsxs(o,{flex:1,children:[e.jsxs(o,{display:"flex",alignItems:"center",mb:1,children:[e.jsx(Zt,{size:16,style:{marginRight:8}}),e.jsx(t,{variant:"body2",color:"text.secondary",children:"Churches in System"})]}),e.jsxs(t,{variant:"body1",fontWeight:500,children:[l.churchCount," ",l.churchCount===1?"church":"churches"]})]}),e.jsxs(o,{flex:1,children:[e.jsxs(o,{display:"flex",alignItems:"center",mb:1,children:[e.jsx(gr,{size:16,style:{marginRight:8}}),e.jsx(t,{variant:"body2",color:"text.secondary",children:"Free Memory"})]}),e.jsxs(t,{variant:"body1",fontWeight:500,children:[pn(l.freeMemory)," available"]})]})]})]}),e.jsx(ks,{sx:{my:2}}),e.jsxs(o,{display:"flex",justifyContent:"space-between",alignItems:"center",children:[e.jsxs(t,{variant:"body2",color:"text.secondary",children:["Last updated: ",new Date().toLocaleString()]}),e.jsx(_,{variant:"outlined",size:"small",onClick:S,disabled:m,children:"Refresh"})]})]})})]})]}),e.jsx(Vs,{value:a,index:1,children:e.jsx(ii,{})}),e.jsxs(Vs,{value:a,index:2,children:[e.jsx(t,{variant:"h6",gutterBottom:!0,children:"Security Settings"}),e.jsx(ue,{severity:"info",sx:{mb:3},children:"Security settings are under development."}),e.jsxs(Q,{direction:{xs:"column",md:"row"},spacing:3,children:[e.jsx(pe,{variant:"outlined",sx:{flex:1},children:e.jsxs(de,{children:[e.jsx(t,{variant:"h6",gutterBottom:!0,children:"Password Policy"}),e.jsx(t,{variant:"body2",color:"text.secondary",children:"Configure password requirements and policies."})]})}),e.jsx(pe,{variant:"outlined",sx:{flex:1},children:e.jsxs(de,{children:[e.jsx(t,{variant:"h6",gutterBottom:!0,children:"Session Management"}),e.jsx(t,{variant:"body2",color:"text.secondary",children:"Configure session timeout and security settings."})]})})]})]}),e.jsx(Vs,{value:a,index:3,children:e.jsx(Bl,{})}),e.jsx(Vs,{value:a,index:4,children:e.jsx(ci,{})}),e.jsx(Vs,{value:a,index:5,children:e.jsx(di,{})}),e.jsx(Vs,{value:a,index:6,children:e.jsx(Kl,{})}),e.jsx(Vs,{value:a,index:7,children:e.jsx(ec,{})}),e.jsx(Vs,{value:a,index:8,children:e.jsx(sc,{})})]})]})]})};export{ou as default};
//# sourceMappingURL=AdminSettings-b0Xid9b9.js.map
