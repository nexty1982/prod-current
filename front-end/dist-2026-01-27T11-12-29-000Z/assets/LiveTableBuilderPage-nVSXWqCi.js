var vs=Object.defineProperty,Rs=Object.defineProperties;var ks=Object.getOwnPropertyDescriptors;var ot=Object.getOwnPropertySymbols;var jt=Object.prototype.hasOwnProperty,Tt=Object.prototype.propertyIsEnumerable;var gt=(e,s,n)=>s in e?vs(e,s,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[s]=n,Z=(e,s)=>{for(var n in s||(s={}))jt.call(s,n)&&gt(e,n,s[n]);if(ot)for(var n of ot(s))Tt.call(s,n)&&gt(e,n,s[n]);return e},ce=(e,s)=>Rs(e,ks(s));var At=(e,s)=>{var n={};for(var a in e)jt.call(e,a)&&s.indexOf(a)<0&&(n[a]=e[a]);if(e!=null&&ot)for(var a of ot(e))s.indexOf(a)<0&&Tt.call(e,a)&&(n[a]=e[a]);return n};var Ct=(e,s,n)=>gt(e,typeof s!="symbol"?s+"":s,n);var Oe=(e,s,n)=>new Promise((a,l)=>{var c=i=>{try{r(n.next(i))}catch(h){l(h)}},d=i=>{try{r(n.throw(i))}catch(h){l(h)}},r=i=>i.done?a(i.value):Promise.resolve(i.value).then(c,d);r((n=n.apply(e,s)).next())});import{a as ze,j as o,cI as Es,cJ as Is,cK as Ms,cL as at,cM as Fs,cN as Ps,cO as js,cP as It,cQ as Ts,cR as Qt,cS as As,cT as Te,cU as Os,cV as Bs,cW as Ns,cX as ut,cY as Gs,cZ as _s,c_ as Ws,c$ as Us,d0 as Ls,d1 as Hs,d2 as wt,d3 as Ds,d4 as Vs,d5 as $s,d6 as Js,d7 as zs,d8 as Ks,d9 as qs,da as Ke,db as Ys,dc as Qs,dd as Zs,de as Xs,O as _e,I as Je,B as Re,T as Ye,bd as St,e as oe,d as Be,q as er,R as tr,b9 as sr,a0 as Ot,a1 as Bt,a2 as Nt,f as We,D as Qe,aH as rr,J as Ue,Y as Le,K as He,F as Gt,aJ as _t,a3 as De,a5 as nr,$ as or}from"./index-CHjTtHW2.js";import{r as t,b as y,c as ar,a as Zt}from"./vendor-DgfDxsY7.js";import{E as lr}from"./Edit-C9MNfJRw.js";import{a as Ge}from"./admin.api-BRdbrdSp.js";import{C as cr}from"./Container-DQ6QG2MT.js";import{E as ir}from"./ExpandLess-CTZRrQ0n.js";import{E as ur}from"./ExpandMore-D52hm1T1.js";import{H as dr}from"./HelpOutline-BkTk5hdJ.js";import{D as pr}from"./Delete-DeWtZK2F.js";import"./api.config-C9UNSeTF.js";const yt=ze(o.jsx("path",{d:"M19 9h-4V3H9v6H5l7 7zM5 18v2h14v-2z"})),Ze=ze(o.jsx("path",{d:"M9 16h6v-6h4l-7-7-7 7h4zm-4 2h14v2H5z"})),mr=ze(o.jsx("path",{d:"M18.4 10.6C16.55 8.99 14.15 8 11.5 8c-4.65 0-8.58 3.03-9.96 7.22L3.9 16c1.05-3.19 4.05-5.5 7.6-5.5 1.95 0 3.73.72 5.12 1.88L13 16h9V7z"})),Wt=ze(o.jsx("path",{d:"M19 13H5v-2h14z"})),hr=ze(o.jsx("path",{d:"M6.99 11 3 15l3.99 4v-3H14v-2H6.99zM21 9l-3.99-4v3H10v2h7.01v3z"})),fr=ze(o.jsx("path",{d:"M12.5 8c-2.65 0-5.05.99-6.9 2.6L2 7v9h9l-3.62-3.62c1.39-1.16 3.16-1.88 5.12-1.88 3.54 0 6.55 2.31 7.6 5.5l2.37-.78C21.08 11.03 17.15 8 12.5 8"}));var be=y.createContext({}),Xt=y.createContext("default"),tt=(e,s,n,a)=>{if(!e||e.componentFromFramework||s.isDestroyed())return;const c=e.newAgStackInstance();let d,r,i=!1;return c.then(h=>{if(i){s.destroyBean(h);return}d=h,r=d.getGui(),n.appendChild(r),Ut(a,d)}),()=>{var h;i=!0,d&&((h=r==null?void 0:r.parentElement)==null||h.removeChild(r),s.destroyBean(d),a&&Ut(a,void 0))}},Ut=(e,s)=>{if(e)if(e instanceof Function)e(s);else{const n=e;n.current=s}},Pe=(...e)=>e.filter(n=>n!=null&&n!=="").join(" "),je=class es{constructor(...s){this.classesMap={},s.forEach(n=>{this.classesMap[n]=!0})}setClass(s,n){if(!!this.classesMap[s]==n)return this;const l=new es;return l.classesMap=Z({},this.classesMap),l.classesMap[s]=n,l}toString(){return Object.keys(this.classesMap).filter(n=>this.classesMap[n]).join(" ")}},qe=e=>{const s=()=>typeof Symbol=="function"&&Symbol.for,n=()=>s()?Symbol.for("react.memo"):60115;return typeof e=="function"&&!(e.prototype&&e.prototype.isReactComponent)||typeof e=="object"&&e.$$typeof===n()},Yt,vt=(Yt=y.version)==null?void 0:Yt.split(".")[0],ts=vt==="16"||vt==="17";function gr(){return vt==="19"}var lt=!1;function Cr(e){return lt||setTimeout(()=>lt=!1,0),lt=!0,e()}var et=(e,s)=>{!ts&&e&&!lt?ar.flushSync(s):s()},wr=e=>{ts?e():y.startTransition(e)};function yr(e,s,n){return y.useSyncExternalStore?y.useSyncExternalStore(e,s):n}function ct(e,s,n){if(s==null||e==null)return s;if(e===s||s.length===0&&e.length===0)return e;if(n||e.length===0&&s.length>0||e.length>0&&s.length===0)return s;const a=[],l=[],c=new Map,d=new Map;for(let r=0;r<s.length;r++){const i=s[r];d.set(i.instanceId,i)}for(let r=0;r<e.length;r++){const i=e[r];c.set(i.instanceId,i),d.has(i.instanceId)&&a.push(i)}for(let r=0;r<s.length;r++){const i=s[r],h=i.instanceId;c.has(h)||l.push(i)}return a.length===e.length&&l.length===0?e:a.length===0&&l.length===s.length?s:a.length===0?l:l.length===0?a:[...a,...l]}var ss=t.forwardRef((e,s)=>{var H;const{registry:n,context:a}=t.useContext(be),l=t.useRef(null),c=t.useRef(null),d=t.useRef(null),r=t.useRef(null),i=t.useRef(null),h=t.useRef(),[p,P]=t.useState(),[m,R]=t.useState(),[g,B]=t.useState(),[M,j]=t.useState(()=>new je),[O,N]=t.useState(()=>new je("ag-hidden")),[V,f]=t.useState(()=>new je("ag-hidden")),[z,U]=t.useState(()=>new je("ag-invisible"));t.useImperativeHandle(s,()=>({refresh(){return!1}})),t.useLayoutEffect(()=>tt(p,a,c.current),[p]);const k=t.useCallback($=>{if(l.current=$,!$){h.current=a.destroyBean(h.current);return}const G={setInnerRenderer:(K,W)=>{P(K),B(W)},setChildCount:K=>R(K),toggleCss:(K,W)=>j(q=>q.setClass(K,W)),setContractedDisplayed:K=>f(W=>W.setClass("ag-hidden",!K)),setExpandedDisplayed:K=>N(W=>W.setClass("ag-hidden",!K)),setCheckboxVisible:K=>U(W=>W.setClass("ag-invisible",!K)),setCheckboxSpacing:K=>U(W=>W.setClass("ag-group-checkbox-spacing",K))},D=n.createDynamicBean("groupCellRendererCtrl",!0);D&&(h.current=a.createBean(D),h.current.init(G,$,d.current,r.current,i.current,ss,e))},[]),E=t.useMemo(()=>`ag-cell-wrapper ${M.toString()}`,[M]),I=t.useMemo(()=>`ag-group-expanded ${O.toString()}`,[O]),T=t.useMemo(()=>`ag-group-contracted ${V.toString()}`,[V]),b=t.useMemo(()=>`ag-group-checkbox ${z.toString()}`,[z]),S=p==null?void 0:p.componentFromFramework,A=S?p.componentClass:void 0,F=p==null&&g!=null,L=As(g);return y.createElement("span",Z({className:E,ref:k},e.colDef?{}:{role:(H=h.current)==null?void 0:H.getCellAriaRole()}),y.createElement("span",{className:I,ref:r}),y.createElement("span",{className:T,ref:i}),y.createElement("span",{className:b,ref:d}),y.createElement("span",{className:"ag-group-value",ref:c},F?L:S?y.createElement(A,Z({},p.params)):null),y.createElement("span",{className:"ag-group-child-count"},m))}),Lt=ss,Mt=t.createContext({setMethods:()=>{}}),xr=e=>{const{initialProps:s,addUpdateCallback:n,CustomComponentClass:a,setMethods:l}=e,[i,...h]=t.useState(s),p=i,{key:c}=p,d=At(p,["key"]),[r]=h;return t.useEffect(()=>{n(P=>r(P))},[]),y.createElement(Mt.Provider,{value:{setMethods:l}},y.createElement(a,Z({key:c},d)))},br=t.memo(xr),Sr=0;function Ht(){return`agPortalKey_${++Sr}`}var rs=class{constructor(e,s,n,a){this.portal=null,this.oldPortal=null,this.reactComponent=e,this.portalManager=s,this.componentType=n,this.suppressFallbackMethods=!!a,this.statelessComponent=this.isStateless(this.reactComponent),this.key=Ht(),this.portalKey=Ht(),this.instanceCreated=this.isStatelessComponent()?Te.resolve(!1):new Te(l=>{this.resolveInstanceCreated=l})}getGui(){return this.eParentElement}getRootElement(){return this.eParentElement.firstChild}destroy(){this.componentInstance&&typeof this.componentInstance.destroy=="function"&&this.componentInstance.destroy();const e=this.portal;e&&this.portalManager.destroyPortal(e)}createParentElement(e){const s=this.portalManager.getComponentWrappingElement(),n=document.createElement(s||"div");return n.classList.add("ag-react-container"),e.reactContainer=n,n}statelessComponentRendered(){return this.eParentElement.childElementCount>0||this.eParentElement.childNodes.length>0}getFrameworkComponentInstance(){return this.componentInstance}isStatelessComponent(){return this.statelessComponent}getReactComponentName(){return this.reactComponent.name}getMemoType(){return this.hasSymbol()?Symbol.for("react.memo"):60115}hasSymbol(){return typeof Symbol=="function"&&Symbol.for}isStateless(e){return typeof e=="function"&&!(e.prototype&&e.prototype.isReactComponent)||typeof e=="object"&&e.$$typeof===this.getMemoType()}hasMethod(e){const s=this.getFrameworkComponentInstance();return!!s&&s[e]!=null||this.fallbackMethodAvailable(e)}callMethod(e,s){const n=this.getFrameworkComponentInstance();if(this.isStatelessComponent())return this.fallbackMethod(e,s&&s[0]?s[0]:{});if(!n){setTimeout(()=>this.callMethod(e,s));return}const a=n[e];if(a)return a.apply(n,s);if(this.fallbackMethodAvailable(e))return this.fallbackMethod(e,s&&s[0]?s[0]:{})}addMethod(e,s){this[e]=s}init(e){return this.eParentElement=this.createParentElement(e),this.createOrUpdatePortal(e),new Te(s=>this.createReactComponent(s))}createOrUpdatePortal(e){this.isStatelessComponent()||(this.ref=s=>{var n;this.componentInstance=s,(n=this.resolveInstanceCreated)==null||n.call(this,!0),this.resolveInstanceCreated=void 0},e.ref=this.ref),this.reactElement=this.createElement(this.reactComponent,ce(Z({},e),{key:this.key})),this.portal=Zt.createPortal(this.reactElement,this.eParentElement,this.portalKey)}createElement(e,s){return t.createElement(e,s)}createReactComponent(e){this.portalManager.mountReactPortal(this.portal,this,e)}rendered(){return this.isStatelessComponent()&&this.statelessComponentRendered()||!!(!this.isStatelessComponent()&&this.getFrameworkComponentInstance())}refreshComponent(e){this.oldPortal=this.portal,this.createOrUpdatePortal(e),this.portalManager.updateReactPortal(this.oldPortal,this.portal)}fallbackMethod(e,s){const n=this[`${e}Component`];if(!this.suppressFallbackMethods&&n)return n.bind(this)(s)}fallbackMethodAvailable(e){return this.suppressFallbackMethods?!1:!!this[`${e}Component`]}};function dt(e,s,n){e.forEach(a=>{const l=s[a];l&&(n[a]=l)})}var Ee=class extends rs{constructor(){super(...arguments),this.awaitUpdateCallback=new Te(e=>{this.resolveUpdateCallback=e}),this.wrapperComponent=br}init(e){return this.sourceParams=e,super.init(this.getProps())}addMethod(){}getInstance(){return this.instanceCreated.then(()=>this.componentInstance)}getFrameworkComponentInstance(){return this}createElement(e,s){return super.createElement(this.wrapperComponent,{initialProps:s,CustomComponentClass:e,setMethods:n=>this.setMethods(n),addUpdateCallback:n=>{this.updateCallback=()=>(n(this.getProps()),new Te(a=>{setTimeout(()=>{a()})})),this.resolveUpdateCallback()}})}setMethods(e){this.providedMethods=e,dt(this.getOptionalMethods(),this.providedMethods,this)}getOptionalMethods(){return[]}getProps(){return ce(Z({},this.sourceParams),{key:this.key,ref:this.ref})}refreshProps(){return this.updateCallback?this.updateCallback():new Te(e=>this.awaitUpdateCallback.then(()=>{this.updateCallback().then(()=>e())}))}},vr=class extends Ee{refresh(e){return this.sourceParams=e,this.refreshProps(),!0}},Rr=class extends Ee{constructor(){super(...arguments),this.date=null,this.onDateChange=e=>this.updateDate(e)}getDate(){return this.date}setDate(e){this.date=e,this.refreshProps()}refresh(e){this.sourceParams=e,this.refreshProps()}getOptionalMethods(){return["afterGuiAttached","setInputPlaceholder","setInputAriaLabel","setDisabled"]}updateDate(e){this.setDate(e),this.sourceParams.onDateChanged()}getProps(){const e=super.getProps();return e.date=this.date,e.onDateChange=this.onDateChange,delete e.onDateChanged,e}},kr=class extends Ee{constructor(){super(...arguments),this.label="",this.icon=null,this.shake=!1}setIcon(e,s){this.icon=e,this.shake=s,this.refreshProps()}setLabel(e){this.label=e,this.refreshProps()}getProps(){const e=super.getProps(),{label:s,icon:n,shake:a}=this;return e.label=s,e.icon=n,e.shake=a,e}},Er=class extends Ee{constructor(){super(...arguments),this.model=null,this.onModelChange=e=>this.updateModel(e),this.onUiChange=()=>this.sourceParams.filterModifiedCallback(),this.expectingNewMethods=!0,this.hasBeenActive=!1,this.awaitSetMethodsCallback=new Te(e=>{this.resolveSetMethodsCallback=e})}isFilterActive(){return this.model!=null}doesFilterPass(e){return this.providedMethods.doesFilterPass(e)}getModel(){return this.model}setModel(e){return this.expectingNewMethods=!0,this.model=e,this.hasBeenActive||(this.hasBeenActive=this.isFilterActive()),this.refreshProps()}refresh(e){return this.sourceParams=e,this.refreshProps(),!0}afterGuiAttached(e){var n;const s=this.providedMethods;s?(n=s.afterGuiAttached)==null||n.call(s,e):this.awaitSetMethodsCallback.then(()=>{var a,l;return(l=(a=this.providedMethods)==null?void 0:a.afterGuiAttached)==null?void 0:l.call(a,e)})}getOptionalMethods(){return["afterGuiDetached","onNewRowsLoaded","getModelAsString","onAnyFilterChanged"]}setMethods(e){var s,n;this.expectingNewMethods===!1&&this.hasBeenActive&&((s=this.providedMethods)==null?void 0:s.doesFilterPass)!==(e==null?void 0:e.doesFilterPass)&&setTimeout(()=>{this.sourceParams.filterChangedCallback()}),this.expectingNewMethods=!1,super.setMethods(e),this.resolveSetMethodsCallback(),(n=this.resolveFilterPassCallback)==null||n.call(this),this.resolveFilterPassCallback=void 0}updateModel(e){var n;(n=this.resolveFilterPassCallback)==null||n.call(this);const s=new Te(a=>{this.resolveFilterPassCallback=a});this.setModel(e).then(()=>{s.then(()=>{this.sourceParams.filterChangedCallback()})})}getProps(){const e=super.getProps();return e.model=this.model,e.onModelChange=this.onModelChange,e.onUiChange=this.onUiChange,delete e.filterChangedCallback,e}},Ir=class extends Ee{constructor(){super(...arguments),this.awaitSetMethodsCallback=new Te(e=>{this.resolveSetMethodsCallback=e})}refresh(e){return this.sourceParams=e,this.refreshProps(),!0}afterGuiAttached(e){var n;const s=this.providedMethods;s?(n=s.afterGuiAttached)==null||n.call(s,e):this.awaitSetMethodsCallback.then(()=>{var a,l;return(l=(a=this.providedMethods)==null?void 0:a.afterGuiAttached)==null?void 0:l.call(a,e)})}getOptionalMethods(){return["afterGuiDetached","onNewRowsLoaded","onAnyFilterChanged"]}setMethods(e){super.setMethods(e),this.resolveSetMethodsCallback()}};function ns(e,s){e.parentFilterInstance(n=>{(n.setModel(s)||Te.resolve()).then(()=>{e.filterParams.filterChangedCallback()})})}var Mr=class{constructor(e,s){this.floatingFilterParams=e,this.refreshProps=s,this.model=null,this.onModelChange=n=>this.updateModel(n)}getProps(){return ce(Z({},this.floatingFilterParams),{model:this.model,onModelChange:this.onModelChange})}onParentModelChanged(e){this.model=e,this.refreshProps()}refresh(e){this.floatingFilterParams=e,this.refreshProps()}setMethods(e){dt(this.getOptionalMethods(),e,this)}getOptionalMethods(){return["afterGuiAttached"]}updateModel(e){this.model=e,this.refreshProps(),ns(this.floatingFilterParams,e)}},Fr=class extends Ee{constructor(){super(...arguments),this.model=null,this.onModelChange=e=>this.updateModel(e)}onParentModelChanged(e){this.model=e,this.refreshProps()}refresh(e){this.sourceParams=e,this.refreshProps()}getOptionalMethods(){return["afterGuiAttached"]}updateModel(e){this.model=e,this.refreshProps(),ns(this.sourceParams,e)}getProps(){const e=super.getProps();return e.model=this.model,e.onModelChange=this.onModelChange,e}},Pr=class extends Ee{refresh(e){this.sourceParams=e,this.refreshProps()}getOptionalMethods(){return["afterGuiAttached"]}},jr=class extends Ee{refresh(e){return this.sourceParams=e,this.refreshProps(),!0}},Tr=class extends Ee{refresh(e){this.sourceParams=e,this.refreshProps()}},Ar=class extends Ee{constructor(){super(...arguments),this.active=!1,this.expanded=!1,this.onActiveChange=e=>this.updateActive(e)}setActive(e){this.awaitSetActive(e)}setExpanded(e){this.expanded=e,this.refreshProps()}getOptionalMethods(){return["select","configureDefaults"]}awaitSetActive(e){return this.active=e,this.refreshProps()}updateActive(e){const s=this.awaitSetActive(e);e&&s.then(()=>this.sourceParams.onItemActivated())}getProps(){const e=super.getProps();return e.active=this.active,e.expanded=this.expanded,e.onActiveChange=this.onActiveChange,delete e.onItemActivated,e}},Or=class extends Ee{refresh(e){this.sourceParams=e,this.refreshProps()}},Br=class extends Ee{refresh(e){return this.sourceParams=e,this.refreshProps(),!0}},Nr=class extends Ee{constructor(){super(...arguments),this.onStateChange=e=>this.updateState(e)}refresh(e){return this.sourceParams=e,this.refreshProps(),!0}getState(){return this.state}updateState(e){this.state=e,this.refreshProps(),this.sourceParams.onStateUpdated()}getProps(){const e=super.getProps();return e.state=this.state,e.onStateChange=this.onStateChange,e}};function Ft(){It(231)}var Gr=1e3,_r=class{constructor(e,s,n){this.destroyed=!1,this.portals=[],this.hasPendingPortalUpdate=!1,this.wrappingElement=s||"div",this.refresher=e,this.maxComponentCreationTimeMs=n||Gr}getPortals(){return this.portals}destroy(){this.destroyed=!0}destroyPortal(e){this.portals=this.portals.filter(s=>s!==e),this.batchUpdate()}getComponentWrappingElement(){return this.wrappingElement}mountReactPortal(e,s,n){this.portals=[...this.portals,e],this.waitForInstance(s,n),this.batchUpdate()}updateReactPortal(e,s){this.portals[this.portals.indexOf(e)]=s,this.batchUpdate()}batchUpdate(){this.hasPendingPortalUpdate||(setTimeout(()=>{this.destroyed||(this.refresher(),this.hasPendingPortalUpdate=!1)}),this.hasPendingPortalUpdate=!0)}waitForInstance(e,s,n=Date.now()){if(this.destroyed){s(null);return}if(e.rendered())s(e);else{if(Date.now()-n>=this.maxComponentCreationTimeMs&&!this.hasPendingPortalUpdate){et(!0,()=>this.refresher()),e.rendered()&&s(e);return}window.setTimeout(()=>{this.waitForInstance(e,s,n)})}}},Wr=({ctrl:e})=>{const s=e.isAlive(),{context:n}=t.useContext(be),a=s?e.column.getColId():void 0,[l,c]=t.useState(),[d,r]=t.useState(),i=t.useRef(),h=t.useRef(null),p=t.useRef(null),P=t.useRef(null),m=t.useRef(),R=t.useRef();s&&!R.current&&(R.current=new ut(()=>h.current));const g=t.useCallback(O=>{if(h.current=O,i.current=O?n.createBean(new Ke):n.destroyBean(i.current),!O||!e.isAlive())return;const N=()=>{var z;const f=e.getSelectAllGui();f&&((z=p.current)==null||z.insertAdjacentElement("afterend",f),i.current.addDestroyFunc(()=>f.remove()))},V={setWidth:f=>{h.current&&(h.current.style.width=f)},toggleCss:(f,z)=>R.current.toggleCss(f,z),setUserStyles:f=>r(f),setAriaSort:f=>{h.current&&(f?Ys(h.current,f):Qs(h.current))},setUserCompDetails:f=>c(f),getUserCompInstance:()=>m.current||void 0,refreshSelectAllGui:N,removeSelectAllGui:()=>{var f;return(f=e.getSelectAllGui())==null?void 0:f.remove()}};e.setComp(V,O,p.current,P.current,i.current),N()},[]);t.useLayoutEffect(()=>tt(l,n,P.current,m),[l]),t.useEffect(()=>{e.setDragSource(h.current)},[l]);const B=t.useMemo(()=>!!((l==null?void 0:l.componentFromFramework)&&qe(l.componentClass)),[l]),M=l==null?void 0:l.componentFromFramework,j=l==null?void 0:l.componentClass;return y.createElement("div",{ref:g,style:d,className:"ag-header-cell","col-id":a,role:"columnheader"},y.createElement("div",{ref:p,className:"ag-header-cell-resize",role:"presentation"}),y.createElement("div",{ref:P,className:"ag-header-cell-comp-wrapper",role:"presentation"},M?B?y.createElement(j,Z({},l.params)):y.createElement(j,ce(Z({},l.params),{ref:m})):null))},Ur=t.memo(Wr),Lr=class{constructor(e,s){this.floatingFilterParams=e,this.refreshProps=s}getProps(){return this.floatingFilterParams}refresh(e){this.floatingFilterParams=e,this.refreshProps()}setMethods(e){dt(this.getOptionalMethods(),e,this)}getOptionalMethods(){return["afterGuiAttached"]}},Hr=({ctrl:e})=>{const{context:s,gos:n}=t.useContext(be),[a,l]=t.useState(),[c,d]=t.useState(()=>new je("ag-header-cell","ag-floating-filter")),[r,i]=t.useState(()=>new je),[h,p]=t.useState(()=>new je("ag-floating-filter-button","ag-hidden")),[P,m]=t.useState("false"),[R,g]=t.useState(),[,B]=t.useState(1),M=t.useRef(),j=t.useRef(null),O=t.useRef(null),N=t.useRef(null),V=t.useRef(null),f=t.useRef(),z=t.useRef(),U=D=>{D!=null&&f.current&&f.current(D)},k=t.useCallback(D=>{if(j.current=D,M.current=D?s.createBean(new Ke):s.destroyBean(M.current),!D||!e.isAlive())return;z.current=new Te(W=>{f.current=W});const K={toggleCss:(W,q)=>d(X=>X.setClass(W,q)),setUserStyles:W=>l(W),addOrRemoveBodyCssClass:(W,q)=>i(X=>X.setClass(W,q)),setButtonWrapperDisplayed:W=>{p(q=>q.setClass("ag-hidden",!W)),m(W?"false":"true")},setWidth:W=>{j.current&&(j.current.style.width=W)},setCompDetails:W=>g(W),getFloatingFilterComp:()=>z.current?z.current:null,setMenuIcon:W=>{var q;return(q=V.current)==null?void 0:q.appendChild(W)}};e.setComp(K,D,V.current,O.current,M.current)},[]);t.useLayoutEffect(()=>tt(R,s,O.current,U),[R]);const E=t.useMemo(()=>c.toString(),[c]),I=t.useMemo(()=>r.toString(),[r]),T=t.useMemo(()=>h.toString(),[h]),b=t.useMemo(()=>!!(R&&R.componentFromFramework&&qe(R.componentClass)),[R]),S=t.useMemo(()=>n.get("reactiveCustomComponents"),[]),A=t.useMemo(()=>n.get("enableFilterHandlers"),[]),[F,L]=t.useState();t.useEffect(()=>{if(R!=null&&R.componentFromFramework)if(S){const D=A?Lr:Mr,K=new D(R.params,()=>B(W=>W+1));U(K),L(K)}else Ft()},[R]);const H=F==null?void 0:F.getProps(),$=R==null?void 0:R.componentFromFramework,G=R==null?void 0:R.componentClass;return y.createElement("div",{ref:k,style:a,className:E,role:"gridcell"},y.createElement("div",{ref:O,className:I,role:"presentation"},$?S?H&&y.createElement(Mt.Provider,{value:{setMethods:D=>F.setMethods(D)}},y.createElement(G,Z({},H))):y.createElement(G,ce(Z({},R.params),{ref:b?()=>{}:U})):null),y.createElement("div",{ref:N,"aria-hidden":P,className:T,role:"presentation"},y.createElement("button",{ref:V,type:"button",className:"ag-button ag-floating-filter-button-button",tabIndex:-1})))},Dr=t.memo(Hr),Vr=({ctrl:e})=>{const{context:s}=t.useContext(be),[n,a]=t.useState(),[l,c]=t.useState(()=>new je),[d,r]=t.useState(()=>new je),[i,h]=t.useState("false"),[p,P]=t.useState(),[m,R]=t.useState(),g=t.useMemo(()=>e.column.getUniqueId(),[]),B=t.useRef(),M=t.useRef(null),j=t.useRef(null),O=t.useRef(null),N=t.useRef(),V=t.useCallback(I=>{if(M.current=I,B.current=I?s.createBean(new Ke):s.destroyBean(B.current),!I||!e.isAlive())return;const T={setWidth:b=>{M.current&&(M.current.style.width=b)},toggleCss:(b,S)=>c(A=>A.setClass(b,S)),setUserStyles:b=>a(b),setHeaderWrapperHidden:b=>{const S=O.current;S&&(b?S.style.setProperty("display","none"):S.style.removeProperty("display"))},setHeaderWrapperMaxHeight:b=>{const S=O.current;S&&(b!=null?S.style.setProperty("max-height",`${b}px`):S.style.removeProperty("max-height"),S.classList.toggle("ag-header-cell-comp-wrapper-limited-height",b!=null))},setUserCompDetails:b=>R(b),setResizableDisplayed:b=>{r(S=>S.setClass("ag-hidden",!b)),h(b?"false":"true")},setAriaExpanded:b=>P(b),getUserCompInstance:()=>N.current||void 0};e.setComp(T,I,j.current,O.current,B.current)},[]);t.useLayoutEffect(()=>tt(m,s,O.current),[m]),t.useEffect(()=>{M.current&&e.setDragSource(M.current)},[m]);const f=t.useMemo(()=>!!((m==null?void 0:m.componentFromFramework)&&qe(m.componentClass)),[m]),z=t.useMemo(()=>"ag-header-group-cell "+l.toString(),[l]),U=t.useMemo(()=>"ag-header-cell-resize "+d.toString(),[d]),k=m==null?void 0:m.componentFromFramework,E=m==null?void 0:m.componentClass;return y.createElement("div",{ref:V,style:n,className:z,"col-id":g,role:"columnheader","aria-expanded":p},y.createElement("div",{ref:O,className:"ag-header-cell-comp-wrapper",role:"presentation"},k?f?y.createElement(E,Z({},m.params)):y.createElement(E,ce(Z({},m.params),{ref:N})):null),y.createElement("div",{ref:j,"aria-hidden":i,className:U}))},$r=t.memo(Vr),Jr=({ctrl:e})=>{const{context:s}=t.useContext(be),{topOffset:n,rowHeight:a}=t.useMemo(()=>e.getTopAndHeight(),[]),[l,c]=t.useState(e.getAriaRowIndex()),d=e.headerRowClass,[r,i]=t.useState(()=>a+"px"),[h,p]=t.useState(()=>n+"px"),P=t.useRef([]),[m,R]=t.useState(()=>e.getUpdatedHeaderCtrls()),g=t.useRef(),B=t.useRef(null),M=t.useCallback(N=>{if(B.current=N,g.current=N?s.createBean(new Ke):s.destroyBean(g.current),!N)return;const V={setHeight:f=>i(f),setTop:f=>p(f),setHeaderCtrls:(f,z,U)=>{const k=P.current,E=ct(k,f,z);E!==k&&(P.current=E,et(U,()=>R(E)))},setWidth:f=>{B.current&&(B.current.style.width=f)},setRowIndex:f=>{c(f)}};e.setComp(V,g.current,!1)},[]),j=t.useMemo(()=>({height:r,top:h}),[r,h]),O=t.useCallback(N=>{switch(e.type){case"group":return y.createElement($r,{ctrl:N,key:N.instanceId});case"filter":return y.createElement(Dr,{ctrl:N,key:N.instanceId});default:return y.createElement(Ur,{ctrl:N,key:N.instanceId})}},[]);return y.createElement("div",{ref:M,className:d,role:"row",style:j,"aria-rowindex":l},m.map(O))},zr=t.memo(Jr),Kr=({pinned:e})=>{const[s,n]=t.useState(!0),[a,l]=t.useState([]),{context:c}=t.useContext(be),d=t.useRef(null),r=t.useRef(null),i=t.useRef(),h=e==="left",p=e==="right",P=!h&&!p,m=t.useCallback(B=>{if(d.current=B,i.current=B?c.createBean(new Vs(e)):c.destroyBean(i.current),!B)return;const M={setDisplayed:n,setCtrls:j=>l(j),setCenterWidth:j=>{r.current&&(r.current.style.width=j)},setViewportScrollLeft:j=>{d.current&&(d.current.scrollLeft=j)},setPinnedContainerWidth:j=>{d.current&&(d.current.style.width=j,d.current.style.minWidth=j,d.current.style.maxWidth=j)}};i.current.setComp(M,d.current)},[]),R=s?"":"ag-hidden",g=()=>a.map(B=>y.createElement(zr,{ctrl:B,key:B.instanceId}));return h?y.createElement("div",{ref:m,className:"ag-pinned-left-header "+R,"aria-hidden":!s,role:"rowgroup"},g()):p?y.createElement("div",{ref:m,className:"ag-pinned-right-header "+R,"aria-hidden":!s,role:"rowgroup"},g()):P?y.createElement("div",{ref:m,className:"ag-header-viewport "+R,role:"presentation",tabIndex:-1},y.createElement("div",{ref:r,className:"ag-header-container",role:"rowgroup"},g())):null},xt=t.memo(Kr),qr=()=>{const[e,s]=t.useState(()=>new je),[n,a]=t.useState(),{context:l}=t.useContext(be),c=t.useRef(null),d=t.useRef(),r=t.useCallback(p=>{if(c.current=p,d.current=p?l.createBean(new Ds):l.destroyBean(d.current),!p)return;const P={toggleCss:(m,R)=>s(g=>g.setClass(m,R)),setHeightAndMinHeight:m=>a(m)};d.current.setComp(P,p,p)},[]),i=t.useMemo(()=>"ag-header "+e.toString(),[e]),h=t.useMemo(()=>({height:n,minHeight:n}),[n]);return y.createElement("div",{ref:r,className:i,style:h,role:"presentation"},y.createElement(xt,{pinned:"left"}),y.createElement(xt,{pinned:null}),y.createElement(xt,{pinned:"right"}))},Yr=t.memo(qr),Qr=(e,s)=>{t.useEffect(()=>{const n=s.current;if(n){const a=n.parentElement;if(a){const l=document.createComment(e);return a.insertBefore(l,n),()=>{a.removeChild(l)}}}},[e])},Ve=Qr,Zr=class{constructor(e,s){this.cellEditorParams=e,this.refreshProps=s,this.instanceCreated=new Te(n=>{this.resolveInstanceCreated=n}),this.onValueChange=n=>this.updateValue(n),this.value=e.value}getProps(){return ce(Z({},this.cellEditorParams),{initialValue:this.cellEditorParams.value,value:this.value,onValueChange:this.onValueChange})}getValue(){return this.value}refresh(e){this.cellEditorParams=e,this.refreshProps()}setMethods(e){dt(this.getOptionalMethods(),e,this)}getInstance(){return this.instanceCreated.then(()=>this.componentInstance)}setRef(e){var s;this.componentInstance=e,(s=this.resolveInstanceCreated)==null||s.call(this),this.resolveInstanceCreated=void 0}getOptionalMethods(){return["isCancelBeforeStart","isCancelAfterEnd","focusIn","focusOut","afterGuiAttached","getValidationErrors","getValidationElement"]}updateValue(e){this.value=e,this.refreshProps()}},Xr=e=>{const s=t.useRef(e),n=t.useRef(),a=t.useRef(!1),l=t.useRef(!1),[,c]=t.useState(0);a.current&&(l.current=!0),t.useEffect(()=>(a.current||(n.current=s.current(),a.current=!0),c(d=>d+1),()=>{var d;l.current&&((d=n.current)==null||d.call(n))}),[])},en=e=>{const[s,n]=t.useState(),a=t.useContext(be),{context:l,popupSvc:c,gos:d,editSvc:r}=a,{editDetails:i,cellCtrl:h,eParentCell:p}=e;return Xr(()=>{var f,z;const{compDetails:P}=i,m=d.get("stopEditingWhenCellsLoseFocus"),R=l.createBean(r.createPopupEditorWrapper(P.params)),g=R.getGui();if(e.jsChildComp){const U=e.jsChildComp.getGui();U&&g.appendChild(U)}const{column:B,rowNode:M}=h,j={column:B,rowNode:M,type:"popupCellEditor",eventSource:p,ePopup:g,position:i.popupPosition,keepWithinBounds:!0},O=c==null?void 0:c.positionPopupByComponent.bind(c,j),N=c==null?void 0:c.addPopup({modal:m,eChild:g,closeOnEsc:!0,closedCallback:()=>{h.onPopupEditorClosed()},anchorToElement:p,positionCallback:O,ariaOwns:p}),V=N?N.hideFunc:void 0;return n(R),(z=(f=e.jsChildComp)==null?void 0:f.afterGuiAttached)==null||z.call(f),()=>{V==null||V(),l.destroyBean(R)}}),t.useLayoutEffect(()=>()=>{h.isCellFocused()&&(s!=null&&s.getGui().contains(Xs(a)))&&p.focus({preventScroll:!0})},[s]),s&&e.wrappedContent?Zt.createPortal(e.wrappedContent,s.getGui()):null},Dt=t.memo(en),tn=(e,s,n)=>{const{compProxy:a}=e;n(a);const l=a.getProps(),c=qe(s);return y.createElement(Mt.Provider,{value:{setMethods:d=>a.setMethods(d)}},c?y.createElement(s,Z({},l)):y.createElement(s,ce(Z({},l),{ref:d=>a.setRef(d)})))},Vt=(e,s,n)=>e.compProxy?tn(e,s,n):y.createElement(s,ce(Z({},e.compDetails.params),{ref:n})),sn=(e,s,n,a,l)=>{const c=e.compDetails,d=c.componentClass,r=c.componentFromFramework&&!e.popup,i=c.componentFromFramework&&e.popup,h=!c.componentFromFramework&&e.popup;return r?Vt(e,d,s):i?y.createElement(Dt,{editDetails:e,cellCtrl:a,eParentCell:n,wrappedContent:Vt(e,d,s)}):h&&l?y.createElement(Dt,{editDetails:e,cellCtrl:a,eParentCell:n,jsChildComp:l}):null},rn=(e,s,n,a,l,c)=>{const{context:d}=t.useContext(be),r=t.useCallback(()=>{const i=l.current;if(!i)return;const h=i.getGui();h&&h.parentElement&&h.parentElement.removeChild(h),d.destroyBean(i),l.current=void 0},[]);t.useEffect(()=>{const i=e!=null,h=(e==null?void 0:e.compDetails)&&!e.compDetails.componentFromFramework,p=s&&n==null;if(!(i&&h&&!p)){r();return}const m=e.compDetails;if(l.current){const g=l.current,M=g.refresh!=null&&e.force==!1?g.refresh(m.params):!1;if(M===!0||M===void 0)return;r()}m.newAgStackInstance().then(g=>{if(!g)return;const B=g.getGui();if(!B)return;(s?n:c.current).appendChild(B),l.current=g})},[e,s,a]),t.useEffect(()=>r,[])},os=rn,nn=({cellCtrl:e,parent:s})=>{var l;const n=t.useRef(),a=t.useMemo(()=>{const{loadingComp:c}=e.getDeferLoadingCellRenderer();return c?{value:void 0,compDetails:c,force:!1}:void 0},[e]);if(os(a,!1,void 0,1,n,s),(l=a==null?void 0:a.compDetails)!=null&&l.componentFromFramework){const c=a.compDetails.componentClass;return y.createElement(c,Z({},a.compDetails.params))}return y.createElement(y.Fragment,null)},on=({cellCtrl:e,printLayout:s,editingCell:n})=>{const a=t.useContext(be),{context:l}=a,{column:{colIdSanitised:c},instanceId:d}=e,r=t.useRef(),[i,h]=t.useState(()=>e.isCellRenderer()?void 0:{compDetails:void 0,value:e.getValueToDisplay(),force:!1}),[p,P]=t.useState(),[m,R]=t.useState(1),[g,B]=t.useState(),[M,j]=t.useState(!1),[O,N]=t.useState(!1),[V,f]=t.useState(!1),[z,U]=t.useState(),k=t.useMemo(()=>e.isForceWrapper(),[e]),E=t.useMemo(()=>e.getCellAriaRole(),[e]),I=t.useRef(null),T=t.useRef(null),b=t.useRef(null),S=t.useRef(),A=t.useRef(),F=t.useRef(),L=t.useRef([]),H=t.useRef(),[$,G]=t.useState(0),D=t.useCallback(J=>{H.current=J,G(ee=>ee+1)},[]),K=i!=null&&(M||V||O)&&(p==null||!!p.popup),W=k||K,q=t.useCallback(J=>{if(A.current=J,J){const ee=J.isCancelBeforeStart&&J.isCancelBeforeStart();setTimeout(()=>{ee?(e.stopEditing(!0),e.focusCell(!0)):(e.cellEditorAttached(),e.enableEditorTooltipFeature(J))})}},[e]),X=t.useRef();X.current||(X.current=new ut(()=>I.current)),os(i,W,H.current,$,S,I);const ie=t.useRef();t.useLayoutEffect(()=>{var Y;const J=ie.current,ee=i;if(ie.current=i,J==null||J.compDetails==null||ee==null||ee.compDetails==null)return;const ue=J.compDetails,C=ee.compDetails;if(ue.componentClass!=C.componentClass||((Y=b.current)==null?void 0:Y.refresh)==null)return;b.current.refresh(C.params)!=!0&&R(se=>se+1)},[i]),t.useLayoutEffect(()=>{if(!(p&&!p.compDetails.componentFromFramework))return;const ee=p.compDetails,ue=p.popup===!0,C=ee.newAgStackInstance();return C.then(te=>{if(!te)return;const Y=te.getGui();if(q(te),!ue){const se=(k?F:I).current;se==null||se.appendChild(Y),te.afterGuiAttached&&te.afterGuiAttached()}U(te)}),()=>{C.then(te=>{var se;const Y=te.getGui();e.disableEditorTooltipFeature(),l.destroyBean(te),q(void 0),U(void 0),(se=Y==null?void 0:Y.parentElement)==null||se.removeChild(Y)})}},[p]);const Ce=t.useCallback(J=>{if(F.current=J,!J){L.current.forEach(ue=>ue()),L.current=[];return}const ee=ue=>{if(ue){const C=ue.getGui();J.insertAdjacentElement("afterbegin",C),L.current.push(()=>{l.destroyBean(ue),Zs(C)})}return ue};if(M){const ue=e.createSelectionCheckbox();ee(ue)}V&&ee(e.createDndSource()),O&&ee(e.createRowDragComp())},[e,l,V,O,M]),Ie=t.useCallback(()=>{var te;const J=!e.isCellSpanning()||T.current,ee=I.current;if(r.current=ee?l.createBean(new Ke):l.destroyBean(r.current),!ee||!J||!e)return;const ue={toggleCss:(Y,se)=>X.current.toggleCss(Y,se),setUserStyles:Y=>B(Y),getFocusableElement:()=>I.current,setIncludeSelection:Y=>j(Y),setIncludeRowDrag:Y=>N(Y),setIncludeDndSource:Y=>f(Y),getCellEditor:()=>A.current||null,getCellRenderer:()=>{var Y;return(Y=b.current)!=null?Y:S.current},getParentOfValue:()=>{var Y,se;return(se=(Y=H.current)!=null?Y:F.current)!=null?se:I.current},setRenderDetails:(Y,se,de)=>{var Me;const Ae=()=>{h(le=>(le==null?void 0:le.compDetails)!==Y||(le==null?void 0:le.value)!==se||(le==null?void 0:le.force)!==de?{value:se,compDetails:Y,force:de}:le)};if((Me=Y==null?void 0:Y.params)!=null&&Me.deferRender&&!e.rowNode.group){const{loadingComp:le,onReady:$e}=e.getDeferLoadingCellRenderer();if(le){h({value:void 0,compDetails:le,force:!1}),$e.then(()=>wr(Ae));return}}Ae()},setEditDetails:(Y,se,de,Ae)=>{if(Y){let Me;Y.componentFromFramework&&(Ae?Me=new Zr(Y.params,()=>R(le=>le+1)):Ft()),P({compDetails:Y,popup:se,popupPosition:de,compProxy:Me}),se||h(void 0)}else e.hasBrowserFocus()&&ue.getFocusableElement().focus({preventScroll:!0}),P(le=>{le!=null&&le.compProxy&&(A.current=void 0)})},refreshEditStyles:(Y,se)=>{if(!I.current)return;const{current:de}=X;de.toggleCss("ag-cell-value",!W),de.toggleCss("ag-cell-inline-editing",!!Y&&!se),de.toggleCss("ag-cell-popup-editing",!!Y&&!!se),de.toggleCss("ag-cell-not-inline-editing",!Y||!!se)}},C=F.current||void 0;e.setComp(ue,ee,(te=T.current)!=null?te:void 0,C,s,n,r.current)},[]),ye=t.useCallback(J=>{I.current=J,Ie()},[]),ne=t.useCallback(J=>{T.current=J,Ie()},[]),xe=t.useMemo(()=>{var ee;return!!(((ee=i==null?void 0:i.compDetails)==null?void 0:ee.componentFromFramework)&&qe(i.compDetails.componentClass))},[i]);t.useLayoutEffect(()=>{if(!I.current)return;const{current:J}=X;J.toggleCss("ag-cell-value",!W),J.toggleCss("ag-cell-inline-editing",!!p&&!p.popup),J.toggleCss("ag-cell-popup-editing",!!p&&!!p.popup),J.toggleCss("ag-cell-not-inline-editing",!p||!!p.popup)});const me=()=>{var ue,C;const{compDetails:J,value:ee}=i;if(!J)return(C=(ue=ee==null?void 0:ee.toString)==null?void 0:ue.call(ee))!=null?C:ee;if(J.componentFromFramework){const te=J.componentClass;return y.createElement(t.Suspense,{fallback:y.createElement(nn,{cellCtrl:e,parent:I})},xe?y.createElement(te,ce(Z({},J.params),{key:m})):y.createElement(te,ce(Z({},J.params),{key:m,ref:b})))}},Se=()=>{const J=()=>i==null?null:W?y.createElement("span",{role:"presentation",id:`cell-${d}`,className:"ag-cell-value",ref:D},me()):me(),ee=ue=>sn(ue,q,I.current,e,z);return p!=null?p.popup?y.createElement(y.Fragment,null,J(),ee(p)):ee(p):J()},ke=()=>y.createElement("div",{ref:ye,style:g,role:E,"col-id":c},W?y.createElement("div",{className:"ag-cell-wrapper",role:"presentation",ref:Ce},Se()):Se());return e.isCellSpanning()?y.createElement("div",{ref:ne,className:"ag-spanned-cell-wrapper",role:"presentation"},ke()):ke()},an=t.memo(on),ln=({rowCtrl:e,containerType:s})=>{const{context:n,gos:a,editSvc:l}=t.useContext(be),c=t.useContext(Xt)==="default",d=t.useRef(),r=t.useRef(e.getDomOrder()),i=e.isFullWidth(),h=e.rowNode.displayed,[p,P]=t.useState(()=>h?e.rowNode.getRowIndexString():null),[m,R]=t.useState(()=>e.rowId),[g,B]=t.useState(()=>e.businessKey),[M,j]=t.useState(()=>e.rowStyles),O=t.useRef(null),[N,V]=t.useState(()=>null),[f,z]=t.useState(),[U,k]=t.useState(()=>h?e.getInitialRowTop(s):void 0),[E,I]=t.useState(()=>h?e.getInitialTransform(s):void 0),T=t.useRef(null),b=t.useRef(),S=t.useRef(!1),[A,F]=t.useState(0);t.useEffect(()=>{var xe;if(S.current||!f||A>10)return;const ne=(xe=T.current)==null?void 0:xe.firstChild;ne?(e.setupDetailRowAutoHeight(ne),S.current=!0):F(me=>me+1)},[f,A]);const L=t.useRef();L.current||(L.current=new ut(()=>T.current));const H=t.useRef(()=>{}),$=t.useCallback(ne=>(H.current=ne,()=>{H.current=()=>{}}),[]),G=yr($,()=>O.current,[]),D=c?G:N,K=t.useCallback(ne=>{if(T.current=ne,d.current=ne?n.createBean(new Ke):n.destroyBean(d.current),!ne){e.unsetComp(s);return}if(!e.isAlive())return;const xe={setTop:k,setTransform:I,toggleCss:(me,Se)=>L.current.toggleCss(me,Se),setDomOrder:me=>r.current=me,setRowIndex:P,setRowId:R,setRowBusinessKey:B,setUserStyles:j,setCellCtrls:(me,Se)=>{const ke=O.current,J=ct(ke,me,r.current);J!==ke&&(O.current=J,c?H.current():et(Se,()=>V(J)))},showFullWidth:me=>z(me),getFullWidthCellRenderer:()=>b.current,refreshFullWidth:me=>Ce.current?(z(Se=>ce(Z({},Se),{params:me()})),!0):!b.current||!b.current.refresh?!1:b.current.refresh(me())};e.setComp(xe,ne,s,d.current)},[]);t.useLayoutEffect(()=>tt(f,n,T.current,b),[f]);const W=t.useMemo(()=>{const ne={top:U,transform:E};return Object.assign(ne,M),ne},[U,E,M]),q=i&&(f==null?void 0:f.componentFromFramework),X=!i&&D!=null,ie=t.useMemo(()=>!!((f==null?void 0:f.componentFromFramework)&&qe(f.componentClass)),[f]),Ce=t.useRef(!1);t.useEffect(()=>{Ce.current=ie&&!!f&&!!a.get("reactiveCustomComponents")},[ie,f]);const Ie=()=>D==null?void 0:D.map(ne=>{var xe;return y.createElement(an,{cellCtrl:ne,editingCell:(xe=l==null?void 0:l.isEditing(ne,{withOpenEditor:!0}))!=null?xe:!1,printLayout:e.printLayout,key:ne.instanceId})}),ye=()=>{const ne=f.componentClass;return ie?y.createElement(ne,Z({},f.params)):y.createElement(ne,ce(Z({},f.params),{ref:b}))};return y.createElement("div",{ref:K,role:"row",style:W,"row-index":p,"row-id":m,"row-business-key":g},X?Ie():q?ye():null)},$t=t.memo(ln),cn=({name:e})=>{const{context:s,gos:n}=t.useContext(be),a=t.useMemo(()=>$s(e),[e]),l=t.useRef(null),c=t.useRef(null),d=t.useRef(null),r=t.useRef([]),i=t.useRef([]),[h,p]=t.useState(()=>[]),P=!!n.get("enableCellSpan")&&!!a.getSpannedRowCtrls,m=t.useRef([]),R=t.useRef([]),[g,B]=t.useState(()=>[]),M=t.useRef(!1),j=t.useRef(),O=t.useMemo(()=>Pe("ag-viewport",Js(e)),[e]),N=t.useMemo(()=>Pe(zs(e)),[e]),V=t.useMemo(()=>Pe("ag-spanning-container",Ks(e)),[e]),f=a.type==="center"||P,z=f?l:c;Ve(" AG Row Container "+e+" ",z);const U=t.useCallback(()=>{const F=!f||l.current!=null,L=c.current!=null,H=!P||d.current!=null;return F&&L&&H},[]),k=t.useCallback(()=>l.current==null&&c.current==null&&d.current==null,[]),E=t.useCallback(()=>{var F;if(k()&&(j.current=s.destroyBean(j.current)),U()){const L=G=>{const D=ct(i.current,r.current,M.current);D!==i.current&&(i.current=D,et(G,()=>p(D)))},H=G=>{const D=ct(R.current,m.current,M.current);D!==R.current&&(R.current=D,et(G,()=>B(D)))},$={setHorizontalScroll:G=>{l.current&&(l.current.scrollLeft=G)},setViewportHeight:G=>{l.current&&(l.current.style.height=G)},setRowCtrls:({rowCtrls:G,useFlushSync:D})=>{const K=!!D&&r.current.length>0&&G.length>0;r.current=G,L(K)},setSpannedRowCtrls:(G,D)=>{const K=!!D&&m.current.length>0&&G.length>0;m.current=G,H(K)},setDomOrder:G=>{M.current!=G&&(M.current=G,L(!1))},setContainerWidth:G=>{c.current&&(c.current.style.width=G)},setOffsetTop:G=>{c.current&&(c.current.style.transform=`translateY(${G})`)}};j.current=s.createBean(new qs(e)),j.current.setComp($,c.current,(F=d.current)!=null?F:void 0,l.current)}},[U,k]),I=t.useCallback(F=>{c.current=F,E()},[E]),T=t.useCallback(F=>{d.current=F,E()},[E]),b=t.useCallback(F=>{l.current=F,E()},[E]),S=()=>y.createElement("div",{className:N,ref:I,role:"rowgroup"},h.map(F=>y.createElement($t,{rowCtrl:F,containerType:a.type,key:F.instanceId})));if(!f)return S();const A=()=>y.createElement("div",{className:V,ref:T,role:"rowgroup"},g.map(F=>y.createElement($t,{rowCtrl:F,containerType:a.type,key:F.instanceId})));return y.createElement("div",{className:O,ref:b,role:"presentation"},S(),P?A():null)},un=t.memo(cn),dn=()=>{const e=t.useContext(be),{context:s,overlays:n}=e,[a,l]=t.useState(""),[c,d]=t.useState(0),[r,i]=t.useState(0),[h,p]=t.useState("0px"),[P,m]=t.useState("0px"),[R,g]=t.useState("100%"),[B,M]=t.useState("0px"),[j,O]=t.useState("0px"),[N,V]=t.useState("100%"),[f,z]=t.useState(!0),[U,k]=t.useState(!0),[E,I]=t.useState(null),[T,b]=t.useState(""),[S,A]=t.useState(null),[F,L]=t.useState("ag-layout-normal"),H=t.useRef();H.current||(H.current=new ut(()=>$.current));const $=t.useRef(null),G=t.useRef(null),D=t.useRef(null),K=t.useRef(null),W=t.useRef(null),q=t.useRef(null),X=t.useRef(null),ie=t.useRef([]),Ce=t.useRef([]);Ve(" AG Grid Body ",$),Ve(" AG Pinned Top ",G),Ve(" AG Sticky Top ",D),Ve(" AG Middle ",q),Ve(" AG Pinned Bottom ",X);const Ie=t.useCallback(de=>{if($.current=de,!de){ie.current=s.destroyBeans(ie.current),Ce.current.forEach(pe=>pe()),Ce.current=[];return}if(!s)return;const Ae=(pe,ve)=>{pe.appendChild(ve),Ce.current.push(()=>pe.removeChild(ve))},Me=pe=>{const ve=s.createBean(new pe);return ie.current.push(ve),ve},le=(pe,ve,mt)=>{Ae(pe,document.createComment(mt)),Ae(pe,Me(ve).getGui())};le(de,Ls," AG Fake Horizontal Scroll ");const $e=n==null?void 0:n.getOverlayWrapperCompClass();$e&&le(de,$e," AG Overlay Wrapper "),W.current&&le(W.current,Hs," AG Fake Vertical Scroll ");const pt={setRowAnimationCssOnBodyViewport:l,setColumnCount:pe=>{$.current&&Us($.current,pe)},setRowCount:pe=>{$.current&&Ws($.current,pe)},setTopHeight:d,setBottomHeight:i,setStickyTopHeight:p,setStickyTopTop:m,setStickyTopWidth:g,setTopInvisible:z,setBottomInvisible:k,setColumnMovingCss:(pe,ve)=>H.current.toggleCss(pe,ve),updateLayoutClasses:L,setAlwaysVerticalScrollClass:I,setPinnedTopBottomOverflowY:b,setCellSelectableCss:(pe,ve)=>A(ve?pe:null),setBodyViewportWidth:pe=>{q.current&&(q.current.style.width=pe)},registerBodyViewportResizeListener:pe=>{if(q.current){const ve=Qt(e,q.current,pe);Ce.current.push(()=>ve())}},setStickyBottomHeight:M,setStickyBottomBottom:O,setStickyBottomWidth:V,setGridRootRole:pe=>de.setAttribute("role",pe)},st=s.createBean(new Gs);ie.current.push(st),st.setComp(pt,de,q.current,G.current,X.current,D.current,K.current)},[]),ye=t.useMemo(()=>Pe("ag-root","ag-unselectable",F),[F]),ne=t.useMemo(()=>Pe("ag-body-viewport",a,F,E,S),[a,F,E,S]),xe=t.useMemo(()=>Pe("ag-body",F),[F]),me=t.useMemo(()=>Pe("ag-floating-top",f?"ag-invisible":null,S),[S,f]),Se=t.useMemo(()=>Pe("ag-sticky-top",S),[S]),ke=t.useMemo(()=>Pe("ag-sticky-bottom",B==="0px"?"ag-invisible":null,S),[S,B]),J=t.useMemo(()=>Pe("ag-floating-bottom",U?"ag-invisible":null,S),[S,U]),ee=t.useMemo(()=>({height:c,minHeight:c,overflowY:T}),[c,T]),ue=t.useMemo(()=>({height:h,top:P,width:R}),[h,P,R]),C=t.useMemo(()=>({height:B,bottom:j,width:N}),[B,j,N]),te=t.useMemo(()=>({height:r,minHeight:r,overflowY:T}),[r,T]),Y=de=>y.createElement(un,{name:de,key:`${de}-container`}),se=({section:de,children:Ae,className:Me,style:le})=>y.createElement("div",{ref:de,className:Me,role:"presentation",style:le},Ae.map(Y));return y.createElement("div",{ref:Ie,className:ye},y.createElement(Yr,null),se({section:G,className:me,style:ee,children:["topLeft","topCenter","topRight","topFullWidth"]}),y.createElement("div",{className:xe,ref:W,role:"presentation"},se({section:q,className:ne,children:["left","center","right","fullWidth"]})),se({section:D,className:Se,style:ue,children:["stickyTopLeft","stickyTopCenter","stickyTopRight","stickyTopFullWidth"]}),se({section:K,className:ke,style:C,children:["stickyBottomLeft","stickyBottomCenter","stickyBottomRight","stickyBottomFullWidth"]}),se({section:X,className:J,style:te,children:["bottomLeft","bottomCenter","bottomRight","bottomFullWidth"]}))},pn=t.memo(dn),mn=(e,s)=>{const{children:n,eFocusableElement:a,onTabKeyDown:l,gridCtrl:c,forceFocusOutWhenTabGuardsAreEmpty:d,isEmpty:r}=e,{context:i}=t.useContext(be),h=t.useRef(null),p=t.useRef(null),P=t.useRef(),m=j=>{const O=j==null?void 0:parseInt(j,10).toString();[h,p].forEach(N=>{var V,f;O===void 0?(V=N.current)==null||V.removeAttribute("tabindex"):(f=N.current)==null||f.setAttribute("tabindex",O)})};t.useImperativeHandle(s,()=>({forceFocusOutOfContainer(j){var O;(O=P.current)==null||O.forceFocusOutOfContainer(j)}}));const R=t.useCallback(()=>{const j=h.current,O=p.current;if(!j&&!O){P.current=i.destroyBean(P.current);return}if(j&&O){const N={setTabIndex:m};P.current=i.createBean(new _s({comp:N,eTopGuard:j,eBottomGuard:O,eFocusableElement:a,onTabKeyDown:l,forceFocusOutWhenTabGuardsAreEmpty:d,focusInnerElement:V=>c.focusInnerElement(V),isEmpty:r}))}},[]),g=t.useCallback(j=>{h.current=j,R()},[R]),B=t.useCallback(j=>{p.current=j,R()},[R]),M=j=>{const O=j==="top"?wt.TAB_GUARD_TOP:wt.TAB_GUARD_BOTTOM;return y.createElement("div",{className:`${wt.TAB_GUARD} ${O}`,role:"presentation",ref:j==="top"?g:B})};return y.createElement(y.Fragment,null,M("top"),n,M("bottom"))},hn=t.forwardRef(mn),fn=t.memo(hn),gn=({context:e})=>{const[s,n]=t.useState(""),[a,l]=t.useState(""),[c,d]=t.useState(null),[r,i]=t.useState(null),[h,p]=t.useState(!1),[P,m]=t.useState(),R=t.useRef(),g=t.useRef(null),B=t.useRef(),[M,j]=t.useState(null),O=t.useRef(()=>{}),N=t.useRef(),V=t.useRef([]),f=t.useCallback(()=>{},[]),z=t.useMemo(()=>e.isDestroyed()?null:e.getBeans(),[e]);Ve(" AG Grid ",g);const U=t.useCallback(S=>{if(g.current=S,R.current=S?e.createBean(new Os):e.destroyBean(R.current),!S||e.isDestroyed())return;const A=R.current;O.current=A.focusInnerElement.bind(A);const F={destroyGridUi:()=>{},setRtlClass:n,forceFocusOutOfContainer:L=>{var H,$;if(!L&&((H=N.current)!=null&&H.isDisplayed())){N.current.forceFocusOutOfContainer(L);return}($=B.current)==null||$.forceFocusOutOfContainer(L)},updateLayoutClasses:l,getFocusableContainers:()=>{var $;const L=[],H=($=g.current)==null?void 0:$.querySelector(".ag-root");return H&&L.push({getGui:()=>H}),V.current.forEach(G=>{G.isDisplayed()&&L.push(G)}),L},setCursor:d,setUserSelect:i};A.setComp(F,S,S),p(!0)},[]);t.useEffect(()=>{const S=R.current,A=g.current;if(!P||!z||!S||!M||!A||e.isDestroyed())return;const F=[],{watermarkSelector:L,paginationSelector:H,sideBarSelector:$,statusBarSelector:G,gridHeaderDropZonesSelector:D}=S.getOptionalSelectors(),K=[];if(D){const q=e.createBean(new D.component),X=q.getGui();A.insertAdjacentElement("afterbegin",X),K.push(X),F.push(q)}if($){const q=e.createBean(new $.component),X=q.getGui(),ie=M.querySelector(".ag-tab-guard-bottom");ie&&(ie.insertAdjacentElement("beforebegin",X),K.push(X)),F.push(q),V.current.push(q)}const W=q=>{const X=e.createBean(new q),ie=X.getGui();return A.insertAdjacentElement("beforeend",ie),K.push(ie),F.push(X),X};if(G&&W(G.component),H){const q=W(H.component);N.current=q,V.current.push(q)}return L&&W(L.component),()=>{e.destroyBeans(F),K.forEach(q=>{var X;(X=q.parentElement)==null||X.removeChild(q)})}},[P,M,z]);const k=t.useMemo(()=>Pe("ag-root-wrapper",s,a),[s,a]),E=t.useMemo(()=>Pe("ag-root-wrapper-body","ag-focus-managed",a),[a]),I=t.useMemo(()=>({userSelect:r!=null?r:"",WebkitUserSelect:r!=null?r:"",cursor:c!=null?c:""}),[r,c]),T=t.useCallback(S=>{B.current=S,m(S!==null)},[]),b=t.useCallback(()=>{var S;return!((S=R.current)!=null&&S.isFocusable())},[]);return y.createElement("div",{ref:U,className:k,style:I,role:"presentation"},y.createElement("div",{className:E,ref:j,role:"presentation"},h&&M&&z&&y.createElement(be.Provider,{value:z},y.createElement(fn,{ref:T,eFocusableElement:M,onTabKeyDown:f,gridCtrl:R.current,forceFocusOutWhenTabGuardsAreEmpty:!0,isEmpty:b},y.createElement(pn,null)))))},Cn=t.memo(gn),wn=class extends js{wireBeans(e){this.ctrlsSvc=e.ctrlsSvc}areHeaderCellsRendered(){return this.ctrlsSvc.getHeaderRowContainerCtrls().every(e=>e.getAllCtrls().every(s=>s.areCellsRendered()))}},as={setGridApi:void 0,maxComponentCreationTimeMs:void 0,children:void 0},yn=Z({gridOptions:void 0,modules:void 0,containerStyle:void 0,className:void 0,passGridApi:void 0,componentWrappingElement:void 0},as),ls=new Set(Object.keys(yn)),xn=new Set(Object.keys(as)),cs=e=>{var j,O;const s=t.useRef(),n=t.useRef(null),a=t.useRef(null),l=t.useRef([]),c=t.useRef([]),d=t.useRef(e),r=t.useRef(),i=t.useRef(),h=t.useRef(!1),[p,P]=t.useState(void 0),[,m]=t.useState(0),R=t.useCallback(N=>{var S;if(n.current=N,!N){l.current.forEach(A=>A()),l.current.length=0;return}const V=e.modules||[];a.current||(a.current=new _r(()=>m(A=>A+1),e.componentWrappingElement,e.maxComponentCreationTimeMs),l.current.push(()=>{var A;(A=a.current)==null||A.destroy(),a.current=null}));const f=Es(e.gridOptions,e,Object.keys(e).filter(A=>!ls.has(A))),z=()=>{if(h.current){const A=()=>{var L;return(L=r.current)!=null&&L.shouldQueueUpdates()?void 0:c.current.shift()};let F=A();for(;F;)F(),F=A()}},U=new Rn(z);r.current=U;const k=new wn,E={providedBeanInstances:{frameworkCompWrapper:new Sn(a.current,f),renderStatus:k},modules:V,frameworkOverrides:U,setThemeOnGridDiv:!0},I=A=>{P(A),A.createBean(k),l.current.push(()=>{A.destroy()}),A.getBean("ctrlsSvc").whenReady({addDestroyFunc:F=>{l.current.push(F)}},()=>{var L;if(A.isDestroyed())return;const F=s.current;F&&((L=e.passGridApi)==null||L.call(e,F))})},T=A=>{A.getBean("ctrlsSvc").whenReady({addDestroyFunc:F=>{l.current.push(F)}},()=>{c.current.forEach(F=>F()),c.current.length=0,h.current=!0})},b=new Is;(S=f.gridId)!=null||(f.gridId=i.current),s.current=b.create(N,f,I,T,E),l.current.push(()=>{s.current=void 0}),s.current&&(i.current=s.current.getGridId())},[]),g=t.useMemo(()=>Z({height:"100%"},e.containerStyle||{}),[e.containerStyle]),B=t.useCallback(N=>{var V;h.current&&!((V=r.current)!=null&&V.shouldQueueUpdates())?N():c.current.push(N)},[]);t.useEffect(()=>{const N=bn(d.current,e);d.current=e,B(()=>{s.current&&Ms(N,s.current)})},[e]);const M=!y.useSyncExternalStore||at(e,"renderingMode")==="legacy"?"legacy":"default";return y.createElement("div",{style:g,className:e.className,ref:R},y.createElement(Xt.Provider,{value:M},p&&!p.isDestroyed()?y.createElement(Cn,{context:p}):null,(O=(j=a.current)==null?void 0:j.getPortals())!=null?O:null))};function bn(e,s){const n={};return Object.keys(s).forEach(a=>{if(ls.has(a)){xn.has(a)&&It(274,{prop:a});return}const l=s[a];e[a]!==l&&(n[a]=l)}),n}var Sn=class extends Ps{constructor(e,s){super(),this.parent=e,this.gridOptions=s}createWrapper(e,s){const n=this.gridOptions;if(at(n,"reactiveCustomComponents")){const d=(r=>{switch(r){case"filter":return at(n,"enableFilterHandlers")?Ir:Er;case"floatingFilterComponent":return at(n,"enableFilterHandlers")?Pr:Fr;case"dateComponent":return Rr;case"dragAndDropImageComponent":return kr;case"loadingOverlayComponent":return Tr;case"noRowsOverlayComponent":return Or;case"statusPanel":return Br;case"toolPanel":return Nr;case"menuItem":return Ar;case"cellRenderer":return vr;case"innerHeaderComponent":return jr}})(s.name);if(d)return new d(e,this.parent,s)}else switch(s.name){case"filter":case"floatingFilterComponent":case"dateComponent":case"dragAndDropImageComponent":case"loadingOverlayComponent":case"noRowsOverlayComponent":case"statusPanel":case"toolPanel":case"menuItem":case"cellRenderer":Ft();break}const l=!s.cellRenderer&&s.name!=="toolPanel";return new rs(e,this.parent,s,l)}},vn=t.forwardRef((e,s)=>{const n=t.useContext(be),{registry:a,context:l,gos:c,rowModel:d}=n,[r,i]=t.useState(()=>new je),[h,p]=t.useState(()=>new je),[P,m]=t.useState(),[R,g]=t.useState(),B=t.useRef(),M=t.useRef(null),j=t.useRef(),O=t.useMemo(()=>{var U;return Ts(e.api.getGridId(),(U=P==null?void 0:P.rowModelType)!=null?U:"clientSide")},[e]),N=t.useMemo(()=>r.toString()+" ag-details-row",[r]),V=t.useMemo(()=>h.toString()+" ag-details-grid",[h]);s&&t.useImperativeHandle(s,()=>({refresh(){var U,k;return(k=(U=B.current)==null?void 0:U.refresh())!=null?k:!1}})),e.template&&It(230);const f=t.useCallback(U=>{var I;if(M.current=U,!U){B.current=l.destroyBean(B.current),(I=j.current)==null||I.call(j);return}const k={toggleCss:(T,b)=>i(S=>S.setClass(T,b)),toggleDetailGridCss:(T,b)=>p(S=>S.setClass(T,b)),setDetailGrid:T=>m(T),setRowData:T=>g(T),getGui:()=>M.current},E=a.createDynamicBean("detailCellRendererCtrl",!0);if(E&&(l.createBean(E),E.init(k,e),B.current=E,c.get("detailRowAutoHeight"))){const T=()=>{if(M.current==null)return;const b=M.current.clientHeight;b!=null&&b>0&&setTimeout(()=>{e.node.setRowHeight(b),(Bs(c)||Ns(c))&&d.onRowHeightChanged()},0)};j.current=Qt(n,U,T),T()}},[]),z=t.useCallback(U=>{var k;(k=B.current)==null||k.registerDetailWithMaster(U)},[]);return y.createElement("div",{className:N,ref:f},P&&y.createElement(cs,ce(Z({className:V},P),{modules:O,rowData:R,passGridApi:z})))}),Rn=class extends Fs{constructor(e){super("react"),this.processQueuedUpdates=e,this.queueUpdates=!1,this.renderingEngine="react",this.frameworkComponents={agGroupCellRenderer:Lt,agGroupRowRenderer:Lt,agDetailCellRenderer:vn},this.wrapIncoming=(s,n)=>n==="ensureVisible"?Cr(s):s()}frameworkComponent(e){return this.frameworkComponents[e]}isFrameworkComponent(e){if(!e)return!1;const s=e.prototype;return!(s&&"getGui"in s)}getLockOnRefresh(){this.queueUpdates=!0}releaseLockOnRefresh(){this.queueUpdates=!1,this.processQueuedUpdates()}shouldQueueUpdates(){return this.queueUpdates}runWhenReadyAsync(){return gr()}},kn=class extends t.Component{constructor(){super(...arguments),this.apiListeners=[],this.setGridApi=e=>{this.api=e,this.apiListeners.forEach(s=>s(e))}}registerApiListener(e){this.apiListeners.push(e)}componentWillUnmount(){this.apiListeners.length=0}render(){return y.createElement(cs,ce(Z({},this.props),{passGridApi:this.setGridApi}))}};function is(e){if(!e||!e.trim())return{rows:[],rowCount:0,colCount:0};const n=e.replace(/\r\n/g,`
`).replace(/\r/g,`
`).split(`
`).filter(P=>P.trim());if(n.length===0)return{rows:[],rowCount:0,colCount:0};const a=n.slice(0,Math.min(5,n.length)).join(`
`),l=(a.match(/\t/g)||[]).length,c=(a.match(/,/g)||[]).length,d=(a.match(/;/g)||[]).length;let r="	";l>c&&l>d?r="	":c>d?r=",":d>0&&(r=";");const i=[];let h=0;for(const P of n){if(!P.trim())continue;const m=[];let R="",g=!1;for(let B=0;B<P.length;B++){const M=P[B],j=P[B+1];if(M==='"')g&&j==='"'?(R+='"',B++):g=!g;else if((M===r||M===`
`)&&!g){if(m.push(R.trim()),R="",M===`
`)break}else R+=M}(R||m.length>0)&&m.push(R.trim()),m.length>0&&(i.push(m),h=Math.max(h,m.length))}const p=i.map(P=>{const m=[...P];for(;m.length<h;)m.push("");return m});return{rows:p,rowCount:p.length,colCount:h}}const En=e=>{const s=e.displayName||"",n=e.onHeaderValueChange,[a,l]=t.useState(!1),[c,d]=t.useState(s),r=t.useRef(null);t.useEffect(()=>{d(s)},[s]),t.useEffect(()=>{a&&r.current&&(r.current.focus(),r.current.select())},[a]);const i=m=>{m.stopPropagation(),l(!0),d(s)},h=()=>{const m=c.trim();m&&m!==s&&n?n(m):m||d(s),l(!1)},p=()=>{d(s),l(!1)},P=m=>{m.key==="Enter"?(m.preventDefault(),h()):m.key==="Escape"&&(m.preventDefault(),p())};return a?o.jsx("div",{style:{display:"flex",alignItems:"center",width:"100%",gap:4,padding:"0 8px"},children:o.jsx(_e,{inputRef:r,value:c,onChange:m=>d(m.target.value),onBlur:h,onKeyDown:P,size:"small",variant:"standard",sx:{flex:1,"& .MuiInputBase-input":{padding:"4px 8px",fontSize:"14px"}}})}):o.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",width:"100%",cursor:"pointer",padding:"0 8px"},onDoubleClick:i,children:[o.jsx("span",{style:{flex:1,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:s}),o.jsx(Je,{size:"small",onClick:i,sx:{padding:"4px",marginLeft:"4px"},title:"Edit column name",children:o.jsx(lr,{fontSize:"small"})})]})},Rt=1,us=500,kt=1,ds=100;function it(e,s,n){return Math.max(s,Math.min(n,Math.floor(e)||s))}function In(e){return`col_${e}`}function Mn(e){return`row_${e}`}function Jt(e){return`Column ${String.fromCharCode(65+e%26)}`}function ae(e,s,n){const a=it(s,Rt,us),l=it(n,kt,ds),c=[],d=(e==null?void 0:e.columns)||[];for(let p=0;p<l;p++){const P=In(p),m=d.find(R=>(R==null?void 0:R.id)===P)||(p<d.length?d[p]:null);m?c.push({id:P,label:m.label||Jt(p)}):c.push({id:P,label:Jt(p)})}const r=[],i=(e==null?void 0:e.rows)||[],h={};d.forEach((p,P)=>{P<c.length&&(h[p.id]=c[P].id)});for(let p=0;p<a;p++){const P=Mn(p),m=i.find(g=>(g==null?void 0:g.id)===P)||(p<i.length?i[p]:null),R={};c.forEach((g,B)=>{let M="";if(m!=null&&m.cells){if(g.id in m.cells)M=String(m.cells[g.id]||"");else if(B<d.length){const j=d[B].id;j&&j in m.cells&&(M=String(m.cells[j]||""))}}R[g.id]=M}),r.push({id:P,cells:R})}return{columns:c,rows:r}}function bt(e,s){const n=it(Number(e)||Rt,Rt,us),a=it(Number(s)||kt,kt,ds);return{rows:n,cols:a}}const Fn=({data:e,onDataChange:s,onToast:n})=>{var z,U;const a=t.useRef(null),l=t.useRef(null),[c,d]=t.useState(null),r=t.useMemo(()=>{if(!(e!=null&&e.columns)||!Array.isArray(e.columns)||e.columns.length===0||!(e!=null&&e.rows)||!Array.isArray(e.rows)||e.rows.length===0)return ae(null,1,1);const k=Math.max(1,e.columns.length),E=Math.max(1,e.rows.length);return ae(e,E,k)},[e]),{rowData:i,columnDefs:h}=t.useMemo(()=>{var I,T,b,S;if(!(r!=null&&r.columns)||!(r!=null&&r.rows)){const A=ae(null,1,1);return{rowData:[{id:((I=A.rows[0])==null?void 0:I.id)||"row_0",[((T=A.columns[0])==null?void 0:T.id)||"col_0"]:""}],columnDefs:[{field:((b=A.columns[0])==null?void 0:b.id)||"col_0",headerName:((S=A.columns[0])==null?void 0:S.label)||"Column A",editable:!0,sortable:!1,filter:!1,resizable:!0,minWidth:120,flex:1}]}}const k=r.columns.map(A=>({field:A.id,headerName:A.label||"",editable:!0,sortable:!1,filter:!1,resizable:!0,minWidth:120,flex:1,cellEditor:"agTextCellEditor",cellEditorParams:{useFormatter:!1},headerComponent:En,headerComponentParams:{onHeaderValueChange:F=>{if(F&&F.trim()&&(A!=null&&A.id)){const L=r.columns.map(H=>H.id===A.id?ce(Z({},H),{label:F.trim()}):H);s(ce(Z({},r),{columns:L}))}}}}));return{rowData:r.rows.map(A=>{const F={id:A.id};return r.columns.forEach(L=>{var H;F[L.id]=String(((H=A.cells)==null?void 0:H[L.id])||"")}),F}),columnDefs:k}},[r,s]),p=t.useCallback(k=>{d(k.api)},[]),P=t.useCallback(k=>{var S,A;if(!(k!=null&&k.data)||!((S=k==null?void 0:k.colDef)!=null&&S.field))return;const E=k.data.id,I=k.colDef.field,T=(A=k.newValue)!=null?A:"";if(!(r!=null&&r.rows)||!Array.isArray(r.rows))return;const b=r.rows.map(F=>(F==null?void 0:F.id)===E?ce(Z({},F),{cells:ce(Z({},F.cells||{}),{[I]:String(T)})}):F);s(ce(Z({},r),{rows:b}))},[r,s]),m=t.useCallback(()=>{if(!(r!=null&&r.columns)||!(r!=null&&r.rows))return;const k=r.rows.length,I={id:`row_${k}`,cells:{}};r.columns.forEach(S=>{I.cells[S.id]=""});const T=ce(Z({},r),{rows:[...r.rows,I]}),b=ae(T,T.rows.length,T.columns.length);s(b),setTimeout(()=>{c&&r.columns.length>0&&(c.setFocusedCell(k,r.columns[0].id),c.startEditingCell({rowIndex:k,colKey:r.columns[0].id}))},100)},[r,s,c]),R=t.useCallback(()=>{if(!(r!=null&&r.rows)||!Array.isArray(r.rows)||r.rows.length<=1){n("Cannot remove the last row","warning");return}const k=r.rows.slice(0,-1),E=ae(ce(Z({},r),{rows:k}),k.length,r.columns.length);s(E)},[r,s,n]),g=t.useCallback(()=>{if(!(r!=null&&r.columns)||!(r!=null&&r.rows))return;const k=r.columns.length+1,E=ae(r,r.rows.length,k);s(E)},[r,s]),B=t.useCallback(()=>{if(!(r!=null&&r.columns)||!(r!=null&&r.rows)||r.columns.length<=1){n("Cannot remove the last column","warning");return}const k=r.columns.length-1,E=ae(r,r.rows.length,k);s(E)},[r,s,n]),M=t.useCallback(k=>{var E,I,T;if(!c||!(r!=null&&r.columns)||!(r!=null&&r.rows))return!1;try{const b=is(k);if(b.rows.length===0)return!1;const S=c.getFocusedCell();if(!S)return!1;const A=(E=S.rowIndex)!=null?E:0,F=((I=S.column)==null?void 0:I.getColId())||((T=r.columns[0])==null?void 0:T.id)||"",L=r.columns.findIndex(K=>(K==null?void 0:K.id)===F);if(L===-1)return!1;const H=Math.max(r.rows.length,A+b.rows.length),$=Math.max(r.columns.length,L+b.colCount);let G=ae(r,H,$);b.rows.forEach((K,W)=>{const q=A+W;if(q>=G.rows.length)return;const X=G.rows[q];K.forEach((ie,Ce)=>{const Ie=L+Ce;if(Ie<G.columns.length){const ye=G.columns[Ie].id;X.cells[ye]=String(ie||"")}})});const D=ae(G,G.rows.length,G.columns.length);return s(D),n(`Pasted ${b.rows.length} rows, ${b.colCount} columns`,"success"),!0}catch(b){return console.error("Paste error:",b),!1}},[r,s,c,n]);t.useEffect(()=>{if(!l.current)return;const k=I=>{var b;const T=((b=I.clipboardData)==null?void 0:b.getData("text/plain"))||"";T.trim()&&M(T)&&(I.preventDefault(),I.stopPropagation())},E=l.current;return E.addEventListener("paste",k),()=>{E.removeEventListener("paste",k)}},[M]);const j=t.useCallback(k=>{},[]),O=t.useCallback(k=>{c&&(r!=null&&r.columns)&&(r!=null&&r.rows)&&setTimeout(()=>{const E=[];if(c.forEachNode(I=>{var T;if((T=I==null?void 0:I.data)!=null&&T.id){const b={};r.columns.forEach(S=>{b[S.id]=String(I.data[S.id]||"")}),E.push({id:I.data.id,cells:b})}}),E.length>0){const I=ce(Z({},r),{rows:E}),T=ae(I,E.length,r.columns.length);s(T)}},0)},[r,s,c]),N=t.useCallback(k=>{if(c&&(r!=null&&r.columns)){const E=[];if(c.forEachNode(I=>{var T;if((T=I==null?void 0:I.data)!=null&&T.id){const b={};r.columns.forEach(S=>{b[S.id]=String(I.data[S.id]||"")}),E.push({id:I.data.id,cells:b})}}),E.length>0){const I=ce(Z({},r),{rows:E}),T=ae(I,E.length,r.columns.length);s(T)}}},[r,s,c]),V=t.useCallback(()=>{var L;if(!(r!=null&&r.rows)||!(r!=null&&r.columns)||r.rows.length===0||r.columns.length===0){n("Cannot transpose empty table","warning");return}const k=r.rows.map(H=>r.columns.map($=>{var G;return String(((G=H.cells)==null?void 0:G[$.id])||"")})),E=[];for(let H=0;H<r.columns.length;H++){E[H]=[];for(let $=0;$<r.rows.length;$++)E[H][$]=((L=k[$])==null?void 0:L[H])||""}const I=r.columns.length,T=r.rows.length,b={columns:r.rows.map((H,$)=>{var G;return{id:`col_${$}`,label:((G=r.columns[$])==null?void 0:G.label)||`Column ${String.fromCharCode(65+$%26)}`}}),rows:r.columns.map((H,$)=>{const G={};return r.rows.forEach((D,K)=>{var W;G[`col_${K}`]=((W=E[$])==null?void 0:W[K])||""}),{id:`row_${$}`,cells:G}})},S=ae(b,I,T);s(S);const A=S.rows.length,F=S.columns.length;n(`Table transposed: ${A} rows  ${F} columns`,"success")},[r,s,n]),f=t.useCallback((k,E)=>{const{rows:I,cols:T}=bt(k,E),b=ae(r,I,T);s(b)},[r,s]);return o.jsxs(Re,{sx:{display:"flex",flexDirection:"column",height:"100%",gap:2},children:[o.jsxs(Re,{sx:{display:"flex",gap:1,flexWrap:"wrap",alignItems:"center",p:2,borderBottom:1,borderColor:"divider"},children:[o.jsx(_e,{label:"Rows",type:"number",size:"small",value:((z=r==null?void 0:r.rows)==null?void 0:z.length)||0,onChange:k=>{var I;const E=k.target.value;f(E,((I=r==null?void 0:r.columns)==null?void 0:I.length)||0)},onBlur:k=>{var I,T;const{rows:E}=bt(k.target.value,((I=r==null?void 0:r.columns)==null?void 0:I.length)||0);f(E,((T=r==null?void 0:r.columns)==null?void 0:T.length)||0)},sx:{width:100},inputProps:{min:1,max:500}}),o.jsx(_e,{label:"Columns",type:"number",size:"small",value:((U=r==null?void 0:r.columns)==null?void 0:U.length)||0,onChange:k=>{var I;const E=k.target.value;f(((I=r==null?void 0:r.rows)==null?void 0:I.length)||0,E)},onBlur:k=>{var I,T;const{cols:E}=bt(((I=r==null?void 0:r.rows)==null?void 0:I.length)||0,k.target.value);f(((T=r==null?void 0:r.rows)==null?void 0:T.length)||0,E)},sx:{width:100},inputProps:{min:1,max:100}}),o.jsx(Re,{sx:{flex:1}}),o.jsx(Ye,{title:"Add Row",children:o.jsx(Je,{onClick:m,size:"small",children:o.jsx(St,{})})}),o.jsx(Ye,{title:"Remove Last Row",children:o.jsx(Je,{onClick:R,size:"small",children:o.jsx(Wt,{})})}),o.jsx(Ye,{title:"Add Column",children:o.jsx(Je,{onClick:g,size:"small",children:o.jsx(St,{})})}),o.jsx(Ye,{title:"Remove Last Column",children:o.jsx(Je,{onClick:B,size:"small",children:o.jsx(Wt,{})})}),o.jsx(Re,{sx:{width:1,borderTop:1,borderColor:"divider",my:1}}),o.jsx(Ye,{title:"Transpose Table (Swap Rows & Columns)",children:o.jsx(oe,{variant:"outlined",startIcon:o.jsx(hr,{}),onClick:V,size:"small",children:"Transpose"})})]}),o.jsx(Re,{sx:{flex:1,minHeight:400,display:"flex",flexDirection:"column",overflow:"hidden"},children:o.jsx("div",{className:"ag-theme-alpine",ref:l,style:{height:"100%",width:"100%",minHeight:400,flex:1},children:o.jsx(kn,{ref:a,columnDefs:h,rowData:i,onGridReady:p,onCellValueChanged:P,onPasteStart:j,onPasteEnd:O,onRowDataUpdated:N,defaultColDef:{editable:!0,sortable:!1,filter:!1,resizable:!0},theme:"legacy",suppressClipboardPaste:!1,animateRows:!1,getRowId:k=>k.data.id,rowSelection:{mode:"multiRow",enableClickSelection:!0}})})})]})};function zt(e){if(e==null)return"";const s=String(e);return s.includes(",")||s.includes('"')||s.includes(`
`)||s.includes("\r")?`"${s.replace(/"/g,'""')}"`:s}function Pn(e){if(!(e!=null&&e.columns)||!(e!=null&&e.rows))return"";const s=[],n=e.columns.map(a=>zt((a==null?void 0:a.label)||"")).join(",");return s.push(n),e.rows.forEach(a=>{const l=e.columns.map(c=>{var r;const d=((r=a==null?void 0:a.cells)==null?void 0:r[(c==null?void 0:c.id)||""])||"";return zt(String(d))});s.push(l.join(","))}),s.join(`\r
`)}function jn(){const e=new Date,s=e.getFullYear(),n=String(e.getMonth()+1).padStart(2,"0"),a=String(e.getDate()).padStart(2,"0"),l=String(e.getHours()).padStart(2,"0"),c=String(e.getMinutes()).padStart(2,"0");return`live-table-builder_${s}-${n}-${a}_${l}${c}.csv`}function Tn(e,s=!0){if(!e.rows||e.rows.length===0)return{columns:[],rows:[]};let n=[],a=[];if(s&&e.rows.length>0)n=e.rows[0],a=e.rows.slice(1);else{const r=Math.max(...e.rows.map(i=>i.length));n=Array.from({length:r},(i,h)=>`Column ${String.fromCharCode(65+h%26)}`),a=e.rows}const l=Math.max(n.length,...a.map(r=>r.length));for(;n.length<l;){const r=n.length,i=String.fromCharCode(65+r%26);n.push(`Column ${i}`)}const c=n.map((r,i)=>({id:`col_${i}`,label:r||`Column ${String.fromCharCode(65+i%26)}`})),d=a.map((r,i)=>{const h=`row_${i}`,p={};return c.forEach((P,m)=>{p[P.id]=String(r[m]||"")}),{id:h,cells:p}});return{columns:c,rows:d}}function Kt(e,s=!0){const n=is(e);return Tn(n,s)}const An=50;class On{constructor(){Ct(this,"history",[]);Ct(this,"currentIndex",-1)}push(s){this.currentIndex<this.history.length-1&&(this.history=this.history.slice(0,this.currentIndex+1)),this.history.push(JSON.parse(JSON.stringify(s))),this.currentIndex++,this.history.length>An&&(this.history.shift(),this.currentIndex--)}undo(){return this.currentIndex>0?(this.currentIndex--,JSON.parse(JSON.stringify(this.history[this.currentIndex]))):null}redo(){return this.currentIndex<this.history.length-1?(this.currentIndex++,JSON.parse(JSON.stringify(this.history[this.currentIndex]))):null}canUndo(){return this.currentIndex>0}canRedo(){return this.currentIndex<this.history.length-1}clear(){this.history=[],this.currentIndex=-1}initialize(s){this.history=[JSON.parse(JSON.stringify(s))],this.currentIndex=0}}const qt="om_live_table_builder_state_v1",Et=10,Bn=6,Xe=()=>ae(null,Et,Bn),zn=()=>{const[e,s]=t.useState(Xe()),[n,a]=t.useState(!1),[l,c]=t.useState(!1),[d,r]=t.useState(""),[i,h]=t.useState(""),[p,P]=t.useState(!0),[m,R]=t.useState(!1),g=y.useRef(new On),[B,M]=t.useState(!1),[j,O]=t.useState(!1),[N,V]=t.useState({open:!1,message:"",severity:"info"}),[f,z]=t.useState(""),[U,k]=t.useState(""),[E,I]=t.useState([]),[T,b]=t.useState(!1),[S,A]=t.useState(!1),[F,L]=t.useState(!1),[H,$]=t.useState(""),[G,D]=t.useState(!1),[K,W]=t.useState(""),[q,X]=t.useState(!1),[ie,Ce]=t.useState(""),[Ie,ye]=t.useState(""),[ne,xe]=t.useState("custom"),[me,Se]=t.useState(""),[ke,J]=t.useState(!1),[ee,ue]=t.useState(!1),C=t.useCallback((u,w="info")=>{V({open:!0,message:u,severity:w})},[]),te=t.useCallback(()=>Oe(void 0,null,function*(){ue(!0);try{const u=yield Ge.templates.getAll();u.success&&I(u.templates.map(w=>({slug:w.slug,name:w.name,record_type:w.record_type,is_global:w.is_global})))}catch(u){console.error("Failed to load templates from database:",u),C("Failed to load templates","error")}finally{ue(!1)}}),[C]);t.useEffect(()=>{var u,w;try{const v=localStorage.getItem(qt);if(v){const x=JSON.parse(v);if((u=x==null?void 0:x.data)!=null&&u.columns&&Array.isArray(x.data.columns)&&((w=x==null?void 0:x.data)!=null&&w.rows)&&Array.isArray(x.data.rows)){const _=ae(x.data,x.data.rows.length,x.data.columns.length);s(_),g.current.initialize(_),ye(JSON.stringify(_))}else{C("Invalid saved data format, using defaults","warning");const _=Xe();s(_),g.current.initialize(_),ye(JSON.stringify(_))}}else{const x=Xe();s(x),g.current.initialize(x),ye(JSON.stringify(x))}}catch(v){console.error("Failed to load table data:",v),C("Failed to load saved data, using defaults","warning");const x=Xe();s(x),g.current.initialize(x),ye(JSON.stringify(x))}te()},[te]),t.useEffect(()=>{M(g.current.canUndo()),O(g.current.canRedo())},[e]),t.useEffect(()=>{try{if(e!=null&&e.columns&&Array.isArray(e.columns)&&(e!=null&&e.rows)&&Array.isArray(e.rows)){const u=ae(e,e.rows.length,e.columns.length),w={data:u,version:"1"};localStorage.setItem(qt,JSON.stringify(w)),ye(JSON.stringify(u))}}catch(u){console.error("Failed to save table data:",u),C("Failed to save data to localStorage","error")}},[e]),t.useEffect(()=>{te()},[T,F,q,te]);const Y=t.useCallback(u=>{var _,Q;const w=ae(u,((_=u==null?void 0:u.rows)==null?void 0:_.length)||0,((Q=u==null?void 0:u.columns)==null?void 0:Q.length)||0),v=JSON.stringify(e),x=JSON.stringify(w);v!==x&&(s(w),g.current.push(w),M(g.current.canUndo()),O(g.current.canRedo()))},[e]),se=t.useCallback(()=>{const u=g.current.undo();u&&(s(u),M(g.current.canUndo()),O(g.current.canRedo()),C("Undone","info"))},[C]),de=t.useCallback(()=>{const u=g.current.redo();u&&(s(u),M(g.current.canUndo()),O(g.current.canRedo()),C("Redone","info"))},[C]);t.useEffect(()=>{const u=w=>{(w.ctrlKey||w.metaKey)&&w.key==="z"&&!w.shiftKey&&(w.preventDefault(),se()),(w.ctrlKey||w.metaKey)&&(w.key==="y"||w.key==="z"&&w.shiftKey)&&(w.preventDefault(),de())};return window.addEventListener("keydown",u),()=>{window.removeEventListener("keydown",u)}},[se,de]);const Ae=t.useCallback(()=>{try{if(!(e!=null&&e.columns)||!(e!=null&&e.rows)){C("No data to export","warning");return}const w={data:ae(e,e.rows.length,e.columns.length),version:"1"},v=JSON.stringify(w,null,2);navigator.clipboard&&navigator.clipboard.writeText&&navigator.clipboard.writeText(v).then(()=>{C("JSON copied to clipboard","success")}).catch(()=>{});const x=new Blob([v],{type:"application/json"}),_=URL.createObjectURL(x),Q=document.createElement("a");Q.href=_,Q.download=`live-table-builder-${new Date().toISOString().split("T")[0]}.json`,document.body.appendChild(Q),Q.click(),document.body.removeChild(Q),URL.revokeObjectURL(_),C("JSON exported and copied to clipboard","success")}catch(u){C("Failed to export data","error"),console.error(u)}},[e,C]),Me=t.useCallback(()=>{a(!0),h("")},[]),le=t.useCallback(()=>{a(!0),r("")},[]),$e=t.useCallback(()=>{var u;try{if(!i||!i.trim()){C("Please paste CSV data","warning");return}const w=Kt(i,p);if(!w.columns||w.columns.length===0){C("Invalid CSV format: no columns found","error");return}const v=ae(w,((u=w.rows)==null?void 0:u.length)||0,w.columns.length);s(v),g.current.push(v),M(g.current.canUndo()),O(g.current.canRedo()),a(!1),h("");const x=v.rows.length,_=v.columns.length;C(`Imported ${x} rows, ${_} columns`,"success")}catch(w){const v=w instanceof Error?w.message:"Unknown error";C("Failed to parse CSV: "+v,"error"),console.error(w)}},[i,p,C]),pt=t.useCallback(()=>{var u,w;try{if(!d||!d.trim()){C("Please paste JSON data","warning");return}const v=JSON.parse(d);if((u=v==null?void 0:v.data)!=null&&u.columns&&Array.isArray(v.data.columns)&&((w=v==null?void 0:v.data)!=null&&w.rows)&&Array.isArray(v.data.rows)){const x=ae(v.data,v.data.rows.length,v.data.columns.length);s(x),g.current.push(x),M(g.current.canUndo()),O(g.current.canRedo()),a(!1),r("");const _=x.rows.length,Q=x.columns.length;C(`JSON imported: ${_} rows, ${Q} columns`,"success")}else C("Invalid JSON format: missing columns or rows","error")}catch(v){C("Failed to parse JSON: "+(v instanceof Error?v.message:"Unknown error"),"error"),console.error(v)}},[d,C]),st=t.useCallback(u=>{var x;const w=(x=u.target.files)==null?void 0:x[0];if(!w)return;const v=new FileReader;v.onload=_=>{var Q,ge,fe,re;try{const he=(Q=_.target)==null?void 0:Q.result;if(!he||!he.trim()){C("File is empty","error");return}const Fe=w.name.toLowerCase();if(Fe.endsWith(".csv")||Fe.endsWith(".tsv")){const we=Kt(he,p);if(!we.columns||we.columns.length===0){C("Invalid CSV format: no columns found","error");return}const Ne=ae(we,((ge=we.rows)==null?void 0:ge.length)||0,we.columns.length);s(Ne),g.current.push(Ne),M(g.current.canUndo()),O(g.current.canRedo());const ht=Ne.rows.length,ft=Ne.columns.length;C(`Imported ${ht} rows, ${ft} columns from CSV`,"success")}else{const we=JSON.parse(he);if((fe=we==null?void 0:we.data)!=null&&fe.columns&&Array.isArray(we.data.columns)&&((re=we==null?void 0:we.data)!=null&&re.rows)&&Array.isArray(we.data.rows)){const Ne=ae(we.data,we.data.rows.length,we.data.columns.length);s(Ne),g.current.push(Ne),M(g.current.canUndo()),O(g.current.canRedo());const ht=Ne.rows.length,ft=Ne.columns.length;C(`Imported ${ht} rows, ${ft} columns from JSON`,"success")}else C("Invalid JSON format: missing columns or rows","error")}}catch(he){const Fe=he instanceof Error?he.message:"Unknown error";C("Failed to parse file: "+Fe,"error"),console.error(he)}},v.onerror=()=>{C("Failed to read file","error")},v.readAsText(w)},[C,p]),pe=t.useCallback(()=>{try{if(!(e!=null&&e.columns)||!(e!=null&&e.rows)){C("No data to export","warning");return}const u=ae(e,e.rows.length,e.columns.length),w=Pn(u);if(!w){C("Failed to generate CSV","error");return}const v=new Blob([w],{type:"text/csv;charset=utf-8;"}),x=URL.createObjectURL(v),_=document.createElement("a");_.href=x,_.download=jn(),document.body.appendChild(_),_.click(),document.body.removeChild(_),URL.revokeObjectURL(x),C("CSV exported successfully","success")}catch(u){C("Failed to export CSV","error"),console.error(u)}},[e,C]),ve=t.useCallback(()=>{c(!0)},[]),mt=t.useCallback(()=>{try{const u=Xe();s(u),g.current.clear(),g.current.initialize(u),M(!1),O(!1),c(!1),ye(JSON.stringify(u)),C("Grid reset to defaults","success")}catch(u){C("Failed to reset table","error"),console.error(u)}},[C]),Pt=t.useCallback(()=>{if(!e)return!1;const u=ae(e,e.rows.length,e.columns.length);return JSON.stringify(u)!==Ie},[e,Ie]),rt=t.useCallback(u=>u.columns.map((v,x)=>{let _="string";const Q=v.label.toLowerCase();return Q.includes("date")||Q.includes("time")?_="date":Q.includes("id")||Q.includes("number")||Q.includes("count")?_="number":Q.includes("email")?_="email":Q.includes("phone")&&(_="tel"),{column:v.id,label:v.label||`Column ${x+1}`,type:_,required:!1}}),[]),ps=t.useCallback(()=>Oe(void 0,null,function*(){var w,v;if(!f.trim()){C("Template name is required","warning");return}if(E.find(x=>x.name===f.trim()||x.slug===f.trim().toLowerCase().replace(/[^\w\s-]/g,"").replace(/[\s_-]+/g,"-"))){A(!0);return}try{const x=ae(e,e.rows.length,e.columns.length),_=rt(x),Q=f.trim().toLowerCase().replace(/[^\w\s-]/g,"").replace(/[\s_-]+/g,"-").replace(/^-+|-+$/g,""),ge={name:f.trim(),slug:Q,record_type:ne,description:me.trim()||null,fields:_,grid_type:"aggrid",theme:"liturgicalBlueGold",layout_type:"table",is_editable:!0,church_id:null,is_global:ke};if((yield Ge.templates.create(ge)).success){const re=f.trim();yield te(),z(""),Se(""),xe("custom"),J(!1),b(!1),C(`Saved template: ${re}`,"success")}else C("Failed to save template","error")}catch(x){console.error("Error saving template:",x);const _=((v=(w=x==null?void 0:x.response)==null?void 0:w.data)==null?void 0:v.error)||(x==null?void 0:x.message)||"Unknown error";C(`Failed to save template: ${_}`,"error")}}),[f,ne,me,ke,e,E,rt,te,C]),ms=t.useCallback(()=>Oe(void 0,null,function*(){var u,w;try{const v=E.find(fe=>fe.name===f.trim()||fe.slug===f.trim().toLowerCase().replace(/[^\w\s-]/g,"").replace(/[\s_-]+/g,"-"));if(!v){C("Template not found","error");return}const x=ae(e,e.rows.length,e.columns.length),_=rt(x),Q={record_type:ne,description:me.trim()||null,fields:_,is_global:ke};if((yield Ge.templates.update(v.slug,Q)).success){const fe=f.trim();yield te(),z(""),Se(""),xe("custom"),J(!1),b(!1),A(!1),C(`Updated template: ${fe}`,"success")}else C("Failed to update template","error")}catch(v){console.error("Error updating template:",v);const x=((w=(u=v==null?void 0:v.response)==null?void 0:u.data)==null?void 0:w.error)||(v==null?void 0:v.message)||"Unknown error";C(`Failed to update template: ${x}`,"error")}}),[f,ne,me,ke,e,E,rt,te,C]),hs=t.useCallback(u=>Oe(void 0,null,function*(){if(Pt()){W(u),D(!0);return}try{const w=yield Ge.templates.getBySlug(u);if(!w.success||!w.template){C("Template not found","error");return}const v=w.template;let x=[];if(Array.isArray(v.fields))x=v.fields;else if(v.fields&&typeof v.fields=="object")if(v.fields.columns&&Array.isArray(v.fields.columns))x=v.fields.columns.map(re=>({column:re.name||re.column||`col_${x.length}`,label:re.label||re.name||re.column,type:re.type||"string",required:re.required||!1}));else throw new Error("Template fields format not recognized");else throw new Error("Template fields is missing or invalid");const _=x.map((re,he)=>({id:re.column||`col_${he}`,label:re.label||re.column||`Column ${he+1}`})),Q=Array.from({length:Et},(re,he)=>({id:`row_${he}`,cells:_.reduce((Fe,nt)=>(Fe[nt.id]="",Fe),{})})),fe=ae({columns:_,rows:Q},Q.length,_.length);s(fe),g.current.clear(),g.current.initialize(fe),M(!1),O(!1),ye(JSON.stringify(fe)),k(u),C(`Loaded template: ${v.name}`,"success")}catch(w){console.error("Error loading template:",w),C(`Failed to load template: ${(w==null?void 0:w.message)||"Unknown error"}`,"error")}}),[Pt,C]),fs=t.useCallback(()=>Oe(void 0,null,function*(){const u=K;try{const w=yield Ge.templates.getBySlug(u);if(!w.success||!w.template){C("Template not found","error"),D(!1);return}const v=w.template;let x=[];if(Array.isArray(v.fields))x=v.fields;else if(v.fields&&typeof v.fields=="object")if(v.fields.columns&&Array.isArray(v.fields.columns))x=v.fields.columns.map(re=>({column:re.name||re.column||`col_${x.length}`,label:re.label||re.name||re.column,type:re.type||"string",required:re.required||!1}));else throw new Error("Template fields format not recognized");else throw new Error("Template fields is missing or invalid");const _=x.map((re,he)=>({id:re.column||`col_${he}`,label:re.label||re.column||`Column ${he+1}`})),Q=Array.from({length:Et},(re,he)=>({id:`row_${he}`,cells:_.reduce((Fe,nt)=>(Fe[nt.id]="",Fe),{})})),fe=ae({columns:_,rows:Q},Q.length,_.length);s(fe),g.current.clear(),g.current.initialize(fe),M(!1),O(!1),ye(JSON.stringify(fe)),k(u),D(!1),W(""),C(`Loaded template: ${v.name}`,"success")}catch(w){console.error("Error loading template:",w),C(`Failed to load template: ${(w==null?void 0:w.message)||"Unknown error"}`,"error"),D(!1)}}),[K,C]),gs=t.useCallback(u=>{$(u),L(!0)},[]),Cs=t.useCallback(()=>Oe(void 0,null,function*(){const u=H;try{(yield Ge.templates.delete(u)).success?(yield te(),L(!1),$(""),U===u&&k(""),C("Template deleted successfully","success")):C("Failed to delete template","error")}catch(w){console.error("Error deleting template:",w),C(`Failed to delete template: ${(w==null?void 0:w.message)||"Unknown error"}`,"error")}}),[H,U,te,C]),ws=t.useCallback(()=>Oe(void 0,null,function*(){try{const u=yield Ge.templates.getAll();if(u.success){const w=JSON.stringify(u.templates,null,2),v=new Blob([w],{type:"application/json"}),x=URL.createObjectURL(v),_=document.createElement("a");_.href=x;const Q=new Date,ge=Q.toISOString().split("T")[0],fe=Q.toTimeString().split(" ")[0].replace(/:/g,"");_.download=`live-table-templates_${ge}_${fe}.json`,document.body.appendChild(_),_.click(),document.body.removeChild(_),URL.revokeObjectURL(x),C("Templates exported successfully","success")}else C("Failed to export templates","error")}catch(u){C("Failed to export templates","error"),console.error(u)}}),[C]),ys=t.useCallback(()=>{X(!0),Ce("")},[]),xs=t.useCallback(u=>{var x;const w=(x=u.target.files)==null?void 0:x[0];if(!w)return;const v=new FileReader;v.onload=_=>{var Q;try{const ge=(Q=_.target)==null?void 0:Q.result;if(!ge){C("Failed to read file","error");return}JSON.parse(ge),Ce(ge),X(!0)}catch(ge){C("Invalid JSON file","error"),console.error(ge)}},v.onerror=()=>{C("Failed to read file","error")},v.readAsText(w),u.target.value=""},[C]),bs=t.useCallback(()=>Oe(void 0,null,function*(){try{if(!ie.trim()){C("Please paste template JSON data","warning");return}const u=JSON.parse(ie);if(!Array.isArray(u)){C("Invalid template format: expected array","error");return}let w=0,v=0;for(const x of u)try{yield Ge.templates.create({name:x.name,slug:x.slug,record_type:x.record_type||"custom",description:x.description||null,fields:x.fields||[],grid_type:x.grid_type||"aggrid",theme:x.theme||"liturgicalBlueGold",layout_type:x.layout_type||"table",is_editable:x.is_editable!==!1,church_id:x.church_id||null,is_global:x.is_global||!1}),w++}catch(_){console.error("Failed to import template:",x.name,_),v++}yield te(),X(!1),Ce(""),v>0?C(`Imported ${w} templates. ${v} failed.`,"warning"):C(`Imported ${w} templates successfully`,"success")}catch(u){C("Failed to import templates","error"),console.error(u)}}),[ie,te,C]),Ss=t.useCallback(()=>Oe(void 0,null,function*(){try{const u=["id","church_id","entry_no","date","first_name","last_name","father_name","mother_name","godfather_name","godmother_name","notes"],w=["baptism","marriage","funeral"],v=["en","gr"];let x=0;for(const _ of v)for(const Q of w){const ge=`${_}_${Q}_records`,fe=ge.toLowerCase().replace(/[^\w\s-]/g,"").replace(/[\s_-]+/g,"-"),re=u.map((he,Fe)=>({column:`col_${Fe}`,label:he,type:"string",required:!1}));try{yield Ge.templates.create({name:ge,slug:fe,record_type:Q,description:`Standard ${Q} template for ${_}`,fields:re,grid_type:"aggrid",theme:"liturgicalBlueGold",layout_type:"table",is_editable:!0,church_id:null,is_global:!0}),x++}catch(he){console.log(`Template ${ge} may already exist, skipping`)}}yield te(),C(`Created ${x} standard templates`,"success")}catch(u){C("Failed to create standard templates","error"),console.error(u)}}),[te,C]);return o.jsxs(cr,{maxWidth:"xl",sx:{py:4,height:"calc(100vh - 120px)",display:"flex",flexDirection:"column"},children:[o.jsxs(Re,{sx:{mb:3},children:[o.jsxs(Re,{sx:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",mb:2},children:[o.jsxs(Re,{children:[o.jsx(Be,{variant:"h4",gutterBottom:!0,children:"Live Table Builder"}),o.jsx(Be,{variant:"body2",color:"text.secondary",children:"Create, edit, and manage tables with clipboard paste support. Data is automatically saved."})]}),o.jsxs(Je,{onClick:()=>R(!m),title:"Show/hide quick tips",sx:{ml:2},children:[m?o.jsx(ir,{}):o.jsx(ur,{}),o.jsx(dr,{sx:{ml:.5}})]})]}),o.jsx(er,{in:m,children:o.jsxs(tr,{sx:{p:2,mb:2,bgcolor:"background.default"},children:[o.jsx(Be,{variant:"subtitle2",gutterBottom:!0,sx:{fontWeight:"bold"},children:"Quick Tips:"}),o.jsxs(Re,{component:"ul",sx:{m:0,pl:2.5,"& li":{mb:.5}},children:[o.jsx("li",{children:"Double-click column headers to edit them inline"}),o.jsx("li",{children:"Paste data from Excel/Google Sheets directly into cells"}),o.jsxs("li",{children:["Use ",o.jsx("strong",{children:"Ctrl+Z"})," to undo and ",o.jsx("strong",{children:"Ctrl+Y"})," to redo"]}),o.jsx("li",{children:"Export to CSV for Excel compatibility or JSON for data backup"}),o.jsx("li",{children:"Import CSV/TSV files with automatic delimiter detection"}),o.jsx("li",{children:"All changes are automatically saved to your browser"})]})]})}),o.jsxs(Re,{sx:{mb:2,p:2,border:1,borderColor:"divider",borderRadius:1,bgcolor:"background.paper"},children:[o.jsx(Be,{variant:"subtitle2",gutterBottom:!0,sx:{fontWeight:"bold",mb:1.5},children:"Template Management"}),o.jsxs(Re,{sx:{display:"flex",gap:1,flexWrap:"wrap",alignItems:"center"},children:[o.jsx(_e,{label:"Template Name",size:"small",value:f,onChange:u=>z(u.target.value),placeholder:"e.g., en_baptism_records",sx:{width:200}}),o.jsx(oe,{variant:"contained",startIcon:o.jsx(sr,{}),onClick:()=>b(!0),disabled:!f.trim(),size:"small",children:"Save Template"}),o.jsxs(Ot,{size:"small",sx:{minWidth:200},children:[o.jsx(Bt,{children:"Load Template"}),o.jsx(Nt,{value:U,label:"Load Template",disabled:ee,onChange:u=>{const w=u.target.value;k(w),w&&hs(w)},children:ee?o.jsx(We,{disabled:!0,children:"Loading templates..."}):E.length===0?o.jsx(We,{disabled:!0,children:"No templates available"}):E.map(u=>o.jsxs(We,{value:u.slug,children:[u.name," ",u.is_global?"(Global)":""]},u.slug))})]}),o.jsx(oe,{variant:"outlined",startIcon:o.jsx(pr,{}),onClick:()=>{U&&gs(U)},disabled:!U,color:"error",size:"small",children:"Delete"}),o.jsx(Qe,{orientation:"vertical",flexItem:!0,sx:{mx:1}}),o.jsx(oe,{variant:"outlined",startIcon:o.jsx(yt,{}),onClick:ws,size:"small",children:"Export Templates"}),o.jsx(oe,{variant:"outlined",startIcon:o.jsx(Ze,{}),onClick:ys,size:"small",children:"Import Templates"}),o.jsx("input",{accept:".json",style:{display:"none"},id:"import-templates-file-input",type:"file",onChange:xs}),o.jsx("label",{htmlFor:"import-templates-file-input",children:o.jsx(oe,{variant:"outlined",component:"span",startIcon:o.jsx(Ze,{}),size:"small",children:"Upload Templates"})}),o.jsx(oe,{variant:"outlined",startIcon:o.jsx(St,{}),onClick:Ss,size:"small",color:"secondary",children:"Create Standard Templates"}),o.jsx(Qe,{orientation:"vertical",flexItem:!0,sx:{mx:1}})]})]}),o.jsxs(Re,{sx:{display:"flex",gap:1,flexWrap:"wrap",alignItems:"center"},children:[o.jsx(oe,{variant:"outlined",startIcon:o.jsx(fr,{}),onClick:se,disabled:!B,title:"Undo (Ctrl+Z)",size:"small",children:"Undo"}),o.jsx(oe,{variant:"outlined",startIcon:o.jsx(mr,{}),onClick:de,disabled:!j,title:"Redo (Ctrl+Y or Ctrl+Shift+Z)",size:"small",children:"Redo"}),o.jsx(Qe,{orientation:"vertical",flexItem:!0,sx:{mx:1}}),o.jsx(oe,{variant:"outlined",startIcon:o.jsx(rr,{}),onClick:ve,color:"warning",size:"small",children:"Reset"}),o.jsx(Qe,{orientation:"vertical",flexItem:!0,sx:{mx:1}}),o.jsx(oe,{variant:"outlined",startIcon:o.jsx(Ze,{}),onClick:Me,size:"small",children:"Import JSON"}),o.jsx(oe,{variant:"outlined",startIcon:o.jsx(Ze,{}),onClick:le,size:"small",children:"Import CSV"}),o.jsx("input",{accept:".json,.csv,.tsv",style:{display:"none"},id:"import-file-input",type:"file",onChange:st}),o.jsx("label",{htmlFor:"import-file-input",children:o.jsx(oe,{variant:"outlined",component:"span",startIcon:o.jsx(Ze,{}),size:"small",children:"Upload File"})}),o.jsx(Qe,{orientation:"vertical",flexItem:!0,sx:{mx:1}}),o.jsx(oe,{variant:"outlined",startIcon:o.jsx(yt,{}),onClick:Ae,size:"small",children:"Export JSON"}),o.jsx(oe,{variant:"contained",startIcon:o.jsx(yt,{}),onClick:pe,size:"small",children:"Export CSV"})]})]}),o.jsx(Re,{sx:{mb:2,p:1.5,bgcolor:"action.hover",borderRadius:1},children:o.jsxs(Be,{variant:"body2",color:"text.secondary",children:[o.jsx("strong",{children:"Tip:"})," Paste data from Excel/Google Sheets (Ctrl/Cmd+V) or start typing in any cell. All changes are automatically saved."]})}),o.jsx(Re,{sx:{flex:1,minHeight:500,display:"flex",flexDirection:"column",overflow:"hidden"},children:o.jsx(Fn,{data:e,onDataChange:Y,onToast:C})}),o.jsxs(Ue,{open:n,onClose:()=>a(!1),maxWidth:"md",fullWidth:!0,children:[o.jsx(Le,{children:i?"Import CSV/TSV":"Import JSON"}),o.jsx(He,{children:i?o.jsxs(o.Fragment,{children:[o.jsx(Gt,{control:o.jsx(_t,{checked:p,onChange:u=>P(u.target.checked)}),label:"First row is headers",sx:{mt:2,mb:1}}),o.jsx(_e,{fullWidth:!0,multiline:!0,rows:12,value:i,onChange:u=>h(u.target.value),placeholder:"Paste CSV/TSV data here...",sx:{mt:1}})]}):o.jsx(_e,{fullWidth:!0,multiline:!0,rows:12,value:d,onChange:u=>r(u.target.value),placeholder:"Paste JSON data here...",sx:{mt:2}})}),o.jsxs(De,{children:[o.jsx(oe,{onClick:()=>{a(!1),r(""),h("")},children:"Cancel"}),i?o.jsx(oe,{onClick:$e,variant:"contained",children:"Import CSV"}):o.jsx(oe,{onClick:pt,variant:"contained",children:"Import JSON"})]})]}),o.jsxs(Ue,{open:l,onClose:()=>c(!1),children:[o.jsx(Le,{children:"Reset Table"}),o.jsx(He,{children:o.jsx(Be,{children:"Reset to default 10x6 grid? This will lose all current data."})}),o.jsxs(De,{children:[o.jsx(oe,{onClick:()=>c(!1),children:"Cancel"}),o.jsx(oe,{onClick:mt,variant:"contained",color:"warning",children:"Reset"})]})]}),o.jsxs(Ue,{open:T,onClose:()=>b(!1),maxWidth:"sm",fullWidth:!0,children:[o.jsx(Le,{children:"Save Template to Database"}),o.jsx(He,{children:o.jsxs(Re,{sx:{display:"flex",flexDirection:"column",gap:2,pt:1},children:[o.jsx(_e,{fullWidth:!0,label:"Template Name",value:f,onChange:u=>z(u.target.value),placeholder:"e.g., Standard Baptism Records",required:!0,autoFocus:!0}),o.jsxs(Ot,{fullWidth:!0,children:[o.jsx(Bt,{children:"Record Type"}),o.jsxs(Nt,{value:ne,label:"Record Type",onChange:u=>xe(u.target.value),children:[o.jsx(We,{value:"baptism",children:"Baptism"}),o.jsx(We,{value:"marriage",children:"Marriage"}),o.jsx(We,{value:"funeral",children:"Funeral"}),o.jsx(We,{value:"custom",children:"Custom"})]})]}),o.jsx(_e,{fullWidth:!0,label:"Description (optional)",value:me,onChange:u=>Se(u.target.value),placeholder:"Template description...",multiline:!0,rows:2}),o.jsx(Gt,{control:o.jsx(_t,{checked:ke,onChange:u=>J(u.target.checked)}),label:"Make this template global (available to all churches)"})]})}),o.jsxs(De,{children:[o.jsx(oe,{onClick:()=>{b(!1),z(""),Se(""),xe("custom"),J(!1)},children:"Cancel"}),o.jsx(oe,{onClick:ps,variant:"contained",disabled:!f.trim(),children:"Save"})]})]}),o.jsxs(Ue,{open:S,onClose:()=>A(!1),children:[o.jsx(Le,{children:"Update Template?"}),o.jsx(He,{children:o.jsxs(Be,{children:['Template "',f,'" already exists in the database. Update it?']})}),o.jsxs(De,{children:[o.jsx(oe,{onClick:()=>{A(!1),z(""),b(!1)},children:"Cancel"}),o.jsx(oe,{onClick:ms,variant:"contained",color:"warning",children:"Update"})]})]}),o.jsxs(Ue,{open:F,onClose:()=>L(!1),children:[o.jsx(Le,{children:"Delete Template?"}),o.jsx(He,{children:o.jsx(Be,{children:"Are you sure you want to delete this template? This action cannot be undone."})}),o.jsxs(De,{children:[o.jsx(oe,{onClick:()=>{L(!1),$("")},children:"Cancel"}),o.jsx(oe,{onClick:Cs,variant:"contained",color:"error",children:"Delete"})]})]}),o.jsxs(Ue,{open:G,onClose:()=>D(!1),children:[o.jsx(Le,{children:"Load Template?"}),o.jsx(He,{children:o.jsx(Be,{children:"You have unsaved changes. Loading this template will replace your current table. Continue?"})}),o.jsxs(De,{children:[o.jsx(oe,{onClick:()=>{D(!1),W("")},children:"Cancel"}),o.jsx(oe,{onClick:fs,variant:"contained",color:"warning",children:"Load Template"})]})]}),o.jsxs(Ue,{open:q,onClose:()=>X(!1),maxWidth:"md",fullWidth:!0,children:[o.jsx(Le,{children:"Import Templates"}),o.jsxs(He,{children:[o.jsx(Be,{variant:"body2",color:"text.secondary",sx:{mb:2},children:"Paste JSON template data. Existing templates with the same name will be overwritten."}),o.jsx(_e,{fullWidth:!0,multiline:!0,rows:12,value:ie,onChange:u=>Ce(u.target.value),placeholder:"Paste template JSON here...",sx:{mt:1}})]}),o.jsxs(De,{children:[o.jsx(oe,{onClick:()=>{X(!1),Ce("")},children:"Cancel"}),o.jsx(oe,{onClick:bs,variant:"contained",disabled:!ie.trim(),children:"Import Templates"})]})]}),o.jsx(nr,{open:N.open,autoHideDuration:12e3,onClose:()=>V(ce(Z({},N),{open:!1})),anchorOrigin:{vertical:"center",horizontal:"center"},sx:{position:"fixed",top:"50% !important",left:"50% !important",transform:"translate(-50%, -50%) !important",zIndex:1e4,"& .MuiSnackbar-root":{position:"fixed",top:"50% !important",left:"50% !important",transform:"translate(-50%, -50%) !important"}},children:o.jsx(or,{onClose:()=>V(ce(Z({},N),{open:!1})),severity:N.severity,sx:{minWidth:"400px",maxWidth:"600px",fontSize:"1.1rem",padding:"16px 20px","& .MuiAlert-message":{fontSize:"1.1rem",fontWeight:500},"& .MuiAlert-icon":{fontSize:"28px"}},children:N.message})})]})};export{zn as LiveTableBuilderPage,zn as default};
//# sourceMappingURL=LiveTableBuilderPage-nVSXWqCi.js.map
