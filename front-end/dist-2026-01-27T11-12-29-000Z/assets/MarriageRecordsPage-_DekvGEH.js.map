{"version":3,"file":"MarriageRecordsPage-_DekvGEH.js","sources":["../../src/features/records-centralized/components/marriage/MarriageRecordsPage.tsx"],"sourcesContent":["/**\n * MarriageRecordsPage Component\n * \n * Centralized marriage records management page with full UI features.\n * \n * Route: /apps/records/marriage\n */\n\nimport React, { useState, useEffect } from 'react';\nimport { useSearchParams, useNavigate } from 'react-router-dom';\nimport {\n  Box,\n  Typography,\n  Paper,\n  CircularProgress,\n  Alert,\n  Table,\n  TableBody,\n  TableCell,\n  TableContainer,\n  TableHead,\n  TableRow,\n  TablePagination,\n  TextField,\n  InputAdornment,\n  Tabs,\n  Tab,\n  Button,\n  IconButton,\n  Tooltip,\n  Chip,\n  Stack\n} from '@mui/material';\nimport { IconSearch, IconEdit, IconEye, IconTrash, IconRefresh, IconReport } from '@tabler/icons-react';\nimport { useAuth } from '../../../../context/AuthContext';\nimport { formatRecordDate } from '../../../../utils/formatDate';\n\n// Helper to safely parse JSON fields (witnesses)\nconst parseJsonField = (value: any): string[] => {\n  if (!value) return [];\n  if (Array.isArray(value)) return value;\n  if (typeof value === 'string') {\n    try {\n      const parsed = JSON.parse(value);\n      return Array.isArray(parsed) ? parsed : [value];\n    } catch {\n      return value.trim() ? [value] : [];\n    }\n  }\n  return [];\n};\n\n// Helper to display JSON array fields as comma-separated string\nconst displayJsonField = (value: any): string => {\n  const arr = parseJsonField(value);\n  return arr.length > 0 ? arr.join(', ') : '';\n};\n\n// Interface updated to match production schema (05_sacrament_tables.sql)\ninterface MarriageRecord {\n  id: number;\n  // Production schema fields (groom_*, bride_*)\n  groom_first?: string;\n  groom_middle?: string;\n  groom_last?: string;\n  groom_full?: string;\n  bride_first?: string;\n  bride_middle?: string;\n  bride_last?: string;\n  bride_full?: string;\n  // Legacy field names for backwards compatibility\n  groom_first_name?: string;\n  groom_last_name?: string;\n  bride_first_name?: string;\n  bride_last_name?: string;\n  // Date field\n  marriage_date?: string;\n  // Officiant\n  officiant_name?: string;\n  clergy?: string;\n  // Church\n  church_id?: number;\n  // Witnesses - JSON in production, string in legacy\n  witnesses?: string | string[];\n  // Location\n  place_name?: string;\n  marriage_place?: string;\n  // Registry fields\n  certificate_no?: string;\n  book_no?: string;\n  page_no?: string;\n  entry_no?: string;\n  // Metadata fields (production schema)\n  source_system?: string;\n  source_row_id?: string;\n  source_hash?: string;\n  notes?: string;\n  created_at?: string;\n  updated_at?: string;\n}\n\nconst MarriageRecordsPage: React.FC = () => {\n  const { user } = useAuth();\n  const [searchParams, setSearchParams] = useSearchParams();\n  const navigate = useNavigate();\n  \n  // Get church_id from URL query params first, fallback to user context\n  const urlChurchId = searchParams.get('church_id');\n  const [churchId, setChurchId] = useState<number | null>(\n    urlChurchId ? parseInt(urlChurchId) : (user?.church_id || null)\n  );\n  \n  const [records, setRecords] = useState<MarriageRecord[]>([]);\n  const [loading, setLoading] = useState(true);\n  const [error, setError] = useState<string | null>(null);\n  const [page, setPage] = useState(0);\n  const [rowsPerPage, setRowsPerPage] = useState(10);\n  const [totalRecords, setTotalRecords] = useState(0);\n  const [searchQuery, setSearchQuery] = useState('');\n  const [sortField, setSortField] = useState<string>('marriage_date');\n  const [sortDirection, setSortDirection] = useState<'asc' | 'desc'>('desc');\n\n  // Update churchId when URL param changes\n  useEffect(() => {\n    const urlChurchId = searchParams.get('church_id');\n    if (urlChurchId) {\n      const parsedId = parseInt(urlChurchId);\n      if (!isNaN(parsedId)) {\n        setChurchId(parsedId);\n      }\n    } else if (user?.church_id) {\n      setChurchId(user.church_id);\n    }\n  }, [searchParams, user?.church_id]);\n\n  useEffect(() => {\n    const fetchRecords = async () => {\n      let effectiveChurchId = churchId;\n      \n      if (!effectiveChurchId && (user?.role === 'super_admin' || user?.role === 'admin')) {\n        try {\n          const churchesResponse = await fetch('/api/my/churches', {\n            credentials: 'include',\n            headers: { 'Content-Type': 'application/json' }\n          });\n          \n          if (churchesResponse.ok) {\n            const churchesData = await churchesResponse.json();\n            const churches = churchesData.data?.churches || churchesData.churches || [];\n            if (churches.length > 0) {\n              effectiveChurchId = churches[0].id;\n              // Update state and URL if we're auto-selecting a church\n              if (!urlChurchId) {\n                setChurchId(effectiveChurchId);\n                setSearchParams({ church_id: effectiveChurchId.toString() }, { replace: true });\n                // Return early - useEffect will re-run with new churchId\n                return;\n              }\n            } else {\n              // No churches available - show appropriate error\n              if (user?.role === 'super_admin') {\n                setError('No churches found in the system. Please create a church first.');\n              } else {\n                setError('No church available. Please ensure you have access to at least one church.');\n              }\n              setLoading(false);\n              return;\n            }\n          } else {\n            // API error - show appropriate message\n            if (user?.role === 'super_admin') {\n              setError('Unable to load churches. Please try again or select a church manually.');\n            } else {\n              setError('No church available. Please ensure you have access to at least one church.');\n            }\n            setLoading(false);\n            return;\n          }\n        } catch (err) {\n          console.error('Error fetching churches:', err);\n          if (user?.role === 'super_admin') {\n            setError('Unable to load churches. Please try again or select a church manually.');\n          } else {\n            setError('No church available. Please ensure you have access to at least one church.');\n          }\n          setLoading(false);\n          return;\n        }\n      }\n      \n      if (!effectiveChurchId) {\n        // Only show hard error for non-superadmin users\n        if (user?.role !== 'super_admin') {\n          setError('No church available. Please ensure you have access to at least one church.');\n        } else {\n          setError('Select a church to view records. Use the church_id query parameter or ensure churches are available.');\n        }\n        setLoading(false);\n        return;\n      }\n\n      try {\n        setLoading(true);\n        setError(null);\n        \n        const params = new URLSearchParams({\n          page: (page + 1).toString(),\n          limit: rowsPerPage.toString()\n        });\n\n        if (searchQuery.trim()) {\n          params.append('search', searchQuery.trim());\n        }\n\n        const response = await fetch(`/api/marriage-records?${params.toString()}`, {\n          credentials: 'include',\n          headers: {\n            'Content-Type': 'application/json'\n          }\n        });\n\n        if (!response.ok) {\n          throw new Error(`Failed to load records: ${response.status} ${response.statusText}`);\n        }\n\n        const data = await response.json();\n        setRecords(data.records || []);\n        setTotalRecords(data.pagination?.total || data.totalRecords || 0);\n      } catch (err: any) {\n        console.error('Error fetching marriage records:', err);\n        setError(err.message || 'Failed to load marriage records');\n      } finally {\n        setLoading(false);\n      }\n    };\n\n    if (user) {\n      fetchRecords();\n    }\n  }, [user, churchId, page, rowsPerPage, searchQuery]);\n\n  const handleChangePage = (_: unknown, newPage: number) => {\n    setPage(newPage);\n  };\n\n  const handleChangeRowsPerPage = (event: React.ChangeEvent<HTMLInputElement>) => {\n    setRowsPerPage(parseInt(event.target.value, 10));\n    setPage(0);\n  };\n\n  const handleSearchChange = (event: React.ChangeEvent<HTMLInputElement>) => {\n    setSearchQuery(event.target.value);\n    setPage(0);\n  };\n\n  const handleRecordTypeChange = (_: React.SyntheticEvent, newValue: number) => {\n    const types = ['baptism', 'marriage', 'funeral'];\n    const newType = types[newValue];\n    const currentParams = new URLSearchParams(searchParams);\n    currentParams.set('church_id', churchId?.toString() || '');\n    navigate(`/apps/records/${newType}?${currentParams.toString()}`);\n  };\n\n  const handleSort = (field: string) => {\n    if (sortField === field) {\n      setSortDirection(sortDirection === 'asc' ? 'desc' : 'asc');\n    } else {\n      setSortField(field);\n      setSortDirection('asc');\n    }\n  };\n\n  const handleViewRecord = (recordId: number) => {\n    navigate(`/apps/records/marriage/${recordId}?church_id=${churchId}`);\n  };\n\n  const handleEditRecord = (recordId: number) => {\n    navigate(`/apps/records/marriage/edit/${recordId}?church_id=${churchId}`);\n  };\n\n  const handleDeleteRecord = async (recordId: number) => {\n    if (!confirm('Are you sure you want to delete this record?')) return;\n    console.log('Delete record:', recordId);\n  };\n\n  const handleRefresh = () => {\n    setPage(0);\n    setSearchQuery('');\n    window.location.reload();\n  };\n\n  const sortedRecords = [...records].sort((a, b) => {\n    const aVal = (a as any)[sortField] || '';\n    const bVal = (b as any)[sortField] || '';\n    if (sortDirection === 'asc') {\n      return aVal > bVal ? 1 : -1;\n    }\n    return aVal < bVal ? 1 : -1;\n  });\n\n  if (loading && records.length === 0) {\n    return (\n      <Box sx={{ p: 3, display: 'flex', justifyContent: 'center', alignItems: 'center', minHeight: '400px' }}>\n        <CircularProgress />\n      </Box>\n    );\n  }\n\n  return (\n    <Box sx={{ p: 3 }}>\n      {/* Header with Record Type Switcher */}\n      <Paper sx={{ mb: 2 }}>\n        <Tabs\n          value={1}\n          onChange={handleRecordTypeChange}\n          sx={{ borderBottom: 1, borderColor: 'divider' }}\n        >\n          <Tab label=\"Baptism Records\" />\n          <Tab label=\"Marriage Records\" />\n          <Tab label=\"Funeral Records\" />\n        </Tabs>\n      </Paper>\n\n      {/* Quick Facts */}\n      <Stack direction=\"row\" spacing={2} sx={{ mb: 2 }}>\n        <Chip label={`Total: ${totalRecords}`} color=\"primary\" variant=\"outlined\" />\n        <Chip label={`Showing: ${records.length}`} color=\"default\" variant=\"outlined\" />\n        {churchId && <Chip label={`Church ID: ${churchId}`} color=\"secondary\" variant=\"outlined\" />}\n      </Stack>\n\n      {/* Search and Actions Bar */}\n      <Paper sx={{ p: 2, mb: 2 }}>\n        <Stack direction=\"row\" spacing={2} alignItems=\"center\">\n          <TextField\n            placeholder=\"Search records...\"\n            value={searchQuery}\n            onChange={handleSearchChange}\n            size=\"small\"\n            sx={{ flexGrow: 1 }}\n            InputProps={{\n              startAdornment: (\n                <InputAdornment position=\"start\">\n                  <IconSearch size={20} />\n                </InputAdornment>\n              ),\n            }}\n          />\n          <Tooltip title=\"Refresh\">\n            <IconButton onClick={handleRefresh}>\n              <IconRefresh />\n            </IconButton>\n          </Tooltip>\n          <Button\n            variant=\"contained\"\n            onClick={() => navigate(`/apps/records/marriage/new?church_id=${churchId}`)}\n          >\n            New Record\n          </Button>\n          <Button\n            variant=\"outlined\"\n            startIcon={<IconReport size={18} />}\n            onClick={() => navigate(`/apps/interactive-reports/create?recordType=marriage&churchId=${churchId}`)}\n            sx={{ ml: 1 }}\n          >\n            Generate Report\n          </Button>\n        </Stack>\n      </Paper>\n\n      {error && (\n        <Alert severity=\"error\" sx={{ mb: 2 }} onClose={() => setError(null)}>\n          {error}\n        </Alert>\n      )}\n\n      {/* Records Table */}\n      <Paper sx={{ p: 3 }}>\n        <TableContainer>\n          <Table>\n            <TableHead>\n              <TableRow>\n                <TableCell>\n                  <Button size=\"small\" onClick={() => handleSort('id')} sx={{ textTransform: 'none', fontWeight: 'bold' }}>\n                    ID {sortField === 'id' && (sortDirection === 'asc' ? '↑' : '↓')}\n                  </Button>\n                </TableCell>\n                <TableCell>\n                  <Button size=\"small\" onClick={() => handleSort('groom_first_name')} sx={{ textTransform: 'none', fontWeight: 'bold' }}>\n                    Groom {sortField === 'groom_first_name' && (sortDirection === 'asc' ? '↑' : '↓')}\n                  </Button>\n                </TableCell>\n                <TableCell>\n                  <Button size=\"small\" onClick={() => handleSort('bride_first_name')} sx={{ textTransform: 'none', fontWeight: 'bold' }}>\n                    Bride {sortField === 'bride_first_name' && (sortDirection === 'asc' ? '↑' : '↓')}\n                  </Button>\n                </TableCell>\n                <TableCell>\n                  <Button size=\"small\" onClick={() => handleSort('marriage_date')} sx={{ textTransform: 'none', fontWeight: 'bold' }}>\n                    Marriage Date {sortField === 'marriage_date' && (sortDirection === 'asc' ? '↑' : '↓')}\n                  </Button>\n                </TableCell>\n                <TableCell>\n                  <Button size=\"small\" onClick={() => handleSort('marriage_place')} sx={{ textTransform: 'none', fontWeight: 'bold' }}>\n                    Location {sortField === 'marriage_place' && (sortDirection === 'asc' ? '↑' : '↓')}\n                  </Button>\n                </TableCell>\n                <TableCell>\n                  <Button size=\"small\" onClick={() => handleSort('clergy')} sx={{ textTransform: 'none', fontWeight: 'bold' }}>\n                    Clergy {sortField === 'clergy' && (sortDirection === 'asc' ? '↑' : '↓')}\n                  </Button>\n                </TableCell>\n                <TableCell>\n                  <Button size=\"small\" onClick={() => handleSort('witnesses')} sx={{ textTransform: 'none', fontWeight: 'bold' }}>\n                    Witnesses {sortField === 'witnesses' && (sortDirection === 'asc' ? '↑' : '↓')}\n                  </Button>\n                </TableCell>\n                <TableCell align=\"center\" sx={{ fontWeight: 'bold' }}>Actions</TableCell>\n              </TableRow>\n            </TableHead>\n            <TableBody>\n              {loading ? (\n                <TableRow>\n                  <TableCell colSpan={8} align=\"center\">\n                    <CircularProgress size={24} />\n                  </TableCell>\n                </TableRow>\n              ) : sortedRecords.length === 0 ? (\n                <TableRow>\n                  <TableCell colSpan={8} align=\"center\">\n                    <Typography color=\"text.secondary\">\n                      {searchQuery ? 'No records found matching your search' : 'No records found'}\n                    </Typography>\n                  </TableCell>\n                </TableRow>\n              ) : (\n                sortedRecords.map((record) => {\n                  // Support both production (groom_first) and legacy (groom_first_name) schemas\n                  const groomFirst = record.groom_first || record.groom_first_name || '';\n                  const groomMiddle = record.groom_middle || '';\n                  const groomLast = record.groom_last || record.groom_last_name || '';\n                  const groomName = record.groom_full || [groomFirst, groomMiddle, groomLast].filter(Boolean).join(' ').trim() || '-';\n                  \n                  const brideFirst = record.bride_first || record.bride_first_name || '';\n                  const brideMiddle = record.bride_middle || '';\n                  const brideLast = record.bride_last || record.bride_last_name || '';\n                  const brideName = record.bride_full || [brideFirst, brideMiddle, brideLast].filter(Boolean).join(' ').trim() || '-';\n                  \n                  // Use formatRecordDate for proper date display (YYYY-MM-DD)\n                  const marriageDate = formatRecordDate(record.marriage_date) || '-';\n                  const location = record.place_name || record.marriage_place || '-';\n                  const clergy = record.officiant_name || record.clergy || '-';\n                  // Handle JSON witnesses array from production or string from legacy\n                  const witnesses = displayJsonField(record.witnesses) || '-';\n                  \n                  return (\n                    <TableRow key={record.id} hover>\n                      <TableCell>{record.id}</TableCell>\n                      <TableCell>{groomName}</TableCell>\n                      <TableCell>{brideName}</TableCell>\n                      <TableCell>{marriageDate}</TableCell>\n                      <TableCell>{location}</TableCell>\n                      <TableCell>{clergy}</TableCell>\n                      <TableCell>{witnesses}</TableCell>\n                      <TableCell align=\"center\">\n                        <Stack direction=\"row\" spacing={1} justifyContent=\"center\">\n                          <Tooltip title=\"View\">\n                            <IconButton size=\"small\" onClick={() => handleViewRecord(record.id)}>\n                              <IconEye size={18} />\n                            </IconButton>\n                          </Tooltip>\n                          <Tooltip title=\"Edit\">\n                            <IconButton size=\"small\" onClick={() => handleEditRecord(record.id)}>\n                              <IconEdit size={18} />\n                            </IconButton>\n                          </Tooltip>\n                          <Tooltip title=\"Delete\">\n                            <IconButton size=\"small\" color=\"error\" onClick={() => handleDeleteRecord(record.id)}>\n                              <IconTrash size={18} />\n                            </IconButton>\n                          </Tooltip>\n                        </Stack>\n                      </TableCell>\n                    </TableRow>\n                  );\n                })\n              )}\n            </TableBody>\n          </Table>\n        </TableContainer>\n        \n        <TablePagination\n          component=\"div\"\n          count={totalRecords}\n          page={page}\n          onPageChange={handleChangePage}\n          rowsPerPage={rowsPerPage}\n          onRowsPerPageChange={handleChangeRowsPerPage}\n          rowsPerPageOptions={[10, 25, 50, 100]}\n        />\n      </Paper>\n    </Box>\n  );\n};\n\nexport default MarriageRecordsPage;\n"],"names":["parseJsonField","value","parsed","e","displayJsonField","arr","MarriageRecordsPage","user","useAuth","searchParams","setSearchParams","useSearchParams","navigate","useNavigate","urlChurchId","churchId","setChurchId","useState","records","setRecords","loading","setLoading","error","setError","page","setPage","rowsPerPage","setRowsPerPage","totalRecords","setTotalRecords","searchQuery","setSearchQuery","sortField","setSortField","sortDirection","setSortDirection","useEffect","parsedId","__async","effectiveChurchId","churchesResponse","churchesData","churches","_a","err","params","response","data","_b","handleChangePage","_","newPage","handleChangeRowsPerPage","event","handleSearchChange","handleRecordTypeChange","newValue","newType","currentParams","handleSort","field","handleViewRecord","recordId","handleEditRecord","handleDeleteRecord","handleRefresh","sortedRecords","a","b","aVal","bVal","Box","jsx","CircularProgress","Paper","jsxs","Tabs","Tab","Stack","Chip","TextField","InputAdornment","IconSearch","Tooltip","IconButton","IconRefresh","Button","IconReport","Alert","TableContainer","Table","TableHead","TableRow","TableCell","TableBody","Typography","record","groomFirst","groomMiddle","groomLast","groomName","brideFirst","brideMiddle","brideLast","brideName","marriageDate","formatRecordDate","location","clergy","witnesses","IconEye","IconEdit","IconTrash","TablePagination"],"mappings":"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"}